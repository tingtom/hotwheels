"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[911],{32932:function(e,t,n){let i,r,l;n.d(t,{$L:function(){return FC},$rW:function(){return fo},BoV:function(){return cp},C8M:function(){return function e(t,n){var i;let[r,...l]=n,a=t.members.find(e=>"fieldSet"===e.kind&&e.fieldSet.members.some(e=>"field"===e.kind&&e.name===r)),o=[{type:"expandPath",path:n}];a&&o.push({type:"expandFieldSet",path:a.fieldSet.path});let s=t.members.find(e=>"field"===e.kind&&e.name===r),d=t.schemaType.fields.find(e=>e.name===r),c=null==(i=t.groups.find(e=>e.selected))?void 0:i.name,u=c&&("all-fields"===c||d&&oK()(d.group).includes(c));return(u||o.push({type:"setSelectedGroup",path:t.path,groupName:"all-fields"}),s&&o.push({type:"expandPath",path:s.field.path}),0===l.length)?o:s&&mF(s)?o.concat([{type:"expandPath",path:s.field.path},...function(t,n){let[i,...r]=n;if(!(0,rM.Fd)(i))throw Error("Expected path segment to be an object with a _key property");let l=t.members.find(e=>e.key===i._key);return l?[{type:"expandPath",path:n},...e(l.item,r)]:[]}(s.field,l)]):o}},Cnp:function(){return Fb},Cw0:function(){return uU},Dqo:function(){return Rn},Dr7:function(){return uX},E6V:function(){return I0},EyJ:function(){return y2},F2f:function(){return Rv},FMn:function(){return ul},GWp:function(){return FF},H7Z:function(){return bs},HD0:function(){return c_},H__:function(){return Rg},Hdz:function(){return zs},IIC:function(){return vM},INm:function(){return I7},I_y:function(){return I3},LOQ:function(){return IH},LPT:function(){return uc},L_b:function(){return ps},Lky:function(){return SJ},MUX:function(){return cu},NEx:function(){return IX},OPK:function(){return M4},Q3k:function(){return E1},RgL:function(){return cy},Sis:function(){return FO},UMU:function(){return zv},Uy$:function(){return cC},WVR:function(){return TZ},YtX:function(){return Rw},Z7x:function(){return function e(t,n){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];if(n(t,i)){if("array"===t.type){"unchanged"!==t.action&&t.items.forEach(t=>{var r;let l="object"===t.diff.type&&(null==(r=t.diff.toValue)?void 0:r._key),a=l?{_key:l}:void 0===t.toIndex?t.fromIndex||0:t.toIndex;e(t.diff,n,i.concat(a))});return}if("object"===t.type){"unchanged"!==t.action&&Object.keys(t.fields).forEach(r=>{let l=t.fields[r];e(l,n,i.concat(r))});return}"string"===t.type&&"unchanged"!==t.action&&t.segments.forEach(t=>{e(t,n,i)})}}},ZDM:function(){return uV},_2T:function(){return pt},a3k:function(){return Me},ap5:function(){return Rx},cFj:function(){return SW},cWh:function(){return SY},clL:function(){return FR},d9t:function(){return IQ},duV:function(){return RF},eLL:function(){return pa},ek8:function(){return ch},euX:function(){return hS},fm0:function(){return p0},hHf:function(){return zh},iav:function(){return I1},jbM:function(){return ur},jr5:function(){return Fy},kwM:function(){return yQ},l$t:function(){return cW},m85:function(){return IW},mEJ:function(){return hR},mPO:function(){return cA},nqf:function(){return E2},nuD:function(){return I6},oUE:function(){return us},ogX:function(){return u3},pt$:function(){return function e(t,n,i){var r;if(0===n.length)return d6(d6({},t||{}),{},{value:i});let[l,...a]=n,o=(0,rM.Fd)(l)?l._key:String(l),s=null!=(r=null==t?void 0:t.children)?r:{};return{value:null==t?void 0:t.value,children:d6(d6({},s),{},{[o]:e(s[o]||{},a,i)})}}},quP:function(){return hw},qyu:function(){return cv},r8Q:function(){return mD},rq_:function(){return Rm},t2O:function(){return zd},uHP:function(){return FL},vSY:function(){return zg},vsM:function(){return cb},xJ:function(){return Mi},z1O:function(){return IY},zEW:function(){return I8},zaX:function(){return Rf}});var a,o,s,d,c,u,p,h,f,m,g,x,v,b,y,j,w,k,C,_,S,E,T,A,P,I,M,z,R,F,O,D,Z,L,q,N,V,B,U,K,H,$,X,W,G,Y,J,Q,ee,et,en,ei,er,el,ea,eo,es,ed,ec,eu,ep,eh,ef,em,eg,ex,ev,eb,ey,ej,ew,ek,eC,e_,eS,eE,eT,eA,eP,eI,eM,ez,eR,eF,eO,eD,eZ,eL,eq,eN,eV,eB,eU,eK,eH,e$,eX,eW,eG,eY,eJ,eQ,e0,e1,e2,e3,e4,e5,e6,e8,e7,e9,te,tt,tn,ti,tr,tl,ta,to,ts,td,tc,tu,tp,th,tf,tm,tg,tx,tv,tb,ty,tj,tw,tk,tC,t_,tS,tE,tT,tA,tP,tI,tM,tz,tR,tF,tO,tD,tZ,tL,tq,tN,tV,tB,tU,tK,tH,t$,tX,tW,tG,tY,tJ,tQ,t0,t1,t2,t3,t4,t5,t6,t8,t7,t9,ne,nt,nn,ni,nr,nl,na,no,ns,nd,nc,nu,np,nh,nf,nm,ng,nx,nv,nb,ny,nj,nw,nk,nC,n_,nS,nE,nT,nA,nP,nI,nM,nz,nR,nF,nO,nD,nZ,nL,nq,nN,nV,nB,nU,nK,nH,n$,nX,nW,nG,nY,nJ,nQ,n0,n1,n2,n3,n4,n5,n6,n8,n7,n9,ie,it,ii,ir,il,ia,io,is,id,ic,iu,ip,ih,im,ig,ix,iv,ib,iy,ij,iw,ik,iC,i_,iS,iE,iT,iA,iP,iI,iM,iz,iR,iF,iO,iD,iZ,iL,iq,iN,iV,iB,iU,iK,iH,i$,iX,iW,iG,iY,iJ,iQ,i0,i1,i2,i3,i4,i5,i6,i8,i7,i9,re,rt,rn,ri,rr,rl,ra,ro,rs,rd,rc,ru,rp,rh,rf,rm,rg,rx,rv,rb,ry,rj,rw,rk,rC,r_,rS,rE,rT,rA,rP=n(59729),rI=n.n(rP),rM=n(92212),rz=n(85893),rR=n(64927),rF=n(67294),rO=n(69590),rD=n.n(rO),rZ=n(23279),rL=n.n(rZ),rq=n(86023),rN=n(11636),rV=n(28440),rB=n(18170),rU=n(60429),rK=n(57027),rH=n(70211),r$=n(14370),rX=n(51410),rW=n(64944),rG=n(11633),rY=n(83720),rJ=n(5631),rQ=n(3222),r0=n(75142),r1=n(55760),r2=n(77232),r3=n(89233),r4=n(90964),r5=n(78556),r6=n(96381),r8=n(55709),r7=n(22807),r9=n(41931),le=n(40486),lt=n(66008),ln=n(67006),li=n(43485),lr=n(13068),ll=n(33756),la=n(1558),lo=n(51015),ls=n(47746),ld=n(81030),lc=n(76007),lu=n(30776),lp=n(22556),lh=n(89095),lf=n(31762),lm=n(3018),lg=n(13251),lx=n(25971),lv=n(86777),lb=n(7839),ly=n(5602),lj=n(56449),lw=n(43825),lk=n(92582),lC=n(11120),l_=n(73316),lS=n(34181),lE=n(3283),lT=n(14953),lA=n(71198),lP=n(88780),lI=n(18446),lM=n.n(lI),lz=n(58354),lR=n(23493),lF=n.n(lR),lO=n(14141),lD=n(89734),lZ=n.n(lD),lL=n(40168),lq=n(933),lN=n(88306),lV=n.n(lN),lB=n(21827),lU=n(47037),lK=n.n(lU),lH=n(18029),l$=n.n(lH),lX=n(80562),lW=n(5560),lG=n(42076),lY=n(30222),lJ=n(10623),lQ=n(73955),l0=n.n(lQ),l1=n(43703),l2=n(86298),l3=n(8230),l4=n(77349),l5=n(13956),l6=n(3151),l8=n(49160),l7=n(34176),l9=n(16218),ae=n(11640),at=n(44749),an=n(4543),ai=n(37042),ar=n(23855),al=n(39159),aa=n(61436),ao=n(42298),as=n(42034),ad=n(28366),ac=n(46038),au=n(82161),ap=n(31397),ah=n(69295),af=n(29383),am=n(76972),ag=n(69690),ax=n(11699),av=n(3982),ab=n(6803),ay=n.n(ab),aj=n(81548),aw=n(11190),ak=n(38993),aC=n.n(ak),a_=n(94184),aS=n.n(a_),aE=n(98235),aT=n(55379),aA=n(39693),aP=n.n(aA),aI=n(25325),aM=n.n(aI),az=n(24350),aR=n.n(az),aF=n(43174),aO=n.n(aF),aD=n(7334),aZ=n.n(aD),aL=n(93386),aq=n.n(aL),aN=n(44908),aV=n.n(aN),aB=n(58748),aU=n.n(aB),aK=n(85564),aH=n.n(aK),a$=n(59242),aX=n.n(a$),aW=n(92742),aG=n.n(aW),aY=n(25934),aJ=n(57557),aQ=n.n(aJ),a0=n(75472),a1=n.n(a0),a2=n(52027),a3=n(57122),a4=n(60814),a5=n(40258),a6=n(4527),a8=n(83508),a7=n(12707),a9=n(41609),oe=n.n(a9),ot=n(18156),on=n(6551),oi=n(76566),or=n.n(oi),ol=n(45578),oa=n.n(ol),oo=n(7739),os=n.n(oo),od=n(76590),oc=n(9095),ou=n(18612),op=n.n(ou),oh=n(6979),of=n.n(oh),om=n(36155),og=n.n(om),ox=n(45950),ov=n.n(ox),ob=n(96412),oy=n.n(ob),oj=n(4979),ow=n.n(oj),ok=n(27361),oC=n.n(ok),o_=n(13311),oS=n.n(o_),oE=n(60887),oT=n(45587),oA=n(24285),oP=n(32339),oI=n(29043),oM=n(98434),oz=n(68630),oR=n.n(oz),oF=n(48403),oO=n.n(oF),oD=n(23660),oZ=n(3522),oL=n.n(oZ);n(20745);var oq=n(96026),oN=n.n(oq),oV=n(989),oB=n.n(oV),oU=n(84596),oK=n.n(oU),oH=n(78718),o$=n.n(oH),oX=n(2141),oW=n(99119),oG=n(26642),oY=n.n(oG),oJ=n(90634),oQ=n.n(oJ),o0=n(63706),o1=n.n(o0),o2=n(91966),o3=n.n(o2),o4=n(6557),o5=n.n(o4),o6=n(52628),o8=n.n(o6),o7=n(28092),o9=n(2137),se=n(93735),st=n(5887),sn=n(65104),si=n(25874),sr=n(75175),sl=n(53416),sa=n(95534),so=n.n(sa),ss=n(45933),sd=n.n(ss),sc=n(54087),su=n.n(sc),sp=n(38063),sh=n(21137),sf=n(3147),sm=n(94786);let sg=["as","onScroll"],sx=["bounds"],sv=["children","className","isReviewChangesOpen","onOpenReviewChanges","onSetFocus"],sb=["children","selected","as"],sy=["tone","dimmed","muted"],sj=["getClient","loginMethod","redirectOnSingle"],sw=["clientFactory","projectId","dataset","loginMethod"],sk=["icon","layout","media","imageUrl","title"],sC=["layout","value","component","style","schemaType"],s_=["children","status","suffix","title"],sS=["onIntersection","io","id"],sE=["height"],sT=["validation","__unstable_presence","children","description","inputId","level","title"],sA=["validation","__unstable_presence","children","collapsible","columns","description","level","onFocus","onCollapse","onExpand","collapsed","tabIndex","title"],sP=["items","axis","onItemMove","onItemMoveStart","onItemMoveEnd","children"],sI=["onItemMove","onItemMoveEnd","onItemMoveStart","sortable"],sM=["sortable"],sz=["children","open","icon","title"],sR=["children","status","title"],sF=["value","onFocus","vertical"],sO=["members"],sD=["onFiles","onFilesOver","onFilesOut","disabled"],sZ=["icon","id","accept","capture","fontSize","multiple","onSelect","padding","space","textAlign","text","disabled"],sL=["icon","id","accept","capture","fontSize","multiple","onSelect","padding","space","textAlign","text","disabled"],sq=["readOnly","onDragStart","onDragEnd","onDrag"],sN=["drag","readOnly","isRejected","src"],sV=["diff","path"],sB=["annotations","children","description"],sU=["annotation","as","children","className","diff","disableHoverEffect","path","style","tooltip"],sK=["crop","diff","hash","hotspot","width","height"],sH=["crop","width","height"],s$=["hotspot","offset","width","height"],sX=["children","diff","object","schemaType","path"],sW=["diff","children","object","schemaType","path"],sG=["diff","object","schemaType"],sY=["diff","object","path","schemaType"],sJ=["diff","childDiff","children","path","segment"],sQ=["diff","childDiff","children","path","segment"],s0=["fieldFilter"],s1=["fieldFilter"],s2=["direction"],s3=["children","as","change"],s4=["align","layout","from","to","style"],s5=["selected"],s6=["change","readOnly","hidden"],s8=["enabled"],s7=["createOptions","onCreate","id"],s9=["value","onFocus","vertical"],de=["children"],dt=["children"],dn=["children"],di=["children"],dr=["children"],dl=["children"],da=["children"],ds=["children"],dd=["collapsedProps","expandedProps","tooltipProps","tooltipText","dividerBefore","fontSize","padding","text","icon","selected"],dc=["callback","children","options"],du=["hidden"],dp=["children","collapsed","collapseText","disableRestoreFocusOnClose","gap","menuButtonProps","onMenuClose"],dh=["collapsedProps","expandedProps","tooltipProps","tooltipText","dividerBefore"],df=["disabled","onChange","onFocus","placeholder","readOnly","value"],dm=["children","resolveUploader","onUpload","types"],dg=["validation","selected","tone","presence","children","dragHandle","menu","footer"],dx=["value","onFocus","vertical"],dv=["name","title"],db=["disabled","onClick"],dy=["onChange","onBlur","onKeyPress","value"],dj=["onChange"],dw=["selectTime","onFocusedDateChange","selectedDate","focusedDate","timeStep","onSelect"],dk=["value","onChange"],dC=["value","inputValue","onInputChange","onChange","selectTime","timeStep"],d_=["id","deserialize","formatInputValue","onChange","parseInputValue","placeholder","readOnly","selectTime","serialize","timeStep","value"],dS=["components"],dE=["compact","disableIntentLink","documentId","documentType","onClick"],dT=["children"],dA=["background","smallClearButton"],dP=["onChange","onBlur","onKeyPress","value"],dI=["onChange"],dM=["selectTime","onFocusedDateChange","selectedDate","focusedDate","timeStep","onSelect"],dz=["value","onChange"],dR=["plugins"],dF=["config","context","initialValue","propertyName"],dO=["unstable_sources"],dD=["activeIndex","children","fixedHeight","measure","virtualRow"],dZ=["children","setVirtualListRef","totalHeight"],dL=["item","onClose"],dq=["selected","type"],dN=["index","maxVisibleTypePillChars","showFiltersOnClick","value"],dV=["__recent"],dB=["name","tools"],dU=["name"],dK=["context","isSidebarOpen"],dH=["ConfigErrorsComponent"],d$=["unstable_globalStyles"],dX=["_id","_rev","_updatedAt"],dW=["resultRev"],dG=["document","permission"],dY=["templateItems"],dJ=["_updatedAt"],dQ=["user"],d0=["user"],d1=["children"],d2=["children","header","onClose","width"];function d3(e,t){if(null==e)return{};var n,i,r=function(e,t){if(null==e)return{};var n,i,r={},l=Object.keys(e);for(i=0;i<l.length;i++)n=l[i],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(i=0;i<l.length;i++)n=l[i],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function d4(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function d5(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,i)}return n}function d6(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?d5(Object(n),!0).forEach(function(t){var i,r;i=e,r=n[t],t in i?Object.defineProperty(i,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):i[t]=r}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):d5(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function d8(e){return"function"==typeof e?e():e}let d7=()=>void 0,d9=!1,ce=e=>{d9||console.warn(Error('No context provided for reporter. Make sure that the component calling "useReporter('.concat(e,', ...)", is wrapped in a <Tracker> element'))),d9=!0},ct=()=>(d9||console.warn(Error('No context provided for reporter. Make sure that the component calling "useReportedValues()", is wrapped inside a <Tracker> element')),d9=!0,()=>{}),cn={add:ce,update:ce,remove:ce,subscribe:ct,read:function(){return d9||console.warn(Error('No context provided for reporter. Make sure that the component calling "useReportedValues()", is wrapped inside a <Tracker> element')),d9=!0,[]}},ci=0,cr=()=>++ci;function cl(){let e=rF.createContext(cn),t=function(t,n){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Object.is,{add:r,update:l,remove:a}=rF.useContext(e),o=rF.useRef();rF.useLayoutEffect(()=>{if(null===t)return d7;let e=d8(n);return r(t,e),o.current=e,()=>{a(t)}},[r,t,a,n]),rF.useLayoutEffect(()=>{let e=d8(n);void 0===o.current||i(o.current,e)||null===t||l(t,e),o.current=e})};return{Tracker:function(t){let n=rF.useMemo(()=>(function(){let e=new Map,{publish:t,subscribe:n}=(0,rq.Z)(),i=rL()(t,10,{trailing:!0}),r=()=>Array.from(e.entries());return{add:function(t,n){e.has(t),e.set(t,n),i(r())},remove:function(t){e.has(t),e.delete(t),i(r())},update:function(t,n){e.has(t),e.set(t,n),i(r())},read:r,subscribe:n}})(),[]);return(0,rz.jsx)(e.Provider,{value:n,children:t.children})},useReportedValues:function(){let t=rF.useContext(e),[n,i]=rF.useState(t.read());return rF.useLayoutEffect(()=>(i(t.read()),t.subscribe(i)),[t]),n},useReporter:t,useAutoIdReporter:function(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Object.is;return t("element-".concat(rF.useRef(cr()).current),e,n)}}}let ca=cl(),co=ca.Tracker,cs=ca.useReportedValues,cd=ca.useReporter,cc=(0,rF.createContext)({isReviewChangesOpen:!1,onOpenReviewChanges:()=>void 0,onSetFocus:()=>void 0}),cu=e=>{let t=rF.useRef(null),{onSetFocus:n}=rF.useContext(cc),[i,r]=rF.useState(!1),l=rF.useCallback(()=>{r(!0)},[]),a=rF.useCallback(()=>{r(!1)},[]);cd("change-".concat(rR.BB(e.path)),()=>({element:t.current,path:e.path,isChanged:!0,hasFocus:!1,hasHover:i,hasRevertHover:e.hasHover}),rD());let o=(0,rF.useCallback)(t=>{var i;i=e.path,t.stopPropagation(),n(i)},[n,e.path]);return(0,rz.jsx)("div",{ref:t,onClick:o,onMouseLeave:a,onMouseEnter:l,children:e.children})};function cp(e){let t=(0,rF.useRef)(e);return lM()(t.current,e)||(t.current=e),t.current}function ch(e,t){let n=[t,!0],i={type:"tuple",tuple:n};return function(t){let r=cp(t),l=(0,rV.m2)(()=>(0,rB.of)(r).pipe((0,r6.w)(t=>(0,rU.z)((0,rB.of)({type:"loading"}),e(t).pipe((0,r8.U)(e=>({type:"value",value:e}))))),(0,r7.R)((e,t)=>{let[n]=e;return"loading"===t.type?[n,!0]:[t.value,!1]},n),(0,r9.x)((e,t)=>{let[n,i]=e,[r,l]=t;return n===r&&i===l}),(0,r8.U)(e=>({type:"tuple",tuple:e})),(0,le.K)(e=>(0,rB.of)({type:"error",error:e}))),[r],i);if("error"===l.type)throw l.error;return l.tuple}}function cf(e){return null!=e}let cm="".concat("drafts",".");function cg(e){return e.startsWith(cm)}function cx(e){return{draftId:cv(e),publishedId:cb(e)}}function cv(e){return cg(e)?e:cm+e}function cb(e){return cg(e)?e.slice(cm.length):e}function cy(e){let t=e.reduce((e,t)=>{let n=cb(t._id),i=e.get(n);return i||(i={id:n,type:t._type,published:void 0,draft:void 0},e.set(n,i)),i[n===t._id?"published":"draft"]=t,e},new Map);return Array.from(t.values())}function cj(e){return cy(e).map(e=>e.draft||e.published).filter(cf)}Object.freeze({});let cw=Object.freeze([]),ck=function(){if("undefined"!=typeof globalThis)return globalThis;if("undefined"!=typeof window)return window;if("undefined"!=typeof self)return self;if(void 0!==n.g)return n.g;throw Error("@sanity/ui: could not locate global scope")}();function cC(e){return Boolean(e)&&"object"==typeof e&&!Array.isArray(e)}function c_(e){return"string"==typeof e}let cS="object"==typeof document&&"object"==typeof window&&window.ResizeObserver?window.ResizeObserver:lz.do,cE=(()=>{let e=(0,rq.Z)(),t=new cS(t=>e.publish(t));return{observe:(n,i,r)=>{let l=e.subscribe(e=>{let t=e.find(e=>e.target===n);t&&i(t)});return t.observe(n,r),()=>{l(),t.unobserve(n)}}}})(),cT=["sanity.imageAsset","sanity.fileAsset"];function cA(e){return"document"===e.type&&!("document"===e.type&&cT.includes(e.name))}let cP=["match","in","asc","desc","true","false","null"],cI=/^[a-zA-Z_][a-zA-Z0-9_]*$/,cM=e=>!cI.test(e)||cP.includes(e),cz=e=>'["'.concat(e,'"]'),cR=e=>"@".concat(cz(e)),cF=e=>Array.isArray(e)&&0===e.length,cO=e=>{let t="";for(let n=0;n<e.length;n++){let i=e[n];if(cF(i)){t+="[]";continue}if("number"==typeof i){t+="[".concat(i,"]");continue}let r=0===n,l=cM(i);t=l?r?cR(i):"".concat(t).concat(cz(i)):r?i:"".concat(t,".").concat(i)}return t},cD={isLoading:!0,value:void 0,error:null};function cZ(e,t){return(0,rV.m2)(()=>e.pipe(e=>e.pipe((0,r8.U)(e=>({isLoading:!1,value:e,error:null})),(0,le.K)(e=>(0,rB.of)({isLoading:!1,value:void 0,error:e})))),[e],void 0===t?cD:{isLoading:!1,value:t,error:null})}let cL=lO.ZP.div(e=>{let{changed:t,disabled:n,isReviewChangeOpen:i}=e;return n?(0,lO.iv)(a||(a=d4(["\n      "," {\n        display: none;\n      }\n    "])),cN):(0,lO.iv)(o||(o=d4(["\n    --change-bar-offset: 2px;\n\n    display: flex;\n    position: relative;\n\n    @media (hover: hover) {\n      &:hover {\n        z-index: 10;\n      }\n    }\n\n    /* hide when field is not changed */\n    ","\n\n    /* hide hover effect when review changes is open */\n    ","\n  "])),!t&&(0,lO.iv)(s||(s=d4(["\n      "," {\n        opacity: 0;\n        pointer-events: none;\n      }\n    "])),cN),i&&(0,lO.iv)(d||(d=d4(["\n      "," {\n        opacity: 0;\n      }\n    "])),cB))}),cq=lO.ZP.div(c||(c=d4(["\n  flex-grow: 1;\n  min-width: 0;\n"]))),cN=lO.ZP.div(u||(u=d4(["\n  position: relative;\n  opacity: 1;\n  transition: opacity 100ms;\n  z-index: ",";\n"])),e=>{let{$zIndex:t}=e;return t}),cV=lO.ZP.div(e=>{let{theme:t}=e,n=t.sanity.color.spot.yellow,i=t.sanity.media[0];return(0,lO.iv)(p||(p=d4(["\n    position: absolute;\n    top: 0;\n    left: var(--change-bar-offset);\n    width: 2px;\n    bottom: 0;\n    background-color: ",";\n    border-radius: 1px;\n\n    @media (min-width: ","px) {\n      display: unset;\n    }\n  "])),n,i)}),cB=lO.ZP.button(e=>{let{theme:t,$withHoverEffect:n}=e,i=t.sanity.color.spot.yellow;return(0,lO.iv)(h||(h=d4(["\n      appearance: none;\n      border: 0;\n      outline: 0;\n      display: block;\n      padding: 0;\n      background: transparent;\n      opacity: 0;\n      position: absolute;\n      height: 100%;\n      cursor: pointer;\n      pointer-events: all;\n      left: calc(-0.25rem + var(--change-bar-offset));\n      width: 1rem;\n      transition: opacity ","ms;\n\n      &:focus {\n        border: 0;\n        outline: 0;\n      }\n\n      &:after {\n        content: '';\n        width: 16px;\n        height: calc(100% + 14px);\n        display: block;\n        position: absolute;\n        top: -7px;\n        left: -3px;\n        border-radius: 8px;\n        background: ",";\n      }\n\n      &:focus {\n        border: 0;\n        outline: 0;\n      }\n\n      ","\n    "])),250,i,n&&(0,lO.iv)(f||(f=d4(["\n        @media (hover: hover) {\n          &:hover {\n            opacity: 0.2;\n          }\n        }\n      "]))))});function cU(e){let{children:t,disabled:n,hasFocus:i,isChanged:r,withHoverEffect:l=!0}=e,[a,o]=(0,rF.useState)(!1),{onOpenReviewChanges:s,isReviewChangesOpen:d}=rF.useContext(cc),{zIndex:c}=(0,rN.sJ)(),u=(0,rF.useCallback)(()=>o(!0),[]),p=(0,rF.useCallback)(()=>o(!1),[]),h=(0,rF.useMemo)(()=>n||!r?null:(0,rz.jsxs)(cN,{"data-testid":"change-bar",$zIndex:c,children:[(0,rz.jsx)(cV,{"data-testid":"change-bar__marker"}),(0,rz.jsx)(cB,{"aria-label":"Review changes","data-testid":"change-bar__button",onClick:d?void 0:s,onMouseEnter:u,onMouseLeave:p,tabIndex:-1,type:"button",$withHoverEffect:l})]}),[n,r,c,d,s,u,p,l]);return(0,rz.jsxs)(cL,{changed:r,"data-testid":"change-bar-wrapper",disabled:n,focus:i,hover:a,isReviewChangeOpen:d,children:[(0,rz.jsx)(cq,{"data-testid":"change-bar__field-wrapper",children:t}),h]})}let cK=(0,rF.memo)(function(e){let{children:t,className:n,disabled:i,hasFocus:r,isChanged:l,path:a=cw,withHoverEffect:o}=e,s=(0,rN.sJ)(),[d,c]=rF.useState(!1),u=rF.useCallback(()=>c(!0),[]),p=rF.useCallback(()=>c(!1),[]),h=rF.useRef(null);return cd(i?null:"field-".concat(rR.BB(a)),()=>({element:h.current,path:a,isChanged:l,hasFocus:r,hasHover:d,zIndex:s.zIndex}),rD()),(0,rz.jsx)("div",{ref:h,className:n,onMouseEnter:u,onMouseLeave:p,children:(0,rz.jsx)(cU,{hasFocus:r,isChanged:l,disabled:i,withHoverEffect:o,children:t})})});function cH(e){let{children:t,className:n,disabled:i,hasFocus:r,isChanged:l,path:a,withHoverEffect:o}=e;return(0,rz.jsx)(cK,{className:n,disabled:i,path:a,hasFocus:r,isChanged:l,withHoverEffect:o,children:t})}rF.createContext({path:[],fullPath:[],focusPath:[],isChanged:!1});let c$=rF.createContext(null),cX=()=>void 0,cW=rF.forwardRef(function(e,t){let{as:n="div",onScroll:i}=e,r=d3(e,sg),l=(0,rN.ts)(t),a=(0,rF.useContext)(c$),o=(0,rF.useMemo)(()=>(0,rq.Z)(),[]);return(0,rF.useEffect)(()=>i?o.subscribe(i):cX,[o,i]),(0,rF.useEffect)(()=>a?o.subscribe(a.publish):cX,[a,o]),(0,rF.useEffect)(()=>{let e=e=>{o.publish(e)},t=l.current;if(t)return t.addEventListener("scroll",e,{passive:!0,capture:!0}),()=>{t.removeEventListener("scroll",e)}},[o,l]),(0,rz.jsx)(c$.Provider,{value:o,children:rF.createElement(n,d6({ref:l,"data-testid":"scroll-container"},r))})});function cG(e){let{onScroll:t,children:n}=e;return!function(e){let t=rF.useContext(c$);rF.useEffect(()=>null==t?void 0:t.subscribe(e),[e])}(t),(0,rz.jsx)(rz.Fragment,{children:n})}function cY(e,t,n){let i;let r=t.slice(t.indexOf("-")+1)||"[]",l=rR.mL(r),a="".concat(e,"-").concat(rR.BB(l));if(n.has(a))return n.get(a);for(let[o,s]of n){if(!("path"in s)||!o.startsWith(e))continue;let d=rR.eh(l,s.path),c=s.path[s.path.length-1],u=d===s.path.length-1&&(0,rM.fU)(c);if(0!==d&&(d===s.path.length||u)&&(i=s,d===l.length))break}return i}function cJ(e){let t=getComputedStyle(e).overflow;return t.includes("auto")||t.includes("scroll")}function cQ(e){let t=e.element,n=t;for(;!function(e){let t=e.scrollHeight!==e.offsetHeight||e.scrollWidth!==e.offsetWidth;return t&&cJ(e)}(n);)if(!(n=n.parentElement))return;n.scroll({top:n.scrollTop+e.rect.top-e.bounds.top+-15,left:0,behavior:"smooth"})}let c0=(e,t)=>{let n={top:0,left:0,height:t.offsetHeight,width:t.offsetWidth},i={top:0,left:0,height:e.offsetHeight,width:e.offsetWidth},r=!1,l=e;for(;l&&l!==t&&t.contains(l);)r&&(n.top+=l.offsetTop,n.left+=l.offsetLeft),cJ(l)&&(n.top=l.offsetTop,n.height=l.offsetHeight,n.left=l.offsetLeft,n.width=l.offsetWidth,r=!0),i.top+=l.offsetTop-l.scrollTop,i.left+=l.offsetLeft-l.scrollLeft,l=l.offsetParent;return{rect:i,bounds:n}};function c1(e,t,n){return["M ".concat(e-4," ").concat(t-4*n," "),"L ".concat(e," ").concat(t),"L ".concat(e+4," ").concat(t-4*n)].join("")}function c2(e,t){return"M".concat(e," ").concat(t)}function c3(e,t){return"L".concat(e," ").concat(t)}function c4(e,t,n,i){return"Q".concat(e," ").concat(t," ").concat(n," ").concat(i)}function c5(e,t){let n=e.top+e.height/2,i=e.top+e.height<t.top+2,r=e.top>t.top+t.height-2;return{bounds:t,left:e.left,top:n,centerY:n,startY:e.top+8,endY:e.top+e.height-8,isAbove:i,isBelow:r,outOfBounds:i||r}}lO.ZP.rect(m||(m=d4(["\n  stroke: #ccc;\n  fill: none;\n  pointer-events: none;\n  stroke-linecap: round;\n"])));let c6=lO.ZP.path(e=>{let{theme:t}=e,n=t.sanity.color.spot.yellow;return(0,lO.iv)(g||(g=d4(["\n    fill: none;\n    pointer-events: none;\n    stroke-linecap: round;\n    stroke-linejoin: round;\n    stroke: ",";\n  "])),n)}),c8=lO.ZP.path(e=>{let{theme:t}=e,n=t.sanity.color.spot.yellow;return(0,lO.iv)(x||(x=d4(["\n    fill: none;\n    pointer-events: stroke;\n    stroke: ",";\n    cursor: pointer;\n    stroke-linecap: round;\n    stroke-linejoin: round;\n    opacity: 0;\n\n    &:hover {\n      opacity: 0.2;\n    }\n  "])),n)}),c7=(0,lO.ZP)(function(e){let{bounds:t}=e,n=d3(e,sx),i=Math.max(t.left,e.left),r=Math.max(e.top,t.top),l=Math.max(0,e.height-(r-e.top)),a=Math.max(0,e.width-(i-e.left));return(0,rz.jsx)("rect",d6(d6({},n),{},{x:i,y:r,height:l,width:a}))})(e=>{let{theme:t}=e,n=t.sanity.color.spot.yellow;return(0,lO.iv)(v||(v=d4(["\n    stroke: none;\n    pointer-events: none;\n    fill: ",";\n  "])),n)}),c9=(0,rF.memo)(function(e){let{from:t,to:n}=e,i=function(e){let t={top:e.from.bounds.top+12,bottom:e.from.bounds.top+e.from.bounds.height-12,left:e.from.bounds.left,right:e.from.bounds.left+e.from.bounds.width,width:e.from.bounds.width,height:e.from.bounds.height-24},n=c5(e.from.rect,t);n.left=e.from.rect.left+e.from.rect.width+1;let i={top:e.to.bounds.top+12,bottom:e.to.bounds.top+e.to.bounds.height-12,left:e.to.bounds.left,right:e.to.bounds.left+e.to.bounds.width,width:e.to.bounds.width,height:e.to.bounds.height-24},r=c5(e.to.rect,i),l=Math.max(r.startY,n.startY);return n.top=Math.min(l,n.endY),n.top<i.top?n.top=Math.min(i.top,n.endY):n.top>i.bottom&&(n.top=Math.max(i.bottom,n.startY)),r.top=Math.min(l,r.endY),r.top<t.top?r.top=Math.min(t.top,r.endY):r.top>t.bottom&&(r.top=Math.max(t.bottom,r.startY)),n.top=Math.min(Math.max(n.top,t.top),t.bottom),r.top=Math.min(Math.max(r.top,i.top),i.bottom),{from:n,to:r}}({from:t,to:n});if(i.from.outOfBounds&&i.to.outOfBounds)return null;let r=function(e){let{from:t,to:n}=e,{left:i,top:r}=t,{left:l,top:a}=n,o=[],s=Math.min(4,Math.abs(r-a)/2);return t.isAbove?o.push(c2(i+8,r-12+2),c3(i+8,r-4),c4(i+8,r,i+8+4,r)):t.isBelow?o.push(c2(i+8,r+12-2),c3(i+8,r+4),c4(i+8,r,i+8+4,r)):o.push(c2(i,r)),n.isAbove?r<n.bounds.top?o.push(c3(n.bounds.left-8-s,r),c4(n.bounds.left-8,r,n.bounds.left-8,r+s),c3(n.bounds.left-8,a-s),c4(n.bounds.left-8,a,n.bounds.left-8+s,a),c3(n.bounds.left+8-4,a),c4(n.bounds.left+8,a,n.bounds.left+8,a-4),c3(n.bounds.left+8,a-12+2)):o.push(c3(n.bounds.left+8-4,r),c4(n.bounds.left+8,r,n.bounds.left+8,r-4),c3(n.bounds.left+8,a-12+2)):n.isBelow?r>n.bounds.top+n.bounds.height?o.push(c3(n.bounds.left-8-s,r),c4(n.bounds.left-8,r,n.bounds.left-8,r-s),c3(n.bounds.left-8,a+s),c4(n.bounds.left-8,a,n.bounds.left-8+s,a),c3(n.bounds.left+8-4,a),c4(n.bounds.left+8,a,n.bounds.left+8,a+4),c3(n.bounds.left+8,a+12-2)):o.push(c3(n.bounds.left+8-4,r),c4(n.bounds.left+8,r,n.bounds.left+8,r+4),c3(n.bounds.left+8,a+12-2)):r<a?o.push(c3(n.bounds.left+8-s,r),c4(n.bounds.left+8,r,n.bounds.left+8,r+s),c3(n.bounds.left+8,a-s),c4(n.bounds.left+8,a,n.bounds.left+8+s,a),c3(l,a)):o.push(c3(n.bounds.left+8-s,r),c4(n.bounds.left+8,r,n.bounds.left+8,r-s),c3(n.bounds.left+8,a+s),c4(n.bounds.left+8,a,n.bounds.left+8+s,a),c3(l,a)),function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return e.join(t)}(o)}(i);return(0,rz.jsxs)(rz.Fragment,{children:[(0,rz.jsx)(c8,{d:r,strokeWidth:16}),(0,rz.jsx)(c6,{d:r,strokeWidth:2}),(0,rz.jsx)(c7,{top:n.rect.top,left:n.rect.left,height:n.rect.height,width:2,bounds:n.bounds}),i.from.isAbove&&(0,rz.jsx)(c6,{d:c1(i.from.left+8,i.from.bounds.top-12+2,-1),strokeWidth:2}),i.from.isBelow&&(0,rz.jsx)(c6,{d:c1(i.from.left+8,i.from.bounds.top+i.from.bounds.height+12-2,1),strokeWidth:2}),i.to.isAbove&&(0,rz.jsx)(c6,{d:c1(i.to.bounds.left+8,i.to.bounds.top-12+2,-1),strokeWidth:2}),i.to.isBelow&&(0,rz.jsx)(c6,{d:c1(i.to.bounds.left+8,i.to.bounds.top+i.to.bounds.height+12-2,1),strokeWidth:2}),!1]})}),ue=lO.ZP.svg(b||(b=d4(["\n  pointer-events: none;\n  position: absolute;\n  left: 0;\n  top: 0;\n  right: 0;\n  bottom: 0;\n  width: 100%;\n  height: 100%;\n"])));function ut(e,t,n,i){let r=[],l=[];for(let a of e){if(!("changePanel"!==a[0])||!a[1].isChanged)continue;let[o,s]=a;if(o===t||s.hasHover){r.push(a);continue}if(s.hasFocus){l.push(a);continue}}let d=r.length>0,c=(d?r:l).map(e=>{let[t]=e,i=cY("field",t,n),r=cY("change",t,n);return i&&r?{field:d6({id:t},i),change:d6({id:t},r)}:null}).filter(cf).map(e=>{let{field:t,change:n}=e;return{hasHover:t.hasHover||n.hasHover,hasFocus:t.hasFocus,hasRevertHover:n.hasRevertHover,field:d6(d6({},t),c0(t.element,i)),change:d6(d6({},n),c0(n.element,i))}});return{connectors:c,isHoverConnector:d}}function un(e){let{rootElement:t,onSetFocus:n}=e,[i,r]=rF.useState(null),l=cs(),a=(0,rF.useMemo)(()=>new Map(l),[l]),[{connectors:o},s]=(0,rF.useState)(()=>ut(l,i,a,t)),d=(0,rF.useMemo)(()=>lZ()(o,e=>0-e.field.path.length).slice(0,1),[o]),c=(0,rF.useCallback)(()=>{s(ut(l,i,a,t))},[a,l,i,t]);return(0,rF.useEffect)(()=>cE.observe(t,c),[t,c]),(0,rz.jsx)(cG,{onScroll:c,children:(0,rz.jsx)(ue,{style:{zIndex:d[0]&&d[0].field.zIndex},children:d.map(e=>{let{field:t,change:i}=e;return i?(0,rz.jsx)(ui,{field:t,change:i,onSetFocus:n,setHovered:r},t.id):null})})})}function ui(e){let{change:t,field:n,onSetFocus:i,setHovered:r}=e,l=(0,rF.useCallback)(()=>{cQ(n),cQ(t),i(n.path)},[n,t,i]),a=(0,rF.useCallback)(()=>r(n.id),[n,r]),o=(0,rF.useCallback)(()=>r(null),[r]),s=(0,rF.useMemo)(()=>({rect:{left:n.rect.left+2,top:n.rect.top,height:n.rect.height,width:n.rect.width},bounds:n.bounds}),[n.bounds,n.rect]),d=(0,rF.useMemo)(()=>({rect:t.rect,bounds:t.bounds}),[t.bounds,t.rect]);return(0,rz.jsxs)(rz.Fragment,{children:[(0,rz.jsx)("g",{onClick:l,onMouseEnter:a,onMouseLeave:o,children:(0,rz.jsx)(c9,{from:s,to:d})}),!1]})}let ur=function(e){let{children:t,className:n,isReviewChangesOpen:i,onOpenReviewChanges:r,onSetFocus:l}=e,a=d3(e,sv),[o,s]=rF.useState(),d=(0,rF.useMemo)(()=>({isReviewChangesOpen:i,onOpenReviewChanges:r,onSetFocus:l}),[i,r,l]);return(0,rz.jsx)(cc.Provider,{value:d,children:(0,rz.jsx)(co,{children:(0,rz.jsxs)(cW,d6(d6({},a),{},{ref:s,className:n,children:[t,o&&(0,rz.jsx)(un,{rootElement:o,onSetFocus:l})]}))})})};function ul(e){var t,n;let{currentUser:i,title:r="Insufficient permissions",operationLabel:l="access this feature"}=e,a=(null==i?void 0:i.roles)||[],o=1!==a.length;return(0,rz.jsxs)(rN.xu,{padding:2,children:[(0,rz.jsxs)(rN.gF,{space:2,children:[(0,rz.jsx)(rN.xv,{size:1,children:(0,rz.jsx)(lL.vaB,{})}),(0,rz.jsx)(rN.xv,{weight:"semibold",children:r})]}),(0,rz.jsx)(rN.gF,{marginTop:4,children:(0,rz.jsx)(rN.xv,{size:1,children:0===a.length?(0,rz.jsxs)(rz.Fragment,{children:["You have no role that grants you permission to ",l]}):(0,rz.jsxs)(rz.Fragment,{children:["Your role",o&&"s"," ",(t=a.map(e=>(0,rz.jsx)("code",{children:e.title},e.name)),n=(0,rz.jsx)(rz.Fragment,{children:", "}),t.reduce((e,t)=>null===e?[t]:[...e,n,t],null))," ","do",o||"es"," not have permissions to ",l]})})})]})}let ua=(0,lO.ZP)(rN.Zb)(()=>(0,lO.iv)(y||(y=d4(["\n    /* this is a hack to avoid layout jumps while previews are loading\n    there's probably better ways of solving this */\n    min-height: 35px;\n\n    /* TextWithTone uses its own logic to set color, and we therefore need */\n    /* to override this logic in order to set the correct color in different states */\n    &[data-selected],\n    &[data-pressed],\n    &:active {\n      [data-ui='TextWithTone'] {\n        color: inherit;\n      }\n    }\n  "])))),uo=(0,rF.createContext)({selected:!1}),us=(0,rF.forwardRef)(function(e,t){let{children:n,selected:i,as:r}=e,l=d3(e,sb);return(0,rz.jsx)(ua,d6(d6({"data-ui":"PreviewCard"},l),{},{forwardedAs:r,ref:t,selected:i,children:(0,rz.jsx)(uo.Provider,{value:{selected:i},children:n})}))}),ud=(0,lO.ZP)(rN.xv)(e=>{let{$tone:t,theme:n}=e,i=n.sanity.color.muted[t];return(0,lO.iv)(j||(j=d4(["\n    &:not([data-muted]) {\n      --card-fg-color: ",";\n    }\n\n    &[data-dimmed] {\n      opacity: 0.3;\n    }\n  "])),i?i.enabled.fg:void 0)}),uc=rF.forwardRef(function(e,t){let{tone:n,dimmed:i,muted:r}=e,l=d3(e,sy);return(0,rz.jsx)(ud,d6({"data-ui":"TextWithTone","data-dimmed":i?"":void 0,"data-muted":r?"":void 0,$tone:n,muted:r,ref:t},l))}),uu=(0,rF.createContext)(null);function up(e){let{children:t}=e,n=(0,rF.useMemo)(()=>{let e=new Map,t={};return{get:n=>{let{namespace:i,dependencies:r}=n,l=r.map(e=>null===e?t:e),a=e.get(i);return null==a?void 0:a.get(l)},set:n=>{let{namespace:i,dependencies:r,value:l}=n,a=e.get(i)||function(){let e=new WeakMap,t=new WeakMap;function n(e){return Array.from(new Set(e)).map(e=>[function(e){let n=t.get(e);if(n)return n;let i=Array.from({length:10}).map(()=>Math.floor(255*Math.random()).toString(16).padStart(2,"0")).join("");return t.set(e,i),i}(e),e]).sort((e,t)=>{let[n]=e,[i]=t;return n.localeCompare(i,"en")}).map(e=>{let[,t]=e;return t})}return{get:function(t){return function e(t,n){if(!t.length)return;let[i,...r]=t,l=n.get(i);if(l)return r.length?e(r,l.next):l.value}(n(t),e)},set:function(t,i){!function e(t,n,i){if(!t.length)return;let[r,...l]=t,a=n.get(r)||{type:"multi-key-weak-map-node",value:void 0,next:new WeakMap};if(n.set(r,a),!l.length){a.value=i;return}e(l,a.next,i)}(n(t),e,i)}}}(),o=r.map(e=>null===e?t:e);e.set(i,a),a.set(o,l)}}},[]);return(0,rz.jsx)(uu.Provider,{value:n,children:t})}function uh(){let e=(0,rF.useContext)(uu);if(!e)throw Error("Could not find `cache` context");return e}class uf extends Error{constructor(e){let{projectId:t}=e;super("CorsOriginError"),this.projectId=t}}let um=(()=>{let e="__tmp_supports_local_storage";try{if("undefined"==typeof localStorage)return!1;return localStorage.setItem(e,"---"),localStorage.removeItem(e),!0}catch(t){return!1}})(),ug={};function ux(e,t){um?localStorage[e]=t:ug[e]=t}function uv(e){um?localStorage.removeItem(e):delete ug[e]}let ub=/sid=[^&]{20,}/,uy=function(){if("undefined"==typeof window||"object"!=typeof window.location)return null;let e=window.location.hash,[t]=e.match(ub)||[];if(!t)return null;let n=t.slice(t.indexOf("=")+1),i=e.replace(ub,""),r=new URL(window.location.href);return r.hash=i.length>1?i:"",history.replaceState(null,"",r),n}(),uj=lO.ZP.svg(e=>{let{theme:t}=e,{fg:n}=t.sanity.color.base;return(0,lO.iv)(w||(w=d4(["\n    fill: ",";\n  "])),n)}),uw=()=>(0,rz.jsx)(uj,{width:"1em",height:"1em",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 438.55 438.55",children:(0,rz.jsx)("path",{d:"M409.13 114.57a218.32 218.32 0 0 0-79.8-79.8Q278.94 5.36 219.27 5.36T109.21 34.77a218.29 218.29 0 0 0-79.8 79.8Q0 165 0 224.63q0 71.67 41.83 128.91t108.06 79.23q7.71 1.43 11.42-2a11.17 11.17 0 0 0 3.69-8.57q0-.86-.14-15.42t-.14-25.41l-6.57 1.14a83.77 83.77 0 0 1-15.85 1 120.73 120.73 0 0 1-19.84-2 44.34 44.34 0 0 1-19.11-8.51 36.23 36.23 0 0 1-12.56-17.6l-2.86-6.57a71.34 71.34 0 0 0-9-14.56q-6.14-8-12.42-10.85l-2-1.43a21 21 0 0 1-3.71-3.43 15.66 15.66 0 0 1-2.57-4q-.86-2 1.43-3.29C61.2 310.42 64 310 68 310l5.71.85q5.71 1.14 14.13 6.85a46.08 46.08 0 0 1 13.85 14.84q6.57 11.71 15.85 17.85t18.7 6.14a81.19 81.19 0 0 0 16.27-1.42 56.78 56.78 0 0 0 12.85-4.29q2.57-19.14 14-29.41a195.49 195.49 0 0 1-29.36-5.13 116.52 116.52 0 0 1-26.83-11.14 76.86 76.86 0 0 1-23-19.13q-9.14-11.42-15-30t-5.8-42.81q0-34.55 22.56-58.82-10.57-26 2-58.24 8.28-2.57 24.55 3.85t23.84 11q7.57 4.56 12.13 7.71a206.2 206.2 0 0 1 109.64 0l10.85-6.85a153.65 153.65 0 0 1 26.26-12.56q15.13-5.71 23.13-3.14 12.84 32.26 2.28 58.24 22.55 24.27 22.56 58.82 0 24.27-5.85 43t-15.12 30a79.82 79.82 0 0 1-23.13 19 116.74 116.74 0 0 1-26.84 11.14 195.29 195.29 0 0 1-29.23 5.07q14.8 12.84 14.81 40.58v60.2a11.37 11.37 0 0 0 3.57 8.56q3.57 3.42 11.28 2 66.24-22 108.07-79.23t41.83-128.91q-.03-59.62-29.43-110.05z"})}),uk=()=>(0,rz.jsxs)("svg",{width:"1em",height:"1em",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 48 48",children:[(0,rz.jsx)("path",{d:"M11 24a13 13 0 0 1 .66-4.08l-7.4-5.66a22.18 22.18 0 0 0 0 19.49l7.4-5.67A13 13 0 0 1 11 24z",fill:"#fbbc05"}),(0,rz.jsx)("path",{d:"M24 11a12.72 12.72 0 0 1 8.1 2.9l6.4-6.4a22 22 0 0 0-34.24 6.75l7.4 5.66A13 13 0 0 1 24 11z",fill:"#ea4335"}),(0,rz.jsx)("path",{d:"M24 37a13 13 0 0 1-12.34-8.92l-7.4 5.66A21.93 21.93 0 0 0 24 46a21 21 0 0 0 14.33-5.48l-7-5.44A13.59 13.59 0 0 1 24 37zm-12.35-8.93l-7.4 5.67 7.4-5.66z",fill:"#34a853"}),(0,rz.jsx)("path",{d:"M44.5 20H24v8.5h11.8a9.91 9.91 0 0 1-4.49 6.58l7 5.44C42.37 36.76 45 31.17 45 24a18.25 18.25 0 0 0-.5-4z",fill:"#4285f4"})]}),uC={google:uk,github:uw,custom:function(e){let{provider:t}=e;return t.logo?(0,rz.jsx)("img",{src:t.logo,alt:"Logo for ".concat(t.name)}):void 0}};async function u_(e){let{client:t,mode:n,providers:i=[]}=e,{providers:r,thirdPartyLogin:l,sso:a}=await t.request({uri:"/auth/providers"});if(!i.length)return r;let o=i.map(e=>{let t=r.some(t=>t.url===e.url),n=t||l||a&&Object.values(a).some(Boolean);return d6(d6({},e),{},{custom:!t,supported:n})});return"replace"===n?o:r.filter(e=>o.some(t=>t.url!==e.url)).concat(o)}function uS(e){let{loginMethod:t,projectId:n,url:i,basePath:r}=e,l=new URLSearchParams;return l.set("origin","".concat(window.location.origin).concat(r)),l.set("projectId",n),l.set("type",t),"".concat(i,"?").concat(l)}let uE=e=>{if(!e)throw Error("Invalid project id");return"__studio_auth_token_".concat(e)},uT=e=>{try{var t;let n=(t=uE(e),um?localStorage[t]:ug[t]);if(n){let{token:i}=JSON.parse(n);if(i&&"string"==typeof i)return i}}catch(r){console.error(r)}return null},uA=e=>{try{uv(uE(e))}catch(t){console.error(t)}},uP=e=>{let{token:t,projectId:n}=e;try{ux(uE(n),JSON.stringify({token:t,time:new Date().toISOString()}))}catch(i){console.error(i)}},uI=async(e,t)=>{var n;try{let i=await e.request({uri:"/users/me",withCredentials:!0,tag:"users.get-current"});return"string"==typeof(null==i?void 0:i.id)?i:null}catch(a){if(401===a.statusCode)return uA(e.config().projectId||""),t(null),null;let r=await e.request({uri:"/ping",withCredentials:!1,tag:"cors-check"}).then(()=>!0,()=>!1);if(r)throw new uf({projectId:null==(n=e.config())?void 0:n.projectId});if(a.isNetworkError&&!a.message&&a.request&&a.request.url){let l=new URL(a.request.url).host;throw Error("Unknown network error attempting to reach ".concat(l))}throw a}},uM=lV()(function(e){let{clientFactory:t,projectId:n,dataset:i,loginMethod:r="dual"}=e,l=d3(e,sw),{broadcast:a,messages:o}=function(e){let t="undefined"==typeof window?(0,rB.of)():(0,rK.R)(window,"storage"),n="__studio_local_storage_messaging_".concat(e),i=new rH.xQ,r=(0,r$.T)(i,t.pipe((0,lt.h)(e=>e.key===n),(0,r8.U)(e=>e.newValue),(0,lt.h)(cf),(0,r8.U)(e=>JSON.parse(e)))).pipe((0,ln.d)(1));return{messages:r,broadcast:function(e){try{ux(n,JSON.stringify(e)),uv(n),i.next(e)}catch(t){}}}}("dual_mode_auth_".concat(n)),s=null!=t?t:rI(),d=o.pipe((0,li.O)("dual"===r?uT(n):null)),c=d.pipe((0,r8.U)(e=>s(d6(d6({projectId:n,dataset:i,apiVersion:"2021-06-07",useCdn:!1},e&&{token:e}),{},{withCredentials:!0,requestTagPrefix:"sanity.studio",ignoreBrowserTokenWarning:!0,allowReconfigure:!1},"undefined"!=typeof __SANITY_STAGING__&&__SANITY_STAGING__?{apiHost:"undefined"!=typeof __SANITY_STAGING__&&!0===__SANITY_STAGING__?"https://api.sanity.work":void 0}:{}))),(0,r6.w)(e=>(0,rX.P)(async()=>{let t=await uI(e,a);return{currentUser:t,client:e,authenticated:!!t}})),(0,ln.d)(1));async function u(){if(uy&&"dual"===r){let e=s({projectId:n,dataset:i,useCdn:!0,withCredentials:!0,apiVersion:"2021-06-07",requestTagPrefix:"sanity.studio"}),t=await uI(e,a);if(t)a(null);else{let{token:l}=await e.request({method:"GET",uri:"/auth/fetch",query:{sid:uy},tag:"auth.fetch-token"});uP({token:l,projectId:n}),a(l)}}else a("dual"===r?uT(n):null)}async function p(){let e=s({projectId:n,dataset:i,useCdn:!0,withCredentials:!0,apiVersion:"2021-06-07",requestTagPrefix:"sanity.studio"});uA(n),await e.auth.logout(),a(null)}let h=function(e){let{getClient:t,loginMethod:n,redirectOnSingle:i}=e,r=d3(e,sj),l=ch(t);return function(e){let{projectId:t,basePath:a}=e,[o,s]=(0,rF.useState)(null),[d,c]=(0,rF.useState)(null);if(d)throw d;let[u]=l();(0,rF.useEffect)(()=>{u&&u_(d6({client:u},r)).then(s).catch(c)},[u]);let p=i&&(null==o?void 0:o.length)===1&&(null==o?void 0:o[0])&&uS({loginMethod:n,projectId:t,url:o[0].url,basePath:a});return((0,rF.useEffect)(()=>{p&&(window.location.href=p)},[p]),!o||p)?(0,rz.jsxs)(rN.kC,{align:"center",direction:"column",gap:4,justify:"center",padding:6,sizing:"border",children:[(0,rz.jsx)(rN.xv,{muted:!0,children:"Loading…"}),(0,rz.jsx)(rN.$j,{muted:!0})]}):(0,rz.jsxs)(rN.Kq,{space:4,children:[(0,rz.jsx)(rN.X6,{align:"center",size:1,children:"Choose login provider"}),(0,rz.jsx)(rN.Kq,{space:2,children:o.map((e,i)=>(0,rz.jsx)(rN.zx,{icon:uC[e.name],as:"a",href:uS({loginMethod:n,projectId:t,url:e.url,basePath:a}),mode:"ghost",text:e.title},"".concat(e.url,"_").concat(i)))})]})}}(d6(d6({},l),{},{getClient:()=>c.pipe((0,r8.U)(e=>e.client)),loginMethod:r}));return{handleCallbackUrl:u,token:d,state:c,LoginComponent:h,logout:p}},function e(t){return"object"!=typeof t||null===t?"".concat(t):JSON.stringify(Object.fromEntries(Object.entries(t).sort((e,t)=>{let[n]=e,[i]=t;return n.localeCompare(i,"en")}).map(t=>{let[n,i]=t;return[n,e(i)]})))});function uz(e){return"google"===e?"Google":"github"===e?"GitHub":"sanity"===e?"Sanity":(null==e?void 0:e.startsWith("saml-"))?"SAML/SSO":void 0}let uR="undefined"==typeof window?(0,rB.of)({}):(0,rK.R)(window,"online"),uF="undefined"==typeof window?(0,rB.of)({}):(0,rK.R)(window,"offline"),uO=e=>100*Math.pow(2,e),uD={type:"connecting"},uZ=(0,lB.E)(),uL=uZ[0];uZ[1];let uq=e=>{let{error:t,isOffline:n,attemptNo:i,retryAt:r}=e;return{type:"error",error:t,attemptNo:i,isOffline:n,retryAt:r}},uN=(0,lO.vJ)(e=>{let{theme:t}=e,{color:n,fonts:i}=t.sanity;return{html:{backgroundColor:n.base.bg},"#sanity":{fontFamily:i.text.family}}});function uV(e){return e}function uB(e){let t=["projectId"in e&&"`projectId` not allowed in plugin configuration","dataset"in e&&"`dataset` not allowed in plugin configuration"].filter(lK());if(t.length)throw Error("Invalid plugin configuration:\n".concat(t.map(e=>"	".concat(e)).join("\n")))}function uU(e){return"function"==typeof e?t=>{let n=e(t);return uB(n),n}:(uB(e),()=>e)}let uK=e=>"error"===e.severity,uH=[{name:"sanity.assetSourceData",title:"Asset Source Data",type:"object",fields:[{name:"name",title:"Source name",description:"A canonical name for the source this asset is originating from",type:"string"},{name:"id",title:"Asset Source ID",description:"The unique ID for the asset within the originating source so you can programatically find back to it",type:"string"},{name:"url",title:"Asset information URL",description:"A URL to find more information about this asset in the originating source",type:"string"}]},{title:"Slug",name:"slug",type:"object",fields:[{name:"current",title:"Current slug",type:"string"},{name:"source",title:"Source field",type:"string",hidden:!0}]},{title:"Geographical Point",name:"geopoint",type:"object",fields:[{name:"lat",type:"number",title:"Latitude"},{name:"lng",type:"number",title:"Longitude"},{name:"alt",type:"number",title:"Altitude"}]},{name:"sanity.imageAsset",title:"Image",type:"document",fieldsets:[{name:"system",title:"System fields",description:"These fields are managed by the system and not editable"}],fields:[{name:"originalFilename",type:"string",title:"Original file name",readOnly:!0},{name:"label",type:"string",title:"Label"},{name:"title",type:"string",title:"Title"},{name:"description",type:"string",title:"Description"},{name:"altText",type:"string",title:"Alternative text"},{name:"sha1hash",type:"string",title:"SHA1 hash",readOnly:!0,fieldset:"system"},{name:"extension",type:"string",readOnly:!0,title:"File extension",fieldset:"system"},{name:"mimeType",type:"string",readOnly:!0,title:"Mime type",fieldset:"system"},{name:"size",type:"number",title:"File size in bytes",readOnly:!0,fieldset:"system"},{name:"assetId",type:"string",title:"Asset ID",readOnly:!0,fieldset:"system"},{name:"uploadId",type:"string",readOnly:!0,hidden:!0,fieldset:"system"},{name:"path",type:"string",title:"Path",readOnly:!0,fieldset:"system"},{name:"url",type:"string",title:"Url",readOnly:!0,fieldset:"system"},{name:"metadata",type:"sanity.imageMetadata",title:"Metadata"},{name:"source",type:"sanity.assetSourceData",title:"Source",readOnly:!0,fieldset:"system"}],preview:{select:{id:"_id",title:"originalFilename",mimeType:"mimeType",size:"size"},prepare:e=>({title:e.title||"string"==typeof e.path&&e.path.split("/").slice(-1)[0],media:{asset:{_ref:e.id}},subtitle:"".concat(e.mimeType," (").concat((Number(e.size)/1024/1024).toFixed(2)," MB)")})},orderings:[{title:"File size",name:"fileSizeDesc",by:[{field:"size",direction:"desc"}]}]},{name:"sanity.fileAsset",title:"File",type:"document",fieldsets:[{name:"system",title:"System fields",description:"These fields are managed by the system and not editable"}],fields:[{name:"originalFilename",type:"string",title:"Original file name",readOnly:!0},{name:"label",type:"string",title:"Label"},{name:"title",type:"string",title:"Title"},{name:"description",type:"string",title:"Description"},{name:"altText",type:"string",title:"Alternative text"},{name:"sha1hash",type:"string",title:"SHA1 hash",readOnly:!0,fieldset:"system"},{name:"extension",type:"string",title:"File extension",readOnly:!0,fieldset:"system"},{name:"mimeType",type:"string",title:"Mime type",readOnly:!0,fieldset:"system"},{name:"size",type:"number",title:"File size in bytes",readOnly:!0,fieldset:"system"},{name:"assetId",type:"string",title:"Asset ID",readOnly:!0,fieldset:"system"},{name:"path",type:"string",title:"Path",readOnly:!0,fieldset:"system"},{name:"url",type:"string",title:"Url",readOnly:!0,fieldset:"system"},{name:"source",type:"sanity.assetSourceData",title:"Source",readOnly:!0,fieldset:"system"}],preview:{select:{title:"originalFilename",path:"path",mimeType:"mimeType",size:"size"},prepare:e=>({title:e.title||e.path.split("/").slice(-1)[0],subtitle:"".concat(e.mimeType," (").concat((e.size/1024/1024).toFixed(2)," MB)")})},orderings:[{title:"File size",name:"fileSizeDesc",by:[{field:"size",direction:"desc"}]}]},{name:"sanity.imageCrop",title:"Image crop",type:"object",fields:[{name:"top",type:"number"},{name:"bottom",type:"number"},{name:"left",type:"number"},{name:"right",type:"number"}]},{name:"sanity.imageHotspot",title:"Image hotspot",type:"object",fields:[{name:"x",type:"number"},{name:"y",type:"number"},{name:"height",type:"number"},{name:"width",type:"number"}]},{name:"sanity.imageMetadata",title:"Image metadata",type:"object",fieldsets:[{name:"extra",title:"Extra metadata…",options:{collapsable:!0}}],fields:[{name:"location",type:"geopoint"},{name:"dimensions",title:"Dimensions",type:"sanity.imageDimensions",fieldset:"extra"},{name:"palette",type:"sanity.imagePalette",title:"Palette",fieldset:"extra"},{name:"lqip",title:"LQIP (Low-Quality Image Placeholder)",type:"string",readOnly:!0},{name:"blurHash",title:"BlurHash",type:"string",readOnly:!0},{name:"hasAlpha",title:"Has alpha channel",type:"boolean",readOnly:!0},{name:"isOpaque",title:"Is opaque",type:"boolean",readOnly:!0}]},{name:"sanity.imageDimensions",type:"object",title:"Image dimensions",fields:[{name:"height",type:"number",title:"Height",readOnly:!0},{name:"width",type:"number",title:"Width",readOnly:!0},{name:"aspectRatio",type:"number",title:"Aspect ratio",readOnly:!0}]},{name:"sanity.imagePalette",title:"Image palette",type:"object",fields:[{name:"darkMuted",type:"sanity.imagePaletteSwatch",title:"Dark Muted"},{name:"lightVibrant",type:"sanity.imagePaletteSwatch",title:"Light Vibrant"},{name:"darkVibrant",type:"sanity.imagePaletteSwatch",title:"Dark Vibrant"},{name:"vibrant",type:"sanity.imagePaletteSwatch",title:"Vibrant"},{name:"dominant",type:"sanity.imagePaletteSwatch",title:"Dominant"},{name:"lightMuted",type:"sanity.imagePaletteSwatch",title:"Light Muted"},{name:"muted",type:"sanity.imagePaletteSwatch",title:"Muted"}]},{name:"sanity.imagePaletteSwatch",title:"Image palette swatch",type:"object",fields:[{name:"background",type:"string",title:"Background",readOnly:!0},{name:"foreground",type:"string",title:"Foreground",readOnly:!0},{name:"population",type:"number",title:"Population",readOnly:!0},{name:"title",type:"string",title:"String",readOnly:!0}]}];function u$(e){return"string"==typeof e.title?e.title:e.type?u$(e.type):e.name||e.jsonType}let uX={apiVersion:"2022-09-09"},uW=(0,lO.ZP)(rN.mh)(k||(k=d4(["\n  position: absolute;\n  width: 100%;\n  height: 100%;\n  top: 0;\n"])));function uG(){return(0,rz.jsx)(uW,{children:(0,rz.jsx)(rN.kC,{height:"fill",align:"center",justify:"center",children:(0,rz.jsx)(rN.$j,{})})})}function uY(e){let{text:t}=e;return(0,rz.jsxs)(rN.kC,{direction:"row",justify:"center",align:"center",children:[(0,rz.jsx)(rN.$j,{}),(0,rz.jsx)(rN.xu,{marginLeft:2,children:(0,rz.jsx)(rN.xv,{children:t})})]})}let uJ=()=>(0,rF.createElement)(rF.Fragment);function uQ(e){let{options:t}=SJ().__internal,{defaultComponent:n,pick:i}=e;return(0,rF.useMemo)(()=>{let e=[...EW(t,[])];e.reverse();let r=e.map(e=>{let{config:t}=e;return i(t)}),l=r.filter(Boolean);return e=>{let t=e=>(0,rF.createElement)(n,e);for(let i of l){let r=t;t=e=>(0,rF.createElement)(i,d6(d6({},e),{},{renderDefault:r}))}return t(d6(d6({},e),{},{renderDefault:uJ}))}},[n,t,i])}function u0(e,t){return t.name===e||Boolean(t.type&&u0(e,t.type))}let u1={default:RH,media:function(e){let{media:t,mediaDimensions:n=Fi,children:i,isPlaceholder:r,progress:l=-1,subtitle:a,title:o,withBorder:s=!0,withRadius:d=!0}=e,c=n.aspect||1,u=(0,rF.useMemo)(()=>({paddingBottom:"".concat(100/c,"%")}),[c]),p=(0,rF.useMemo)(()=>o&&a?(0,rz.jsxs)(Fn,{children:[o&&(0,rz.jsx)(rN.xv,{align:"center",size:1,weight:"semibold",children:RN(o,"media")}),a&&(0,rz.jsx)(rN.xv,{align:"center",muted:!0,size:1,children:RN(a,"media")})]}):null,[a,o]);return(0,rz.jsxs)(R7,{"data-testid":"media-preview",overflow:"hidden",flex:1,children:[(0,rz.jsx)("div",{style:u}),(0,rz.jsx)(rN.u,{content:p,disabled:!p,placement:"top",portal:!0,children:(0,rz.jsxs)(R9,{children:[r?(0,rz.jsx)(Fe,{}):(0,rz.jsx)(Rq,{border:s,dimensions:n,layout:"media",media:t,radius:d?1:0,responsive:!0}),"number"==typeof l&&l>-1&&(0,rz.jsx)(Ft,{children:(0,rz.jsx)(R4,{value:l})})]})}),i]})},detail:function(e){let{title:t,subtitle:n,description:i,mediaDimensions:r=R0,media:l,status:a,children:o,isPlaceholder:s}=e,d=a&&(0,rz.jsx)(RX,{marginLeft:3,paddingRight:1,children:RN(a,"detail")});return s?(0,rz.jsxs)(R$,{"data-testid":"detail-preview",children:[!1!==l&&(0,rz.jsx)(RW,{"data-testid":"detail-preview__media"}),(0,rz.jsxs)(rN.xu,{flex:1,paddingLeft:!1===l?1:2,children:[(0,rz.jsxs)(rN.kC,{align:"center","data-testid":"detail-preview__header",children:[(0,rz.jsxs)(rN.Kq,{flex:1,space:2,children:[(0,rz.jsx)(RG,{}),(0,rz.jsx)(RY,{})]}),d]}),i&&(0,rz.jsx)(rN.xu,{marginTop:3,children:(0,rz.jsx)(RJ,{})})]})]}):(0,rz.jsxs)(R$,{"data-testid":"detail-preview",children:[!1!==l&&(0,rz.jsx)(Rq,{dimensions:r,layout:"detail",media:l}),(0,rz.jsxs)(rN.xu,{flex:1,paddingLeft:!1===l?1:2,children:[(0,rz.jsxs)(rN.kC,{align:"center","data-testid":"detail-preview__header",children:[(0,rz.jsxs)(rN.Kq,{flex:1,space:2,children:[(0,rz.jsxs)(rN.xv,{textOverflow:"ellipsis",style:{color:"inherit"},children:[t&&RN(t,"detail"),!t&&(0,rz.jsx)(rz.Fragment,{children:"Untitled"})]}),n&&(0,rz.jsx)(rN.xv,{muted:!0,size:1,textOverflow:"ellipsis",children:RN(n,"detail")})]}),d]}),i&&(0,rz.jsx)(rN.xu,{marginTop:3,children:(0,rz.jsx)(RQ,{muted:!0,size:1,children:RN(i,"detail")})})]}),o]})},inline:function(e){let{title:t,fallbackTitle:n="Untitled",media:i,mediaDimensions:r=Ff}=e;return(0,rz.jsxs)(Fu,{"data-testid":"inline-preview",children:[i&&(0,rz.jsxs)(Fp,{"data-testid":"inline-preview-media",children:[(0,lW.isValidElementType)(i)?(0,rF.createElement)(i,{layout:"inline",dimensions:r}):"string"==typeof i?(0,rz.jsx)("div",{children:i}):i,(0,rz.jsx)("span",{})]}),(0,rz.jsx)(Fh,{"data-testid":"inline-preview-title",size:1,children:RN(t,"inline",n)})]})},block:function(e){let{actions:t,title:n,subtitle:i,description:r,mediaDimensions:l=Fd,media:a,status:o,children:s}=e;return(0,rz.jsxs)(rN.Kq,{"data-testid":"block-preview",space:1,children:[(0,rz.jsxs)(Fc,{"data-testid":"block-preview__header",children:[a&&(0,rz.jsx)(Rq,{dimensions:l,layout:"block",media:a}),(0,rz.jsxs)(rN.xu,{flex:1,paddingLeft:a?2:1,children:[(0,rz.jsx)(rN.xv,{size:1,textOverflow:"ellipsis",weight:"semibold",children:n?RN(n,"block"):"Untitled"}),i&&(0,rz.jsx)(rN.xu,{marginTop:2,children:(0,rz.jsx)(rN.xv,{muted:!0,size:1,textOverflow:"ellipsis",children:RN(i,"block")})}),r&&(0,rz.jsx)(rN.xu,{marginTop:3,children:(0,rz.jsx)(rN.xv,{muted:!0,size:1,textOverflow:"ellipsis",children:RN(r,"block")})})]}),(0,rz.jsxs)(rN.kC,{gap:1,paddingLeft:1,children:[o&&(0,rz.jsx)(rN.xu,{paddingX:2,paddingY:3,children:RN(o,"block")}),t]})]}),s&&(0,rz.jsx)("div",{"data-testid":"block-preview__children",children:s})]})},blockImage:function(e){let{actions:t,title:n,subtitle:i,description:r,fallbackTitle:l="Untitled",mediaDimensions:a=Fo,media:o,children:s,status:d}=e;return(0,rz.jsxs)(Fa,{children:[(0,rz.jsxs)(rN.Kq,{children:[(0,rz.jsxs)(Fr,{paddingLeft:2,paddingRight:1,paddingY:1,children:[(0,rz.jsxs)(rN.Kq,{flex:1,space:2,children:[(n||l)&&(0,rz.jsx)(rN.xv,{size:1,textOverflow:"ellipsis",weight:"semibold",children:n?RN(n,"block"):l}),i&&(0,rz.jsx)(rN.xv,{muted:!0,size:1,textOverflow:"ellipsis",children:RN(i,"block")})]}),(0,rz.jsxs)(rN.kC,{gap:1,paddingLeft:1,children:[d&&(0,rz.jsx)(rN.xu,{paddingX:2,paddingY:3,children:RN(d,"block")}),t]})]}),(0,rz.jsx)(Fl,{$ratio:Fs(a),__unstable_checkered:!0,display:"flex",sizing:"border",tone:"inherit",children:(0,rz.jsx)(Rq,{border:!1,dimensions:a,layout:"blockImage",media:o,radius:0,responsive:!0})})]}),r&&(0,rz.jsx)(rN.xu,{paddingX:2,paddingY:3,children:(0,rz.jsx)(rN.xv,{muted:!0,size:1,children:RN(r,"block")})}),s&&(0,rz.jsx)("div",{children:s})]})}};function u2(){return(0,rz.jsx)(lL.$lS,{className:"sanity-studio__preview-fallback-icon"})}function u3(e){let{icon:t,layout:n,media:i,imageUrl:r,title:l}=e,a=d3(e,sk),o=IW(uX),s=(0,rF.useMemo)(()=>ay()(o),[o]),d=(0,rF.useCallback)(e=>{let{dimensions:t}=e;return(0,rz.jsx)("img",{alt:c_(l)?l:void 0,referrerPolicy:"strict-origin-when-cross-origin",src:s.image(i).width(t.width||100).height(t.height||100).fit(t.fit).dpr(t.dpr||1).url()||""})},[s,i,l]),c=(0,rF.useCallback)(()=>(0,rF.createElement)(t||u2),[t]),u=(0,rF.useMemo)(()=>!1!==t&&((0,lW.isValidElementType)(i)||(0,rF.isValidElement)(i)?i:(0,aj.JZ)(i)?d:c_(r)?(0,rz.jsx)("img",{src:r,alt:c_(l)?l:void 0,referrerPolicy:"strict-origin-when-cross-origin"}):c),[t,r,i,c,d,l]),p=(0,rF.useMemo)(()=>d6(d6({},a),{},{media:u,title:l}),[u,a,l]),h=u1[n||"default"];return(0,rF.createElement)(h,p)}let u4="undefined"==typeof window?rJ.E:(0,rK.R)(window,"resize").pipe((0,ln.d)(1)),u5="undefined"==typeof window?rJ.E:(0,rK.R)(window,"scroll",{passive:!0,capture:!0}).pipe((0,ln.d)(1)),u6="undefined"==typeof window?rJ.E:(0,rK.R)(window,"orientationchange").pipe((0,ln.d)(1)),u8="undefined"!=typeof window&&"IntersectionObserver"in window&&"IntersectionObserverEntry"in window&&"intersectionRatio"in IntersectionObserverEntry.prototype&&("isIntersecting"in IntersectionObserverEntry.prototype||Object.defineProperty(IntersectionObserverEntry.prototype,"isIntersecting",{get(){return this.intersectionRatio>0}}),1)?function(){let e=new rH.xQ,t=new IntersectionObserver(t=>{t.forEach(t=>{e.next(t)})},{threshold:0,rootMargin:"".concat(150,"px")});return function(n){return new rQ.y(e=>(t.observe(n),e.next(),()=>t.unobserve(n))).pipe((0,ls.zg)(()=>e.asObservable()),(0,lt.h)(e=>e.target===n),(0,r8.U)(e=>({isIntersecting:e.isIntersecting})))}}():function(e){let t=()=>{var t,n;return t=e.getBoundingClientRect(),n={left:0,right:window.innerWidth,top:0,bottom:window.innerHeight},t.left<=n.right+150&&t.right>=n.left-150&&t.top<=n.bottom+150&&t.bottom>=n.top-150};return(0,r$.T)((0,rB.of)(t()),u4,u5,u6).pipe((0,r8.U)(t),(0,r8.U)(e=>({isIntersecting:e})))},u7="undefined"==typeof window?rJ.E:(0,rK.R)(document,"visibilitychange").pipe((0,ln.d)(1)),u9={isLoading:!0},pe={isLoading:!1};function pt(e){let{enabled:t=!0,ordering:n,schemaType:i,value:r}=e||{},{observeForPreview:l}=Rm();return(0,rV.m2)(()=>t&&r&&i?l(r,i,{ordering:n}).pipe((0,r8.U)(e=>({isLoading:!1,value:e.snapshot||void 0})),(0,le.K)(e=>(0,rB.of)({isLoading:!1,error:e}))):(0,rB.of)(pe),[t,l,n,i,r],u9)}function pn(e){return c_(e)?e:void 0}function pi(e){var t;let{layout:n,value:i,component:r,style:l,schemaType:a}=e,o=d3(e,sC),[s,d]=(0,rF.useState)(null),c=n&&["inline","block","blockImage"].includes(n),u=function(e){let{element:t,hideDelay:n=0}=e,[i,r]=(0,rF.useState)(!1);return(0,rF.useEffect)(()=>{if(!t)return;let e=(0,rU.z)((0,rB.of)(!document.hidden),u7.pipe((0,r8.U)(e=>{var t;return e.target instanceof Document&&!(null==(t=null==e?void 0:e.target)?void 0:t.hidden)}))).pipe((0,r9.x)()),i=u8(t).pipe((0,r8.U)(e=>e.isIntersecting)),l=e.pipe((0,r6.w)(e=>e?i:(0,rB.of)(!1)),(0,r6.w)(e=>e?(0,rB.of)(!0):(0,rB.of)(!1).pipe((0,ld.g)(n))),(0,r9.x)()),a=l.subscribe(r);return()=>a.unsubscribe()},[t,n]),i}({element:c?null:s,hideDelay:2e3}),p=pt({enabled:c||u,schemaType:a,value:i}),h=(0,rF.useMemo)(()=>d6(d6({},l),{},{minWidth:(null==l?void 0:l.minWidth)||1,minHeight:(null==l?void 0:l.minHeight)||1}),[l]),f=(0,rF.useMemo)(()=>(function(e){var t,n;if(!cC(e))return;let i="number"==typeof e.progress?e.progress:0,r=pn(e.initiated||e.createdAt),l=pn(e.updated||e.updatedAt),a=pn(null==(t=null==e?void 0:e.file)?void 0:t.name),o=pn(null==(n=null==e?void 0:e.file)?void 0:n.type),s=pn(e.previewImage);if(r&&l&&a&&o)return{progress:i,createdAt:r,updatedAt:l,file:{name:a,type:o},previewImage:s}})(null==i?void 0:i._upload),[i]);return(0,rz.jsx)("div",{ref:d,style:h,children:(0,rF.createElement)(r,d6(d6(d6({},o),(null==p?void 0:p.value)||{}),{},{media:(null==f?void 0:f.previewImage)?(0,rz.jsx)("img",{alt:"The image currently being uploaded",src:f.previewImage}):null==(t=null==p?void 0:p.value)?void 0:t.media,error:null==p?void 0:p.error,isPlaceholder:null==p?void 0:p.isLoading,layout:n,schemaType:a}))})}function pr(e){let t=null==e?void 0:e.select;if(t)return Object.values(t).map(e=>String(e).split("."))}let pl=e=>!0===e.liveEdit;function pa(e,t,n,i){let r=pl(t)?(0,rB.of)({snapshot:null}):e.observeForPreview({_type:"reference",_ref:cv(n)},t),l=e.observeForPreview({_type:"reference",_ref:cb(n)},t);return(0,r0.aj)([r,l]).pipe((0,r8.U)(e=>{let[t,n]=e;return{draft:t.snapshot?d6({title:i},t.snapshot||{}):null,isLoading:!1,published:n.snapshot?d6({title:i},n.snapshot||{}):null}}),(0,li.O)({draft:null,isLoading:!0,published:null}))}let po=e=>({title:(0,rz.jsx)("em",{children:e.title?String(e.title):"Missing document"}),subtitle:(0,rz.jsx)("em",{children:e.title?"Missing document ID: ".concat(e._id):"Document ID: ".concat(e._id)}),media:()=>(0,rz.jsx)(lL.foC,{})}),ps=e=>{let{value:t,draft:n,published:i}=e,r=n||i;return r?o1()({},r,t,(e,t)=>void 0===t?e:t):po(t)},pd=["_id","_rev","_type"],pc=[...pd,"_key"],pu={available:!0,reason:"READABLE"},pp={available:!1,reason:"PERMISSION_DENIED"},ph={available:!1,reason:"NOT_FOUND"},pf={title:"Invalid preview config",subtitle:"Check the error log in the console",media:(0,rz.jsx)(lL.foC,{})};function pm(e){return Object.keys(e)}let pg=["_id","_type","_upload","_createdAt","_updatedAt"],px=[],pv=(r={},{add:(e,t,n)=>{r[e.name]||(r[e.name]=[]),r[e.name].push({error:n,type:e,value:t})},getAll:()=>r,clear(){r={}}}),pb=rL()(()=>{let e=pv.getAll(),t=aH()(Object.keys(e).map(t=>{let n=e[t];return oa()(n,e=>e.error.message)})),n=t.length;0!==n&&(console.groupCollapsed("%cHeads up! Got ".concat(1===n?"error":"".concat(n," errors")," while preparing data for preview. Click for details."),"color: #ff7e7c"),Object.keys(e).forEach(t=>{let n=e[t],i=n[0];console.group('Check the preview config for schema type "'.concat(t,'": %o'),i.type.preview);let r=oa()(n,e=>e.error.message);r.forEach(e=>{var t;if("returnValueError"===e.error.type){let n="function"==typeof(null==(t=e.type.preview)?void 0:t.prepare),{value:i,error:r}=e;console.log("Encountered an invalid ".concat(n?"return value when calling prepare(%o)":"value targeted by preview.select",":"),i),console.error(r)}if("prepareError"===e.error.type){let{value:l,error:a}=e;console.log("Encountered an error when calling prepare(%o):",l),console.error(a)}}),console.groupEnd()}),console.groupEnd(),pv.clear())},1e3),py=e=>t=>{let n=typeof t;return null===t||"undefined"===n||"string"===n||"number"===n||"boolean"===n?px:[pk("returnValueError",Error('The "'.concat(e,'" field should be a string, number, boolean, undefined or null, instead saw ').concat(pw(t))))]},pj={media:()=>px,title:py("title"),subtitle:py("subtitle"),description:py("description"),imageUrl:py("imageUrl"),date:py("date")};function pw(e){let t=!(arguments.length>1)||void 0===arguments[1]||arguments[1];if(cC(e)){let n=Object.keys(e),i=n.length>3?"...":"";return"".concat(t?"object with keys ":"","{").concat(n.slice(0,3).join(", ")).concat(i,"}")}if(Array.isArray(e)){let r=e.length>3?"...":"";return"".concat(t?"array with ":"","[").concat(e.map(e=>pw(e,!1))).concat(r,"]")}return"the ".concat(typeof e," ").concat(e)}function pk(e,t){return Object.assign(t,{type:e})}function pC(e,t){var n;let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=null==(n=e.preview)?void 0:n.prepare;try{return{returnValue:r?r(t,i):pm(t).reduce((e,n)=>{let i=t[n];return d6(d6({},e),{},{[n]:Array.isArray(i)&&(0===i.length||i.some(rM.DG))?function(e){let t=Array.isArray(e)&&e.find(rM.DG);return t&&t.children?t.children.filter(rM.NG).map(e=>e.text).join(""):""}(i):i})},{}),errors:px}}catch(l){return{returnValue:null,errors:[pk("prepareError",l)]}}}function p_(e,t,n){return e.errors.forEach(e=>pv.add(t,n,e)),pb(),pf}function pS(e,t){var n,i,r,l;let a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},o="function"==typeof(null==(n=t.preview)?void 0:n.prepare),s=(null==(i=t.preview)?void 0:i.select)||{},d=Object.keys(s),c=d.reduce((n,i)=>{var r;let l="fields"in t?t:null,a=s[i],d=null==(r=null==l?void 0:l.fields)?void 0:r.find(e=>e.name===a),c=d&&function(e){if(!function(e){let t=!!e.options&&"object"==typeof e.options&&e.options;if(!t||!("list"in t))return!1;let n=t.list;return Array.isArray(n)}(e))return;let t=e.options.list;return t.map(e=>(0,rM.n4)(e)?e:{title:e,value:e})}(d.type);if(!o&&c){let u=c&&c.find(t=>t.value===oC()(e,s[i]));n[i]=u?u.value:oC()(e,s[i])}else n[i]=oC()(e,s[i]);return n},{}),u=pC(t,c,a);if(u.errors.length>0)return p_(u,t,c);let p=d6(d6({},r=pC(t,c,a)),{},{errors:[...r.errors||[],...(l=r.returnValue,oR()(l)&&null!==l?Object.entries(l).reduce((e,t)=>{let[n,i]=t;return[...e,...function(e,t){if(void 0===t)return px;let n=pj[e];return n&&n(t)||px}(n,i)]},px):[pk("returnValueError",Error("Invalid return value. Expected a plain object with at least a 'title' field, instead saw ".concat(pw(l))))])]});return p.errors.length>0?p_(p,t,c):d6(d6({},o$()(e,pg)),u.returnValue)}function pE(e,t){let n;let i={},r=0;return function(){for(var e=arguments.length,a=Array(e),o=0;o<e;o++)a[o]=arguments[o];return new rQ.y(e=>{clearTimeout(n),n=setTimeout(l,t);let o={args:a,observer:e,completed:!1},s=r++;return i[s]=o,()=>{o.completed=!0}})};function l(){let t=i;i={};let n=Object.keys(t).filter(e=>{let n=t[e];return n&&!n.completed});if(0===n.length)return;let r=n.map(e=>{let n=t[e];return n&&n.args}).filter(cf);e(r).subscribe({next(e){e.forEach((i,r)=>{let l=t[n[r]];l&&!l.completed&&l.observer.next(e[r])})},complete(){n.forEach(e=>{let n=t[e];n&&!n.completed&&n.observer.complete()})},error(e){n.forEach(n=>{let i=t[n];i&&!i.completed&&i.observer.error(e)})}})}}function pT(e,t){return e.push(...t),e}function pA(e,t){function n(e){return t({_ref:e},[["_rev"]]).pipe((0,r8.U)(e=>cC(e)&&Boolean("_rev"in e&&(null==e?void 0:e._rev))),(0,r9.x)(),(0,r6.w)(t=>t?(0,rB.of)(pu):i(e)))}let i=pE(function(e){let t=[...new Set(aH()(e))];return(0,r1.D)(function(e){let t=[],n=0,i=[];for(let r of e)n+r.length+1>=11164&&(i.push(t),t=[],n=0),n+=r.length+1,t.push(r);return i.includes(t)||i.push(t),i}(t)).pipe((0,ls.zg)(r,10),(0,lc.u)(pT,[]),(0,r8.U)(n=>e.map(e=>{let[i]=e;return n[t.indexOf(i)]})))},1);function r(t){return(0,rX.P)(()=>{let n={uri:e.getDataUrl("doc",t.join(",")),json:!0,query:{excludeContent:"true"},tag:"preview.documents-availability"};return e.observable.request(n).pipe((0,r8.U)(e=>{let n=aR()(e.omitted||[],e=>e.id);return t.map(e=>{let t=n[e];if(!t)return pu;if("existence"===t.reason)return ph;if("permission"===t.reason)return pp;throw Error('Unexpected reason for omission: "'.concat(t.reason,'"'))})}))})}return{observeDocumentPairAvailability:function(e){let t=cv(e),i=cb(e);return(0,r0.aj)([n(t),n(i)]).pipe((0,r9.x)(aC()),(0,r8.U)(e=>{let[t,n]=e;return{draft:t,published:n}}))}}}function pP(e,t,n){return d6(d6({},e),{},{[t]:n})}function pI(e){return"_ref"in e}function pM(e){return JSON.stringify(e)}let pz=e=>cM(e)?'"'.concat(e,'": @').concat(cz(e)):e;function pR(e){let{ids:t,fields:n}=e,i=[...pd,...n];return"*[_id in [".concat(t.map(pM).join(","),"]][0...").concat(t.length,"]{").concat(i.map(pz).join(","),"}")}let pF=e=>e,pO=e=>Boolean(e.type&&"document"===e.type.name),pD=e=>e.name.startsWith("sanity."),pZ=e=>e.getTypeNames().map(t=>e.get(t)).filter(cf).filter(e=>pO(e)).filter(e=>!pD(e)),pL=(e,t)=>{let{phrases:n,words:i}=function(e){let t=aV()(e.map(aZ())),[n,i]=aO()(t,e=>/^".*"$/.test(e));return{phrases:aV()(n).map(aZ()).map(pN),words:aV()(i.map(aZ()))}}(e),[r,l]=function(e,t){let n=t.toLowerCase().trim(),i=0,r=0;return e.forEach(e=>{n.includes(e)&&(i+=e.length/n.length,r+=e.length)}),1===i?[1,"[Phrase] Exact match"]:[i/2,"[Phrase] Matched ".concat(r," of ").concat(n.length," characters")]}(n,t),[a,o]=function(e,t){let n=aV()(aP()(aU()(aZ()(t)))),i=aM()(e,n),r=aq()(n,e),l=i.length/r.length;return 1===l?[1,"[Word] Exact match"]:[l/2,"[Word] Matched ".concat(i.length," of ").concat(r.length," terms: [").concat(i.join(", "),"]")]}(i,t);return[r+a,[o,l].join(", ")]},pq=e=>"string"==typeof e?e:JSON.stringify(e);function pN(e){return e.replace(/^"(.*)"$/,"$1")}let pV=/([^!@#$%^&*(),\\/?";:{}|[\]+<>\s-])+/g,pB=/(^[.]+)|([.]+$)/,pU=aX()([aH(),aq(),aP()]);function pK(e,t){let n=!1,i=e.map(e=>({typeName:e.name,paths:e.__experimental_search.map(e=>{let i=e.path.map(e=>"number"==typeof e&&(n=!0,t)?[]:e);return{weight:e.weight,path:cO(i),mapWith:e.mapWith}})}));return{specs:i,hasIndexedPaths:n}}let pH=e=>{let{mapWith:t,path:n}=e;return t?"".concat(t,"(").concat(n,")"):n},p$=e=>e.reduce((e,t,n)=>(e["t".concat(n)]="".concat(t,"*"),e),{});function pX(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return function(i){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},l="string"==typeof i?{query:i,types:e}:i.types.length?i:d6(d6({},i),{},{types:e}),{query:a,params:o,options:s,searchSpec:d,terms:c}=function(e){var t,n,i,r;let l=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{filter:a,params:o,tag:s}=l,{specs:d,hasIndexedPaths:c}=pK(e.types,!1),u=function(e){let t=[],n=e.replace(/("[^"]*")/g,e=>aU()(e).length>1?(t.push(e),""):e),i=t.map(e=>aG()(aZ()(e))),r=aV()(aP()((aZ()(n).match(pV)||[]).map(e=>e.replace(pB,""))));return[...i,...r]}(e.query),p=c?pK(e.types,!0).specs:d,h=["_type in $__types",!1===l.includeDrafts&&"!(_id in path('drafts.**'))",...function(e,t){let n=pU(t.map(e=>(e.paths||[]).map(e=>pH(e)))),i=e.map((e,t)=>n.map(e=>"".concat(e," match $t").concat(t))).filter(e=>e.length>0);return i.map(e=>"(".concat(e.join(" || "),")"))}(u,p),a?"(".concat(a,")"):"",e.filter?"(".concat(e.filter,")"):""].filter(Boolean),f=d.map(e=>{let t='_type == "'.concat(e.typeName,'" => '),n="{ ".concat(e.paths.map((e,t)=>'"w'.concat(t,'": ').concat(pH(e)))," }");return"".concat(t).concat(n)}),m=f.length>0?"...select(".concat(f.join(",\n"),")"):"",g=(null==(t=null==l?void 0:l.sort)?void 0:t.direction)||"asc",x=(null==(n=null==l?void 0:l.sort)?void 0:n.field)||"_id",v="*[".concat(h.join(" && "),"]| order(").concat(x," ").concat(g,")[$__offset...$__limit]{_type, _id, ").concat(m,"}"),b=((null==l?void 0:l.comments)||[]).map(e=>"// ".concat(e)).join("\n"),y=b?"".concat(b,"\n").concat(v):v,j=null!=(i=null==l?void 0:l.offset)?i:0,w=(null!=(r=null==l?void 0:l.limit)?r:1e3)+j;return{query:y,params:d6(d6({},p$(u)),{},{__types:d.map(e=>e.typeName),__limit:w,__offset:j},o||{}),options:{tag:s},searchSpec:d,terms:u}}(l,d6(d6({},n),r));return t.observable.fetch(a,o,s).pipe(n.unique?(0,r8.U)(cj):(0,lr.b)(),(0,r8.U)(e=>(function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],i=aR()(e,e=>e.typeName);return t.map((e,r)=>{var l;let a=i[e._type],o=null==(l=a.paths||[])?void 0:l.map((t,i)=>{let r=pq(e["w".concat(i)]);if(!r)return{path:t.path,score:0,why:"No match"};let[l,a]=pL(n,r);return{path:t.path,score:l*t.weight,why:"".concat(a," (*").concat(t.weight,")")}}),s=o.reduce((e,t)=>e+t.score,0);return{hit:e,resultIndex:t.length-r,score:s,stories:o}})})(d,e,c)),(null==r?void 0:r.skipSortByScore)?(0,lr.b)():(0,r8.U)(e=>lZ()(e,e=>-e.score)))}}let pW={available:!0,reason:"READABLE"},pG={available:!1,reason:"PERMISSION_DENIED"},pY={available:!1,reason:"NOT_FOUND"};function pJ(e,t,n){let{publishedId:i,draftId:r}=cx(t),l=e.unstable_observeDocumentPairAvailability(t);return l.pipe((0,r6.w)(l=>{if(!l.draft.available&&!l.published.available){let a="PERMISSION_DENIED"===l.draft.reason||"PERMISSION_DENIED"===l.published.reason?pG:pY;return(0,rB.of)({id:t,type:void 0,availability:a,preview:{draft:void 0,published:void 0}})}let o={_type:"reference",_ref:r},s={_type:"reference",_ref:i},d=(0,r0.aj)([e.observeDocumentTypeFromId(r),e.observeDocumentTypeFromId(i)]).pipe((0,r8.U)(e=>{let[t,n]=e;return t||n}));return d.pipe((0,r6.w)(t=>{if(!t)return rJ.E;let a=n.to.find(e=>e.name===t);if(!a)return rJ.E;let d=[...pr(null==a?void 0:a.preview)||[],["_updatedAt"],["_createdAt"]],c=e.observePaths(o,d).pipe((0,r8.U)(e=>e?d6({_id:r},pS(e,a)):void 0),(0,li.O)(void 0)),u=e.observePaths(s,d).pipe((0,r8.U)(e=>e?d6({_id:i},pS(e,a)):void 0),(0,li.O)(void 0)),p=(0,r0.aj)([c,u]).pipe((0,r8.U)(e=>{let[t,n]=e;return{draft:t,published:n}}));return p.pipe((0,r8.U)(e=>{let n=l.draft.available||l.published.available?pW:"PERMISSION_DENIED"===l.draft.reason||"PERMISSION_DENIED"===l.published.reason?pG:pY;return{type:t,id:i,availability:n,preview:{draft:cC(e.draft)?e.draft:void 0,published:cC(e.published)?e.published:void 0}}}))}))}))}function pQ(e,t,n,i){let r=pX(n.to,e,i);return r(t,{includeDrafts:!0}).pipe((0,r8.U)(e=>e.map(e=>e.hit)),(0,r8.U)(cy),(0,r8.U)(e=>e.slice(0,100)),(0,ls.zg)(t=>{var n;return(0===(n=t.filter(e=>!e.draft||!e.published).map(e=>e.draft?e.id:cv(e.id))).length?(0,rB.of)([]):e.observable.fetch("*[_id in $ids]._id",{ids:n},{tag:"get-counterpart-ids"})).pipe((0,r8.U)(e=>t.map(t=>{let n=cv(t.id);return{id:t.id,type:t.type,draft:t.draft||e.includes(n)?{_id:n,_type:t.type}:void 0,published:t.published||e.includes(t.id)?{_id:t.id,_type:t.type}:void 0}})))}))}function p0(){let e=[];return{publish(t){for(let n of e)n(t)},subscribe:t=>(e.push(t),()=>{let n=e.indexOf(t);n>-1&&e.splice(n,1)})}}let p1=Symbol.for("sanity.patch");function p2(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return{patchType:p1,type:"setIfMissing",path:t,value:e}}function p3(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];return{patchType:p1,type:"insert",path:n,position:t,items:e}}function p4(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return{patchType:p1,type:"set",path:t,value:e}}function p5(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return{patchType:p1,type:"unset",path:e}}class p6{static from(e){return e instanceof p6?e:new p6(Array.isArray(e)?aH()(e):[e])}constructor(e){this.patches=e}prepend(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return p6.from([...aH()(t),...this.patches])}append(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return p6.from([...this.patches,...aH()(t)])}prefixAll(e){return p6.from(this.patches.map(t=>d6(d6({},t),{},{path:[e,...t.path]})))}}let p8={warning:"caution",error:"critical"},p7=(0,lO.ZP)(rN.xu)(C||(C=d4(["\n  border-top: 1px solid var(--card-border-color);\n"])));function p9(e){let{children:t,status:n="warning",suffix:i,title:r}=e,l=d3(e,s_);return(0,rz.jsxs)(rN.Zb,d6(d6({radius:2,tone:p8[n]},l),{},{"data-ui":"Alert",children:[(0,rz.jsxs)(rN.kC,{padding:4,children:[(0,rz.jsx)(rN.xu,{children:(0,rz.jsxs)(rN.xv,{size:1,children:["warning"===n&&(0,rz.jsx)(lL.foC,{}),"error"===n&&(0,rz.jsx)(lL.uIy,{})]})}),(0,rz.jsxs)(rN.xu,{flex:1,marginLeft:3,children:[(0,rz.jsx)(rN.xv,{size:1,weight:"semibold",children:r}),t&&(0,rz.jsx)(rN.xu,{marginTop:3,children:t})]})]}),i&&(0,rz.jsx)(p7,{children:i})]}))}function he(e,t){let n=(0,rF.useRef)(t||null);return(0,rF.useEffect)(()=>{n.current=e},[e]),n.current}function ht(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:aC(),i=he(e),r=(0,rF.useRef)(!0);(0,rF.useEffect)(()=>{if(r.current){r.current=!1;return}n(i,e)||t(i,e)},[t,e,i,n])}let hn=(0,rF.createContext)(null);function hi(){let e=(0,rF.useContext)(hn);if(!e)throw Error("FormBuilder: missing context value");return e}let hr={constrainSize:!0,portal:!0};function hl(e){let{schemaType:t,readOnly:n,children:i,onValueCreate:r,onItemAppend:l}=e,a=(0,rF.useId)(),o=(0,rF.useCallback)(e=>{let t=r(e);l(t)},[r,l]),s=rF.useCallback(()=>{o(t.of[0])},[t,o]);return n?(0,rz.jsx)(rN.u,{portal:!0,content:(0,rz.jsx)(rN.xu,{padding:2,sizing:"border",children:(0,rz.jsx)(rN.xv,{size:1,muted:!0,children:"This field is read-only"})}),children:(0,rz.jsx)(rN.rj,{children:(0,rz.jsx)(rN.zx,{icon:lL.dtP,mode:"ghost",disabled:!0,text:1===t.of.length?"Add item":"Add item..."})})}):(0,rz.jsxs)(rN.rj,{gap:1,style:{gridTemplateColumns:"repeat(auto-fit, minmax(100px, 1fr))"},children:[1===t.of.length?(0,rz.jsx)(rN.zx,{icon:lL.dtP,mode:"ghost",onClick:s,text:"Add item"}):(0,rz.jsx)(rN.j2,{button:(0,rz.jsx)(rN.zx,{icon:lL.dtP,mode:"ghost",text:"Add item…"}),id:a||"",menu:(0,rz.jsx)(rN.v2,{children:t.of.map((e,t)=>{var n,i;let r=(0,rM.dD)(e)&&1===(e.to||[]).length&&e.to[0].icon,l=e.icon||(null==(n=e.type)?void 0:n.icon)||r;return(0,rz.jsx)(rN.sN,{text:e.title||(null==(i=e.type)?void 0:i.name),onClick:()=>o(e),icon:l},t)})}),popover:hr}),i]})}let ha=e=>"error"===e?(0,rz.jsx)(lL.uIy,{}):"warning"===e?(0,rz.jsx)(lL.foC,{}):(0,rz.jsx)(lL.hQ6,{}),ho=(0,lO.ZP)(rN.xv)(e=>{let{theme:t}=e;return(0,lO.iv)(_||(_=d4(["\n    &[data-info] {\n      color: ",";\n    }\n\n    &[data-warning] {\n      color: ",";\n    }\n\n    &[data-error] {\n      color: ",";\n    }\n  "])),t.sanity.color.muted.primary.enabled.fg,t.sanity.color.muted.caution.enabled.fg,t.sanity.color.muted.critical.enabled.fg)});function hs(e){let{markers:t,validation:n,renderCustomMarkers:i}=e,{CustomMarkers:r}=hi().__internal.components;return 0===t.length&&0===n.length?null:(0,rz.jsxs)(rN.Kq,{space:1,children:[n.length>0&&n.map((e,t)=>{let{message:i,level:r}=e;return(0,rz.jsxs)(rN.kC,{children:[(0,rz.jsx)(rN.xu,{marginRight:2,marginBottom:t+1===n.length?0:2,children:(0,rz.jsx)(ho,{size:1,"data-error":"error"===r?"":void 0,"data-warning":"warning"===r?"":void 0,"data-info":"info"===r?"":void 0,children:ha(r)})}),(0,rz.jsx)(rN.xu,{children:(0,rz.jsx)(rN.xv,{size:1,children:i||"Error"})})]},"validationItem-".concat(t))}),t.length>0&&(0,rz.jsxs)(rN.xu,{marginTop:n.length>0?3:0,children:[i&&i(t),!i&&(0,rz.jsx)(r,{markers:t})]})]})}function hd(){return(0,rz.jsxs)(rN.xv,{size:1,children:["This is a example custom marker, please implement ",(0,rz.jsx)("code",{children:"renderCustomMarkers"})," function."]})}let hc=rF.createContext(null),hu=(0,rF.memo)(function(e){return(0,rz.jsx)(hc.Provider,{value:e,children:e.children})});function hp(){let e=(0,rF.useContext)(hc);if(!e)throw Error("Form context not provided");return e}let hh=(0,rF.createContext)([]);function hf(e){return(0,rz.jsx)(hh.Provider,{value:e.presence,children:e.children})}function hm(e,t){let n=function(){let e=(0,rF.useContext)(hh);if(!e)throw Error("Form context not provided");return e}();return(0,rF.useMemo)(()=>n.filter(n=>(0,rR.Ny)(e,n.path)&&(t||!(0,rR.Xy)(e,n.path))),[t,e,n])}let hg=(0,rF.createContext)([]);function hx(e){return(0,rz.jsx)(hg.Provider,{value:e.validation,children:e.children})}function hv(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=function(){let e=(0,rF.useContext)(hg);if(!e)throw Error("Form context not provided");return e}();return(0,rF.useMemo)(()=>n.filter(n=>(0,rR.Ny)(e,n.path)&&(t||!(0,rR.Xy)(e,n.path))).map(e=>({message:e.item.message,level:e.level,path:e.path})),[t,e,n])}let hb={publish:()=>void 0,subscribe:()=>(console.warn("No patch channel provided to form-builder. If you need input based patch updates, please provide one"),()=>void 0)};function hy(e){let{__internal_patchChannel:t=hb,autoFocus:n,changesOpen:i,children:r,collapsedFieldSets:l,collapsedPaths:a,file:o,filterField:s,focusPath:d,focused:c,groups:u,id:p,image:h,members:f,onChange:m,onFieldGroupSelect:g,onPathBlur:x,onPathFocus:v,onPathOpen:b,onSetFieldSetCollapsed:y,onSetPathCollapsed:j,presence:w,readOnly:k,renderField:C,renderInput:_,renderItem:S,renderPreview:E,schemaType:T,unstable:A,validation:P,value:I}=e,M=(0,rF.useRef)(I);(0,rF.useEffect)(()=>{M.current=I},[I]);let z=(0,rF.useMemo)(()=>({patchChannel:t,components:{ArrayFunctions:hl,CustomMarkers:(null==A?void 0:A.CustomMarkers)||hd,Markers:(null==A?void 0:A.Markers)||hs},file:{assetSources:o.assetSources,directUploads:(null==o?void 0:o.directUploads)!==!1},filterField:s||(()=>!0),image:{assetSources:h.assetSources,directUploads:(null==h?void 0:h.directUploads)!==!1},getDocument:()=>M.current,onChange:m}),[o,s,h,m,t,A]),R=(0,rF.useMemo)(()=>({__internal:z,autoFocus:n,changesOpen:i,collapsedFieldSets:l,collapsedPaths:a,focusPath:d,focused:c,groups:u,id:p,members:f,readOnly:k,renderField:C,renderInput:_,renderItem:S,renderPreview:E,schemaType:T,value:I}),[z,n,i,l,a,I,d,c,u,p,f,k,C,_,S,E,T]);return(0,rz.jsx)(hn.Provider,{value:R,children:(0,rz.jsx)(hu,{onChange:m,onFieldGroupSelect:g,onPathBlur:x,onPathFocus:v,onPathOpen:b,onSetPathCollapsed:j,onSetFieldSetCollapsed:y,children:(0,rz.jsx)(hf,{presence:w,children:(0,rz.jsx)(hx,{validation:P,children:r})})})})}function hj(e){let{__internal_patchChannel:t,autoFocus:n,changesOpen:i,children:r,collapsedFieldSets:l,collapsedPaths:a,focusPath:o,focused:s,groups:d,id:c,members:u,onChange:p,onPathBlur:h,onPathFocus:f,onPathOpen:m,onFieldGroupSelect:g,onSetPathCollapsed:x,onSetFieldSetCollapsed:v,presence:b,readOnly:y,schemaType:j,validation:w,value:k}=e,{file:C,image:_}=SJ().form,S=uQ({defaultComponent:_x,pick:_j}),E=uQ({defaultComponent:_v,pick:_w}),T=__(),A=uQ({defaultComponent:_b,pick:_C}),P=(0,rF.useCallback)(e=>(0,rz.jsx)(S,d6({},e)),[S]),I=(0,rF.useCallback)(e=>(0,rz.jsx)(E,d6({},e)),[E]),M=(0,rF.useCallback)(e=>(0,rz.jsx)(A,d6({},e)),[A]),z=(0,rF.useCallback)(e=>(0,rz.jsx)(pi,d6({component:T},e)),[T]);return(0,rz.jsx)(hy,{__internal_patchChannel:t,autoFocus:n,changesOpen:i,collapsedFieldSets:l,collapsedPaths:a,file:C,focusPath:o,focused:s,groups:d,id:c,image:_,members:u,onChange:p,onPathBlur:h,onPathFocus:f,onPathOpen:m,onFieldGroupSelect:g,onSetPathCollapsed:x,onSetFieldSetCollapsed:v,presence:b,readOnly:y,renderField:I,renderInput:P,renderItem:M,renderPreview:z,schemaType:j,validation:w,value:k,children:r})}function hw(e){let{__internal_patchChannel:t,autoFocus:n,changesOpen:i,collapsedFieldSets:r,collapsedPaths:l,focusPath:a,focused:o,groups:s,id:d,members:c,onChange:u,onPathBlur:p,onPathFocus:h,onPathOpen:f,onFieldGroupSelect:m,onSetFieldSetCollapsed:g,onSetPathCollapsed:x,presence:v,readOnly:b,schemaType:y,validation:j,value:w}=e;return(0,rz.jsx)(hj,{__internal_patchChannel:t,autoFocus:n,changesOpen:i,collapsedFieldSets:r,collapsedPaths:l,focusPath:a,focused:o,groups:s,id:d,members:c,onChange:u,onPathBlur:p,onPathFocus:h,onPathOpen:f,onFieldGroupSelect:m,onSetPathCollapsed:x,onSetFieldSetCollapsed:g,presence:v,validation:j,readOnly:b,schemaType:y,value:w,children:(0,rz.jsx)(hk,{})})}function hk(){let{focusPath:e,focused:t,groups:n,id:i,members:r,readOnly:l,renderField:a,renderInput:o,renderItem:s,renderPreview:d,schemaType:c,value:u}=hi(),{onChange:p,onFieldGroupSelect:h,onPathBlur:f,onPathFocus:m,onPathOpen:g,onSetFieldSetCollapsed:x,onSetPathCollapsed:v}=hp(),b=(0,rF.useCallback)(e=>v([e],!0),[v]),y=(0,rF.useCallback)(e=>v([e],!1),[v]),j=(0,rF.useCallback)(()=>f(cw),[f]),w=(0,rF.useCallback)(()=>m(cw),[m]),k=(0,rF.useCallback)(e=>p(p6.from(e)),[p]),C=(0,rF.useRef)(null),_=(0,rF.useCallback)(e=>h(cw,e),[h]),S=(0,rF.useCallback)(e=>g([e]),[g]),E=(0,rF.useCallback)(()=>g([]),[g]),T=(0,rF.useCallback)(e=>x([e],!0),[x]),A=(0,rF.useCallback)(e=>x([e],!1),[x]),P={focusPath:e,elementProps:{ref:C,id:i,onBlur:j,onFocus:w},changed:r.some(e=>"field"===e.kind&&e.field.changed),focused:t,groups:n,id:i,level:0,members:r,onChange:k,onFieldClose:E,onFieldCollapse:b,onFieldSetCollapse:T,onFieldExpand:y,onFieldSetExpand:A,onPathFocus:m,onFieldOpen:S,onFieldGroupSelect:_,path:cw,presence:cw,readOnly:l,renderField:a,renderInput:o,renderItem:s,renderPreview:d,schemaType:c,validation:cw,value:u};return(0,rz.jsx)(rz.Fragment,{children:o(P)})}let hC=(0,rF.createContext)({});function h_(){return(0,rF.useContext)(hC)}function hS(e){let{children:t,activePath:n,EditReferenceLinkComponent:i,onEditReference:r,initialValueTemplateItems:l}=e,a=(0,rF.useMemo)(()=>({activePath:n,EditReferenceLinkComponent:i,onEditReference:r,initialValueTemplateItems:l}),[n,i,r,l]);return(0,rz.jsx)(hC.Provider,{value:a,children:t})}function hE(e,t){return ht(t,(0,rF.useCallback)((t,n)=>{e.current&&!t&&n&&(0,a5.Z)(e.current,{scrollMode:"always"})},[e]))}(0,rF.createContext)(null);let hT=()=>{if(l)return l;l=[];for(let e=0;e<256;++e)l[e]=(e+256).toString(16).substring(1);return l};function hA(e){let t=hT();return(function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:16,t=new Uint8Array(e);return(0,a6.Z)(t),t})(e).reduce((e,n)=>e+t[n],"").slice(0,e)}let hP={portal:!0},hI=(0,lO.ZP)(rN.Zb)(e=>{var t;let{theme:n,$selected:i}=e,{color:r}=n.sanity;return(0,lO.iv)(S||(S=d4(["\n    --card-bg-color: inherit;\n    --card-fg-color: inherit;\n    --card-hairline-hard-color: ",";\n  "])),i?null==(t=r.selectable)?void 0:t.default.pressed.border:void 0)}),hM=(0,lO.ZP)(rN.xu)(E||(E=d4(["\n  max-width: 150px;\n"]))),hz=e=>1===e.length?"".concat(e[0].user.displayName," is editing this document"):e.length>1?"".concat(e.length," people are editing this document right now"):void 0;function hR(e){let{presence:t}=e,{color:n}=(0,lO.Fg)().sanity,i=n.dark?"light":"dark",{selected:r}=function(){let e=(0,rF.useContext)(uo);if(!e)throw Error("PreviewCard: missing context value");return e}(),l=(0,rF.useMemo)(()=>Array.from(new Set(t.map(e=>e.user.id))).map(e=>t.find(t=>t.user.id===e)).filter(cf),[t]),a=(0,rF.useMemo)(()=>(0,rz.jsx)(hM,{padding:2,children:(0,rz.jsx)(rN.xv,{align:"center",size:1,children:hz(l)})}),[l]);return(0,rz.jsx)(rN.u,d6(d6({content:a},hP),{},{children:(0,rz.jsx)(hI,{scheme:r?i:void 0,$selected:r,children:(0,rz.jsx)(rN.Jh,{maxLength:2,children:l.map(e=>(0,rz.jsx)(Rw,{user:e.user},e.user.id))})})}))}let hF=[0,.25,.75,1],hO=(e,t)=>{let n=e.length>t?t-1:t,i=Math.max(0,e.length-n);return[e.slice(0,i),e.slice(i)]},hD=(0,lO.ZP)(rN.kC)(T||(T=d4(["\n  & > div:first-child {\n    flex: 1;\n    min-width: 0;\n  }\n"]))),hZ=(0,lO.ZP)(rN.kC)(A||(A=d4(["\n  height: 23px;\n  min-width: 23px;\n  vertical-align: top;\n"]))),hL=rF.createContext([]);function hq(e){let{children:t,items:n}=e,i=(0,rF.useMemo)(()=>(0,rz.jsx)(rN.Kq,{padding:1,children:n.map(e=>(0,rz.jsxs)(rN.kC,{align:"center",gap:2,padding:1,children:[(0,rz.jsx)("div",{children:(0,rz.jsx)(Rw,{user:e.user,status:"online"})}),(0,rz.jsx)(rN.xv,{size:1,children:e.user.displayName})]},e.user.id))}),[n]);return(0,rz.jsx)(rN.u,{content:i,placement:"top",portal:"documentScrollElement",children:t})}let{Tracker:hN,useReporter:hV,useReportedValues:hB}=cl(),hU=(0,rF.memo)(function(e){let{presence:t,position:n="inside",animateArrowFrom:i="inside",maxAvatars:r=3,stack:l=!0}=e,a=oa()(t||[],e=>e.user.id),o=lZ()(a,e=>e.lastActiveAt),[s,d]=l?hO(o,r):[[],o],c=[...d.reverse().map(e=>({key:e.user.id,element:(0,rz.jsx)(Rw,{animateArrowFrom:i,position:n,status:"online",user:e.user})})),s.length>=2?{key:"counter",element:(0,rz.jsx)(rN.p2,{count:s.length})}:null].filter(Boolean),u=4+19*r,p=Math.min(4+19*a.length,u);return(0,rz.jsxs)(hD,{justify:"flex-end",style:{width:u},children:[(0,rz.jsx)("div",{}),(0,rz.jsx)(hq,{items:a,children:(0,rz.jsx)(hZ,{direction:"row-reverse",style:{width:p},children:c.map((e,t)=>e&&(0,rz.jsx)("div",{style:{position:"absolute",transform:"translate3d(".concat(-(19*t),"px, 0px, 0px)"),transitionProperty:"transform",transitionDuration:"200ms",transitionTimingFunction:"cubic-bezier(0.85, 0, 0.15, 1)",zIndex:100-t},children:e.element},e.key))})})]})}),hK=function(e){let t=(0,rF.useContext)(hL),{presence:n=t,maxAvatars:i=3}=e,r=rF.useRef(null);hV((0,rF.useId)(),()=>({presence:n,element:r.current,maxAvatars:i}));let l=4+19*e.maxAvatars;return(0,rz.jsx)(hD,{justify:"flex-end",ref:r,style:{minWidth:l,minHeight:23}})},hH=e=>{let t=new rH.xQ,n=new IntersectionObserver(e=>{e.forEach(e=>{t.next(e)})},e);return{observe:e=>new rQ.y(i=>{let r=t.pipe((0,lt.h)(t=>t.target===e)).subscribe(i);return n.observe(e),()=>{r.unsubscribe(),n.unobserve(e)}})}},h$=e=>{let{onIntersection:t,io:n,id:i}=e,r=d3(e,sS),l=rF.useRef(null);return rF.useEffect(()=>{let e=l.current;if(!e)return;let r=n.observe(e).pipe((0,lr.b)(e=>t(i,e))).subscribe();return()=>r.unsubscribe()},[n,i,t]),(0,rz.jsx)("div",d6({ref:l},r))},hX=lO.ZP.div(P||(P=d4(["\n  position: relative;\n"]))),hW=lO.ZP.div(I||(I=d4(["\n  position: absolute;\n  top: 0;\n  left: 0;\n  right: 0;\n  bottom: 0;\n  pointer-events: none;\n  z-index: 13;\n"]))),hG=(0,lO.iv)(M||(M=d4(["\n  overflow: hidden;\n  pointer-events: none;\n  position: absolute;\n"]))),hY=(0,lO.ZP)(h$)(e=>{let{$debug:t,margins:n}=e;return(0,lO.iv)(z||(z=d4(["\n    ","\n\n    z-index: 100;\n    position: sticky;\n    height: 1px;\n    top: ",";\n    background-color: ",";\n  "])),hG,n?"".concat(n[0]-1,"px"):void 0,t?"red":"none")}),hJ=(0,lO.ZP)(h$)(e=>{let{$debug:t}=e;return(0,lO.iv)(R||(R=d4(["\n    ","\n\n    visibility: none;\n\n    ","\n  "])),hG,t&&(0,lO.iv)(F||(F=d4(["\n      background: rgba(255, 0, 0, 0.25);\n      outline: 1px solid #00b;\n      visibility: visible;\n    "]))))}),hQ=(0,lO.ZP)(h$)(e=>{let{$debug:t}=e;return(0,lO.iv)(O||(O=d4(["\n    ","\n\n    position: sticky;\n    bottom: -1px;\n    height: 1px;\n    background-color: ",";\n  "])),hG,t?"blue":"transparent")}),h0=e=>"".concat(e,"px"),h1=e=>0-e,h2=(0,rF.forwardRef)(function(e,t){let{regions:n,render:i,children:r,margins:l}=e,a=(0,rF.useRef)(null),o=(0,rF.useMemo)(()=>l,[JSON.stringify(l)]),s=(0,rF.useMemo)(()=>hH({rootMargin:o.map(h1).map(h0).join(" "),threshold:hF}),[o]),[d,c]=(0,rF.useState)({}),u=(0,rF.useCallback)((e,t)=>{c(n=>d6(d6({},n),{},{[e]:t}))},[]),p=d["::top"],h=d["::bottom"],f=(0,rF.useMemo)(()=>p&&h?n.filter(e=>{var t;return(null==(t=e.presence)?void 0:t.length)>0}).map(e=>{let t=d[e.id];if(!t)return null;let{bottom:n,top:i}=t.boundingClientRect,r=t.boundingClientRect.top<p.boundingClientRect.bottom,l=t.boundingClientRect.top<h.boundingClientRect.top,a=t.isIntersecting?i-(t.intersectionRect.top-23):r?-p.boundingClientRect.bottom:h.boundingClientRect.top,o=t.isIntersecting?-(n-(t.intersectionRect.bottom+23)):l?h.boundingClientRect.top:-p.boundingClientRect.bottom;return{distanceTop:a,distanceBottom:o,region:e,position:a<=8?"top":o<=8?"bottom":"inside"}}).filter(Boolean):[],[h,d,n,p]);return(0,rz.jsxs)(hX,{ref:t,children:[(0,rz.jsx)(hY,{$debug:!1,io:s,id:"::top",onIntersection:u,margins:o}),(0,rz.jsx)("div",{children:r}),(0,rz.jsx)(hW,{ref:a,children:a.current&&i(f,a.current.offsetWidth)}),n.map(e=>{let t=0===e.rect.width;return(0,rz.jsx)(hJ,{$debug:!1,io:s,onIntersection:u,id:e.id,style:{width:t?1:e.rect.width,left:e.rect.left-(t?1:0),top:e.rect.top-23,height:e.rect.height+46}},e.id)}),(0,rz.jsx)(hQ,{$debug:!1,id:"::bottom",io:s,onIntersection:u})]})}),h3={transitionProperty:"transform",transitionDuration:"200ms",transitionTimingFunction:"cubic-bezier(0.85, 0, 0.15, 1)"},h4=e=>e.top+e.height,h5=e=>a1()(e,e=>e.region.rect.top),h6=(e,t)=>e+t,h8=e=>e.reduce(h6,0),h7=e=>{let{height:t}=e,n=d3(e,sE);return(0,rz.jsx)("div",{style:d6({height:Math.max(0,t)},null==n?void 0:n.style)})},h9=[0,0,0,0],fe=(e,t)=>{let n=e,i=-n.scrollTop,r=0;for(;n&&n!==t;)i+=n.offsetTop-n.scrollTop,r+=n.offsetLeft,n=n.offsetParent instanceof HTMLElement?n.offsetParent:null;return{top:i,left:r}};function ft(e){let{children:t,margins:n=h9}=e,i=hB(),r=rF.useRef(null),l=rF.useMemo(()=>{var e;return r.current?(e=r.current,i.map(t=>{var n;let[i,r]=t;return d6(d6({},r),{},{id:i,rect:d6(d6({},fe(n=r.element,e)),{},{width:n.offsetWidth,height:n.offsetHeight})})})):fn},[i]),a=rF.useCallback((e,t)=>{let i=function(e){let t=h5(e).map((e,t,n)=>{var i;let r=null==(i=n[t-1])?void 0:i.region.rect,l=r?h4(r):0;return d6(d6({},e),{},{spacerHeight:e.region.rect.top-l})}),n=d6({top:[],inside:[],bottom:[]},os()(t,e=>e.position));return{top:h5(n.top).map((e,t,n)=>d6(d6({},e),{},{indent:n.slice(t+1).reduce((e,t)=>e+t.region.rect.width,0)})),inside:h5(n.inside).map(e=>d6(d6({},e),{},{indent:0})),bottom:h5(n.bottom).map((e,t,n)=>d6(d6({},e),{},{indent:n.slice(0,t).reduce((e,t)=>e+t.region.rect.width,0)}))}}(e.filter(e=>e.region.presence.length>0)),r=h8(i.top.map(e=>e.region.rect.height+e.spacerHeight)),l=h8([...i.inside,...i.bottom].map(e=>e.region.rect.height+e.spacerHeight)),a=i.inside.reduce((e,t)=>{let{distanceTop:n,distanceBottom:i}=t;return{nearTop:e.nearTop+(n<=20?t.region.presence.length:0),nearBottom:e.nearBottom+(i<=20?t.region.presence.length:0)}},{nearTop:0,nearBottom:0});return(0,rz.jsxs)(rz.Fragment,{children:[(0,rz.jsx)(fi,{closeCount:a.nearTop,margins:n,position:"top",regionsWithIntersectionDetails:i.top}),(0,rz.jsx)(h7,{height:r}),(0,rz.jsx)(fr,{containerWidth:t,regionsWithIntersectionDetails:i.inside}),(0,rz.jsx)(h7,{height:l}),(0,rz.jsx)(fi,{closeCount:a.nearBottom,margins:n,position:"bottom",regionsWithIntersectionDetails:i.bottom})]})},[n]);return(0,rz.jsx)(h2,{ref:r,margins:n,regions:l,render:a,children:t})}let fn=[],fi=(0,rF.memo)(function(e){let{closeCount:t,margins:n,position:i,regionsWithIntersectionDetails:r}=e,l="top"===i?1:-1,a=(0,rF.useMemo)(()=>r.length?aH()(lZ()(r,e=>e.region.rect.top*l).map(e=>e.region.presence||fn)):fn,[l,r]),[o,s,d,c]=n,u=(c||0)+(a.length>0?-(19*t):0)-s,p="top"===i?o:d,h=(0,rF.useMemo)(()=>d6(d6({zIndex:2,position:"sticky",display:"flex",flexDirection:"column",alignItems:"flex-end"},h3),{},{transform:"translate3d(".concat(u,"px, 0px, 0px)"),top:5+p,bottom:5+p}),[u,p]);return(0,rz.jsx)("div",{"data-dock":i,style:h,children:(0,rz.jsx)(hU,{position:i,maxAvatars:3,presence:a})},"sticky-".concat(i))});function fr(e){let{regionsWithIntersectionDetails:t,containerWidth:n}=e;return(0,rz.jsx)(rz.Fragment,{children:t.map(e=>{let t=e.region.rect.left,{distanceTop:i,distanceBottom:r}=e,l=i<=20,a=r<=20,o=n-t-e.region.rect.width,{presence:s,maxAvatars:d}=e.region;return(0,rz.jsx)(rF.Fragment,{children:(0,rz.jsx)("div",{style:d6(d6({zIndex:2,position:"absolute",pointerEvents:"all"},h3),{},{left:t,transform:"translate3d(".concat(l||a?o:0,"px, 0px, 0px)"),height:e.region.rect.height,top:e.region.rect.top}),children:(0,rz.jsx)(fl,{value:()=>"⤒".concat(i," | ").concat(r,"⤓"),children:(0,rz.jsx)(hU,{stack:!l&&!a,position:l?"top":a?"bottom":"inside",maxAvatars:d,presence:s})})})},e.region.id)})})}let fl=e=>e.children,fa=[0,0,0,0],fo=function(e){let{children:t,margins:n}=e;return(0,rz.jsx)(hN,{children:(0,rz.jsx)(ft,{margins:n||fa,children:t})})},fs=[],fd={error:aT.VG.red[500].hex,warning:aT.VG.yellow[500].hex,info:aT.VG.blue[500].hex},fc={error:(0,rz.jsx)(lL.uIy,{"data-testid":"input-validation-icon-error"}),warning:(0,rz.jsx)(lL.foC,{"data-testid":"input-validation-icon-warning"}),info:(0,rz.jsx)(lL.hQ6,{"data-testid":"input-validation-icon-info"})};function fu(e){let{validation:t=fs,__unstable_showSummary:n,fontSize:i,placement:r="top",portal:l}=e,a=t.filter(e=>"error"===e.level),o=t.filter(e=>"warning"===e.level),s=t.filter(e=>"info"===e.level),d=a.length>0,c=o.length>0,u=s.length>0,p=(0,rF.useMemo)(()=>d?fc.error:c?fc.warning:u?fc.info:void 0,[d,u,c]),h=(0,rF.useMemo)(()=>d?fd.error:c?fd.warning:u?fd.info:void 0,[d,u,c]);return(0,rz.jsx)(rN.u,{content:(0,rz.jsxs)(rN.Kq,{padding:3,space:3,children:[n&&(0,rz.jsx)(fh,{validation:t}),!n&&(0,rz.jsx)(rz.Fragment,{children:t.map((e,t)=>(0,rz.jsx)(fp,{validation:e},t))})]}),portal:l,placement:r,fallbackPlacements:["bottom","right","left"],children:(0,rz.jsx)("div",{children:(0,rz.jsx)(rN.xv,{muted:!0,size:i,weight:"semibold",style:{color:h},children:p})})})}function fp(e){let{validation:t}=e,n=(0,rF.useMemo)(()=>"error"===t.level?fc.error:"warning"===t.level?fc.warning:"info"===t.level?fc.info:void 0,[t]),i=(0,rF.useMemo)(()=>"error"===t.level?fd.error:"warning"===t.level?fd.warning:"info"===t.level?fd.info:void 0,[t]);return(0,rz.jsxs)(rN.kC,{children:[(0,rz.jsx)(rN.xu,{marginRight:2,children:(0,rz.jsx)(rN.xv,{size:1,style:{color:i},children:n})}),(0,rz.jsx)(rN.xu,{flex:1,children:(0,rz.jsx)(rN.xv,{muted:!0,size:1,children:t.message})})]})}function fh(e){let{validation:t}=e,n=t.filter(e=>"error"===e.level),i=t.filter(e=>"warning"===e.level),r=n.length,l=i.length,a=r&&"".concat(r," ").concat("error".concat(1===r?"":"s")),o=l&&"".concat(l," ").concat("warning".concat(1===l?"":"s"));return(0,rz.jsxs)(rN.xv,{muted:!0,size:1,children:[a||"",r>0&&l>0&&(0,rz.jsx)(rz.Fragment,{children:" and "}),o||""]})}let ff=[],fm=(0,rF.memo)(function(e){let{description:t,inputId:n,title:i,validation:r=ff}=e,l=r.length>0;return(0,rz.jsxs)(rN.Kq,{space:2,children:[(0,rz.jsxs)(rN.kC,{children:[(0,rz.jsx)(rN.xv,{as:"label",htmlFor:n,weight:"semibold",size:1,children:i||(0,rz.jsx)("span",{style:{color:"var(--card-muted-fg-color)"},children:"Untitled"})}),l&&(0,rz.jsx)(rN.xu,{marginLeft:2,children:(0,rz.jsx)(fu,{fontSize:1,validation:r})})]}),t&&(0,rz.jsx)(rN.xv,{muted:!0,size:1,children:t})]})}),fg=(0,rF.memo)(function(e){let{validation:t,__unstable_presence:n,description:i,inputId:r,title:l}=e;return(0,rz.jsxs)(rN.kC,{align:"flex-end",children:[(0,rz.jsx)(rN.xu,{flex:1,paddingY:2,children:(0,rz.jsx)(fm,{validation:t,description:i,inputId:r,title:l})}),n&&n.length>0&&(0,rz.jsx)(rN.xu,{children:(0,rz.jsx)(hK,{maxAvatars:4,presence:n})})]})}),fx=(0,rF.memo)(function(e){let{validation:t,__unstable_presence:n,children:i,description:r,inputId:l,level:a,title:o}=e,s=d3(e,sT);return(0,rz.jsxs)(rN.Kq,d6(d6({},s),{},{"data-level":a,space:1,children:[o&&(0,rz.jsx)(fg,{validation:t,__unstable_presence:n,description:r,inputId:l,title:o}),(0,rz.jsx)("div",{children:i})]}))});function fv(e){let{base:t,border:n,focusRing:i}=e,r=i.offset+i.width,l=0-i.offset,a=t?t.bg:"var(--card-bg-color)";return[l>0&&"inset 0 0 0 ".concat(l,"px var(--card-focus-ring-color)"),n&&"inset 0 0 0 ".concat(n.width,"px ").concat(n.color),l<0&&"0 0 0 ".concat(0-l,"px ").concat(a),r>0&&"0 0 0 ".concat(r,"px var(--card-focus-ring-color)")].filter(Boolean).join(",")}let fb=lO.ZP.legend(D||(D=d4(["\n  /* See: https://thatemil.com/blog/2015/01/03/reset-your-fieldset/ */\n  padding: 0;\n  display: table;\n"]))),fy=(0,lO.ZP)(rN.kC).attrs({forwardedAs:"button"})(e=>{let{theme:t}=e,{focusRing:n,radius:i}=t.sanity,{base:r}=t.sanity.color;return(0,lO.iv)(Z||(Z=d4(["\n    appearance: none;\n    border: 0;\n    background: none;\n    color: inherit;\n    -webkit-font-smoothing: inherit;\n    font: inherit;\n    outline: none;\n    border-radius: ",";\n\n    &:not([hidden]) {\n      display: flex;\n    }\n\n    &:focus {\n      box-shadow: ",";\n    }\n\n    &:focus:not(:focus-visible) {\n      box-shadow: none;\n    }\n  "])),(0,rN.hO)(i[1]),fv({base:r,focusRing:n}))}),fj=(0,lO.ZP)(rN.xu)(L||(L=d4(["\n  width: 9px;\n  height: 9px;\n  margin-right: 3px;\n\n  & svg {\n    transition: transform 100ms;\n  }\n"]))),fw=(0,rF.memo)(function(e){let{collapsed:t,collapsible:n,onClick:i,title:r}=e,l=(0,rz.jsx)(rN.xv,{weight:"semibold",size:1,children:r||(0,rz.jsx)("span",{style:{color:"var(--card-muted-fg-color)"},children:"Untitled"})});return n?(0,rz.jsx)(fb,{children:(0,rz.jsxs)(fy,{type:"button",onClick:i,children:[(0,rz.jsx)(fj,{children:(0,rz.jsx)(rN.xv,{muted:!0,size:1,children:(0,rz.jsx)(lL.tgp,{style:{transform:"rotate(".concat(t?"0":"90deg",") translate3d(0, 0, 0)")}})})}),l]})}):(0,rz.jsx)(fb,{children:l})}),fk=(0,lO.ZP)(rN.xu).attrs({forwardedAs:"fieldset"})(q||(q=d4(["\n  border: none;\n\n  /* See: https://thatemil.com/blog/2015/01/03/reset-your-fieldset/ */\n  body:not(:-moz-handler-blocked) & {\n    display: table-cell;\n  }\n"]))),fC=(0,lO.ZP)(rN.xu)(e=>{let{$borderLeft:t,theme:n}=e,{focusRing:i,radius:r}=n.sanity,{base:l}=n.sanity.color;return(0,lO.iv)(N||(N=d4(["\n    outline: none;\n    border-left: ",";\n    border-radius: ",";\n\n    &:focus {\n      box-shadow: ",";\n    }\n\n    &:focus:not(:focus-visible) {\n      box-shadow: none;\n    }\n  "])),t?"1px solid var(--card-border-color)":void 0,(0,rN.hO)(r[1]),fv({base:l,focusRing:d6(d6({},i),{},{offset:2})}))}),f_=[],fS=(0,rF.forwardRef)(function(e,t){let{validation:n=f_,__unstable_presence:i=f_,children:r,collapsible:l,columns:a,description:o,level:s=0,onFocus:d,onCollapse:c,onExpand:u,collapsed:p,tabIndex:h,title:f}=e,m=d3(e,sA),g=n.length>0,x=(0,rN.ts)(t),v=(0,rF.useCallback)(e=>{let t=x.current;t===e.target&&d&&d(e)},[x,d]),b=(0,rF.useCallback)(()=>p?null==u?void 0:u():null==c?void 0:c(),[p,c,u]),y=(0,rF.useMemo)(()=>p?null:(0,rz.jsx)(rN.rj,{columns:a,gapX:4,gapY:5,children:"function"==typeof r?r():r}),[r,p,a]);return(0,rz.jsxs)(fk,d6(d6({"data-level":s},m),{},{children:[f&&(0,rz.jsxs)(rN.kC,{align:"flex-end",children:[(0,rz.jsx)(rN.xu,{flex:1,paddingY:2,children:(0,rz.jsxs)(rN.Kq,{space:2,children:[(0,rz.jsxs)(rN.kC,{children:[(0,rz.jsx)(fw,{collapsed:Boolean(p),collapsible:l,onClick:l?b:void 0,title:f}),g&&(0,rz.jsx)(rN.xu,{marginLeft:2,children:(0,rz.jsx)(fu,{fontSize:1,validation:n})})]}),o&&(0,rz.jsx)(rN.xv,{muted:!0,size:1,children:o})]})}),i.length>0&&(0,rz.jsx)(rN.xu,{children:(0,rz.jsx)(hK,{maxAvatars:4,presence:i})})]}),(0,rz.jsx)(fC,{$borderLeft:s>0,hidden:p,marginTop:1,paddingLeft:0===s?0:3,onFocus:"number"==typeof h&&h>-1?v:void 0,ref:x,tabIndex:h,children:!p&&y})]}))}),fE=lO.ZP.div(V||(V=d4(["\n  display: flex;\n  justify-content: flex-end;\n  box-sizing: border-box;\n  min-height: var(--avatar-height);\n  width: 77px;\n  margin-left: var(--small-padding);\n\n  &[data-max-avatars='1'] {\n    max-width: 23px;\n  }\n\n  &[data-position='top'] {\n    align-self: flex-start;\n  }\n\n  &[data-position='bottom'] {\n    align-self: flex-end;\n  }\n"])));function fT(e){let{children:t,maxAvatars:n,position:i="bottom"}=e;return(0,rz.jsx)(fE,{"data-max-avatars":n,"data-position":i,children:t})}let fA=(0,lO.ZP)(rN.zx)(B||(B=d4(["\n  cursor: ",";\n"])),e=>e.grid?"move":"ns-resize"),fP=rF.createContext(null),fI=function(e){let t=(0,rF.useContext)(fP),{listeners:n,attributes:i}=(0,oT.nB)({id:t});return(0,rz.jsx)(fA,d6(d6(d6({icon:lL.VVU,mode:"bleed","data-ui":"DragHandleButton"},i),e),n))},fM=e=>t=>{let{containerNodeRect:n,draggingNodeRect:i,transform:r}=t;return i&&n?function(e,t,n,i){let r=d6({},e),l=i.y||0,a=i.x||0;return t.top+r.y<=n.top+l?r.y=n.top-t.top+l:t.bottom+r.y>=n.top+n.height-l&&(r.y=n.top+n.height-t.bottom-l),t.left+r.x<=n.left-a?r.x=n.left-t.left+a:t.right+r.x>=n.left+n.width+a&&(r.x=n.left+n.width-t.right+a),r}(r,i,n,e):r},fz="moving",fR=(0,lO.ZP)(rN.xu)(U||(U=d4(["\n  ","\n"])),e=>e.$moving&&(0,lO.iv)(K||(K=d4(["\n      z-index: 10000;\n      /* prevents hover-effects etc on the dragged element  */\n      pointer-events: none;\n    "])))),fF={threshold:{x:0,y:.02}},fO={coordinateGetter:oT.is},fD={duration:200,easing:"ease"};function fZ(e){let{items:t,axis:n,onItemMove:i,onItemMoveStart:r,onItemMoveEnd:l,children:a}=e,o=d3(e,sP),s=(0,oE.Dy)((0,oE.VT)(oE.we),(0,oE.VT)(oE.Lg,fO)),d=(0,rF.useCallback)(e=>{let{active:n,over:r}=e;n.id!==(null==r?void 0:r.id)&&(null==i||i({fromIndex:t.indexOf(n.id),toIndex:t.indexOf(null==r?void 0:r.id)})),null==l||l()},[t,i,l]),c=(0,rF.useMemo)(()=>[fM({y:4}),...n?["x"===n?oP.K7:oP.DL]:[]],[n]);return(0,rz.jsx)(oE.LB,{sensors:s,autoScroll:fF,modifiers:c,collisionDetection:oE.pE,onDragEnd:d,onDragStart:r,children:(0,rz.jsx)(oT.Fo,{items:t,strategy:n?"x"===n?oT.PG:oT.qw:void 0,children:(0,rz.jsx)(rN.rj,d6(d6({},o),{},{children:a}))})})}function fL(e){let{id:t,children:n,disableTransition:i}=e,{setNodeRef:r,transform:l,transition:a,active:o}=(0,oT.nB)({id:t,transition:i?null:fD}),s=t===(null==o?void 0:o.id),d=(0,rF.useMemo)(()=>({transform:oA.ux.Translate.toString(l),transition:a,pointerEvents:o?"none":void 0}),[l,a,o]);return(0,rz.jsx)(fR,{ref:r,style:d,$moving:s,className:s?fz:"",children:n})}function fq(e){let{onItemMove:t,onItemMoveEnd:n,onItemMoveStart:i,sortable:r}=e,l=d3(e,sI),a=(0,rF.useCallback)(e=>{null==t||t(e)},[t]);return r?(0,rz.jsx)(fZ,d6({onItemMove:a,onItemMoveStart:i,onItemMoveEnd:n},l)):(0,rz.jsx)(rN.rj,d6({},l))}function fN(e){let{sortable:t}=e,n=d3(e,sM);return(0,rz.jsx)(fP.Provider,{value:e.id,children:t?(0,rz.jsx)(fL,d6({},n)):(0,rz.jsx)(fR,d6({},n))})}let fV=(0,lO.ZP)(rN.Zb)(H||(H=d4(["\n  position: relative;\n  border: 1px solid transparent;\n  transition: border-color 250ms;\n\n  ."," & {\n    border-color: var(--card-shadow-umbra-color);\n    box-shadow: 0 0 0 0, 0 8px 17px 2px var(--card-shadow-umbra-color),\n      0 3px 14px 2px var(--card-shadow-penumbra-color),\n      0 5px 5px -3px var(--card-shadow-ambient-color);\n  }\n\n  &:hover {\n    border-color: var(--card-shadow-umbra-color);\n  }\n\n  &[aria-selected='true'] {\n    border-color: var(--card-focus-ring-color);\n  }\n"])),fz);function fB(e){let{validation:t,selected:n,tone:i,presence:r,focused:l,children:a,dragHandle:o,menu:s,footer:d}=e,c=(0,rF.useRef)(null);return ht(l,(e,t)=>{var n;!e&&t&&(null==(n=c.current)||n.focus())}),(0,rz.jsx)(fV,{ref:c,selected:n,"aria-selected":n,radius:2,padding:1,tone:i,children:(0,rz.jsxs)(rN.Kq,{space:1,children:[(0,rz.jsxs)(rN.kC,{align:"center",children:[o&&(0,rz.jsx)(rN.xu,{marginRight:1,paddingY:1,children:(0,rz.jsx)(fI,{paddingX:1,paddingY:3})}),(0,rz.jsx)(rN.xu,{flex:1,children:a}),(r||t||s)&&(0,rz.jsxs)(rN.kC,{align:"center",marginLeft:1,children:[r&&(0,rz.jsx)(rN.xu,{marginLeft:1,children:r}),t&&(0,rz.jsx)(rN.xu,{marginLeft:1,children:t}),s]})]}),d]})})}let fU=lO.ZP.button($||($=d4(["\n  display: block;\n  -webkit-font-smoothing: inherit;\n  appearance: none;\n  font: inherit;\n  background: none;\n  width: 100%;\n  text-align: left;\n  border: 0;\n  margin: 0;\n  padding: 0;\n  outline: none;\n"]))),fK=(0,lO.ZP)(lL.tgp)(X||(X=d4(["\n  transform: ",";\n"])),e=>e.open?"rotate(90deg)":""),fH=(0,lO.ZP)(rN.kC)(W||(W=d4(["\n  cursor: default;\n"]))),f$=(0,lO.ZP)(rN.xu)(G||(G=d4(["\n  & > div > svg {\n    transform: rotate(0);\n    transition: transform 100ms;\n  }\n\n  &[data-open] > div > svg {\n    transform: rotate(90deg);\n  }\n"])));function fX(e){let{children:t,open:n,icon:i,title:r="Details"}=e,l=d3(e,sz),[a,o]=(0,rF.useState)(n||!1),s=(0,rF.useCallback)(()=>o(e=>!e),[]);return(0,rF.useEffect)(()=>o(n||!1),[n]),(0,rz.jsxs)(rN.xu,d6(d6({},l),{},{children:[(0,rz.jsx)(fU,{type:"button",onClick:s,children:(0,rz.jsx)(fH,{align:"center",children:(0,rz.jsxs)(rN.gF,{children:[(0,rz.jsx)(f$,{"data-open":a?"":void 0,children:(0,rz.jsx)(rN.xv,{size:1,children:(0,rz.jsx)(fK,{open:a})})}),i&&(0,rz.jsx)(rN.xu,{marginLeft:1,children:i}),(0,rz.jsx)(rN.xu,{flex:1,marginLeft:1,children:(0,rz.jsx)(rN.xv,{size:1,weight:"medium",children:r})})]})})}),(0,rz.jsx)(rN.xu,{hidden:!a,marginTop:3,children:t})]}))}let fW={warning:"caution",error:"critical",info:"positive"},fG={warning:(0,rz.jsx)(lL.foC,{}),error:(0,rz.jsx)(lL.uIy,{}),info:(0,rz.jsx)(lL.hQ6,{})};function fY(e){let{children:t,status:n="warning",title:i}=e,r=d3(e,sR);return(0,rz.jsx)(rN.Zb,d6(d6({radius:2,tone:fW[n]},r),{},{"data-ui":"Alert",children:(0,rz.jsx)(rN.kC,{padding:1,children:t&&(0,rz.jsx)(rN.xu,{flex:1,children:(0,rz.jsx)(fX,{icon:fG[n],title:i,children:(0,rz.jsx)(rN.xu,{marginLeft:3,marginTop:3,children:t})})})})}))}function fJ(e){return(0,rM.m$)(e)?"object"===e.name?{}:{_type:e.name}:(0,rM.jB)(e)?[]:"string"===e.jsonType?"":"number"===e.jsonType?0:"boolean"!==e.jsonType&&void 0}function fQ(e){if(!(0,rM.m$)(e))throw Error('Invalid item type: "'.concat(e.type,'". Default array input can only contain objects (for now)'));return d6(d6({},fJ(e)),{},{_key:(0,a3.E2)(12)})}let f0={portal:!0,tone:"default",placement:"left",constrainSize:!0},f1=(0,rF.memo)(function(e){let{types:t,onInsert:n}=e;return(0,rz.jsxs)(rz.Fragment,{children:[(0,rz.jsx)(f2,{pos:"before",types:t,onInsert:n,text:"Add item before",icon:lL.ySV}),(0,rz.jsx)(f2,{pos:"after",types:t,onInsert:n,text:"Add item after",icon:lL.oty})]})});function f2(e){let{types:t,onInsert:n,pos:i,text:r,icon:l}=e;return(null==t?void 0:t.length)===1?(0,rz.jsx)(rN.sN,{text:r,icon:l,onClick:()=>n(i,t[0])},i):(0,rz.jsx)(rN.kS,{text:r,popover:f0,children:null==t?void 0:t.map(e=>(0,rz.jsx)(rN.sN,{icon:e.icon,text:e.title,onClick:()=>n(i,e)},e.name))},i)}let f3={isLoading:!0,result:void 0,error:void 0,retry:()=>void 0},f4={isLoading:!1,result:void 0,error:void 0,retry:()=>void 0};function f5(e,t){let n=(0,rF.useMemo)(()=>new rH.xQ,[]),i=(0,rF.useMemo)(()=>n.asObservable(),[n]),r=(0,rF.useCallback)(()=>{n.next({type:"retry"})},[n]),l=(0,rV.m2)(()=>(0,rU.z)((0,rB.of)(null),i).pipe((0,r8.U)(()=>e),(0,lg.b)(e=>e?t(e).pipe((0,r8.U)(e=>({isLoading:!1,result:e,error:void 0,retry:r})),(0,li.O)(f3),(0,le.K)(e=>(console.error(e),(0,rB.of)({isLoading:!1,result:void 0,error:e,retry:r})))):(0,rB.of)(f4))),[t,e,i,r],f3),a=he(e,e);return e&&a!==e?f3:l}function f6(e){let{time:t}=e;!function(e){let[t,n]=(0,rF.useReducer)(e=>e+1,0);(0,rF.useEffect)(()=>{let t=setInterval(n,e);return()=>clearInterval(t)},[e])}(1e3);let n=(0,oX.Z)(new Date(t));return(0,rz.jsxs)("span",{title:n,children:[n," ago"]})}function f8(e){let t=e.icon;return(0,rz.jsxs)(rN.kC,{padding:3,children:[(0,rz.jsx)(rN.xu,{children:(0,rz.jsx)(rN.xv,{size:1,children:(0,rz.jsx)(t,{})})}),(0,rz.jsxs)(rN.xu,{flex:1,marginLeft:3,children:[(0,rz.jsx)(rN.xv,{size:1,weight:"semibold",children:e.title}),(0,rz.jsx)(rN.xu,{marginTop:3,children:(0,rz.jsx)(rN.xv,{as:"p",muted:!0,size:1,children:e.children})})]})]})}function f7(e){var t,n,i,r;let{availability:l,id:a,layout:o,preview:s,refType:d,renderPreview:c,showTypeLabel:u}=e,p=(0,rN.Ur)(),h=Rn(a),f="NOT_FOUND"===l.reason,m="PERMISSION_DENIED"===l.reason,g=(null==(t=s.draft)?void 0:t._id)||(null==(n=s.published)?void 0:n._id)||a,x=(0,rF.useMemo)(()=>({_id:g,_type:d.name}),[g,d.name]),v=(0,rF.useMemo)(()=>({layout:o,schemaType:d,value:x}),[o,x,d]);return(0,rz.jsxs)(rN.kC,{align:"center",children:[l.available?(0,rz.jsx)(rN.xu,{flex:1,children:c(v)}):(0,rz.jsx)(rN.xu,{flex:1,children:(0,rz.jsx)(rN.kC,{align:"center",children:(0,rz.jsx)(rN.xu,{flex:1,paddingY:2,children:(0,rz.jsx)(rN.xv,{muted:!0,children:"Document unavailable"})})})}),(0,rz.jsx)(rN.xu,{paddingLeft:3,children:(0,rz.jsxs)(rN.gF,{space:3,children:[u&&(0,rz.jsx)(rN.__,{size:1,muted:!0,children:d.title}),m||f?(0,rz.jsx)(rN.xu,{children:(0,rz.jsx)(rN.u,{portal:!0,content:f?(0,rz.jsxs)(f8,{title:"Not found",icon:lL.BHU,children:["The referenced document does not exist",(0,rz.jsx)("br",{}),"(id: ",(0,rz.jsx)("code",{children:a}),")"]}):(0,rz.jsx)(f8,{title:"Insufficcient permissions",icon:lL.vaB,children:"The referenced document could not be accessed due to insufficient permissions"}),children:(0,rz.jsx)(uc,{tone:"default",children:(0,rz.jsx)(lL.BHU,{})})})}):null,h&&h.length>0&&(0,rz.jsx)(hR,{presence:h}),(0,rz.jsxs)(rN.gF,{space:4,children:[(0,rz.jsx)(rN.xu,{children:(0,rz.jsx)(rN.u,{portal:!0,content:(0,rz.jsx)(rN.xu,{padding:2,children:(0,rz.jsx)(rN.xv,{size:1,children:(null==(i=s.published)?void 0:i._updatedAt)?(0,rz.jsxs)(rz.Fragment,{children:["Published ",(0,rz.jsx)(f6,{time:s.published._updatedAt})]}):(0,rz.jsx)(rz.Fragment,{children:"Not published"})})}),children:(0,rz.jsx)(uc,{tone:"default"===p.tone?"positive":"default",size:1,dimmed:!s.published,muted:!s.published,children:(0,rz.jsx)(lL.EI4,{})})})}),(0,rz.jsx)(rN.xu,{children:(0,rz.jsx)(rN.u,{portal:!0,content:(0,rz.jsx)(rN.xu,{padding:2,children:(0,rz.jsx)(rN.xv,{size:1,children:(null==(r=s.draft)?void 0:r._updatedAt)?(0,rz.jsxs)(rz.Fragment,{children:["Edited ",(0,rz.jsx)(f6,{time:s.draft._updatedAt})]}):(0,rz.jsx)(rz.Fragment,{children:"No unpublished edits"})})}),children:(0,rz.jsx)(uc,{tone:"default"===p.tone?"caution":"default",size:1,dimmed:!s.draft,muted:!s.draft,children:(0,rz.jsx)(lL.dY8,{})})})})]})]})})]})}function f9(e){var t,n,i,r,l,a;let{referenceInfo:o,renderPreview:s,type:d,value:c,showTypeLabel:u}=e;if(o.isLoading||o.error)return(0,rz.jsx)(u3,{isPlaceholder:!0});if((null==(t=o.result)?void 0:t.availability.reason)==="NOT_FOUND"&&c._strengthenOnPublish){let p=d.to.find(e=>{var t;return e.name===(null==(t=null==c?void 0:c._strengthenOnPublish)?void 0:t.type)});if(!p)return(0,rz.jsx)("div",{children:"Invalid reference type"});if(c._strengthenOnPublish){let h=(null==(n=c._strengthenOnPublish)?void 0:n.type)?{_id:c._ref,_type:null==(i=c._strengthenOnPublish)?void 0:i.type}:c;return(0,rz.jsxs)(rN.kC,{align:"center",children:[(0,rz.jsx)(rN.xu,{flex:1,children:s({layout:"default",schemaType:p,value:h})}),(0,rz.jsx)(rN.xu,{children:(0,rz.jsx)(rN.gF,{space:4,children:u&&(0,rz.jsx)(rN.__,{size:1,muted:!0,children:p.title})})})]})}}let f=null==(r=o.result)?void 0:r.type,m=d.to.find(e=>e.name===f);return m?(0,rz.jsx)(f7,{availability:null==(l=o.result)?void 0:l.availability,id:c._ref,layout:"default",preview:null==(a=o.result)?void 0:a.preview,refType:m,renderPreview:s,showTypeLabel:u}):(0,rz.jsxs)(rN.Kq,{space:2,padding:2,children:["The referenced document is of invalid type: (",f||"unknown",")",(0,rz.jsx)("pre",{children:JSON.stringify(c,null,2)})]})}let me={portal:!0,tone:"default"},mt={position:"absolute",top:0,left:0,width:"100%",height:"100%",opacity:.6},mn=(0,lO.ZP)(rN.Zb)(Y||(Y=d4(["\n  /* this is a hack to avoid layout jumps while previews are loading\n     there's probably better ways of solving this */\n  min-height: 35px;\n\n  /* TextWithTone uses its own logic to set color, and we therefore need */\n  /* to override this logic in order to set the correct color in different states */\n  &[data-selected],\n  &[data-pressed],\n  &:active {\n    [data-ui='TextWithTone'] {\n      color: inherit;\n    }\n  }\n"])));function mi(e){var t,n,i,r,l,a,o,s,d,c;let{schemaType:u,parentSchemaType:p,path:h,readOnly:f,onRemove:m,value:g,open:x,onInsert:v,onFocus:b,presence:y,validation:j,inputId:w,changed:k,focused:C,children:_,inputProps:{onChange:S,focusPath:E,onPathFocus:T,renderPreview:A,elementProps:P}}=e,I=(null==(t=p.options)?void 0:t.sortable)!==!1,M=p.of,z=(0,rF.useRef)(null),{EditReferenceLink:R,getReferenceInfo:F,selectedState:O,isCurrentDocumentLiveEdit:D}=jl({path:h,schemaType:u,value:g});hE(z,x),ht(C,(e,t)=>{var n;!e&&t&&z.current&&(null==(n=z.current)||n.focus())});let Z=e.validation.some(e=>"error"===e.level),L=e.validation.some(e=>"warning"===e.level),q=g._resolvingInitialValue,N=(0,rF.useCallback)(()=>{v({items:[d6(d6({},g),{},{_key:hA()})],position:"after"})},[v,g]),V=(0,rF.useCallback)((e,t)=>{v({items:[d6(d6({},fQ(t)),{},{_key:hA()})],position:e})},[v]),B=f5(null==g?void 0:g._ref,F),U=g._ref,K=(null==(n=B.result)?void 0:n.type)||(null==(i=null==g?void 0:g._strengthenOnPublish)?void 0:i.type),H=U&&(null==(a=null==(l=null==(r=B.result)?void 0:r.preview)?void 0:l.published)?void 0:a._id),$=(0,rF.useCallback)(()=>{S([!0===u.weak?p4(!0,["_weak"]):p5(["_weak"]),p5(["_strengthenOnPublish"])])},[S,u.weak]),X=K?u.to.find(e=>e.name===K):void 0,W="pressed"===O,G="selected"===O,Y=function(e){let{readOnly:t,hasErrors:n,hasWarnings:i}=e;return t?"transparent":n?"critical":i?"caution":"default"}({readOnly:f,hasErrors:Z,hasWarnings:L}),J=!U||"_ref"===E[0],Q=(0,rF.useMemo)(()=>f?null:(0,rz.jsx)(rN.xu,{marginLeft:1,children:(0,rz.jsx)(rN.j2,{button:(0,rz.jsx)(rN.zx,{paddingY:3,paddingX:2,mode:"bleed",icon:lL.zGg}),id:"".concat(w,"-menuButton"),menu:(0,rz.jsxs)(rN.v2,{children:[!f&&(0,rz.jsxs)(rz.Fragment,{children:[(0,rz.jsx)(rN.sN,{text:"Remove",tone:"critical",icon:lL.XHJ,onClick:m}),(0,rz.jsx)(rN.sN,{text:U&&J?"Cancel replace":"Replace",icon:U&&J?lL.Two:lL.bnu,onClick:U&&J?()=>T([]):()=>T(["_ref"])}),(0,rz.jsx)(rN.sN,{text:"Duplicate",icon:lL.TIy,onClick:N}),(0,rz.jsx)(f1,{onInsert:V,types:M})]}),!f&&!J&&U&&(0,rz.jsx)(rN.R,{}),!J&&U&&(0,rz.jsx)(rN.sN,{as:R,"data-as":"a",text:"Open in new tab",icon:lL.buG})]}),popover:me})}),[f,w,m,U,J,N,V,M,R,T]),ee=(0,rF.useCallback)(()=>{S(!0===u.weak?p4(!0,["_weak"]):p5(["_weak"]))},[S,u]),et=(null==g?void 0:g._weak)?"weak":"strong",en=!0===u.weak?"weak":"strong",ei=U&&!B.isLoading&&(null==g?void 0:g._strengthenOnPublish),er=!B.isLoading&&U&&et!==en&&!ei,el=(null==(o=B.result)?void 0:o.preview.draft)||(null==(s=B.result)?void 0:s.preview.published),ea=(0,rz.jsxs)(rz.Fragment,{children:[D&&H&&g._strengthenOnPublish&&(0,rz.jsx)(fY,{padding:1,title:u.weak?"Finalize reference":"Convert to strong reference",status:"info","data-testid":"alert-reference-published",children:(0,rz.jsxs)(rN.Kq,{space:3,children:[(0,rz.jsxs)(rN.xv,{as:"p",muted:!0,size:1,children:[(0,rz.jsx)("strong",{children:null==(c=null==(d=B.result)?void 0:d.preview.published)?void 0:c.title})," is published and this reference should now be"," ",u.weak?(0,rz.jsx)(rz.Fragment,{children:"finalized"}):(0,rz.jsx)(rz.Fragment,{children:"converted to a strong reference"}),"."]}),(0,rz.jsx)(rN.zx,{onClick:$,text:(0,rz.jsx)(rz.Fragment,{children:"Convert to strong reference"}),tone:"positive"})]})}),er&&(0,rz.jsx)(fY,{padding:1,title:"Reference strength mismatch",status:"warning","data-testid":"alert-reference-strength-mismatch",children:(0,rz.jsxs)(rN.Kq,{space:3,children:[(0,rz.jsxs)(rN.xv,{as:"p",muted:!0,size:1,children:["This reference is ",(0,rz.jsx)("em",{children:et}),", but according to the current schema it should be"," ",(0,rz.jsxs)("em",{children:[en,"."]})]}),(0,rz.jsx)(rN.xv,{as:"p",muted:!0,size:1,children:u.weak?(0,rz.jsxs)(rz.Fragment,{children:['It will not be possible to delete the "',null==el?void 0:el.title,'"-document without first removing this reference.']}):(0,rz.jsxs)(rz.Fragment,{children:['This makes it possible to delete the "',null==el?void 0:el.title,'"-document without first deleting this reference, leaving this field referencing a nonexisting document.']})}),(0,rz.jsx)(rN.zx,{onClick:ee,text:(0,rz.jsxs)(rz.Fragment,{children:["Convert to ",en," reference"]}),tone:"caution"})]})}),B.error&&(0,rz.jsx)(fY,{padding:1,title:"Unable to load reference metadata",status:"warning","data-testid":"alert-reference-info-failed",children:(0,rz.jsxs)(rN.Kq,{space:3,children:[(0,rz.jsxs)(rN.xv,{as:"p",muted:!0,size:1,children:["Error: ",B.error.message]}),(0,rz.jsx)(rN.zx,{onClick:B.retry,text:(0,rz.jsx)(rz.Fragment,{children:"Retry"}),tone:"primary"})]})})]}),eo=(0,rz.jsx)(fB,{dragHandle:I,presence:!J&&y.length>0&&(0,rz.jsx)(hK,{presence:y,maxAvatars:1}),validation:!J&&j.length>0&&(0,rz.jsx)(fu,{validation:j}),menu:Q,footer:J?void 0:ea,tone:J?void 0:Y,focused:C,children:J?(0,rz.jsx)(rN.xu,{padding:1,children:(0,rz.jsx)(fS,{title:u.title,description:u.description,__unstable_presence:y,validation:j,children:_})}):(0,rz.jsxs)(mn,d6(d6({forwardedAs:R,tone:"inherit",radius:2,"data-as":"a",documentId:null==g?void 0:g._ref,documentType:null==X?void 0:X.name,disabled:q,paddingX:2,paddingY:1,__unstable_focusRing:!0,style:{position:"relative"},selected:G,pressed:W,"data-selected":!!G||void 0,"data-pressed":!!W||void 0},P),{},{children:[(0,rz.jsx)(f9,{value:g,referenceInfo:B,renderPreview:A,type:u}),q&&(0,rz.jsx)(rN.Zb,{style:mt,tone:"transparent",radius:2,as:rN.kC,justify:"center",children:(0,rz.jsxs)(rN.kC,{align:"center",justify:"center",padding:3,children:[(0,rz.jsx)(rN.xu,{marginX:3,children:(0,rz.jsx)(rN.$j,{muted:!0})}),(0,rz.jsx)(rN.xv,{children:"Resolving initial value…"})]})})]}))});return(0,rz.jsx)(cH,{path:h,isChanged:k,hasFocus:Boolean(C),children:(0,rz.jsx)(rN.xu,{paddingX:1,children:eo})})}function mr(e){return(0,rM.m$)(e.schemaType)}function ml(e){return(0,rM.jB)(e.schemaType)}function ma(e){return void 0!==e._key?e:d6(d6({},e),{},{_key:hA(12)})}function mo(e,t){let n=e.indexOf(t);return n>-1&&e.splice(n,1),e}let ms=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:4,n=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:4,t=[],n=[],i=new rH.xQ;return function r(l){return new rQ.y(a=>{if(t.length>=e)return(n.push(l),i.asObservable().pipe((0,lx.P)(e=>e===l))).pipe((0,ls.zg)(r)).subscribe(a);let o=l.subscribe(a);return t.push(o),()=>{mo(t,o),mo(n,l),o.unsubscribe(),function(){for(;n.length>0&&t.length<e;)i.next(n.shift())}()}})}}(t);return function(){return(0,r1.D)(n(e(...arguments)))}}(function(e,t,n){var i;let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},l=r.metadata,a=r.storeOriginalFilename,{label:o,title:s,description:d,creditLine:c,source:u}=r;return(i=n,window.crypto&&window.crypto.subtle&&window.FileReader?new rQ.y(e=>{let t=new FileReader;return t.onload=()=>{e.next(t.result),e.complete()},t.onerror=t=>{e.error(t)},t.readAsArrayBuffer(i),()=>{t.abort()}}).pipe((0,ls.zg)(e=>crypto.subtle.digest("SHA-1",e)),(0,r8.U)(mp)):(0,rB.of)(null)).pipe((0,le.K)(()=>(0,rB.of)(null)),(0,ls.zg)(n=>n?e.observable.fetch("*[_type == $documentType && sha1hash == $hash][0]",{documentType:"sanity.".concat(t,"Asset"),hash:n},{tag:"asset.find-duplicate"}):(0,rB.of)(null)),(0,ls.zg)(i=>i?(0,rB.of)({type:"complete",id:i._id,asset:i}):e.observable.assets.upload(t,n,{tag:"asset.upload",extract:l,preserveFilename:a,label:o,title:s,description:d,creditLine:c,source:u}).pipe((0,r8.U)(e=>"response"===e.type?{type:"complete",id:e.body.document._id,asset:e.body.document}:e))))},4),md=(e,t,n)=>ms(e,"image",t,n),mc=(e,t,n)=>ms(e,"file",t,n);function mu(e,t){return e.observePaths({_type:"reference",_ref:t},["originalFilename","url","metadata","label","title","description","creditLine","source","size"])}function mp(e){return Array.prototype.map.call(new Uint8Array(e),e=>"00".concat(e.toString(16)).slice(-2)).join("")}let mh=/(invalid image format)|(No exif data)/i;function mf(e){return[5,6,7,8].indexOf(e)>-1}function mm(e,t,n){let i=e.getContext("2d");null==i||i.translate(t?e.width:0,n?e.height:0),null==i||i.scale(t?-1:1,n?-1:1)}let mg=[{op:"none",degrees:0},{op:"flip-x",degrees:0},{op:"none",degrees:180},{op:"flip-y",degrees:0},{op:"flip-x",degrees:90},{op:"none",degrees:90},{op:"flip-x",degrees:-90},{op:"none",degrees:-90}],mx=["top-left","top-right","bottom-right","bottom-left","left-top","right-top","right-bottom","left-bottom"],mv="_upload",mb=p5([mv]);function my(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return{type:"uploadProgress",patches:e}}let mj=my([mb]);function mw(e){let t=new Date().toISOString(),n={progress:2,createdAt:t,updatedAt:t,file:{name:e.name,type:e.type}};return my([p4(n,[mv])])}function mk(e,t,n){let i=mc(e,t,n).pipe((0,r8.U)(e=>"complete"===e.type?my([p4({_type:"reference",_ref:e.asset._id},["asset"]),p4(100,[mv,"progress"]),p4(new Date().toISOString(),[mv,"updated"])]):my([p4(e.percent,[mv,"progress"]),p4(new Date().toISOString(),[mv,"updated"])])));return(0,rU.z)((0,rB.of)(mw(t)),i,(0,rB.of)(mj))}let mC=[{type:"image",accepts:"image/*",upload:(e,t,n,i)=>(function(e,t,n){let i=md(e,t,n).pipe((0,lt.h)(e=>"download"!==e.stage),(0,r8.U)(e=>d6(d6({},e),{},{progress:2+e.percent/100*98})),(0,r8.U)(e=>"complete"===e.type?my([p4({_type:"reference",_ref:e.asset._id},["asset"]),p4(100,[mv,"progress"]),p4(new Date().toISOString(),[mv,"updatedAt"])]):my([p4(e.percent,[mv,"progress"]),p4(new Date().toISOString(),[mv,"updatedAt"])]))),r=(0,r1.D)(new rQ.y(e=>{let n=new window.FileReader;return n.onerror=t=>e.error(t),n.onload=()=>{e.next(n.result),e.complete()},n.readAsArrayBuffer(t.slice(0,128e3)),()=>n.abort()})).pipe((0,r8.U)(e=>oY()(e)),(0,le.K)(e=>(mh.test(e.message)||console.warn("Exif read failed, continuing anyway: ".concat(e.message)),(0,rB.of)({})))).pipe((0,ls.zg)(e=>{var n,i;return n=e.orientation||"top-left",(i=window.URL.createObjectURL(t),new rQ.y(e=>{let t=new window.Image;return t.onerror=()=>{e.error(Error('Could not load image from url "'.concat(i,'". Image may be of an unsupported format')))},t.onload=()=>{e.next(t),e.complete()},t.src=i,()=>{}})).pipe((0,ls.zg)(e=>new rQ.y(t=>{let i=mx.indexOf(n)+1,r=function(e,t){let n=mg[t-1],i=e.height/e.width;e.width=120/i,e.height=e.width*i;let r=document.createElement("canvas"),l=r.getContext("2d");if(mf(t)?(r.height=e.width,r.width=e.height):(r.width=e.width,r.height=e.height),"flip-x"===n.op&&mm(r,!0,!1),"flip-y"===n.op&&mm(r,!1,!0),n.degrees&&(function(e,t){let n=t.x,i=t.y,r=(t.degrees||0)*(Math.PI/180);null==e||e.translate(n,i),null==e||e.rotate(r),null==e||e.translate(-n,-i)}(l,{degrees:n.degrees,x:r.width/2,y:r.height/2}),mf(t))){let a=r.width-r.height;null==l||l.translate(a/2,-a/2)}return null==l||l.drawImage(e,0,0,e.width,e.height),r}(e,i);t.next(r.toDataURL("image/jpeg",.1)),t.complete()})))}),(0,le.K)(e=>(console.warn('Image preprocessing failed for "%s" with the error: %s',t.name,e.message),(0,rB.of)(null))),(0,lt.h)(Boolean),(0,r8.U)(e=>my([p4(e,[mv,"previewImage"])])));return(0,rU.z)((0,rB.of)(mw(t)),(0,r$.T)(i,r),(0,rB.of)(mj))})(e,t,i)},{type:"string",accepts:"text/*",upload:(e,t,n,i)=>mk(e,t,i).pipe((0,r8.U)(e=>({type:"uploadProgress",patches:[p4(e)]})))},{type:"file",accepts:"",upload:(e,t,n,i)=>mk(e,t,i)}].map((e,t)=>d6(d6({},e),{},{priority:t}));function m_(e,t){if(!e||!t)return!0;let n=Array.isArray(t)?t:t.split(","),i=e.name||"",r=(e.type||"").toLowerCase(),l=r.replace(/\/.*$/,"");return n.some(e=>{let t=e.trim().toLowerCase();return"."===t.charAt(0)?i.toLowerCase().endsWith(t):t.endsWith("/*")?l===t.replace(/\/.*$/,""):r===t})}function mS(e,t){return mC.find(n=>{var i;return u0(n.type,e)&&m_(t,n.accepts)&&m_(t,(null==(i=e.options)?void 0:i.accept)||"")})||null}let mE=["_key","_type","_weak"];function mT(e){return Object.keys(e).every(e=>mE.includes(e))}let mA=(e,t)=>{let n=(0,a3.wq)(t);return e.of.find(e=>e.name===n)};function mP(e,t,n){return(0,r1.D)(e).pipe((0,ls.zg)(e=>{let i={_key:e._key};return(0,rB.of)(mA(t,e)).pipe((0,ls.zg)(e=>e?(0,rB.of)(e):rJ.E),(0,ls.zg)(t=>mT(e)&&n?(0,rU.z)((0,rB.of)({type:"patch",patches:[p4(!0,[i,"_resolvingInitialValue"])]}),(0,rX.P)(()=>n(t,e)).pipe((0,lt.h)(cf),(0,r8.U)(e=>{var t;return{type:"patch",patches:(t=[i],Object.entries(e).map(e=>{let[n,i]=e;return p4(i,[...t,n])}))}}),(0,le.K)(n=>(0,rB.of)({type:"error",error:n,item:e,schemaType:t}))),(0,rB.of)({type:"patch",patches:[p5([i,"_resolvingInitialValue"])]})):rJ.E))}))}function mI(e){let{onPathBlur:t,onPathFocus:n,onChange:i,onSetPathCollapsed:r,onSetFieldSetCollapsed:l,onPathOpen:a,onFieldGroupSelect:o}=hp(),{member:s,renderField:d,renderInput:c,renderItem:u,renderPreview:p}=e,h=(0,rF.useRef)(),f=(0,rF.useRef)({});ht(s.field.focused,(e,t)=>{var n;!e&&t&&(null==(n=h.current)||n.focus())});let m=(0,rF.useCallback)(e=>{e.currentTarget===e.target&&e.currentTarget===h.current&&n(s.field.path)},[s.field.path,n]),g=(0,rF.useCallback)(e=>{e.currentTarget===e.target&&e.currentTarget===h.current&&t(s.field.path)},[s.field.path,t]),x=(0,rF.useCallback)(e=>{i(p6.from(e).prepend(p2([])).prefixAll(s.name))},[i,s.name]),v=zu(),b=(0,rN.pm)(),y=(0,rF.useCallback)(()=>{r(s.field.path,!0)},[r,s.field.path]),j=(0,rF.useCallback)(()=>{r(s.field.path,!1)},[r,s.field.path]),w=(0,rF.useCallback)(e=>{r(s.field.path.concat({_key:e}),!0)},[r,s.field.path]),k=(0,rF.useCallback)(e=>{r(s.field.path.concat({_key:e}),!1)},[r,s.field.path]),C=(0,rF.useCallback)(e=>{a(e),r(e,!1)},[a,r]),_=(0,rF.useCallback)(()=>{a(s.field.path),r(s.field.path,!0)},[a,s.field.path,r]),S=(0,rF.useCallback)(e=>{if(0===e.items.length)throw Error("Insert event should include at least one item");let t=e.items.map(e=>ma(e));x(p6.from([p3(t,e.position,[e.referenceItem])]));let i=t[0]._key,r=[...s.field.path,{_key:i}];n(r);let l=!1!==e.open;e.skipInitialValue?l&&C(r):mP(t,s.field.schemaType,v).pipe((0,lr.b)(e=>{"patch"===e.type?x(e.patches):b.push({title:"Could not resolve initial value",description:"Unable to resolve initial value for type: ".concat(e.schemaType.title,": ").concat(e.error.message,"."),status:"error"})})).subscribe({complete:()=>{l&&C(r)}})},[x,C,s.field.path,s.field.schemaType,n,v,b]),E=(0,rF.useCallback)(e=>{let t=s.field.value,n=null==t?void 0:t[e.fromIndex],i=null==t?void 0:t[e.toIndex];if(e.fromIndex!==e.toIndex){if(!(null==n?void 0:n._key)||!(null==i?void 0:i._key)){console.error("Neither the item you are moving nor the item you are moving to have a key. Cannot continue.");return}x([p5([{_key:n._key}]),p3([n],e.fromIndex>e.toIndex?"before":"after",[{_key:i._key}])])}},[x,s.field.value]),T=(0,rF.useCallback)(e=>{x([p2([]),p3([ma(e)],"before",[0])])},[x]),A=(0,rF.useCallback)(e=>{x([p2([]),p3([ma(e)],"after",[-1])])},[x]),P=(0,rF.useCallback)(e=>{f.current[e]&&(f.current[e].unsubscribe(),delete f.current[e]),x([p5(s.field.path.concat({_key:e}))])},[x,s.field.path]),I=(0,rF.useCallback)(e=>{n(s.field.path.concat(e))},[s.field.path,n]),M=(0,rF.useMemo)(()=>({onBlur:g,onFocus:m,id:s.field.id,ref:h}),[g,m,s.field.id]),z=IW(uX),R=hi(),F=R.__internal.image.directUploads,O=R.__internal.file.directUploads,D=(0,rF.useCallback)((e,t)=>u0("image",e)&&!F||u0("file",e)&&!O?null:mS(e,t),[O,F]),Z=(0,rF.useCallback)(e=>{let{file:t,schemaType:n,uploader:i}=e,r=fQ(n),l=r._key;S({items:[r],position:"after",referenceItem:-1,open:!1});let a=i.upload(z,t,n).pipe((0,r8.U)(e=>p6.from(e.patches||[]).prefixAll({_key:l})),(0,lr.b)(e=>x(e.patches)));f.current=d6(d6({},f.current),{},{[l]:a.subscribe()})},[z,x,S]),L=(0,rF.useMemo)(()=>({level:s.field.level,members:s.field.members,value:s.field.value,readOnly:s.field.readOnly,schemaType:s.field.schemaType,changed:s.field.changed,id:s.field.id,onItemExpand:k,onItemCollapse:w,onItemClose:_,onItemOpen:C,focusPath:s.field.focusPath,focused:s.field.focused,path:s.field.path,onChange:x,onInsert:S,onItemMove:E,onItemRemove:P,onItemAppend:A,onItemPrepend:T,onPathFocus:I,resolveInitialValue:v,onUpload:Z,resolveUploader:D,validation:s.field.validation,presence:s.field.presence,renderInput:c,renderField:d,renderItem:u,renderPreview:p,elementProps:M}),[s.field.level,s.field.members,s.field.value,s.field.readOnly,s.field.schemaType,s.field.changed,s.field.id,s.field.focusPath,s.field.focused,s.field.path,s.field.validation,s.field.presence,k,w,_,C,x,S,E,P,A,T,I,v,Z,D,c,d,u,p,M]),q=(0,rF.useMemo)(()=>c(L),[L,c]),N=(0,rF.useMemo)(()=>({name:s.name,index:s.index,level:s.field.level,value:s.field.value,title:s.field.schemaType.title,description:s.field.schemaType.description,collapsible:s.collapsible,collapsed:s.collapsed,changed:s.field.changed,onCollapse:y,onExpand:j,schemaType:s.field.schemaType,inputId:s.field.id,path:s.field.path,presence:s.field.presence,validation:s.field.validation,children:q,inputProps:L}),[s.name,s.index,s.field.level,s.field.value,s.field.schemaType,s.field.id,s.field.path,s.field.presence,s.field.changed,s.field.validation,s.collapsible,s.collapsed,y,j,q,L]);return(0,rz.jsx)(hu,{onFieldGroupSelect:o,onChange:x,onSetFieldSetCollapsed:l,onSetPathCollapsed:r,onPathOpen:a,onPathBlur:t,onPathFocus:n,children:(0,rF.useMemo)(()=>d(N),[N,d])})}function mM(e){let{member:t,renderInput:n,renderField:i}=e,r=(0,rF.useRef)(),{onPathBlur:l,onPathFocus:a,onChange:o}=hp();(0,rF.useEffect)(()=>{var e;t.field.focused&&(null==(e=r.current)||e.focus())},[t.field.focused]);let s=(0,rF.useCallback)(()=>{l(t.field.path)},[t.field.path,l]),d=(0,rF.useCallback)(()=>{a(t.field.path)},[t.field.path,a]),c=(0,rF.useCallback)(e=>{o(p6.from(e).prefixAll(t.name))},[o,t.name]),u=(0,rF.useCallback)(e=>{let n=e.currentTarget.value;(0,rM.J1)(t.field.schemaType)?n=e.currentTarget.valueAsNumber:(0,rM.EG)(t.field.schemaType)&&(n=e.currentTarget.checked);let i=""===n||"number"==typeof n&&isNaN(n);o(p6.from(i?p5():p4(n)).prefixAll(t.name))},[t.name,t.field.schemaType,o]),p=(0,rF.useMemo)(()=>t.field.validation.filter(e=>"error"===e.level).map(e=>e.message).join("\n"),[t.field.validation])||void 0,h=(0,rF.useMemo)(()=>{var e;return{onBlur:s,onFocus:d,id:t.field.id,ref:r,onChange:u,value:String(null!=(e=t.field.value)?e:""),readOnly:Boolean(t.field.readOnly),placeholder:t.field.schemaType.placeholder}},[s,d,u,t.field.id,t.field.readOnly,t.field.schemaType.placeholder,t.field.value]),f=(0,rF.useMemo)(()=>({value:t.field.value,readOnly:t.field.readOnly,schemaType:t.field.schemaType,changed:t.field.changed,id:t.field.id,path:t.field.path,focused:t.field.focused,level:t.field.level,onChange:c,validation:t.field.validation,presence:t.field.presence,validationError:p,elementProps:h}),[t.field.value,t.field.readOnly,t.field.schemaType,t.field.changed,t.field.id,t.field.path,t.field.focused,t.field.level,t.field.validation,t.field.presence,c,p,h]),m=(0,rF.useMemo)(()=>n(f),[f,n]),g=(0,rF.useMemo)(()=>({name:t.name,index:t.index,level:t.field.level,value:t.field.value,schemaType:t.field.schemaType,title:t.field.schemaType.title,description:t.field.schemaType.description,inputId:t.field.id,path:t.field.path,validation:t.field.validation,presence:t.field.presence,children:m,changed:t.field.changed,inputProps:f}),[t.name,t.index,t.field.level,t.field.value,t.field.schemaType,t.field.id,t.field.path,t.field.validation,t.field.presence,t.field.changed,m,f]);return(0,rz.jsx)(rz.Fragment,{children:i(g)})}let mz=function(e){let{onPathBlur:t,onPathFocus:n,onChange:i,onPathOpen:r,onSetPathCollapsed:l,onSetFieldSetCollapsed:a,onFieldGroupSelect:o}=hp(),{member:s,renderField:d,renderInput:c,renderItem:u,renderPreview:p}=e,h=(0,rF.useRef)();ht(s.field.focused,(e,t)=>{var n;!e&&t&&(null==(n=h.current)||n.focus())});let f=(0,rF.useCallback)(()=>{t(s.field.path)},[s.field.path,t]),m=(0,rF.useCallback)(()=>{n(s.field.path)},[s.field.path,n]),g=(0,rF.useCallback)(e=>{n(s.field.path.concat(e))},[s.field.path,n]),x=(0,rF.useCallback)(e=>{i(p6.from(e).prepend(p2(fJ(s.field.schemaType))).prefixAll(s.name))},[i,s.field.schemaType,s.name]),v=(0,rF.useCallback)(()=>{l(s.field.path,!0)},[l,s.field.path]),b=(0,rF.useCallback)(()=>{l(s.field.path,!1)},[l,s.field.path]),y=(0,rF.useCallback)(e=>{l(s.field.path.concat(e),!0)},[l,s.field.path]),j=(0,rF.useCallback)(e=>{l(s.field.path.concat(e),!1)},[l,s.field.path]),w=(0,rF.useCallback)(e=>{r(s.field.path.concat(e))},[r,s.field.path]),k=(0,rF.useCallback)(()=>{r(s.field.path)},[r,s.field.path]),C=(0,rF.useCallback)(e=>{a(s.field.path.concat(e),!1)},[a,s.field.path]),_=(0,rF.useCallback)(e=>{a(s.field.path.concat(e),!0)},[a,s.field.path]),S=(0,rF.useCallback)(()=>{r(s.field.path)},[r,s.field.path]),E=(0,rF.useCallback)(()=>{r(s.field.path.slice(0,-1))},[r,s.field.path]),T=(0,rF.useCallback)(e=>{o(s.field.path,e)},[o,s.field.path]),A=(0,rF.useMemo)(()=>({onBlur:f,onFocus:m,id:s.field.id,ref:h}),[f,m,s.field.id]),P=(0,rF.useMemo)(()=>({elementProps:A,level:s.field.level,members:s.field.members,value:s.field.value,readOnly:s.field.readOnly,validation:s.field.validation,presence:s.field.presence,schemaType:s.field.schemaType,changed:s.field.changed,id:s.field.id,onFieldGroupSelect:T,onFieldOpen:w,onFieldClose:k,onFieldCollapse:y,onFieldExpand:j,onFieldSetExpand:C,onFieldSetCollapse:_,onPathFocus:g,path:s.field.path,focusPath:s.field.focusPath,focused:s.field.focused,groups:s.field.groups,onChange:x,renderField:d,renderInput:c,renderItem:u,renderPreview:p}),[A,s.field.level,s.field.members,s.field.value,s.field.readOnly,s.field.validation,s.field.presence,s.field.schemaType,s.field.changed,s.field.id,s.field.path,s.field.focusPath,s.field.focused,s.field.groups,T,w,k,y,j,C,_,g,x,d,c,u,p]),I=(0,rF.useMemo)(()=>c(P),[P,c]),M=(0,rF.useMemo)(()=>({name:s.name,index:s.index,level:s.field.level,value:s.field.value,validation:s.field.validation,presence:s.field.presence,title:s.field.schemaType.title,description:s.field.schemaType.description,collapsible:s.collapsible,collapsed:s.collapsed,onCollapse:v,onExpand:b,open:s.open,changed:s.field.changed,onOpen:S,onClose:E,schemaType:s.field.schemaType,inputId:s.field.id,path:s.field.path,children:I,inputProps:P}),[s.name,s.index,s.field.changed,s.field.level,s.field.value,s.field.validation,s.field.presence,s.field.schemaType,s.field.id,s.field.path,s.collapsible,s.collapsed,s.open,v,b,S,E,I,P]);return(0,rz.jsx)(hu,{onFieldGroupSelect:o,onChange:x,onSetFieldSetCollapsed:a,onPathOpen:r,onSetPathCollapsed:l,onPathBlur:t,onPathFocus:n,children:(0,rF.useMemo)(()=>d(M),[M,d])})};function mR(e){let{onPathBlur:t,onPathFocus:n,onChange:i,onPathOpen:r,onSetPathCollapsed:l,onSetFieldSetCollapsed:a,onFieldGroupSelect:o}=hp(),{member:s,renderField:d,renderInput:c,renderItem:u,renderPreview:p}=e,h=(0,rF.useRef)(),f=(0,rF.useRef)(),m=IW(uX);ht(s.field.focused,(e,t)=>{var n;!e&&t&&(null==(n=h.current)||n.focus())});let g=(0,rF.useCallback)(e=>{e.currentTarget===e.target&&e.currentTarget===h.current&&n(s.field.path)},[s.field.path,n]),x=(0,rF.useCallback)(e=>{e.currentTarget===e.target&&e.currentTarget===h.current&&t(s.field.path)},[s.field.path,t]),v=(0,rF.useCallback)(e=>{i(p6.from(e).prepend(p2([])).prefixAll(s.name))},[i,s.name]),b=(0,rF.useCallback)(e=>{l(s.field.path,e)},[l,s.field.path]),y=(0,rF.useCallback)(()=>{l(s.field.path,!0)},[l,s.field.path]),j=(0,rF.useCallback)(()=>{l(s.field.path,!1)},[l,s.field.path]),w=(0,rF.useCallback)(e=>{v(0===e.length?p5():p4(e))},[v]),k=(0,rF.useCallback)(e=>{let{value:t=[]}=s.field;e.fromIndex!==e.toIndex&&w(function(e,t,n){let i=e.slice(),r=i[t];return i.splice(t,1),i.splice(n,0,r),i}(t,e.fromIndex,e.toIndex))},[s.field,w]),C=(0,rF.useCallback)(e=>{let{value:t=[]}=s.field;w(t.concat(e))},[s.field,w]),_=(0,rF.useCallback)(e=>{let{value:t=[]}=s.field;w([e].concat(t||[]))},[s.field,w]),S=(0,rF.useCallback)(e=>{let{value:t=[]}=s.field,n=e.referenceIndex+("before"===e.position?-1:0);w(function(e,t,n){let i=t.slice();return i.splice(e+1,0,...n),i}(n,t,e.items))},[s.field,w]),E=(0,rF.useCallback)(e=>{v(p5([e]))},[v]),T=(0,rF.useCallback)(e=>{n(s.field.path.concat([e]))},[s.field.path,n]),A=(0,rF.useMemo)(()=>({onBlur:x,onFocus:g,id:s.field.id,ref:h}),[x,g,s.field.id]),P=(0,rF.useMemo)(()=>{var e;return e=s.field.schemaType.of,{priority:0,accepts:"text/*",type:"string",upload:(t,n)=>new rQ.y(e=>{let t=new FileReader;return t.onerror=t=>e.error(t),t.onload=()=>{e.next(t.result),e.complete()},t.readAsText(n,"utf-8"),()=>{t.abort()}}).pipe((0,r8.U)(t=>null==t?void 0:t.split(/[\n\r]/).map(t=>{var n;let i,r,l;return n=t,i=!1,r=!1,l=!1,(e.forEach(e=>{(0,rM.EG)(e)&&(i=!0),(0,rM.aj)(e)&&(l=!0),(0,rM.J1)(e)&&(r=!0)}),i&&("true"===n||"false"===n))?"true"===n:r&&/^\d+$/.test(n)?Number(n):l?n:void 0}).filter(e=>void 0!==e)),(0,lt.h)(e=>Array.isArray(e)),(0,r8.U)(e=>({type:"uploadProgress",patches:[p3(e,"after",[-1])]})))}},[s.field.schemaType.of]),I=(0,rF.useCallback)((e,t)=>m_(t,"text/*")?P:null,[P]),M=(0,rF.useCallback)(e=>{let{file:t,schemaType:n,uploader:i}=e,r=i.upload(m,t,n).pipe((0,r8.U)(e=>p6.from(e.patches||[])),(0,lr.b)(e=>v(e.patches)));f.current&&f.current.unsubscribe(),f.current=r.subscribe()},[m,v]),z=(0,rF.useMemo)(()=>({level:s.field.level,members:s.field.members,value:s.field.value,readOnly:s.field.readOnly,onSetCollapsed:b,schemaType:s.field.schemaType,changed:s.field.changed,id:s.field.id,elementProps:A,path:s.field.path,focusPath:s.field.focusPath,focused:s.field.focused,onChange:v,onInsert:S,onMoveItem:k,onItemRemove:E,onItemAppend:C,onItemPrepend:_,validation:s.field.validation,presence:s.field.presence,resolveUploader:I,onUpload:M,renderInput:c,renderItem:u,onIndexFocus:T,renderPreview:p}),[s.field.level,s.field.members,s.field.value,s.field.readOnly,s.field.schemaType,s.field.changed,s.field.id,s.field.path,s.field.focusPath,s.field.focused,s.field.validation,s.field.presence,b,A,v,S,k,E,C,_,I,M,c,u,T,p]),R=(0,rF.useMemo)(()=>c(z),[z,c]),F=(0,rF.useMemo)(()=>({name:s.name,index:s.index,level:s.field.level,value:s.field.value,title:s.field.schemaType.title,description:s.field.schemaType.description,collapsible:s.collapsible,collapsed:s.collapsed,onExpand:j,changed:s.field.changed,onCollapse:y,schemaType:s.field.schemaType,inputId:s.field.id,path:s.field.path,presence:s.field.presence,validation:s.field.validation,children:R,inputProps:z}),[s.name,s.index,s.field.level,s.field.value,s.field.schemaType,s.field.id,s.field.path,s.field.presence,s.field.validation,s.collapsible,s.collapsed,s.field.changed,j,y,R,z]);return(0,rz.jsx)(hu,{onFieldGroupSelect:o,onChange:v,onPathOpen:r,onSetFieldSetCollapsed:a,onSetPathCollapsed:l,onPathBlur:t,onPathFocus:n,children:(0,rF.useMemo)(()=>d(F),[F,d])})}function mF(e){return(0,rM.jB)(e.field.schemaType)&&e.field.schemaType.of.every(e=>(0,rM.m$)(e))}let mO=(0,rF.memo)(function(e){let{member:t,renderField:n,renderInput:i,renderItem:r,renderPreview:l}=e;return(0,rM.m$)(t.field.schemaType)?(0,rz.jsx)(mz,{member:t,renderField:n,renderInput:i,renderItem:r,renderPreview:l}):(0,rM.jB)(t.field.schemaType)&&t.field.schemaType.of.every(e=>(0,rM.jp)(e))?(0,rz.jsx)(mR,{member:t,renderField:n,renderInput:i,renderItem:r,renderPreview:l}):mF(t)?(0,rz.jsx)(mI,{member:t,renderField:n,renderInput:i,renderItem:r,renderPreview:l}):(0,rz.jsx)(mM,{member:t,renderField:n,renderInput:i})}),mD=!1,mZ=["yes","true","1"],mL=["false","no","false","0","null"],mq=mZ.concat(mL),mN={string:{number:{test:Number,convert:Number},boolean:{test:e=>mq.includes(e.toLowerCase()),convert:e=>mZ.includes(e.toLowerCase())||!mL.includes(e.toLowerCase())},richDate:{test:e=>(0,aa.Z)(e),convert:e=>({_type:"richDate",local:(function(e){let t=new Date(e.getTime()+6e4*e.getTimezoneOffset()),n=e.getTimezoneOffset()/60,i=e.getHours();return t.setHours(i-n),t})(new Date(e)).toJSON(),utc:new Date(e).toJSON(),timezone:function(){try{return Intl.DateTimeFormat().resolvedOptions().timeZone}catch(e){}return null}(),offset:new Date().getTimezoneOffset()})}},date:{richDate:{test:e=>"date"===(e&&e._type),convert:e=>Object.assign({},e,{_type:"richDate"})}},richDate:{datetime:{test:e=>e&&e.utc,convert:e=>e.utc}},number:{string:{test:()=>!0,convert:String},boolean:{test:()=>!0,convert:Number}},boolean:{string:{test:()=>!0,convert:e=>e?"Yes":"No"},number:{test:()=>!0,convert:Number}}};function mV(e){let{value:t,targetType:n,onChange:i}=e,r=(0,rF.useMemo)(()=>d6(d6({},t),{},{_type:n}),[n,t]),l=(0,rF.useCallback)(()=>i(p6.from(p2(n,["_type"])),r),[r,i,n]);return(0,rz.jsx)(rN.zx,{onClick:l,text:(0,rz.jsxs)(rz.Fragment,{children:["Convert to ",(0,rz.jsx)("code",{children:n})]})})}function mB(e){let{value:t,onChange:n,validTypes:i}=e,r=(0,rF.useMemo)(()=>d6(d6({},t),{},{_type:i[0]}),[i,t]),l=(0,rF.useCallback)(()=>n(p6.from(p5()),r),[r,n]);return(0,rz.jsx)(rN.zx,{onClick:l,tone:"critical",text:"Unset value"})}function mU(e){let{validTypes:t,value:n,onChange:i}=e,r=I3(),l=1===t.length,a=r.has(t[0]);return(0,rz.jsx)(p9,{status:"warning",title:(0,rz.jsxs)(rz.Fragment,{children:["Property value missing ",(0,rz.jsx)("code",{children:"_type"})]}),children:(0,rz.jsx)(fX,{open:mD,title:(0,rz.jsx)(rz.Fragment,{children:"Developer info"}),children:(0,rz.jsxs)(rN.Kq,{space:3,children:[(0,rz.jsxs)(rN.xv,{as:"p",muted:!0,size:1,children:["Encountered an object value without a ",(0,rz.jsx)("code",{children:"_type"})," property."]}),l&&!a&&(0,rz.jsxs)(rN.xv,{as:"p",muted:!0,size:1,children:["Either remove the ",(0,rz.jsx)("code",{children:"name"})," property of the object declaration, or set"," ",(0,rz.jsx)("code",{children:"_type"})," property on items."]}),!l&&(0,rz.jsx)(rN.xv,{as:"p",muted:!0,size:1,children:"The following types are valid here according to schema:"}),!l&&(0,rz.jsx)(rN.Kq,{as:"ul",space:2,children:t.map(e=>(0,rz.jsx)(rN.xv,{as:"li",muted:!0,size:1,children:(0,rz.jsx)("code",{children:e})},e))}),(0,rz.jsxs)(rN.Kq,{space:2,children:[(0,rz.jsxs)(rN.xv,{as:"h4",weight:"semibold",size:1,children:["Current value (",(0,rz.jsx)("code",{children:"object"}),"):"]}),(0,rz.jsx)(rN.Zb,{border:!0,overflow:"auto",padding:2,radius:2,tone:"inherit",children:(0,rz.jsx)(rN.EK,{language:"json",children:JSON.stringify(n,null,2)})})]}),(0,rz.jsxs)(rN.rj,{columns:[1,2,2],gap:1,children:[l&&(0,rz.jsx)(mV,{onChange:i,targetType:t[0],value:n}),(0,rz.jsx)(mB,{onChange:i,validTypes:t,value:n})]})]})})})}let mK=(0,rF.forwardRef)((e,t)=>{let{value:n,actualType:i,validTypes:r,onChange:l}=e;(0,rF.useImperativeHandle)(t,()=>({focus:()=>void 0}));let a=(0,rF.useCallback)(()=>{l(p6.from(p5()))},[l]),o=(0,rF.useCallback)(e=>{l(p6.from(p4(e)))},[l]),s=(0,rF.useMemo)(()=>i in mN?Object.keys(mN[i]).filter(e=>r.includes(e)).map(e=>d6({from:i,to:e},mN[i][e])).filter(e=>e.test(n)):[],[n,i,r]);if("object"==typeof n&&null!==n&&!("_type"in n))return(0,rz.jsx)(mU,{value:n,validTypes:r,onChange:l});let d=(0,rz.jsx)(rN.Kq,{padding:2,children:(0,rz.jsx)(rN.zx,{onClick:a,tone:"critical",text:"Reset value"})});return(0,rz.jsxs)(p9,{status:"error",suffix:d,title:(0,rz.jsx)(rz.Fragment,{children:"Invalid property value"}),children:[(0,rz.jsx)(rN.xv,{as:"p",muted:!0,size:1,children:"The property value is stored as a value type that does not match the expected type."}),(0,rz.jsx)(fX,{marginTop:4,open:mD,title:(0,rz.jsx)(rz.Fragment,{children:"Developer info"}),children:(0,rz.jsxs)(rN.Kq,{space:3,children:[1===r.length&&(0,rz.jsxs)(rN.xv,{as:"p",muted:!0,size:1,children:["The value of this property must be of type ",(0,rz.jsx)("code",{children:r[0]})," according to the schema."]}),1===r.length&&(0,rz.jsx)(rN.xv,{as:"p",muted:!0,size:1,children:"Mismatching value types typically occur when the schema has recently been changed."}),1!==r.length&&(0,rz.jsx)(rN.xv,{as:"p",muted:!0,size:1,children:"Only the following types are valid here according to schema:"}),1!==r.length&&(0,rz.jsx)(rN.Kq,{as:"ul",space:2,children:r.map(e=>(0,rz.jsx)(rN.xv,{as:"li",children:(0,rz.jsx)("code",{children:e})},e))}),(0,rz.jsxs)(rN.Kq,{marginTop:2,space:2,children:[(0,rz.jsxs)(rN.xv,{size:1,weight:"semibold",children:["The current value (",(0,rz.jsx)("code",{children:i}),")"]}),(0,rz.jsx)(rN.Zb,{border:!0,padding:2,radius:2,tone:"inherit",children:(0,rz.jsx)(rN.EK,{language:"json",size:1,children:JSON.stringify(n,null,2)})})]}),s.length>0&&(0,rz.jsx)(rN.Kq,{space:1,children:s.map(e=>(0,rz.jsx)(mH,{converter:e,onConvert:o,value:n},"".concat(e.from,"-").concat(e.to)))})]})})]})});function mH(e){let{converter:t,onConvert:n,value:i}=e,r=(0,rF.useCallback)(()=>n(t.convert(i)),[t,n,i]);return(0,rz.jsx)(rN.zx,{onClick:r,text:(0,rz.jsxs)(rz.Fragment,{children:["Convert to ",(0,rz.jsx)("code",{children:t.to})]})})}function m$(e){let{error:t,onChange:n}=e,i=(0,rF.useCallback)(()=>{n(p6.from((t.value||[]).map((e,t)=>p2((0,a3.E2)(),[t,"_key"]))))},[t.value,n]);return(0,rz.jsx)(fx,{title:t.schemaType.title,description:t.schemaType.description,children:(0,rz.jsxs)(p9,{status:"warning",suffix:(0,rz.jsx)(rN.Kq,{padding:2,children:(0,rz.jsx)(rN.zx,{onClick:i,text:"Add missing keys",tone:"caution"})}),title:(0,rz.jsx)(rz.Fragment,{children:"Missing keys"}),children:[(0,rz.jsx)(rN.xv,{as:"p",muted:!0,size:1,children:"Some items in the list are missing their keys. This must be fixed in order to edit the list."}),(0,rz.jsx)(fX,{marginTop:4,open:mD,title:(0,rz.jsx)(rz.Fragment,{children:"Developer info"}),children:(0,rz.jsxs)(rN.Kq,{space:3,children:[(0,rz.jsxs)(rN.xv,{as:"p",muted:!0,size:1,children:["This usually happens when items are created using an API client, and the"," ",(0,rz.jsx)("code",{children:"_key"})," property has not been included."]}),(0,rz.jsxs)(rN.xv,{as:"p",muted:!0,size:1,children:["The value of the ",(0,rz.jsx)("code",{children:"_key"})," property must be a unique string."]})]})})]})})}function mX(e){let{error:t,onChange:n}=e,i=(0,rF.useCallback)(()=>{n(p6.from((t.duplicates||[]).map(e=>{let[t,n]=e;return p4("".concat(n,"_deduped_").concat(t),[t,"_key"])})))},[t.duplicates,n]);return(0,rz.jsx)(fx,{title:t.schemaType.title,description:t.schemaType.description,children:(0,rz.jsxs)(p9,{status:"warning",suffix:(0,rz.jsx)(rN.Kq,{padding:2,children:(0,rz.jsx)(rN.zx,{onClick:i,text:"Generate unique keys",tone:"caution"})}),title:(0,rz.jsx)(rz.Fragment,{children:"Non-unique keys"}),children:[(0,rz.jsx)(rN.xv,{as:"p",muted:!0,size:1,children:"Several items in this list share the same identifier (key). Every item must have an unique identifier."}),(0,rz.jsx)(fX,{marginTop:4,open:mD,title:(0,rz.jsx)(rz.Fragment,{children:"Developer info"}),children:(0,rz.jsxs)(rN.Kq,{space:3,children:[(0,rz.jsxs)(rN.xv,{as:"p",muted:!0,size:1,children:["This usually happens when items are created using an API client, and the"," ",(0,rz.jsx)("code",{children:"_key"})," property of each elements has been generated non-uniquely."]}),(0,rz.jsxs)(rN.xv,{as:"p",muted:!0,size:1,children:["The value of the ",(0,rz.jsx)("code",{children:"_key"})," property must be a unique string."]})]})})]})})}function mW(e){let{error:t,onChange:n}=e,i=()=>{let e=(t.value||[]).flatMap((e,t)=>oR()(e)?[]:[t]).reverse(),i=e.map(e=>p5([e]));n(p6.from(i))};return(0,rz.jsx)(fx,{title:t.schemaType.title,description:t.schemaType.description,children:(0,rz.jsxs)(p9,{status:"error",suffix:(0,rz.jsx)(rN.Kq,{padding:2,children:(0,rz.jsx)(rN.zx,{onClick:i,text:"Remove non-object values",tone:"critical"})}),title:(0,rz.jsx)(rz.Fragment,{children:"Invalid list values"}),children:[(0,rz.jsx)(rN.xv,{as:"p",muted:!0,size:1,children:"Some items in this list are not objects. This must be fixed in order to edit the list."}),(0,rz.jsx)(fX,{marginTop:4,open:mD,title:(0,rz.jsx)(rz.Fragment,{children:"Developer info"}),children:(0,rz.jsx)(rN.Kq,{space:3,children:(0,rz.jsx)(rN.xv,{as:"p",muted:!0,size:1,children:"This usually happens when items are created using an API client, or when a custom input component has added invalid data to the list."})})})]})})}function mG(e){let{member:t}=e,{onChange:n}=hp(),i=(0,rF.useCallback)(e=>{n(p6.from(e).prefixAll(t.fieldName))},[n,t.fieldName]);return"INCOMPATIBLE_TYPE"===t.error.type?(0,rz.jsx)(mK,{value:t.error.value,onChange:i,actualType:t.error.resolvedValueType,validTypes:[t.error.expectedSchemaType.name]}):"MISSING_KEYS"===t.error.type?(0,rz.jsx)(m$,{error:t.error,onChange:i}):"DUPLICATE_KEYS"===t.error.type?(0,rz.jsx)(mX,{error:t.error,onChange:i}):"MIXED_ARRAY"===t.error.type?(0,rz.jsx)(mW,{onChange:i,error:t.error}):(0,rz.jsxs)(rN.xu,{children:["Unexpected error: ",e.member.error.type]})}mK.displayName="InvalidValueInput";let mY=(0,rF.memo)(function(e){var t;let{member:n,renderField:i,renderInput:r,renderItem:l,renderPreview:a}=e,{onSetFieldSetCollapsed:o}=hp(),s=(0,rF.useCallback)(()=>{o(n.fieldSet.path,!0)},[n.fieldSet.path,o]),d=(0,rF.useCallback)(()=>{o(n.fieldSet.path,!1)},[n.fieldSet.path,o]);return(0,rz.jsx)(fS,{title:n.fieldSet.title||oO()(n.fieldSet.name),description:n.fieldSet.description,level:n.fieldSet.level,collapsible:n.fieldSet.collapsible,collapsed:n.fieldSet.collapsed,onCollapse:s,onExpand:d,columns:null==(t=null==n?void 0:n.fieldSet)?void 0:t.columns,"data-testid":"fieldset-".concat(n.fieldSet.name),children:n.fieldSet.members.map(e=>"error"===e.kind?(0,rz.jsx)(mG,{member:e},n.key):(0,rz.jsx)(mO,{member:e,renderField:i,renderInput:r,renderItem:l,renderPreview:a},e.key))})});function mJ(e){let t=(0,rF.useRef)(),{member:n,renderItem:i,renderInput:r,renderField:l,renderPreview:a}=e,{onPathBlur:o,onPathFocus:s,onChange:d,onPathOpen:c,onSetPathCollapsed:u,onSetFieldSetCollapsed:p,onFieldGroupSelect:h}=hp(),f=zu();ht(n.item.focused,(e,n)=>{var i;!e&&n&&(null==(i=t.current)||i.focus())});let m=(0,rF.useCallback)(()=>{d(p6.from([p5([{_key:n.key}])]))},[n.key,d]),g=(0,rF.useCallback)(e=>{c(e),u(e,!1)},[c,u]),x=(0,rN.pm)(),v=(0,rF.useCallback)(e=>{if(0===e.items.length)throw Error("Insert event should include at least one item");let t=e.items.map(e=>ma(e));d(p6.from([p3(t,e.position,[{_key:n.key}])]));let i=t[0]._key,r=n.item.path.slice(0,-1),l=[...r,{_key:i}];s(l);let a=!1!==e.open;e.skipInitialValue?a&&g(l):mP(t,n.parentSchemaType,f).pipe((0,lr.b)(e=>{"patch"===e.type?d(p6.from(e.patches)):x.push({title:"Could not resolve initial value",description:"Unable to resolve initial value for type: ".concat(e.schemaType.title,": ").concat(e.error.message,"."),status:"error"})})).subscribe({complete:()=>{a&&g(l)}})},[g,n.item.path,n.key,n.parentSchemaType,d,s,f,x]),b=(0,rF.useCallback)(()=>{o(n.item.path)},[n.item.path,o]),y=(0,rF.useCallback)(()=>{s(n.item.path)},[n.item.path,s]),j=(0,rF.useCallback)(e=>{s(n.item.path.concat(e))},[n.item.path,s]),w=(0,rF.useCallback)(e=>{d(p6.from(e).prepend(p2(fJ(n.item.schemaType))).prefixAll({_key:n.key}))},[d,n.item.schemaType,n.key]),k=(0,rF.useCallback)(()=>{u(n.item.path,!0)},[u,n.item.path]),C=(0,rF.useCallback)(()=>{u(n.item.path,!1)},[u,n.item.path]),_=(0,rF.useCallback)(e=>{u(n.item.path.concat(e),!0)},[u,n.item.path]),S=(0,rF.useCallback)(e=>{u(n.item.path.concat(e),!1)},[u,n.item.path]),E=(0,rF.useCallback)(()=>{c(n.item.path)},[c,n.item.path]),T=(0,rF.useCallback)(e=>{c(n.item.path.concat(e))},[c,n.item.path]),A=(0,rF.useCallback)(e=>{p(n.item.path.concat(e),!1)},[p,n.item.path]),P=(0,rF.useCallback)(e=>{p(n.item.path.concat(e),!0)},[p,n.item.path]),I=(0,rF.useCallback)(()=>{c(n.item.path)},[c,n.item.path]),M=!n.item.value||mT(n.item.value),z=(0,rF.useCallback)(()=>{M&&m(),c(n.item.path.slice(0,-1)),s(n.item.path)},[M,c,n.item.path,s,m]),R=(0,rF.useCallback)(e=>{h(n.item.path,e)},[h,n.item.path]),F=(0,rF.useMemo)(()=>({onBlur:b,onFocus:y,id:n.item.id,ref:t}),[b,y,n.item.id]),O=(0,rF.useMemo)(()=>({changed:n.item.changed,focusPath:n.item.focusPath,focused:n.item.focused,groups:n.item.groups,id:n.item.id,level:n.item.level,members:n.item.members,onChange:w,onFieldClose:E,onFieldCollapse:_,onFieldSetCollapse:P,onFieldExpand:S,onFieldSetExpand:A,onFieldGroupSelect:R,onPathFocus:j,onFieldOpen:T,path:n.item.path,presence:n.item.presence,readOnly:n.item.readOnly,renderField:l,renderInput:r,renderItem:i,renderPreview:a,schemaType:n.item.schemaType,validation:n.item.validation,value:n.item.value,elementProps:F}),[F,w,E,_,P,S,A,j,T,R,n.item.changed,n.item.focusPath,n.item.focused,n.item.groups,n.item.id,n.item.level,n.item.members,n.item.path,n.item.presence,n.item.readOnly,n.item.schemaType,n.item.validation,n.item.value,l,r,i,a]),D=(0,rF.useMemo)(()=>r(O),[O,r]),Z=(0,rF.useMemo)(()=>({key:n.key,index:n.index,level:n.item.level,value:n.item.value,title:n.item.schemaType.title,description:n.item.schemaType.description,collapsible:n.collapsible,collapsed:n.collapsed,schemaType:n.item.schemaType,parentSchemaType:n.parentSchemaType,onInsert:v,onRemove:m,presence:n.item.presence,validation:n.item.validation,open:n.open,onOpen:I,onClose:z,onExpand:C,onCollapse:k,readOnly:n.item.readOnly,focused:n.item.focused,onFocus:y,onBlur:b,inputId:n.item.id,path:n.item.path,children:D,changed:n.item.changed,inputProps:O}),[n.key,n.index,n.item.level,n.item.value,n.item.schemaType,n.parentSchemaType,n.item.presence,n.item.validation,n.item.readOnly,n.item.focused,n.item.id,n.item.path,n.item.changed,n.collapsible,n.collapsed,n.open,v,m,I,z,C,k,y,b,D,O]);return(0,rz.jsx)(hu,{onFieldGroupSelect:h,onChange:w,onPathOpen:c,onSetFieldSetCollapsed:p,onSetPathCollapsed:u,onPathBlur:o,onPathFocus:s,children:(0,rF.useMemo)(()=>i(Z),[Z,i])})}function mQ(e){switch(e.jsonType){case"string":return"";case"number":return -0;case"boolean":return!1;default:throw Error('Unable to create value from type "'.concat(e.jsonType,'"'))}}function m0(e){let t=(0,rF.useRef)(),{member:n,renderItem:i,renderInput:r}=e,{onPathBlur:l,onPathFocus:a,onChange:o}=hp();ht(n.item.focused,(e,n)=>{var i;!e&&n&&(null==(i=t.current)||i.focus())});let s=(0,rF.useCallback)(e=>{l(n.item.path)},[n.item.path,l]),d=(0,rF.useCallback)(e=>{a(n.item.path)},[n.item.path,a]),c=(0,rF.useCallback)(e=>{o(p6.from(e).prefixAll(n.index))},[o,n.index]),u=(0,rF.useCallback)(e=>{let t=e.currentTarget.value;if((0,rM.J1)(n.item.schemaType)){if((t=e.currentTarget.valueAsNumber)>Number.MAX_SAFE_INTEGER||t<Number.MIN_SAFE_INTEGER)return}else(0,rM.EG)(n.item.schemaType)&&(t=e.currentTarget.checked);let i=""===t||"number"==typeof t&&isNaN(t);c(p4(i?mQ(n.item.schemaType):t))},[c,n.item.schemaType]),p=(0,rF.useMemo)(()=>({onBlur:s,onFocus:d,id:n.item.id,ref:t,onChange:u,value:String(Object.is(n.item.value,-0)?"":n.item.value),readOnly:Boolean(n.item.readOnly),placeholder:n.item.schemaType.placeholder}),[s,d,u,n.item.id,n.item.readOnly,n.item.schemaType.placeholder,n.item.value]),h=(0,rF.useMemo)(()=>({changed:n.item.changed,level:n.item.level,value:n.item.value,readOnly:n.item.readOnly,schemaType:n.item.schemaType,id:n.item.id,path:n.item.path,focused:n.item.focused,onChange:c,validation:n.item.validation,presence:n.item.presence,elementProps:p}),[n.item.changed,n.item.level,n.item.value,n.item.readOnly,n.item.schemaType,n.item.id,n.item.path,n.item.focused,n.item.validation,n.item.presence,c,p]),f=(0,rF.useMemo)(()=>r(h),[h,r]),m=(0,rF.useCallback)(()=>{o(p6.from([p5([n.index])]))},[n.index,o]),g=(0,rF.useCallback)(e=>{o(p6.from([p3(e.items,e.position,[n.index])]))},[n.index,o]),x=(0,rF.useMemo)(()=>({key:n.key,index:n.index,level:n.item.level,value:n.item.value,title:n.item.schemaType.title,description:n.item.schemaType.description,schemaType:n.item.schemaType,parentSchemaType:n.parentSchemaType,onInsert:g,onRemove:m,presence:n.item.presence,validation:n.item.validation,readOnly:n.item.readOnly,focused:n.item.focused,onFocus:d,onBlur:s,inputId:n.item.id,path:n.item.path,children:f}),[n.key,n.index,n.item.level,n.item.value,n.item.schemaType,n.item.presence,n.item.validation,n.item.readOnly,n.item.focused,n.item.id,n.item.path,n.parentSchemaType,g,m,d,s,f]);return(0,rz.jsx)(rz.Fragment,{children:(0,rF.useMemo)(()=>i(x),[x,i])})}let m1=(0,lO.ZP)(rN.Zb)(J||(J=d4(["\n  max-width: ","px;\n"])),e=>{let{theme:t}=e;return t.sanity.container[1]});function m2(e){let{value:t,onFocus:n,vertical:i}=e,r=d3(e,sF),[l,a]=rF.useState(!1),[o,s]=rF.useState(null);(0,rN.O8)(()=>a(!1),[o]);let d=rF.useCallback(e=>{("Escape"===e.key||"Tab"===e.key)&&a(!1)},[]),c=(0,rF.useCallback)(()=>{a(e=>!e)},[]),u=(0,a3.wq)(t);return(0,rz.jsx)(rN.J2,{open:l,ref:s,onKeyDown:d,portal:!0,constrainSize:!0,tone:"default",content:(0,rz.jsx)(m1,{margin:1,padding:3,onKeyDown:d,tabIndex:0,overflow:"auto",children:(0,rz.jsxs)(rN.Kq,{space:4,children:[(0,rz.jsxs)(rN.xv,{weight:"semibold",children:["Item of type ",(0,rz.jsx)("code",{children:u})," not valid for this list"]}),(0,rz.jsx)(rN.xv,{size:1,weight:"semibold",children:"Why is this happening?"}),(0,rz.jsxs)(rN.xv,{size:1,children:["The current schema does not declare items of type ",(0,rz.jsx)("code",{children:u})," as valid for this list. This could mean that the type has been removed as a valid item type, or that someone else has added it to their own local schema that is not yet deployed."]}),(0,rz.jsx)(rN.xu,{children:(0,rz.jsxs)(rN.xv,{size:1,children:[(0,rz.jsx)(lL.sLo,{})," You can still move or delete this item, but it cannot be edited since the schema definition for its type is nowhere to be found."]})}),(0,rz.jsxs)(rN.Kq,{space:2,children:[(0,rz.jsx)(rN.xv,{size:1,weight:"semibold",children:"JSON representation of this item:"}),(0,rz.jsx)(rN.Zb,{padding:2,overflow:"auto",border:!0,children:(0,rz.jsx)(rN.EK,{size:1,as:"pre",language:"json",children:JSON.stringify(t,null,2)})})]})]})}),children:(0,rz.jsx)(rN.Zb,d6(d6({as:"button",type:"button",radius:2,tone:"inherit",paddingX:2,paddingY:3,flex:1,onFocus:n,onClick:c,onKeyDown:d,__unstable_focusRing:!0},r),{},{children:(0,rz.jsxs)(rN.kC,{align:"center",children:[(0,rz.jsx)(rN.xu,{marginRight:3,children:(0,rz.jsx)(rN.xv,{children:(0,rz.jsx)(lL.Tzq,{})})}),(0,rz.jsx)(rN.xu,{flex:1,children:(0,rz.jsxs)(rN.xv,{size:1,textOverflow:"ellipsis",children:["Item of type ",(0,rz.jsx)("code",{children:u})," not valid for this list"]})})]})}))})}function m3(e){let{member:t}=e;return"INVALID_ITEM_TYPE"===t.error.type?(0,rz.jsx)(m2,{value:t.error.value}):(0,rz.jsxs)("div",{children:["Unexpected Error: ",t.error.type]})}function m4(e){let{member:t,renderInput:n,renderField:i,renderItem:r,renderPreview:l}=e;return"field"===t.kind?(0,rz.jsx)(mO,{member:t,renderInput:n,renderField:i,renderItem:r,renderPreview:l},t.key):"error"===t.kind?(0,rz.jsx)(mG,{member:t},t.key):"fieldSet"===t.kind?(0,rz.jsx)(mY,{member:t,renderInput:n,renderField:i,renderItem:r,renderPreview:l},t.key):(console.warn(Error("Unhandled member kind ".concat(t.kind))),null)}function m5(e){let{members:t}=e,n=d3(e,sO);return(0,rz.jsx)(rz.Fragment,{children:t.map(e=>(0,rz.jsx)(m4,d6({member:e},n),e.key))})}let m6=e=>{let{children:t}=e;return t},m8=(0,rF.memo)(function(e){let t=(0,rF.useMemo)(()=>"absolutePath"in e?e.absolutePath:e.path.concat(e.relativePath),[e]);return(0,rz.jsx)(m7,d6(d6({},e),{},{absolutePath:t,destinationRenderField:e.renderField,destinationRenderInput:e.renderInput,destinationRenderItem:e.renderItem,destinationRenderPreview:e.renderPreview}))}),m7=(0,rF.memo)(function e(t){let{absolutePath:n,destinationRenderInput:i,destinationRenderItem:r,destinationRenderField:l,destinationRenderPreview:a}=t,o=(0,rF.useCallback)(t=>{let o=(0,rR.Xy)(t.path,n)||(0,rR.Ny)(n,t.path);if(o)return i(t);if(!mr(t)&&!ml(t))throw Error("Expected either object input props or array input props for: ".concat(JSON.stringify(t.path)));return(0,rz.jsx)(e,d6(d6({},t),{},{absolutePath:n,destinationRenderInput:i,destinationRenderItem:r,destinationRenderField:l,destinationRenderPreview:a}))},[n,l,i,r,a]),s=(0,rF.useCallback)(e=>{let i=(0,rR.Ny)(n,e.path)&&(t.includeField||!(0,rR.Xy)(n,e.path));return i?l(e):m6(e)},[n,l,t.includeField]),d=(0,rF.useCallback)(e=>{let i=(0,rR.Ny)(n,e.path)&&(t.includeItem||!(0,rR.Xy)(n,e.path));return i?r(e):m6(e)},[n,r,t.includeItem]);if(ml(t)){let c=(0,rR.fi)(t.path,n),u=t.members.find(e=>"item"==e.kind&&(0,rM.Fd)(c[0])&&e.key===c[0]._key);if(!u){let p=(0,rR.fi)(t.path,n),h=p[0]._key;return(0,rz.jsxs)("div",{children:["No array item with _key ",(0,rz.jsxs)("code",{children:['"',h,'"']})," found at path ",JSON.stringify(t.path)]})}return"error"===u.kind?(0,rz.jsx)(m3,{member:u}):(0,rz.jsx)(mJ,{member:u,renderInput:o,renderField:s,renderItem:d,renderPreview:a})}if(mr(t)){let f=(0,rR.fi)(t.path,n),m=t.members.find(e=>"field"==e.kind&&f[0]===e.name);if(!m){let g=f[0];return(0,rz.jsxs)("div",{children:["Field ",JSON.stringify(g)," not found among members – please verify that it's both defined in the schema and that it has not been conditionally hidden."]})}return(0,rz.jsx)(mO,{member:m,renderInput:o,renderField:s,renderItem:d,renderPreview:a})}throw Error("FormInput can only be used with arrays or objects")}),m9=[0,0,1,0];function ge(e){let{type:t,id:n,width:i,onClose:r,children:l,legacy_referenceElement:a,header:o}=e,s=(0,rz.jsx)(fo,{margins:m9,children:(0,rz.jsx)(rN.xu,{padding:4,children:l})});return"dialog"===t?(0,rz.jsx)(rN.mh,{children:(0,rz.jsx)(rN.Vq,{width:i,id:n||"",onClose:r,header:o,children:s})}):(0,rz.jsx)(RO,{width:i,onClose:r,referenceElement:a,header:o,children:s})}let gt={portal:!0,tone:"default"},gn={position:"absolute",top:0,left:0,bottom:0,right:0,opacity:.6},gi={position:"relative"};function gr(e){var t,n,i,r,l,a;let{schemaType:o,parentSchemaType:s,path:d,readOnly:c,onRemove:u,value:p,open:h,onInsert:f,onFocus:m,onOpen:g,onClose:x,changed:v,focused:b,children:y,inputProps:{renderPreview:j}}=e,w=(null==(t=s.options)?void 0:t.sortable)!==!1,k=s.of,C=(0,rF.useRef)(null);hE(C,h),ht(b,(e,t)=>{var n;!e&&t&&C.current&&(null==(n=C.current)||n.focus())});let _=p._resolvingInitialValue,S=(0,rF.useCallback)(()=>{f({items:[d6(d6({},p),{},{_key:hA()})],position:"after"})},[f,p]),E=(0,rF.useCallback)((e,t)=>{f({items:[fQ(t)],position:e})},[f]),T=hm(d,!0),A=(0,rF.useMemo)(()=>0===T.length?null:(0,rz.jsx)(hK,{presence:T,maxAvatars:1}),[T]),P=hv(d,!0),I=(0,rF.useMemo)(()=>0===P.length?null:(0,rz.jsx)(rN.xu,{marginLeft:1,paddingX:1,paddingY:3,children:(0,rz.jsx)(fu,{validation:P,__unstable_showSummary:!0})}),[P]),M=P.some(e=>"error"===e.level),z=P.some(e=>"warning"===e.level),R=(0,rF.useMemo)(()=>c?null:(0,rz.jsx)(rN.j2,{button:(0,rz.jsx)(rN.zx,{padding:2,mode:"bleed",icon:lL.zGg}),id:"".concat(e.inputId,"-menuButton"),menu:(0,rz.jsxs)(rN.v2,{children:[(0,rz.jsx)(rN.sN,{text:"Remove",tone:"critical",icon:lL.XHJ,onClick:u}),(0,rz.jsx)(rN.sN,{text:"Duplicate",icon:lL.TIy,onClick:S}),(0,rz.jsx)(f1,{types:k,onInsert:E})]}),popover:gt}),[S,E,u,k,e.inputId,c]),F=function(e){let{readOnly:t,hasErrors:n,hasWarnings:i}=e;return t?"transparent":n?"critical":i?"caution":"default"}({readOnly:c,hasErrors:M,hasWarnings:z}),O=(0,rz.jsx)(fB,{menu:R,presence:A,validation:I,tone:F,focused:b,dragHandle:w,selected:h,children:(0,rz.jsxs)(rN.Zb,{as:"button",type:"button",tone:"inherit",radius:2,disabled:_,padding:1,onClick:g,ref:C,onFocus:m,__unstable_focusRing:!0,style:gi,children:[j({schemaType:e.schemaType,value:e.value,layout:"default"}),_&&(0,rz.jsx)(rN.Zb,{style:gn,tone:"transparent",radius:2,as:rN.kC,justify:"center",children:(0,rz.jsxs)(rN.kC,{align:"center",justify:"center",padding:3,children:[(0,rz.jsx)(rN.xu,{marginX:3,children:(0,rz.jsx)(rN.$j,{muted:!0})}),(0,rz.jsx)(rN.xv,{size:1,muted:!0,children:"Resolving initial value…"})]})})]})}),D=u$(o);return(0,rz.jsxs)(rz.Fragment,{children:[(0,rz.jsx)(cH,{path:d,isChanged:v,hasFocus:Boolean(b),children:(0,rz.jsx)(rN.xu,{paddingX:1,children:O})}),h&&(0,rz.jsx)(ge,{header:c?"View ".concat(D):"Edit ".concat(D),type:(null==(i=null==(n=null==s?void 0:s.options)?void 0:n.modal)?void 0:i.type)||"dialog",width:null!=(a=null==(l=null==(r=null==s?void 0:s.options)?void 0:r.modal)?void 0:l.width)?a:1,id:p._key,onClose:x,legacy_referenceElement:C.current,children:y})]})}function gl(e){var t;return(null==(t=e.components)?void 0:t.item)?e.components.item:(0,rM.dD)(e)?mi:gr}let ga={portal:!0,tone:"default"};function go(e){var t,n,i,r,l,a,o,s,d;let c=(0,rF.useRef)(null),{schemaType:u,path:p,open:h,inputId:f,children:m,inputProps:g}=e,{readOnly:x,focused:v,renderPreview:b,onChange:y}=e.inputProps,j=(0,rF.useCallback)(()=>g.onChange(p5()),[g]),w=e.value,{EditReferenceLink:k,getReferenceInfo:C,selectedState:_,isCurrentDocumentLiveEdit:S}=jl({path:p,schemaType:u,value:w});hE(c,h),ht(v,(e,t)=>{var n;!e&&t&&c.current&&(null==(n=c.current)||n.focus())});let E=e.validation.some(e=>"error"===e.level),T=e.validation.some(e=>"warning"===e.level),A=f5(null==w?void 0:w._ref,C),P=(null==(t=A.result)?void 0:t.type)||(null==(n=null==w?void 0:w._strengthenOnPublish)?void 0:n.type),I=P?u.to.find(e=>e.name===P):void 0,M="pressed"===_,z="selected"===_,R=null==w?void 0:w._ref,F=R&&(null==(l=null==(r=null==(i=A.result)?void 0:i.preview)?void 0:r.published)?void 0:l._id),O=(0,rF.useCallback)(()=>{y([!0===u.weak?p4(!0,["_weak"]):p5(["_weak"]),p5(["_strengthenOnPublish"])])},[y,u.weak]),D=(0,rF.useCallback)(()=>{y(!0===u.weak?p4(!0,["_weak"]):p5(["_weak"]))},[y,u]),Z=(null==w?void 0:w._weak)?"weak":"strong",L=!0===u.weak?"weak":"strong",q=R&&!A.isLoading&&(null==w?void 0:w._strengthenOnPublish),N=!A.isLoading&&R&&Z!==L&&!q,V=function(e){let{readOnly:t,hasErrors:n,hasWarnings:i}=e;return t?"transparent":n?"critical":i?"caution":"default"}({readOnly:x,hasErrors:E,hasWarnings:T}),B=!(null==w?void 0:w._ref)||"_ref"===g.focusPath[0],U=(null==(a=A.result)?void 0:a.preview.draft)||(null==(o=A.result)?void 0:o.preview.published),K=(0,rz.jsxs)(rz.Fragment,{children:[S&&F&&w._strengthenOnPublish&&(0,rz.jsx)(fY,{padding:1,title:u.weak?"Finalize reference":"Convert to strong reference",status:"info","data-testid":"alert-reference-published",children:(0,rz.jsxs)(rN.Kq,{space:3,children:[(0,rz.jsxs)(rN.xv,{as:"p",muted:!0,size:1,children:[(0,rz.jsx)("strong",{children:null==(d=null==(s=A.result)?void 0:s.preview.published)?void 0:d.title})," is published and this reference should now be"," ",u.weak?(0,rz.jsx)(rz.Fragment,{children:"finalized"}):(0,rz.jsx)(rz.Fragment,{children:"converted to a strong reference"}),"."]}),(0,rz.jsx)(rN.zx,{onClick:O,text:(0,rz.jsx)(rz.Fragment,{children:"Convert to strong reference"}),tone:"positive"})]})}),N&&(0,rz.jsx)(fY,{padding:1,title:"Reference strength mismatch",status:"warning","data-testid":"alert-reference-strength-mismatch",children:(0,rz.jsxs)(rN.Kq,{space:3,children:[(0,rz.jsxs)(rN.xv,{as:"p",muted:!0,size:1,children:["This reference is ",(0,rz.jsx)("em",{children:Z}),", but according to the current schema it should be"," ",(0,rz.jsxs)("em",{children:[L,"."]})]}),(0,rz.jsx)(rN.xv,{as:"p",muted:!0,size:1,children:u.weak?(0,rz.jsxs)(rz.Fragment,{children:['It will not be possible to delete the "',null==U?void 0:U.title,'"-document without first removing this reference.']}):(0,rz.jsxs)(rz.Fragment,{children:['This makes it possible to delete the "',null==U?void 0:U.title,'"-document without first deleting this reference, leaving this field referencing a nonexisting document.']})}),(0,rz.jsx)(rN.zx,{onClick:D,text:(0,rz.jsxs)(rz.Fragment,{children:["Convert to ",L," reference"]}),tone:"caution"})]})}),A.error&&(0,rz.jsx)(fY,{padding:1,title:"Unable to load reference metadata",status:"warning","data-testid":"alert-reference-info-failed",children:(0,rz.jsxs)(rN.Kq,{space:3,children:[(0,rz.jsxs)(rN.xv,{as:"p",muted:!0,size:1,children:["Error: ",A.error.message]}),(0,rz.jsx)(rN.zx,{onClick:A.retry,text:(0,rz.jsx)(rz.Fragment,{children:"Retry"}),tone:"primary"})]})})]}),H=(0,rF.useMemo)(()=>x?null:(0,rz.jsx)(rN.xu,{marginLeft:1,children:(0,rz.jsx)(rN.j2,{button:(0,rz.jsx)(rN.zx,{paddingY:3,paddingX:2,mode:"bleed",icon:lL.zGg}),id:"".concat(f,"-menuButton"),menu:(0,rz.jsxs)(rN.v2,{children:[!x&&(0,rz.jsxs)(rz.Fragment,{children:[(0,rz.jsx)(rN.sN,{text:"Clear",tone:"critical",icon:lL.XHJ,onClick:j}),(0,rz.jsx)(rN.sN,{text:(null==w?void 0:w._ref)&&B?"Cancel replace":"Replace",icon:(null==w?void 0:w._ref)&&B?lL.Two:lL.bnu,onClick:(null==w?void 0:w._ref)&&B?()=>g.onPathFocus([]):()=>g.onPathFocus(["_ref"])})]}),!x&&!B&&w._ref&&(0,rz.jsx)(rN.R,{}),!B&&w._ref&&(0,rz.jsx)(rN.sN,{as:k,"data-as":"a",text:"Open in new tab",icon:lL.buG})]}),popover:ga})}),[x,f,j,null==w?void 0:w._ref,B,k,g]);return(0,rz.jsx)(fx,{level:e.level,title:e.title,description:e.description,validation:e.validation,__unstable_presence:e.presence,children:B?(0,rz.jsx)(rN.xu,{paddingY:2,children:m}):(0,rz.jsx)(rN.Zb,{shadow:1,radius:1,padding:1,tone:V,children:(0,rz.jsxs)(rN.Kq,{space:1,children:[(0,rz.jsxs)(rN.kC,{gap:1,align:"center",children:[(0,rz.jsx)(mn,{flex:1,forwardedAs:k,tone:"inherit",radius:2,"data-as":"a",documentId:null==w?void 0:w._ref,documentType:null==I?void 0:I.name,paddingX:2,paddingY:1,__unstable_focusRing:!0,style:{position:"relative"},selected:z,pressed:M,"data-selected":!!z||void 0,"data-pressed":!!M||void 0,children:(0,rz.jsx)(f9,{value:w,referenceInfo:A,renderPreview:b,type:u})}),(0,rz.jsx)(rN.xu,{children:H})]}),K]})})})}function gs(e,t){return oC()(e.options,t)}let gd=["array","file","image","reference","slug"],gc=["asset","crop","hotspot","_ref","_weak"],gu=["tags"],gp=["slug"];function gh(e,t){if(!e||t.has(e))return[];t.add(e);let n=e.type?gh(e.type,t):[];return[e,...n]}function gf(e){let{children:t}=e;return(0,rz.jsx)(rz.Fragment,{children:t})}function gm(e){return(0,rz.jsx)(fx,{"data-testid":"field-".concat(e.inputId),level:e.level,title:e.title,description:e.description,validation:e.validation,__unstable_presence:e.presence,children:(0,rz.jsx)(cH,{path:e.path,hasFocus:Boolean(e.inputProps.focused),isChanged:e.inputProps.changed,children:e.children})})}function gg(e){return(0,rz.jsx)(fS,{"data-testid":"field-".concat(e.inputId),level:e.level,title:e.title,description:e.description,collapsed:e.collapsed,collapsible:e.collapsible,onCollapse:e.onCollapse,onExpand:e.onExpand,validation:e.validation,__unstable_presence:e.presence,children:e.children})}function gx(e){let t=e.inputProps.members.find(e=>"field"===e.kind&&"hotspot"===e.name),n=(null==t?void 0:t.open)?e.presence:e.presence.concat((null==t?void 0:t.field.presence)||[]);return(0,rz.jsx)(fS,{level:e.level,title:e.title,description:e.description,collapsed:e.collapsed,collapsible:e.collapsible,onCollapse:e.onCollapse,onExpand:e.onExpand,validation:e.validation,__unstable_presence:n,children:e.children})}function gv(e){var t;if(null==(t=e.components)?void 0:t.field)return e.components.field;if((0,rM.EG)(e))return gf;let n=gh(e,new Set);return n.some(e=>"image"===e.name||"file"===e.name)?gx:n.some(e=>(0,rM.dD)(e))?go:"object"!==e.jsonType&&"array"!==e.jsonType?gm:gg}let gb=/^\d+$/;function gy(e){return e.split(/[[.\]]/g).filter(Boolean).map(e=>e.includes("==")?function(e){let[t,n]=e.split("==");return{[t]:n.replace(/^['"]/,"").replace(/['"]$/,"")}}(e):gb.test(e)?Number(e):e)}function gj(e){let{reference:t,children:n,observeAsset:i,waitPlaceholder:r}=e,l=null==t?void 0:t._ref,a=(0,rV.m2)(()=>i(l),[l]);return(0,rz.jsx)(rz.Fragment,{children:l&&a?n(a):r})}function gw(e){return null===e?[]:[e]}function gk(e){return Promise.all(e.map(e=>{if("file"===e.kind&&e.webkitGetAsEntry){let t;try{t=e.webkitGetAsEntry()}catch(n){return gw(e.getAsFile())}return t?t.isDirectory?function e(t){if(t.isFile)return new Promise((e,n)=>t.file(e,n)).then(e=>[e]);if(t.isDirectory){let n=t.createReader();return new Promise((e,t)=>n.readEntries(e,t)).then(e=>e.filter(e=>!e.name.startsWith("."))).then(t=>Promise.all(t.map(e)).then(aH()))}return Promise.resolve([])}(t):gw(e.getAsFile()):[]}if("file"===e.kind){let i=e.getAsFile();return Promise.resolve(i?[i]:[])}return"string"===e.kind?(console.warn('DataTransfer with kind="string" is currently not supported'),Promise.resolve([])):(console.warn("Unknown DataTransferItem.kind: %s",e.kind),Promise.resolve([]))}))}let gC={opacity:0,position:"absolute"};function g_(e){return rF.forwardRef(function(t,n){let{onFiles:i,onFilesOver:r,onFilesOut:l,disabled:a}=t,o=d3(t,sD),[s,d]=rF.useState(!1),c=rF.useRef(null),u=(0,rN.ts)(n),p=rF.useRef([]),h=(0,rF.useCallback)(e=>{null==i||i(e)},[i]),f=(0,rF.useCallback)(e=>{e.target===u.current&&(e.ctrlKey||e.metaKey)&&"v"===e.key&&d(!0)},[u]),m=(0,rF.useCallback)(e=>{var t;((t=e.clipboardData).files&&t.files.length>0?Promise.resolve(Array.from(t.files||[])):gk(Array.from(t.items||[])).then(aH())).then(e=>c.current?e.length>0?e:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"image/jpeg";return e.isContentEditable?new Promise(e=>setTimeout(e,10)).then(()=>Array.from(e.querySelectorAll("img"))).then(t=>(e.innerHTML="",t)).then(e=>Promise.all(e.map(e=>(function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"image/jpeg",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;return e.match(/^webkit-fake-url:\/\//)?Promise.reject(Error("Cannot read image contents from webkit fake url")):new Promise((i,r)=>{let l=new Image;l.crossOrigin="anonymous",l.referrerPolicy="strict-origin-when-cross-origin",l.onload=()=>{let e=document.createElement("canvas");e.width=l.width,e.height=l.height;let a=e.getContext("2d");null==a||a.drawImage(l,0,0,e.width,e.height);try{e.toBlob(i,t,n)}catch(o){r(o)}},l.src=e})})(e.src)))).then(e=>e.map(e=>new File([e],"pasted-image.jpg",{type:t}))):Promise.reject(Error('Expected element to be contentEditable="true". Instead found a non contenteditable '.concat(e.tagName)))}(c.current,"image/jpeg"):[]).then(e=>{var t;h(e),d(!1),null==(t=u.current)||t.focus()})},[h,u]),g=(0,rF.useCallback)(e=>{p.current=[],e.preventDefault(),e.stopPropagation();let t=e.nativeEvent.dataTransfer;i&&t&&(function(e){let t=Array.from(e.files||[]),n=Array.from(e.items||[]);return t&&t.length>0?Promise.resolve(t):gk(n).then(aH())})(t).then(e=>{e&&h(e)}),null==l||l()},[h,i,l]),x=(0,rF.useCallback)(e=>{i&&(e.preventDefault(),e.stopPropagation())},[i]),v=(0,rF.useCallback)(e=>{if(e.stopPropagation(),r&&u.current===e.currentTarget){p.current=[...new Set(p.current),e.currentTarget];let t=Array.from(e.dataTransfer.items).map(e=>({type:e.type,kind:e.kind}));r(t)}},[r,u]),b=(0,rF.useCallback)(e=>{e.stopPropagation();let t=p.current.indexOf(e.currentTarget);t>-1&&p.current.splice(t,1),0===p.current.length&&(null==l||l())},[l]),y=rF.useRef(!1);return rF.useEffect(()=>{var e;!y.current&&s&&c.current?(c.current.focus(),function(e){let t=document.createRange();t.selectNodeContents(e);let n=window.getSelection();null==n||n.removeAllRanges(),null==n||n.addRange(t)}(c.current)):y.current&&!s&&(null==(e=c.current)||e.focus()),y.current=s},[s]),(0,rz.jsxs)(rz.Fragment,{children:[(0,rz.jsx)(e,d6(d6({},o),{},{ref:u,onKeyDown:a?void 0:f,onDragOver:a?void 0:x,onDragEnter:a?void 0:v,onDragLeave:a?void 0:b,onDrop:a?void 0:g})),!a&&s&&(0,rz.jsx)("div",{contentEditable:!0,onPaste:m,ref:c,style:gC})]})})}function gS(e){return"inset 0 0 0 ".concat(e.width,"px ").concat(e.color)}function gE(e){let{base:t,border:n,focusRing:i}=e,r=i.offset+i.width,l=0-i.offset,a=t?t.bg:"var(--card-bg-color)";return[l>0&&"inset 0 0 0 ".concat(l,"px var(--card-focus-ring-color)"),n&&gS(n),l<0&&"0 0 0 ".concat(0-l,"px ").concat(a),r>0&&"0 0 0 ".concat(r,"px var(--card-focus-ring-color)")].filter(Boolean).join(",")}function gT(e){return(0,lO.ZP)(e)(e=>{let t={width:e.$border?1:0,color:"var(--card-border-color)"};return(0,lO.iv)(Q||(Q=d4(["\n        --card-focus-box-shadow: ",";\n\n        border-radius: ",";\n        outline: none;\n        box-shadow: var(--card-focus-box-shadow);\n\n        &:focus {\n          --card-focus-box-shadow: ",";\n        }\n      "])),gS(t),(0,rN.hO)(e.theme.sanity.radius[1]),gE({base:e.theme.sanity.color.base,border:t,focusRing:e.theme.sanity.focusRing}))})}let gA=g_(gT(rN.Zb)),gP=(0,lO.ZP)(rN.Zb)(ee||(ee=d4(["\n  min-height: 82px;\n  box-sizing: border-box;\n"]))),gI=(0,lO.ZP)(rN.kC)(et||(et=d4(["\n  text-overflow: ellipsis;\n  overflow: hidden;\n"]))),gM=(0,lO.ZP)(rN.Kq)(en||(en=d4(["\n  position: relative;\n  width: 60%;\n"]))),gz=(0,lO.ZP)(rN.EK)(ei||(ei=d4(["\n  position: relative;\n  width: 100%;\n\n  code {\n    overflow: hidden;\n    text-overflow: ellipsis;\n    position: relative;\n    max-width: 200px;\n  }\n"]))),gR=e=>new Date().getTime()-new Date(e).getTime();function gF(e){let{uploadState:t,onCancel:n,onStale:i,height:r}=e,l=t.file.name;return(0,rF.useEffect)(()=>{gR(t.updatedAt)>12e4&&(null==i||i())},[t.updatedAt,i]),(0,rz.jsx)(gP,{tone:"primary",padding:4,border:!0,style:{height:"".concat(r,"px")},children:(0,rz.jsxs)(gI,{align:"center",justify:"space-between",height:"fill",direction:"row",gap:2,children:[(0,rz.jsxs)(gM,{children:[(0,rz.jsx)(rN.kC,{justify:"center",gap:[3,3,2,2],direction:["column","column","row"],children:(0,rz.jsx)(rN.xv,{size:1,children:(0,rz.jsxs)(rN.gF,{space:2,children:["Uploading",(0,rz.jsx)(gz,{size:1,children:l||"..."})]})})}),(0,rz.jsx)(rN.Zb,{marginTop:3,radius:5,shadow:1,children:(0,rz.jsx)(R8,{value:t.progress})})]}),n?(0,rz.jsx)(rN.zx,{fontSize:2,text:"Cancel upload",mode:"ghost",tone:"critical",onClick:n}):null]})})}function gO(e,t){var n;let i=e.split(","),r=null==(n=i[0].match(/:(.*?);/))?void 0:n[1],l=atob(i[1]),a=l.length,o=new Uint8Array(a);for(;a--;)o[a]=l.charCodeAt(a);return new File([o],t,{type:r})}function gD(e){var t,n;let{assetFromSource:i,onChange:r,type:l,resolveUploader:a,uploadWith:o,isImage:s}=e;if(!i)throw Error("No asset given");if(!Array.isArray(i)||0===i.length)throw Error("Returned value must be an array with at least one item (asset)");let d=i[0],c=oC()(d,"assetDocumentProps.originalFilename"),u=oC()(d,"assetDocumentProps.label"),p=oC()(d,"assetDocumentProps.title"),h=oC()(d,"assetDocumentProps.description"),f=oC()(d,"assetDocumentProps.creditLine"),m=oC()(d,"assetDocumentProps.source"),g=s?[p5(["hotspot"]),p5(["crop"])]:[];switch(d.kind){case"assetDocumentId":r([p2({_type:l.name}),...g,p4({_type:"reference",_ref:d.value},["asset"])]);break;case"file":{let x=a(l,d.value);x&&o(x,d.value,{label:u,title:p,description:h,creditLine:f,source:m});break}case"base64":(t=d.value,new Promise((e,n)=>{let i=t.toString(),r=i.substring(11,i.indexOf(";base64"));if(!r&&!c){n(Error("Could not find mime type for image"));return}e(gO(t,c||"".concat((0,aY.Z)(),".").concat(r)))})).then(e=>{let t=a(l,e);t&&o(t,e,{label:u,title:p,description:h,creditLine:f,source:m})});break;case"url":(n=d.value,new Promise((e,t)=>{let i=new XMLHttpRequest;i.onload=()=>{let n=new FileReader;n.onloadend=()=>{var i;let r=null==(i=n.result)?void 0:i.toString(),l=null==r?void 0:r.substring(11,r.indexOf(";base64"));if(!l&&!c){t(Error("Could not find mime type for image"));return}e(gO(n.result,c||"".concat((0,aY.Z)(),".").concat(l)))},n.readAsDataURL(i.response)},i.onerror=e=>{t(e)},i.open("GET",n),i.responseType="blob",i.send()})).then(e=>{let t=a(l,e);t&&o(t,e,{label:u,title:p,description:h,creditLine:f,source:m})});break;default:throw Error("Invalid value returned from asset source plugin")}}let gZ=(0,lO.ZP)(rN.sN)(e=>{let{theme:t}=e,{focusRing:n}=t.sanity,i=t.sanity.color.base;return(0,lO.iv)(er||(er=d4(["\n    position: relative;\n\n    &:not([data-disabled='true']) {\n      &:focus-within {\n        box-shadow: ",";\n      }\n    }\n\n    & input {\n      overflow: hidden;\n      top: 0;\n      left: 0;\n      width: 100%;\n      height: 100%;\n      position: absolute;\n      min-width: 0;\n      display: block;\n      appearance: none;\n      padding: 0;\n      margin: 0;\n      border: 0;\n      opacity: 0;\n    }\n  "])),gE({base:i,border:{width:1,color:"var(--card-border-color)"},focusRing:n}))}),gL=rF.forwardRef(function(e,t){let{icon:n,id:i,accept:r,capture:l,fontSize:a,multiple:o,onSelect:s,padding:d=3,space:c=3,textAlign:u,text:p,disabled:h}=e,f=d3(e,sZ),m="".concat(i||"","-").concat((0,rF.useId)()),g=rF.useCallback(e=>{s&&e.target.files&&s(Array.from(e.target.files))},[s]),x=(0,rz.jsxs)(rN.kC,{align:"center",justify:"flex-start",padding:d,children:[n&&(0,rz.jsx)(rN.xu,{marginRight:p?c:void 0,children:(0,rz.jsxs)(rN.xv,{size:a,children:[(0,rF.isValidElement)(n)&&n,(0,lW.isValidElementType)(n)&&(0,rF.createElement)(n)]})}),p&&(0,rz.jsx)(rN.xv,{align:u,size:a,textOverflow:"ellipsis",children:p})]});return(0,rz.jsxs)(gZ,d6(d6({},f),{},{htmlFor:m,padding:0,fontSize:2,disabled:h,ref:t,children:[x,(0,rz.jsx)("input",{"data-testid":"file-button-input",accept:r,capture:l,id:m,multiple:o,onChange:g,type:"file",value:"",disabled:h})]}))});function gq(e){let{onUpload:t,onReset:n,readOnly:i,accept:r,directUploads:l,browse:a,downloadUrl:o,copyUrl:s}=e,{push:d}=(0,rN.pm)(),c=(0,rF.useCallback)(()=>{navigator.clipboard.writeText(s||""),d({closable:!0,status:"success",title:"The url is copied to the clipboard"})},[d,s]);return(0,rz.jsxs)(rz.Fragment,{children:[(0,rz.jsx)(rN.xu,{padding:2,children:(0,rz.jsx)(rN.__,{muted:!0,size:1,children:"Replace"})}),(0,rz.jsx)(gL,{icon:lL.rG2,mode:"bleed",onSelect:t,accept:r,text:"Upload","data-testid":"file-input-upload-button",disabled:i||!l,fontSize:2}),a,(o||s)&&(0,rz.jsx)(rN.R,{}),o&&(0,rz.jsx)(rN.sN,{as:"a",icon:lL._8t,text:"Download",href:o}),s&&(0,rz.jsx)(rN.sN,{icon:lL.Kmg,text:"Copy URL",onClick:c}),(0,rz.jsx)(rN.R,{}),(0,rz.jsx)(rN.sN,{tone:"critical",icon:lL.X5P,text:"Clear field",onClick:n,disabled:i,"data-testid":"file-input-clear"})]})}let gN=(0,lO.ZP)(rN.kC)(el||(el=d4(["\n  pointer-events: none;\n"])));function gV(e){let{hoveringFiles:t,type:n,readOnly:i,acceptedFiles:r,rejectedFilesCount:l,directUploads:a}=e,o="file"===n,s=(0,rF.useMemo)(()=>i?(0,rz.jsx)(lL.CPA,{}):t&&l>0||!a?(0,rz.jsx)(lL.vaB,{}):o?(0,rz.jsx)(lL.bg6,{}):(0,rz.jsx)(lL.XBm,{}),[a,t,o,i,l]),d=(0,rF.useMemo)(()=>{let e="Drag or paste ".concat(n," here");return a?(i&&(e="Read only"),t&&a&&!i&&(r.length>0&&(e="Drop to upload ".concat(n)),l>0&&(e="Can't upload ".concat(l," file").concat(l>1?"s":""," here"))),e):"Can't upload files here"},[r.length,a,t,i,l,n]);return(0,rz.jsxs)(gN,{align:"center",gap:2,justify:"center",children:[(0,rz.jsx)(rN.xv,{muted:!0,children:s}),(0,rz.jsx)(rN.xv,{size:1,muted:!0,children:d})]})}let gB=(0,lO.ZP)(rN.zx).attrs({forwardedAs:"label"})(e=>{let{theme:t}=e,{focusRing:n}=t.sanity,i=t.sanity.color.base;return(0,lO.iv)(ea||(ea=d4(["\n      &:not([data-disabled='true']) {\n        &:focus-within {\n          box-shadow: ",";\n        }\n      }\n\n      & input {\n        overflow: hidden;\n        top: 0;\n        left: 0;\n        width: 100%;\n        height: 100%;\n        position: absolute;\n        min-width: 0;\n        display: block;\n        appearance: none;\n        padding: 0;\n        margin: 0;\n        border: 0;\n        opacity: 0;\n      }\n    "])),gE({base:i,border:{width:1,color:"var(--card-border-color)"},focusRing:n}))}),gU=rF.forwardRef(function(e,t){let{icon:n,id:i,accept:r,capture:l,fontSize:a,multiple:o,onSelect:s,padding:d=3,space:c=3,textAlign:u,text:p,disabled:h}=e,f=d3(e,sL),m="".concat(i||"","-").concat((0,rF.useId)()),g=(0,rN.Fg)(),x=rF.useCallback(e=>{s&&e.target.files&&s(Array.from(e.target.files))},[s]),v=(0,rz.jsxs)(rN.kC,{align:"center",justify:"center",padding:d,children:[n&&(0,rz.jsx)(rN.xu,{marginRight:p?c:void 0,children:(0,rz.jsxs)(rN.xv,{size:a,children:[(0,rF.isValidElement)(n)&&n,(0,lW.isValidElementType)(n)&&(0,rF.createElement)(n)]})}),p&&(0,rz.jsx)(rN.xv,{align:u,size:a,textOverflow:"ellipsis",weight:g.sanity.button.textWeight,children:p})]});return(0,rz.jsxs)(gB,d6(d6({},f),{},{htmlFor:m,padding:0,fontSize:2,disabled:h,children:[v,(0,rz.jsx)("input",{"data-testid":"file-button-input",accept:r,capture:l,id:m,multiple:o,onChange:x,ref:t,type:"file",value:"",disabled:h})]}))}),gK=rF.memo(function(e){let{accept:t,acceptedFiles:n,browse:i,directUploads:r,hoveringFiles:l,onUpload:a,readOnly:o,rejectedFilesCount:s,type:d}=e,[c,u]=(0,rF.useState)(null),p=(0,rN.h4)(c),h=(null==p?void 0:p.border)&&p.border.width<440;return(0,rz.jsxs)(rN.kC,{align:h?void 0:"center",direction:h?"column":"row",gap:4,justify:"space-between",paddingY:h?1:void 0,ref:u,children:[(0,rz.jsx)(rN.kC,{flex:1,justify:"center",children:(0,rz.jsx)(gV,{acceptedFiles:n,directUploads:r,hoveringFiles:l,readOnly:o,rejectedFilesCount:s,type:d})}),(0,rz.jsxs)(rN.kC,{align:"center",gap:2,justify:"center",wrap:"wrap",children:[(0,rz.jsx)(gU,{accept:t,"data-testid":"file-input-upload-button",disabled:o||!r,icon:lL.rG2,mode:"ghost",onSelect:a,text:"Upload"}),i]})]})}),gH=(0,lO.ZP)(rN.zx)(eo||(eo=d4(["\n  width: 100%;\n"])));function g$(e){let{onClearStale:t}=e;return(0,rz.jsxs)(rN.Zb,{tone:"caution",padding:4,border:!0,radius:2,children:[(0,rz.jsxs)(rN.kC,{gap:4,marginBottom:4,children:[(0,rz.jsx)(rN.xu,{children:(0,rz.jsx)(rN.xv,{size:1,children:(0,rz.jsx)(lL.foC,{})})}),(0,rz.jsxs)(rN.Kq,{space:3,children:[(0,rz.jsx)(rN.xv,{size:1,weight:"semibold",children:"Incomplete upload"}),(0,rz.jsx)(rN.xv,{size:1,children:"An upload has made no progress in the last 6m and likely got interrupted. You can safely clear the incomplete upload and try uploading again."})]})]}),(0,rz.jsx)(gH,{icon:lL.X5P,text:"Clear upload",onClick:t,mode:"ghost"})]})}let gX=(0,lO.ZP)(rN.Zb)(es||(es=d4(["\n  position: absolute;\n  top: 0;\n  left: 0;\n  width: 100%;\n  height: 100%;\n"]))),gW=(0,lO.ZP)(rN.kC)(ed||(ed=d4(["\n  height: 100%;\n"])));function gG(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2;if(0===e)return"0 Bytes";let n=Math.floor(Math.log(e)/Math.log(1024));return"".concat(parseFloat((e/Math.pow(1024,n)).toFixed(t<0?0:t))," ").concat(["Bytes","KB","MB","GB","TB","PB","EB","ZB","YB"][n])}function gY(e){let{originalFilename:t,size:n,children:i,muted:r,disabled:l,onClick:a,isMenuOpen:o,onMenuOpen:s}=e,[d,c]=(0,rF.useState)(null),u=rF.useCallback(()=>s(!0),[s]);return(0,rN.O8)(rF.useCallback(()=>s(!1),[s]),[d]),(0,rz.jsxs)(rN.kC,{wrap:"nowrap",justify:"space-between",align:"center",children:[(0,rz.jsx)(rN.Zb,{as:r||l?void 0:"button",tabIndex:l?void 0:0,__unstable_focusRing:!0,radius:2,padding:2,tone:"inherit",onClick:a,children:(0,rz.jsxs)(rN.kC,{wrap:"nowrap",align:"center",children:[(0,rz.jsx)(rN.Zb,{padding:3,tone:"transparent",shadow:1,radius:1,children:(0,rz.jsx)(rN.xv,{muted:r,children:(0,rz.jsx)(lL.bg6,{})})}),(0,rz.jsxs)(rN.Kq,{flex:1,space:2,marginLeft:3,children:[(0,rz.jsx)(rN.xv,{size:2,textOverflow:"ellipsis",muted:r,"data-testid":"file-name",children:t}),(0,rz.jsx)(rN.xv,{size:1,muted:!0,"data-testid":"file-size",children:gG(n)})]})]})}),(0,rz.jsx)(rN.xu,{padding:2,children:(0,rz.jsx)(rN.kC,{justify:"center",children:(0,rz.jsx)(rN.J2,{content:(0,rz.jsx)(rN.v2,{ref:c,children:i}),portal:!0,open:o,children:(0,rz.jsx)(rN.zx,{icon:lL.zGg,mode:"bleed","data-testid":"options-menu-button",onClick:u})})})})]})}function gJ(){return(0,rz.jsxs)(rN.kC,{align:"center",justify:"flex-start",padding:2,children:[(0,rz.jsx)(rN.Od,{padding:3,radius:1,animated:!0}),(0,rz.jsxs)(rN.Kq,{flex:1,space:2,marginLeft:3,children:[(0,rz.jsx)(rN.JQ,{style:{width:"100%"},radius:1,animated:!0}),(0,rz.jsx)(rN.JQ,{style:{width:"100%"},radius:1,animated:!0})]})]})}let gQ=(0,lO.ZP)(rN.zx)(ec||(ec=d4(["\n  width: 100%;\n"])));function g0(e){let{onClearValue:t}=e;return(0,rz.jsxs)(rN.Zb,{tone:"caution",padding:4,border:!0,radius:2,children:[(0,rz.jsxs)(rN.kC,{gap:4,marginBottom:4,children:[(0,rz.jsx)(rN.xu,{children:(0,rz.jsx)(rN.xv,{size:1,children:(0,rz.jsx)(lL.foC,{})})}),(0,rz.jsxs)(rN.Kq,{space:3,children:[(0,rz.jsx)(rN.xv,{size:1,weight:"semibold",children:"Invalid file value"}),(0,rz.jsx)(rN.xv,{size:1,children:"The value of this field is not a valid file. Resetting this field will let you choose a new file."})]})]}),(0,rz.jsx)(gQ,{icon:lL.X5P,text:"Reset value",onClick:t,mode:"ghost"})]})}function g1(e){let{children:t}=e;return t}let g2=["asset"];class g3 extends rF.PureComponent{constructor(e){var t;super(e),t=this,this._focusRef=null,this.uploadSubscription=null,this.state={isUploading:!1,selectedAssetSource:null,hoveringFiles:[],isStale:!1,isMenuOpen:!1},this.toast=null,this.handleRemoveButtonClick=()=>{let{path:e,value:t}=this.props,n=e.slice(-1)[0],i=Object.keys(t||{}),r=i.filter(e=>!["_type","_key","_upload","asset"].includes(e)),l=0===r.length,a=["asset"].concat(i.filter(e=>["_upload"].includes(e))).map(e=>p5([e]));this.props.onChange(p6.from(l&&!("string"!=typeof n)?p5():a))},this.handleCancelUpload=()=>{this.cancelUpload()},this.handleClearUploadState=()=>{this.setState({isStale:!1}),this.clearUploadStatus()},this.handleStaleUpload=()=>{this.setState({isStale:!0})},this.handleClearField=()=>{this.props.onChange(p5(["asset"]))},this.handleSelectFiles=e=>{let{directUploads:t,readOnly:n}=this.props,{hoveringFiles:i}=this.state;t&&!n?this.uploadFirstAccepted(e):i.length>0&&this.handleFilesOut()},this.handleSelectFileFromAssetSource=e=>{this.setState({selectedAssetSource:e})},this.handleAssetSourceClosed=()=>{this.setState({selectedAssetSource:null})},this.uploadWith=function(e,n){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},{schemaType:r,onChange:l,client:a}=t.props,{source:o}=i,s={metadata:oC()(r,"options.metadata"),storeOriginalFilename:oC()(r,"options.storeOriginalFilename"),source:o};t.cancelUpload(),t.setState({isUploading:!0}),l(p6.from([p2({_type:r.name})])),t.uploadSubscription=e.upload(a,n,r,s).subscribe({next:e=>{e.patches&&l(p6.from(e.patches))},error:e=>{var n;console.error(e),null==(n=t.toast)||n.push({status:"error",description:"The upload could not be completed at this time.",title:"Upload failed"}),t.clearUploadStatus()},complete:()=>{t.setState({isUploading:!1})}})},this.handleSelectAssetFromSource=e=>{let{onChange:t,schemaType:n,resolveUploader:i}=this.props;gD({assetFromSource:e,onChange:t,type:n,resolveUploader:i,uploadWith:this.uploadWith}),this.setState({selectedAssetSource:null})},this.handleFileTargetFocus=e=>{e.currentTarget===e.target&&e.currentTarget===this._focusRef&&this.props.onPathFocus(["asset"])},this.handleFilesOver=e=>{this.setState({hoveringFiles:e})},this.handleFilesOut=()=>{this.setState({hoveringFiles:[]})},this.setFocusElement=e=>{this._focusRef=e},this.handleUpload=e=>{let{file:t,uploader:n}=e;this.uploadWith(n,t)},this.setToast=e=>{this.toast=e},this._assetFieldPath=e.path.concat(g2)}clearUploadStatus(){var e;(null==(e=this.props.value)?void 0:e._upload)&&this.props.onChange(p6.from([p5(["_upload"])]))}cancelUpload(){this.uploadSubscription&&(this.uploadSubscription.unsubscribe(),this.clearUploadStatus())}uploadFirstAccepted(e){let{schemaType:t}=this.props,n=e.map(e=>{var n,i;return{file:e,uploader:null==(i=(n=this.props).resolveUploader)?void 0:i.call(n,t,e)}}).find(e=>e.uploader);n&&this.uploadWith(n.uploader,n.file),this.setState({isMenuOpen:!1})}renderUploadState(e){let{isUploading:t}=this.state;return(0,rz.jsx)(gF,{uploadState:e,onCancel:t?this.handleCancelUpload:void 0,onStale:this.handleStaleUpload})}renderAssetSource(){let{selectedAssetSource:e}=this.state,{value:t,observeAsset:n}=this.props;if(!e)return null;let i=e.component;return t&&t.asset?(0,rz.jsx)(gj,{observeAsset:n,reference:t.asset,waitPlaceholder:(0,rz.jsx)(gJ,{}),children:e=>(0,rz.jsx)(i,{selectedAssets:[e],selectionType:"single",assetType:"file",dialogHeaderTitle:"Select file",onClose:this.handleAssetSourceClosed,onSelect:this.handleSelectAssetFromSource})}):(0,rz.jsx)(i,{selectedAssets:[],selectionType:"single",assetType:"file",dialogHeaderTitle:"Select file",onClose:this.handleAssetSourceClosed,onSelect:this.handleSelectAssetFromSource})}hasFileTargetFocus(){var e;return(null==(e=this.props.focusPath)?void 0:e[0])==="asset"}renderAsset(){let{value:e,changed:t,readOnly:n,elementProps:i}=this.props,{hoveringFiles:r,isStale:l}=this.state,a=Boolean((null==e?void 0:e._upload)||(null==e?void 0:e.asset));return!e||void 0===e.asset||(null==e?void 0:e._upload)||(0,aj.OT)(e)?o=>(0,rz.jsxs)(rz.Fragment,{children:[l&&(0,rz.jsx)(rN.xu,{marginBottom:2,children:(0,rz.jsx)(g$,{onClearStale:this.handleClearUploadState})}),(0,rz.jsxs)(cH,{path:this._assetFieldPath,hasFocus:!!o.focused,isChanged:t,children:[!(null==e?void 0:e._upload)&&(0,rz.jsx)(gA,d6(d6({},i),{},{tabIndex:0,disabled:Boolean(n),ref:this.setFocusElement,onFiles:this.handleSelectFiles,onFilesOver:this.handleFilesOver,onFilesOut:this.handleFilesOut,tone:this.getFileTone(),$border:a||r.length>0,style:{padding:1},sizing:"border",radius:2,children:(0,rz.jsxs)("div",{style:{position:"relative"},children:[!(null==e?void 0:e.asset)&&this.renderUploadPlaceholder(),(null==e?void 0:e.asset)&&r.length>0?this.renderAssetMenu(this.getFileTone()):null,!(null==e?void 0:e._upload)&&(null==e?void 0:e.asset)&&this.renderPreview()]})})),(null==e?void 0:e._upload)&&this.renderUploadState(e._upload)]})]}):()=>(0,rz.jsx)(g0,{onClearValue:this.handleClearField})}renderPreview(){let{value:e,readOnly:t,assetSources:n,schemaType:i,directUploads:r,observeAsset:l}=this.props,{isMenuOpen:a}=this.state,o=null==e?void 0:e.asset;if(!o)return null;let s=oC()(i,"options.accept",""),d=n&&(null==n?void 0:n.length)===0?null:(0,rz.jsx)(rN.sN,{icon:lL.W1M,text:"Browse",onClick:()=>{this.setState({isMenuOpen:!1}),this.handleSelectFileFromAssetSource(n[0])},disabled:t,"data-testid":"file-input-browse-button"});return n.length>1&&(d=n.map(e=>(0,rz.jsx)(rN.sN,{text:e.title,onClick:()=>{this.setState({isMenuOpen:!1}),this.handleSelectFileFromAssetSource(e)},icon:e.icon||lL.XBm,disabled:t,"data-testid":"file-input-browse-button-".concat(e.name)},e.name))),(0,rz.jsx)(gj,{reference:o,observeAsset:l,waitPlaceholder:(0,rz.jsx)(gJ,{}),children:n=>{let i,l,{originalFilename:o,extension:c,url:u,size:p}=n;return(0,aj.OT)(e)&&(l="".concat(u,"?dl"),i=u),(0,rz.jsx)(gY,{size:p,originalFilename:o||"download.".concat(c),muted:!t,onMenuOpen:e=>this.setState({isMenuOpen:e}),isMenuOpen:a,children:(0,rz.jsx)(gq,{onUpload:this.handleSelectFiles,browse:d,onReset:this.handleRemoveButtonClick,downloadUrl:l,copyUrl:i,readOnly:t,accept:s,directUploads:r})})}})}renderAssetMenu(e){let{schemaType:t,readOnly:n,directUploads:i,resolveUploader:r}=this.props,{hoveringFiles:l}=this.state,a=l.filter(e=>null==r?void 0:r(t,e)),o=l.length-a.length;return(0,rz.jsx)(gX,{tone:e,children:(0,rz.jsx)(gW,{align:"center",justify:"center",gap:2,flex:1,children:(0,rz.jsx)(gV,{readOnly:n,hoveringFiles:l,acceptedFiles:a,rejectedFilesCount:o,directUploads:i,type:"file"})})})}renderBrowser(){let{assetSources:e,readOnly:t,directUploads:n,id:i}=this.props;return 0===e.length?null:e.length>1&&!t&&n?(0,rz.jsx)(rN.j2,{id:"".concat(i,"_assetFileButton"),button:(0,rz.jsx)(rN.zx,{mode:"ghost",text:"Select","data-testid":"file-input-multi-browse-button",icon:lL.W1M}),"data-testid":"input-select-button",menu:(0,rz.jsx)(rN.v2,{children:e.map(e=>(0,rz.jsx)(rN.sN,{text:e.title,onClick:()=>{this.setState({isMenuOpen:!1}),this.handleSelectFileFromAssetSource(e)},icon:e.icon||lL.XBm,disabled:t,"data-testid":"file-input-browse-button-".concat(e.name)},e.name))})}):(0,rz.jsx)(rN.zx,{fontSize:2,text:"Browse",icon:lL.W1M,mode:"ghost",onClick:()=>{this.setState({isMenuOpen:!1}),this.handleSelectFileFromAssetSource(e[0])},"data-testid":"file-input-browse-button",disabled:t})}renderUploadPlaceholder(){let{readOnly:e,schemaType:t,directUploads:n,resolveUploader:i}=this.props,{hoveringFiles:r}=this.state,l=r.filter(e=>null==i?void 0:i(t,e)),a=r.length-l.length,o=oC()(t,"options.accept","");return(0,rz.jsx)("div",{style:{padding:1},children:(0,rz.jsx)(rN.Zb,{tone:e?"transparent":"inherit",border:!0,padding:3,style:0===r.length?{borderStyle:"dashed"}:{borderStyle:"dashed",borderColor:"transparent"},children:(0,rz.jsx)(gK,{browse:this.renderBrowser(),onUpload:this.handleSelectFiles,readOnly:e,hoveringFiles:r,acceptedFiles:l,rejectedFilesCount:a,type:"file",accept:o,directUploads:n})})})}focus(){this._focusRef&&this._focusRef.focus()}getFileTone(){let{directUploads:e,schemaType:t,value:n,readOnly:i,resolveUploader:r}=this.props,{hoveringFiles:l}=this.state,a=l.filter(e=>null==r?void 0:r(t,e)),o=l.length-a.length;return l.length>0&&(o>0||!e)?"critical":(null==n?void 0:n._upload)||i||!(l.length>0)?(null==n?void 0:n._upload)&&(null==n?void 0:n.asset)&&i?"transparent":"default":"primary"}render(){let{members:e,renderItem:t,renderInput:n,renderField:i,renderPreview:r}=this.props,{selectedAssetSource:l}=this.state;return(0,rz.jsxs)(rz.Fragment,{children:[(0,rz.jsx)(Fx,{ref:this.setToast}),e.map(e=>"field"===e.kind&&("crop"===e.name||"hotspot"===e.name)?null:"field"===e.kind?(0,rz.jsx)(mO,{member:e,renderInput:"asset"===e.name?this.renderAsset():n,renderField:"asset"===e.name?g1:i,renderItem:t,renderPreview:r},e.key):"fieldSet"===e.kind?(0,rz.jsx)(mY,{member:e,renderInput:n,renderField:i,renderItem:t,renderPreview:r},e.key):"error"===e.kind?(0,rz.jsx)(mG,{member:e},e.key):(0,rz.jsxs)(rz.Fragment,{children:["Unknown member kind: $",e.kind]})),l&&this.renderAssetSource()]})}}let g4=(0,lO.ZP)(rN.xu)(eu||(eu=d4(["\n  position: relative;\n  padding-bottom: calc("," * 100%);\n\n  & > div {\n    position: absolute;\n    top: ","px;\n    left: ","px;\n    right: ","px;\n    bottom: ","px;\n  }\n"])),e=>{let{ratio:t=1.5}=e;return 1/t},e=>{let{padding:t=0}=e;return t},e=>{let{padding:t=0}=e;return t},e=>{let{padding:t=0}=e;return t},e=>{let{padding:t=0}=e;return t});function g5(e){let{src:t,children:n}=e,[i,r]=(0,rF.useState)(!0),[l,a]=(0,rF.useState)(null),[o,s]=(0,rF.useState)(null);return(0,rF.useEffect)(()=>{a(null),s(null),r(!0);let e=new Image;e.onload=()=>{a(e),s(null),r(!1)},e.onerror=()=>{s(Error("Could not load image from ".concat(JSON.stringify(t)))),r(!1)},e.referrerPolicy="strict-origin-when-cross-origin",e.src=t},[t]),n({image:l,error:o,isLoading:i})}let g6=["","webkit","moz","ms","o"].map(e=>"".concat(e,"backingStoreRatio")),g8=-1;function g7(e,t){let n={x:t.center.x,y:t.center.y},i=t.width/2,r=t.height/2;if(i<=0||r<=0)return!1;let l={x:e.x-n.x,y:e.y-n.y};return Math.pow(l.x,2)/Math.pow(i,2)+Math.pow(l.y,2)/Math.pow(r,2)<=1}function g9(e,t){let{x:n,y:i}=e;return Math.pow(n-t.x,2)+Math.pow(i-t.y,2)<Math.pow(t.radius,2)}function xe(e,t){return e.x>=t.left&&e.x<=t.left+t.width&&e.y>=t.top&&e.y<=t.top+t.height}function xt(e,t){return{x:t.center.x-t.width/2*Math.cos(e),y:t.center.y-t.height/2*Math.sin(e)}}class xn{constructor(e,t){this.x=e,this.y=t}}class xi{constructor(e,t,n){this.y=e,this._left=t,this._right=n}get right(){return new xn(this._right,this.y)}get left(){return new xn(this._left,this.y)}get length(){return this._right-this._left}}class xr{constructor(e){this.rect=e}get top(){return new xi(this.rect.top,this.rect.left,this.rect.right)}get bottom(){return new xi(this.rect.bottom,this.rect.left,this.rect.right)}}class xl{static fromEdges(e){let{left:t,right:n,top:i,bottom:r}=e;return new xl(t,i,1-t-n,1-i-r)}constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;this.left=e,this.top=t,this.width=n,this.height=i}setTopLeft(e,t){return new xl(e,t,this.width||0,this.height||0)}setSize(e,t){return new xl(this.left||0,this.top||0,e,t)}setCenter(e,t){let n=this.width||0,i=this.height||0;return new xl(e-n/2,t-i/2,n||0,i||0)}get center(){return new xn(this.left+this.width/2,this.top+this.height/2)}get corners(){return new xr(this)}get right(){return this.left+this.width}get bottom(){return this.top+this.height}multiply(e){return new xl((this.left||0)+this.width*e.left,(this.top||0)+this.height*e.top,this.width*e.width,this.height*e.height)}grow(e){return new xl(this.left-e,this.top-e,this.width+2*e,this.height+2*e)}shrink(e){return this.grow(-e)}cropRelative(e){let t=this.top+e.top*this.height,n=this.left+e.left*this.width,i=this.height*e.height,r=this.width*e.width;return new xl(n,t,r,i)}clamp(e){let{left:t,top:n,width:i,height:r}=this;return e.width<i&&(i=e.width,t=e.left),e.height<r&&(r=e.height,n=e.top),t+i>e.left+e.width&&(t=e.right-i),n+r>e.top+e.height&&(n=e.bottom-r),new xl(Math.max(t,e.left),Math.max(n,e.top),i,r)}}let xa=oQ()("sanity-imagetool"),xo="undefined"!=typeof window&&"ontouchstart"in window;function xs(e,t,n){return{x:e-n.left,y:t-n.top}}function xd(e){return"touches"in e?e.touches.length>0?{x:e.touches[0].clientX,y:e.touches[0].clientY}:{x:0,y:0}:{x:e.clientX,y:e.clientY}}let xc=class extends rF.PureComponent{constructor(){super(...arguments),this.domNode=null,this.currentPos=null,this.isDragging=!1,this.handleTouchMove=e=>{this.isDragging&&e.preventDefault()},this.handleDragStart=e=>{let{onDragStart:t,readOnly:n}=this.props;if(n||!this.domNode)return;if(this.isDragging){xa("Start cancelled, already a drag in progress");return}this.isDragging=!0;let i=xd(e);xa("Drag started %o",i),t(xs(i.x,i.y,this.domNode.getBoundingClientRect())),this.currentPos=i},this.handleDrag=e=>{var t;if(!this.isDragging||this.props.readOnly||!this.currentPos)return;let{onDrag:n}=this.props,i=xd(e),r=(t=this.currentPos,{x:i.x-t.x,y:i.y-t.y});n(r),xa("moving by %o",r),this.currentPos=i},this.handleDragEnd=e=>{let{onDragEnd:t,readOnly:n}=this.props;if(!this.isDragging||n||!this.domNode)return;let i=xd(e);t(xs(i.x,i.y,this.domNode.getBoundingClientRect())),this.isDragging=!1,this.currentPos=null,xa("Done moving %o",i)},this.handleDragCancel=()=>{if(!this.isDragging||this.props.readOnly||!this.currentPos||!this.domNode)return;let{onDragEnd:e}=this.props;this.isDragging=!1,e(xs(this.currentPos.x,this.currentPos.y,this.domNode.getBoundingClientRect())),this.currentPos=null},this.setDomNode=e=>{this.domNode=e}}componentDidMount(){xo?(document.body.addEventListener("touchmove",this.handleTouchMove,{passive:!1}),document.body.addEventListener("touchend",this.handleDragEnd),document.body.addEventListener("touchcancel",this.handleDragCancel)):(document.body.addEventListener("mousemove",this.handleDrag),document.body.addEventListener("mouseup",this.handleDragEnd),document.body.addEventListener("mouseleave",this.handleDragCancel))}componentWillUnmount(){xo?(document.body.removeEventListener("touchmove",this.handleTouchMove),document.body.removeEventListener("touchend",this.handleDragEnd),document.body.removeEventListener("touchcancel",this.handleDragCancel)):(document.body.removeEventListener("mousemove",this.handleDrag),document.body.removeEventListener("mouseup",this.handleDragEnd),document.body.removeEventListener("mouseleave",this.handleDragCancel))}render(){let e=this.props,{readOnly:t,onDragStart:n,onDragEnd:i,onDrag:r}=e,l=d3(e,sq);return(0,rz.jsx)("canvas",d6({ref:this.setDomNode,onTouchStart:t?void 0:this.handleDragStart,onMouseDown:t?void 0:this.handleDragStart,onTouchMove:t?void 0:this.handleDrag},l))}},xu=lO.ZP.div(ep||(ep=d4(["\n  width: 100%;\n  height: 100%;\n  position: relative;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n"]))),xp=(0,lO.ZP)(xc)(eh||(eh=d4(["\n  display: block;\n  position: relative;\n  max-width: calc(100% - 0.5em); /* to prevent overlap with change bar */\n  max-height: calc(100% + 1em);\n  user-select: none;\n"]))),xh={x:.5,y:.5,height:1,width:1},xf={top:0,left:0,right:0,bottom:0};function xm(e,t){let{top:n,right:i,bottom:r,left:l}=e.crop||xf,a={hotspot:e.hotspot,crop:{top:n+(t.top||0)>0?n:0,right:i+(t.right||0)>0?i:0,bottom:r+(t.bottom||0)>0?r:0,left:l+(t.left||0)>0?l:0}},o={top:n+(t.top||0)>0&&t.top||0,right:i+(t.right||0)>0&&t.right||0,bottom:r+(t.bottom||0)>0&&t.bottom||0,left:l+(t.left||0)>0&&t.left||0};return{value:a,delta:o}}let xg=lV()(()=>{let e=window.devicePixelRatio||1,t=document.createElement("canvas").getContext("2d"),n=t&&(-1===g8&&(g8=g6.find(e=>e in t)),g8&&t[g8])||1;return e/n}),xx=["left","right","top","topLeft","topRight","bottom","bottomLeft","bottomRight"];class xv extends rF.PureComponent{constructor(){super(...arguments),this.state={cropping:!1,cropMoving:!1,moving:!1,resizing:!1,mousePosition:null},this.handleDragStart=e=>{let{x:t,y:n}=e,i={x:t*this.getScale(),y:n*this.getScale()},r=g7(i,this.getHotspotRect()),l=g9(i,this.getDragHandleCoords()),a=this.getActiveCropHandleFor(i),o=xe(i,this.getCropRect());a?this.setState({cropping:a}):l?this.setState({resizing:!0}):r?this.setState({moving:!0}):o&&this.setState({cropMoving:!0})},this.handleDrag=e=>{this.state.cropping?this.emitCrop(this.state.cropping,e):this.state.cropMoving?this.emitCropMove(e):this.state.moving?this.emitMove(e):this.state.resizing&&this.emitResize(e)},this.handleDragEnd=()=>{let{onChange:e,onChangeEnd:t}=this.props;this.setState({moving:!1,resizing:!1,cropping:!1,cropMoving:!1});let{hotspot:n,crop:i}=this.getClampedValue(),r=function(e){let t=e.top>e.bottom,n=e.left>e.right;return{top:t?e.bottom:e.top,bottom:t?e.top:e.bottom,left:n?e.right:e.left,right:n?e.left:e.right}}(i),l={crop:{top:r.top,bottom:1-r.bottom,left:r.left,right:1-r.right},hotspot:{x:n.center.x,y:n.center.y,height:Math.abs(n.height),width:Math.abs(n.width)}};e(l),t&&t(l)},this.handleMouseOut=()=>{this.setState({mousePosition:null})},this.handleMouseMove=e=>{let t=e.currentTarget.getBoundingClientRect();this.setState({mousePosition:{x:(e.clientX-t.left)*this.getScale(),y:(e.clientY-t.top)*this.getScale()}})},this.setCanvas=e=>{this.canvas=e}}getHotspotRect(){let{value:e,image:t}=this.props,n=e.hotspot||xh,i=new xl().setSize(n.width,n.height).setCenter(n.x,n.y);return new xl().setSize(t.width,t.height).shrink(8*this.getScale()).multiply(i)}getCropRect(){let{value:e,image:t}=this.props;return new xl().setSize(t.width,t.height).shrink(8*this.getScale()).cropRelative(xl.fromEdges(e.crop||xf).clamp(new xl(0,0,1,1)))}getCropHandles(){let e=this.getCropRect(),t=12*this.getScale(),n=t/2,i=new xl(0,0,t,t);return{left:i.setTopLeft(e.left-n,e.center.y-n),right:i.setTopLeft(e.right-n,e.center.y-n),top:i.setTopLeft(e.center.x-n,e.top-n),topLeft:i.setTopLeft(e.left-n,e.top-n),topRight:i.setTopLeft(e.right-n,e.top-n),bottom:i.setTopLeft(e.center.x-n,e.bottom-n),bottomLeft:i.setTopLeft(e.left-n,e.bottom-n),bottomRight:i.setTopLeft(e.right-n,e.bottom-n)}}getActiveCropHandleFor(e){let{x:t,y:n}=e,i=this.getCropHandles();for(let r of xx)if(xe({x:t,y:n},i[r]))return r;return!1}emitMove(e){let{image:t,value:n,onChange:i}=this.props,r=this.getScale(),l={x:e.x*r/t.width,y:e.y*r/t.height};i(function(e,t){let n=e&&e.hotspot||xh;return d6(d6({},e),{},{hotspot:d6(d6({},n),{},{x:n.x+t.x,y:n.y+t.y})})}(n,l))}emitCropMove(e){let{image:t,onChange:n,value:i}=this.props,r=this.getScale(),l=e.x*r/t.width,a=-e.x*r/t.width,o=e.y*r/t.height,s=-e.y*r/t.height,d={left:l,right:a,top:o,bottom:s};!i||!i.crop||i.crop.top+d.top<0||i.crop.left+d.left<0||i.crop.right+d.right<0||i.crop.bottom+d.bottom<0||n(xb(i,d))}emitCrop(e,t){let{image:n,onChange:i,value:r}=this.props,l=this.getScale(),a=0,o=0,s=0,d=0;"left"==e||"topLeft"===e||"bottomLeft"===e?a=t.x*l/n.width:("right"==e||"topRight"===e||"bottomRight"===e)&&(o=-t.x*l/n.width),"top"==e||"topLeft"===e||"topRight"===e?s=t.y*l/n.height:("bottom"==e||"bottomLeft"===e||"bottomRight"===e)&&(d=-t.y*l/n.height);let c={left:a,right:o,top:s,bottom:d},u=xm(r,c).value,p=xm(r,c).delta;i(xb(u,p))}emitResize(e){let{image:t,onChange:n,value:i}=this.props,r=this.getScale(),l={x:e.x*r*2/t.width,y:e.y*r*2/t.height};n(function(e,t){let n=e&&e.hotspot||xh;return d6(d6({},e),{},{hotspot:d6(d6({},n),{},{height:n.height+t.height,width:n.width+t.width})})}(i,{height:l.y,width:l.x}))}getClampedValue(){let e=this.props.value,t=xl.fromEdges(e.crop||xf).clamp(new xl(0,0,1,1)),n=e.hotspot||xh,i=new xl(0,0,1,1).setSize(n.width,n.height).setCenter(n.x,n.y).clamp(t);return{crop:t,hotspot:i}}paintHotspot(e,t){let{image:n,readOnly:i}=this.props,r=new xl().setSize(n.width,n.height),{hotspot:l,crop:a}=this.getClampedValue(),o=this.getScale(),s=8*o;function d(t,i,r,l,a,o,s,d){e.save(),e.drawImage(n,t,i,r,l,a,o,s,d),e.restore()}e.save(),function(){let t=r.cropRelative(a),n=r.shrink(s).cropRelative(a);e.save(),d(t.left,t.top,t.width,t.height,n.left,n.top,n.width,n.height),e.globalAlpha=.5,e.fillStyle="black",e.fillRect(n.left,n.top,n.width,n.height),e.restore()}(),function(){e.save();let n=r.shrink(s).multiply(l),i=n.height/n.width;e.scale(1,i),e.beginPath(),e.globalAlpha=t,e.arc(n.center.x,n.center.y/i,Math.abs(n.width/2),0,2*Math.PI,!1),e.strokeStyle="white",e.lineWidth=1.5*o,e.stroke(),e.closePath(),e.restore()}(),e.clip(),function(){let e=r.multiply(l),t=r.shrink(s).multiply(l);d(e.left,e.top,e.width,e.height,t.left,t.top,t.width,t.height)}(),e.restore(),i||function(t){e.save();let n=10*o,i=r.shrink(s).multiply(l),a=xt(t,i);e.beginPath(),e.arc(a.x,a.y,n,0,2*Math.PI,!1),e.fillStyle="rgb(255,255,255)",e.fill(),e.closePath(),e.restore(),e.beginPath(),e.arc(a.x,a.y,n,0,2*Math.PI,!1),e.strokeStyle="rgb(0, 0, 0)",e.lineWidth=.5*o,e.stroke(),e.closePath()}(1.25*Math.PI)}getActualSize(){var e;let t=null==(e=this.canvas)?void 0:e.domNode;return t?{height:t.clientHeight,width:t.clientWidth}:{height:0,width:0}}getDragHandleCoords(){let e=this.getHotspotRect(),t=xt(1.25*Math.PI,e);return{x:t.x,y:t.y,radius:8*this.getScale()}}debug(e){e.save();let{image:t}=this.props,n=this.getHotspotRect(),i=this.getScale(),r=8*i;function l(e){o(e,r,e,t.height-r)}function a(e){o(r,e,t.width-r,e)}function o(t,n,i,r){e.beginPath(),e.moveTo(t,n),e.lineTo(i,r),e.stroke(),e.closePath()}e.setLineDash&&e.setLineDash([2*i,2*i]),e.lineWidth=.5*i,e.strokeStyle="rgba(200, 200, 200, 0.5)",l(n.center.x),a(n.center.y),e.strokeStyle="rgba(150, 150, 150, 0.5)",a(n.top),a(n.bottom),l(n.left),l(n.right),e.restore()}paintBackground(e){let{image:t}=this.props,n=new xl().setSize(t.width,t.height).shrink(8*this.getScale());e.save(),e.fillStyle="white",e.clearRect(0,0,t.width,t.height),e.globalAlpha=.3,e.drawImage(t,n.left,n.top,n.width,n.height),e.restore()}paint(e){let{readOnly:t}=this.props;e.save();let n=xg();e.scale(n,n);let i=!t&&this.state.mousePosition?.8:.2;this.paintBackground(e),this.paintHotspot(e,i),this.debug(e),this.paintCropBorder(e),t||this.highlightCropHandles(e,i),e.restore()}paintMousePosition(e){if(!this.state.mousePosition)return;let{x:t,y:n}=this.state.mousePosition;e.beginPath(),e.arc(t,n,14*this.getScale(),0,2*Math.PI,!1),e.fillStyle="lightblue",e.fill(),e.restore()}paintCropBorder(e){let t=this.getCropRect();e.save(),e.beginPath(),e.fillStyle="rgba(66, 66, 66, 0.9)",e.lineWidth=1,e.rect(t.left,t.top,t.width,t.height),e.stroke(),e.closePath(),e.restore()}highlightCropHandles(e,t){e.save();let n=this.getCropHandles();xx.forEach(i=>{e.fillStyle=this.state.cropping===i?"rgba(202, 54, 53, ".concat(t,")"):"rgba(230, 230, 230, ".concat(t+.4,")");let{left:r,top:l,height:a,width:o}=n[i];e.fillRect(r,l,o,a),e.beginPath(),e.fillStyle="rgba(66, 66, 66, ".concat(t,")"),e.rect(r,l,o,a),e.closePath(),e.stroke()}),e.restore()}getScale(){let e=this.getActualSize();return this.props.image.width/e.width}getCursor(){let{mousePosition:e}=this.state,{readOnly:t}=this.props;if(!e||t)return"auto";let n=this.state.cropping||this.getActiveCropHandleFor(e);if(n)return function(e){switch(e){case"left":case"right":return"col-resize";case"top":case"bottom":return"row-resize";case"topRight":case"bottomLeft":return"nesw-resize";case"topLeft":case"bottomRight":return"nwse-resize";default:return null}}(n)||"auto";let i=g9(e,this.getDragHandleCoords());if(this.state.resizing||i)return"move";if(this.state.moving||this.state.cropMoving)return"url(".concat("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAQAAADZc7J/AAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAAAAmJLR0QA/4ePzL8AAABdSURBVEjH7ZA7DsAwCEMN6v2vTCdESpLKQRl5gxfzMQDNRQyWlEK83QAIRh3cH/QbIhQwMDl8gORl7A16WD/xxAdq6N6SgycKUblf41+wbFBT44RiCi11NU3TLHgBxRUUD4ITqnIAAAAldEVYdGRhdGU6Y3JlYXRlADIwMTUtMDEtMjFUMDA6MTM6NDMrMDE6MDC74T7AAAAAJXRFWHRkYXRlOm1vZGlmeQAyMDEyLTA0LTAyVDA0OjEzOjM3KzAyOjAwQJ35wQAAAABJRU5ErkJggg==","), move");let r=g7(e,this.getHotspotRect()),l=xe(e,this.getCropRect());return r||l?"url(".concat("data:image/png;base64,AAACAAEAICACAAcABQAwAQAAFgAAACgAAAAgAAAAQAAAAAEAAQAAAAAAAAEAAAAAAAAAAAAAAgAAAAAAAAAAAAAA////AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAD8AAAA/AAAAfwAAAP+AAAH/gAAB/8AAA//AAAd/wAAGf+AAAH9gAADbYAAA2yAAAZsAAAGbAAAAGAAAAAAAAA//////////////////////////////////////////////////////////////////////////////////////gH///4B///8Af//+AD///AA///wAH//4AB//8AAf//AAD//5AA///gAP//4AD//8AF///AB///5A////5///8=","), move"):"auto"}componentDidMount(){this.draw()}componentDidUpdate(){this.draw()}draw(){if(!this.canvas)return;let e=this.canvas.domNode,t=e.getContext("2d");if(!t)return;this.paint(t);let n=e.style.cursor,i=this.getCursor();n!==i&&(e.style.cursor=i)}render(){let{image:e,readOnly:t}=this.props,n=xg();return(0,rz.jsx)(xu,{children:(0,rz.jsx)(xp,{readOnly:t,ref:this.setCanvas,onDrag:this.handleDrag,onDragStart:this.handleDragStart,onDragEnd:this.handleDragEnd,onMouseMove:this.handleMouseMove,onMouseOut:this.handleMouseOut,height:e.height*n,width:e.width*n})})}}function xb(e,t){let n=e&&e.crop||xf;return d6(d6({},e),{},{crop:{left:n.left+(t.left||0),right:n.right+(t.right||0),top:n.top+(t.top||0),bottom:n.bottom+(t.bottom||0)}})}function xy(e){let{image:t,maxHeight:n,maxWidth:i,children:r}=e,[l]=(0,rF.useState)(()=>{let e=document.createElement("canvas");return e.style.display="none",e});(0,rF.useEffect)(()=>(document.body.appendChild(l),()=>{document.body.removeChild(l)}),[l]);let a=(0,rF.useCallback)((e,t,n)=>{let i=e.width/e.height,r=Math.min(e.width,n),a=Math.min(e.height,t),o=e.width>e.height,s=o?r:a*i,d=o?r/i:a;l.width=s,l.height=d;let c=l.getContext("2d");return c&&c.drawImage(e,0,0,e.width,e.height,0,0,s,d),l},[l]);return r(a(t,n,i))}function xj(e){return(0,rz.jsx)(g5,{src:e.src,children:t=>{let{isLoading:n,image:i,error:r}=t;return n?(0,rz.jsx)("div",{children:"Loading..."}):r?(0,rz.jsx)("div",{children:r.message}):i?(0,rz.jsx)(xy,{image:i,maxHeight:xj.maxHeight,maxWidth:xj.maxWidth,children:t=>(0,rz.jsx)(xv,d6({image:t},e))}):null}})}function xw(e){if(!e)return null;if("aspectRatio"in e)return e.aspectRatio;if("height"in e||"width"in e){if("number"!=typeof e.height&&"number"!=typeof e.width)throw Error("Height and width must be numbers, got ".concat(JSON.stringify(e)));return e.width/e.height}return null}function xk(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2,n=Math.pow(10,t);return Math.round(e*n)/n}function xC(e){return 0===e?0:"".concat(e,"%")}function x_(e){return xC(xk(100*e))}xj.maxHeight=500,xj.maxWidth=1e3;let xS=lO.ZP.div(ef||(ef=d4(["\n  position: relative;\n  width: 100%;\n"]))),xE=oQ()("sanity-imagetool"),xT=(0,rF.memo)(function(e){let{alignX:t="center",alignY:n="center",alt:i,aspectRatio:r="none",className:l="",crop:a=xf,hotspot:o=xh,onError:s,onLoad:d,src:c,srcAspectRatio:u,srcSet:p,style:h}=e,[f,m]=(0,rF.useState)(null),g=(0,rF.useRef)(null),x=(0,rF.useRef)(null),v=(0,rF.useCallback)(()=>{if(g.current){if("auto"===r){let e=g.current.parentNode;(0,rF.startTransition)(()=>m(e.offsetWidth/e.offsetHeight))}else m(null)}},[r]);(0,rF.useEffect)(()=>{let e=x.current,t=e&&e.src&&e.complete&&void 0!==e.naturalWidth;return t&&(xE("Image '%s' already loaded, refreshing (from cache) to trigger onLoad / onError",c),e.src=e.src),v(),window.addEventListener("resize",v),()=>{window.removeEventListener("resize",v)}},[c,v]);let b=(0,rF.useMemo)(()=>"none"===r?a?function(e,t){let n=1/t,i=t*n,r=i-(e.left+e.right)*i,l=n-(e.top+e.bottom)*n;return r/l}(a,u):u:"auto"===r?f:r||null,[r,f,a,u]),y=(0,rF.useMemo)(()=>(function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=xw(e.image)||1,n=e.hotspot||xh,i=e.crop||xf,r=xw(e.container)||t*function(e){let t=1-e.top-e.bottom,n=1-e.left-e.right;return n/t}(i),l=e.align||{x:"center",y:"center"},a=function(e,t,n){let i,r,l;let a=t.crop,o=n.aspect,s=n.align,d=1-a.left-a.right,c=1-a.top-a.bottom,u={top:-a.top/c,left:-a.left/d,width:1/d,height:1/c},p=d/c*e,h={x:(t.hotspot.x-a.left)/d,y:(t.hotspot.y-a.top)/c,height:t.hotspot.height/c,width:t.hotspot.width/d},f=1/h.width,m=1/h.height*p/o,g=Math.min(f,m),x=p<=o;if((i=x?1:p/o)>g){let v;r="letterbox",l={width:v=x?1-(i-g):g,height:v/p*o,left:0,top:0};let b=h.x*l.width-h.width*l.width/2;switch(s.x){case"left":l.left=x?0:-b;break;case"right":l.left=x?1-l.width:b;break;case"center":l.left=x?(1-l.width)/2:-b;break;default:throw Error("Invalid x alignment: '".concat(s.x,"'. Must be either 'left', 'right' or 'center'"))}let y=h.y*l.height-h.height*l.height/2;switch(s.y){case"top":l.top=x?-y:0;break;case"bottom":l.top=y;break;case"center":l.top=x?-y:(1-l.height)/2;break;default:throw Error("Invalid y alignment: '".concat(s.y,"'. Must be either 'top', 'bottom' or 'center'"))}}else if(x){r="full_width";let j=-h.y/p*o+.5,w=i/p*o;j>0?j=0:-j>w-1&&(j=-(w-1)),l={width:i,height:w,left:0,top:j}}else{r="full_height";let k=.5-h.x*i;k>0?k=0:-k>i-1&&(k=-(i-1)),l={width:i,height:i/p*o,top:0,left:k}}return{method:r,crop:l,image:u}}(t,{hotspot:n,crop:i},{aspect:r,align:l}),o=xC(xk(100/r));return{debug:{result:a},container:{overflow:"hidden",position:"relative",width:"100%",height:o},padding:{marginTop:o},crop:{position:"absolute",overflow:"hidden",height:x_(a.crop.height),width:x_(a.crop.width),top:x_(a.crop.top),left:x_(a.crop.left)},image:{position:"absolute",height:x_(a.image.height),width:x_(a.image.width),top:x_(a.image.top),left:x_(a.image.left)}}})({container:{aspectRatio:b||u},image:{aspectRatio:u},hotspot:o,crop:a,align:{x:t,y:n}}),[t,n,a,o,u,b]);return(0,rz.jsx)(xS,{className:"".concat(l),style:h,ref:g,children:(0,rz.jsxs)("div",{style:y.container,children:[(0,rz.jsx)("div",{style:y.padding}),(0,rz.jsx)("div",{style:y.crop,children:(0,rz.jsx)("img",{ref:x,src:c,alt:i,srcSet:p,onLoad:d,onError:s,style:y.image})})]})})}),xA={isLoading:!0},xP=["hotspot"],xI=[["3:4",3/4],["Square",1],["16:9",16/9],["Panorama",4]],xM={crop:xf,hotspot:xh},xz=lO.ZP.div(em||(em=d4(["\n  min-height: 6em;\n"])));function xR(e){return(0,rz.jsx)(rN.kC,{align:"center",justify:"center",padding:4,style:{overflowWrap:"break-word"},children:e.children})}function xF(e){let{imageUrl:t,value:n,changed:i,level:r,path:l,focusPath:a=cw,presence:o,onChange:s,schemaType:d,onPathFocus:c,readOnly:u,elementProps:p}=e,[h,f]=(0,rF.useState)(n||xM),{image:m,isLoading:g,error:x}=function(e){let[t,n]=(0,rF.useState)(xA);return(0,rF.useEffect)(()=>{n(xA);let t=new rQ.y(t=>{let n=document.createElement("img"),i=!1,r=()=>{i=!0,t.next(n),t.complete()},l=()=>{i=!0,t.error(Error("Could not load image from ".concat(e.startsWith("blob:")?"blob":e)))};return n.onload=r,n.onerror=l,n.src=e,()=>{n.onload=null,n.onerror=null,i||(n.src="data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs=")}}).subscribe({error:e=>{n({isLoading:!1,error:e})},next:e=>{n({image:e,isLoading:!1})}});return()=>{t.unsubscribe()}},[e]),t}(t),v=(0,rF.useCallback)(()=>{c(xP)},[c]);(0,rF.useEffect)(()=>{f(n||xM)},[n]);let b="hotspot"===a[0];ht(b,e=>{var t;!e&&b&&(null==(t=p.ref.current)||t.focus())});let y=(0,rF.useCallback)(e=>{if(u)return;let t=d.fields.find(e=>"crop"===e.name&&"object"!==e.type.name),n=d.fields.find(e=>"object"!==e.type.name&&"hotspot"===e.name),i=t?d6({_type:t.type.name},e.crop||xf):e.crop,r=n?d6({_type:n.type.name},e.hotspot||xh):e.hotspot;s([p4(i,["crop"]),p4(r,["hotspot"])])},[s,u,d.fields]);return(0,rz.jsx)(fx,{title:"Hotspot & crop",level:r,description:"Adjust the rectangle to crop image. Adjust the circle to specify the area that should always be visible.",__unstable_presence:o,children:(0,rz.jsxs)("div",{children:[(0,rz.jsx)(rN.Zb,{__unstable_checkered:!0,__unstable_focusRing:!0,tabIndex:0,ref:p.ref,onFocus:v,children:(0,rz.jsx)(cH,{path:l.concat(xP),hasFocus:"hotspot"===a[0],isChanged:i,children:(0,rz.jsxs)(g4,{ratio:1.5,children:[(g||x)&&(0,rz.jsx)(xR,{children:x?(0,rz.jsx)(rN.Zb,{padding:4,radius:2,tone:"critical",border:!0,children:(0,rz.jsxs)(rN.xv,{children:["Error: ",x.message]})}):(0,rz.jsx)(rN.xv,{muted:!0,children:"Loading image… "})}),!g&&m&&(0,rz.jsx)(rN.xu,{margin:1,children:(0,rz.jsx)(xj,{value:h,src:m.src,readOnly:Boolean(u),onChangeEnd:y,onChange:f})})]})})}),(0,rz.jsx)(rN.xu,{marginTop:3,children:(0,rz.jsx)(rN.rj,{columns:xI.length,gap:1,children:xI.map(e=>{let[t,n]=e;return(0,rz.jsxs)("div",{children:[(0,rz.jsx)(rN.X6,{as:"h4",size:0,children:t}),(0,rz.jsx)(rN.xu,{marginTop:2,children:(0,rz.jsx)(g4,{ratio:n,children:(0,rz.jsx)(rN.Zb,{__unstable_checkered:!0,children:!g&&m?(0,rz.jsx)(xT,{aspectRatio:n,src:m.src,srcAspectRatio:m.width/m.height,hotspot:h.hotspot||xh,crop:h.crop||xf}):(0,rz.jsx)(xz,{})})})})]},n)})})})]})})}let xO={portal:!0,constrainSize:!0},xD=(0,lO.ZP)(rN.gF)(eg||(eg=d4(["\n  position: absolute;\n  top: 0;\n  right: 0;\n"])));function xZ(e){let{onEdit:t,children:n,showEdit:i,setHotspotButtonElement:r,setMenuButtonElement:l}=e;return(0,rz.jsxs)(xD,{"data-buttons":!0,space:1,padding:2,children:[i&&(0,rz.jsx)(rN.zx,{"aria-label":"Open image edit dialog","data-testid":"options-menu-edit-details",icon:lL.Rf5,mode:"ghost",onClick:t,ref:r}),(0,rz.jsx)(rN.j2,{button:(0,rz.jsx)(rN.zx,{"aria-label":"Open image options menu","data-testid":"options-menu-button",icon:lL.zGg,mode:"ghost"}),id:"image-actions-menu",menu:(0,rz.jsx)(rN.v2,{children:n}),popover:xO,ref:l})]})}let xL=(0,lO.ZP)(rN.Zb)(ex||(ex=d4(["\n  position: relative;\n  width: 100%;\n  overflow: hidden;\n  min-height: 3.75rem;\n  max-height: 20rem;\n\n  & > div[data-container] {\n    top: 0;\n    left: 0;\n    width: 100%;\n    height: 100%;\n    display: flex !important;\n    align-items: center;\n    justify-content: center;\n  }\n\n  & img {\n    max-width: 100%;\n    max-height: 100%;\n  }\n"]))),xq=(0,lO.ZP)(rN.$j)(ev||(ev=d4(["\n  position: absolute;\n"]))),xN=(0,lO.ZP)(rN.kC)(e=>{let{tone:t,drag:n}=e,i=rN.Lg.color.light[t].card.enabled.fg,r=(0,rN.m4)(rN.Lg.color.light[t].card.enabled.bg,.8);return(0,lO.iv)(eb||(eb=d4(["\n      position: absolute;\n      top: 0;\n      left: 0;\n      right: 0;\n      bottom: 0;\n      backdrop-filter: ",";\n      color: ",";\n      background-color: ",";\n    "])),n?"blur(10px)":"",t?i:"",n?r:"transparent")}),xV=(0,lO.ZP)(rN.kC)(ey||(ey=d4(["\n  position: absolute;\n  top: 0;\n  left: 0;\n  bottom: 0;\n  right: 0;\n"]))),xB=e=>{let t=new URLSearchParams(e.split("?")[1]),n=t.get("rect");return n?[n.split(",")[2],n.split(",")[3]].map(Number):e.split("-")[1].split(".")[0].split("x").map(Number)};function xU(e){let{drag:t,readOnly:n,isRejected:i,src:r}=e,l=d3(e,sN),[a,o]=(0,rF.useState)(!1),[s,d]=(0,rF.useState)(null),c=(0,rN.XL)(s),u=(null==c?void 0:c.width)||0,p=30*document.documentElement.clientHeight/100,[h,f]=xB(r);(0,rF.useEffect)(()=>{o(!1)},[r]);let m=(0,rF.useCallback)(()=>{o(!0)},[]);return(0,rz.jsxs)(xL,d6(d6({},l),{},{ref:d,style:{height:(h>u?u/(h/f):f)<p?null:"".concat(30,"vh")},tone:"transparent",children:[(0,rz.jsxs)(rN.Zb,{"data-container":!0,tone:"inherit",children:[!a&&(0,rz.jsx)(x$,{cardTone:"transparent",drag:!0,content:(0,rz.jsx)(xq,{})}),(0,rz.jsx)("img",{src:r,"data-testid":"hotspot-image-input",alt:e.alt,onLoad:m,referrerPolicy:"strict-origin-when-cross-origin"})]}),t&&(0,rz.jsx)(x$,{cardTone:t?i||n?"critical":"primary":"default",drag:t,content:(0,rz.jsxs)(rz.Fragment,{children:[(0,rz.jsx)(rN.xu,{marginBottom:3,children:(0,rz.jsx)(rN.X6,{children:(0,rz.jsx)(xK,{isRejected:i,readOnly:n})})}),(0,rz.jsx)(xH,{isRejected:i,readOnly:n})]})})]}))}function xK(e){let{isRejected:t,readOnly:n}=e;return t?(0,rz.jsx)(lL.vaB,{}):n?(0,rz.jsx)(lL.CPA,{}):(0,rz.jsx)(lL.XBm,{})}function xH(e){let{isRejected:t,readOnly:n}=e,i="Drop image to upload";return t&&(i="Cannot upload this file here"),n&&(i="This field is read only"),(0,rz.jsx)(rN.xv,{size:1,children:i})}function x$(e){let{cardTone:t,drag:n,content:i}=e;return(0,rz.jsx)(xN,{justify:"flex-end",padding:3,tone:t,drag:n,children:(0,rz.jsx)(xV,{direction:"column",align:"center",justify:"center",children:i})})}let xX=(0,lO.ZP)(rN.zx)(ej||(ej=d4(["\n  width: 100%;\n"])));function xW(e){let{onClearValue:t}=e;return(0,rz.jsxs)(rN.Zb,{tone:"caution",padding:4,border:!0,radius:2,children:[(0,rz.jsxs)(rN.kC,{gap:4,marginBottom:4,children:[(0,rz.jsx)(rN.xu,{children:(0,rz.jsx)(rN.xv,{size:1,children:(0,rz.jsx)(lL.foC,{})})}),(0,rz.jsxs)(rN.Kq,{space:3,children:[(0,rz.jsx)(rN.xv,{size:1,weight:"semibold",children:"Invalid image value"}),(0,rz.jsx)(rN.xv,{size:1,children:"The value of this field is not a valid image. Resetting this field will let you choose a new image."})]})]}),(0,rz.jsx)(xX,{icon:lL.X5P,text:"Reset value",onClick:t,mode:"ghost"})]})}let xG=()=>"undefined"!=typeof window&&window.devicePixelRatio?Math.round(Math.max(1,window.devicePixelRatio)):1;function xY(e){let{children:t}=e;return t}let xJ=["asset"],xQ={portal:!0};class x0 extends rF.PureComponent{constructor(e){var t;super(e),t=this,this._assetElementRef=null,this.uploadSubscription=null,this.state={isUploading:!1,selectedAssetSource:null,hoveringFiles:[],isStale:!1,hotspotButtonElement:null,menuButtonElement:null},this.toast=null,this.setFocusElement=e=>{this._assetElementRef=e},this.setMenuButtonElement=e=>{this.setState({menuButtonElement:e})},this.setHotspotButtonElement=e=>{this.setState({hotspotButtonElement:e})},this.getUploadOptions=e=>{let{schemaType:t,resolveUploader:n}=this.props,i=n&&n(t,e);return i?[{type:t,uploader:i}]:[]},this.uploadWith=function(e,n){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},{schemaType:r,onChange:l,client:a}=t.props,{label:o,title:s,description:d,creditLine:c,source:u}=i,p={metadata:oC()(r,"options.metadata"),storeOriginalFilename:oC()(r,"options.storeOriginalFilename"),label:o,title:s,description:d,creditLine:c,source:u};t.cancelUpload(),t.setState({isUploading:!0}),l(p2({_type:r.name})),t.uploadSubscription=e.upload(a,n,r,p).subscribe({next:e=>{e.patches&&l(e.patches)},error:e=>{var n;console.error(e),null==(n=t.toast)||n.push({status:"error",description:"The upload could not be completed at this time.",title:"Upload failed"}),t.clearUploadStatus()},complete:()=>{l([p5(["hotspot"]),p5(["crop"])]),t.setState({isUploading:!1})}})},this.handleRemoveButtonClick=()=>{let{value:e}=this.props,t=Object.keys(e||{}),n=t.filter(e=>!["_type","_key","_upload","asset","crop","hotspot"].includes(e)),i=0===n.length,r=["asset"].concat(t.filter(e=>["crop","hotspot","_upload"].includes(e))).map(e=>p5([e]));this.props.onChange(i&&!this.valueIsArrayElement()?p5():r)},this.handleFieldChange=e=>{let{onChange:t,schemaType:n}=this.props;if(!this.valueIsArrayElement()&&this.eventIsUnsettingLastFilledField(e)){t(p5());return}t(e.prepend(p2({_type:n.name})).patches)},this.eventIsUnsettingLastFilledField=e=>{let t=e.patches[0];if(1!==e.patches.length||"unset"!==t.type)return!1;let n=Object.keys(this.props.value||{}),i=n.filter(e=>!["_type","_key","crop","hotspot"].includes(e)),r=1===e.patches[0].path.length&&1===i.length&&i[0]===e.patches[0].path[0];return r},this.valueIsArrayElement=()=>{let{path:e}=this.props,t=e.slice(-1)[0];return"string"!=typeof t},this.handleOpenDialog=()=>{let{onFieldOpen:e}=this.props;e("hotspot")},this.handleCloseDialog=()=>{var e;let{onFieldClose:t}=this.props;t("hotspot"),null==(e=this.state.hotspotButtonElement)||e.focus()},this.handleSelectAssetFromSource=e=>{let{onChange:t,schemaType:n,resolveUploader:i}=this.props;gD({assetFromSource:e,onChange:t,type:n,resolveUploader:i,uploadWith:this.uploadWith,isImage:!0}),this.setState({selectedAssetSource:null})},this.handleFilesOver=e=>{this.setState({hoveringFiles:e})},this.handleFilesOut=()=>{this.setState({hoveringFiles:[]})},this.handleCancelUpload=()=>{this.cancelUpload()},this.handleClearUploadState=()=>{this.setState({isStale:!1}),this.clearUploadStatus()},this.handleStaleUpload=()=>{this.setState({isStale:!0})},this.handleClearField=()=>{this.props.onChange([p5(["asset"]),p5(["crop"]),p5(["hotspot"])])},this.handleSelectFiles=e=>{let{directUploads:t,readOnly:n}=this.props,{hoveringFiles:i}=this.state;t&&!n?this.uploadFirstAccepted(e):i.length>0&&this.handleFilesOut()},this.handleSelectImageFromAssetSource=e=>{this.setState({selectedAssetSource:e})},this.handleAssetSourceClosed=()=>{var e;this.setState({selectedAssetSource:null}),null==(e=this.state.menuButtonElement)||e.focus()},this.renderHotspotInput=e=>{let{value:t,changed:n,id:i,imageUrlBuilder:r}=this.props,l=this.isImageToolEnabled()&&t&&t.asset;return(0,rz.jsx)(rN.Vq,{header:"Edit hotspot and crop",id:"".concat(i,"_dialog"),onClose:this.handleCloseDialog,width:1,__unstable_autoFocus:!1,children:(0,rz.jsx)(fo,{children:(0,rz.jsx)(rN.xu,{padding:4,children:(0,rz.jsx)(rN.Kq,{space:5,children:l&&(null==t?void 0:t.asset)&&(0,rz.jsx)(xF,d6(d6({},this.props),{},{imageUrl:r.image(t.asset).url(),value:t,presence:e.presence,changed:n}))})})})})},this.renderPreview=()=>{let{value:e,schemaType:t,readOnly:n,directUploads:i,imageUrlBuilder:r,resolveUploader:l}=this.props;if(!e||!(0,aj.JZ)(e))return null;let{hoveringFiles:a}=this.state,o=a.filter(e=>l(t,e)),s=a.length-o.length,d=r.width(2e3).fit("max").image(e).dpr(xG()).auto("format").url();return(0,rz.jsx)(xU,{drag:!(null==e?void 0:e._upload)&&a.length>0,isRejected:s>0||!i,readOnly:n,src:d,alt:"Preview of uploaded image"})},this.setToast=e=>{this.toast=e},this._assetPath=e.path.concat(xJ)}focus(){this._assetElementRef&&this._assetElementRef.focus()}isImageToolEnabled(){return!0===oC()(this.props.schemaType,"options.hotspot")}clearUploadStatus(){var e;(null==(e=this.props.value)?void 0:e._upload)&&this.props.onChange(p5(["_upload"]))}cancelUpload(){this.uploadSubscription&&(this.uploadSubscription.unsubscribe(),this.clearUploadStatus())}uploadFirstAccepted(e){let{schemaType:t,resolveUploader:n}=this.props,i=e.map(e=>({file:e,uploader:n(t,e)})).find(e=>e.uploader);i&&this.uploadWith(i.uploader,i.file)}renderAssetMenu(){let{value:e,assetSources:t,schemaType:n,readOnly:i,directUploads:r,imageUrlBuilder:l,observeAsset:a}=this.props,o=null==e?void 0:e.asset;if(!o)return null;let s=oC()(n,"options.accept","image/*"),d=e&&o&&this.isImageToolEnabled(),c=t&&0===t.length?null:(0,rz.jsx)(rN.sN,{icon:lL.W1M,text:"Select",onClick:()=>{this.handleSelectImageFromAssetSource(t[0])},disabled:i,"data-testid":"file-input-browse-button"});return t&&t.length>1&&(c=t.map(e=>(0,rz.jsx)(rN.sN,{text:e.title,onClick:()=>{this.handleSelectImageFromAssetSource(e)},icon:e.icon||lL.XBm,"data-testid":"file-input-browse-button-".concat(e.name),disabled:i},e.name))),(0,rz.jsx)(gj,{observeAsset:a,reference:o,children:t=>{let n,a,{_id:o,originalFilename:u,extension:p}=t;return(0,aj.JZ)(e)&&(a=l.image(o).forceDownload(u||"download.".concat(p)).url(),n=l.image(o).url()),(0,rz.jsx)(xZ,{onEdit:this.handleOpenDialog,showEdit:d,setHotspotButtonElement:this.setHotspotButtonElement,setMenuButtonElement:this.setMenuButtonElement,children:(0,rz.jsx)(gq,{onUpload:this.handleSelectFiles,browse:c,onReset:this.handleRemoveButtonClick,downloadUrl:a,copyUrl:n,readOnly:i,directUploads:r,accept:s})})}})}renderBrowser(){let{assetSources:e,readOnly:t,directUploads:n,id:i}=this.props;return e&&0===e.length?null:e&&e.length>1&&!t&&n?(0,rz.jsx)(rN.j2,{id:"".concat(i,"_assetImageButton"),button:(0,rz.jsx)(rN.zx,{mode:"ghost",text:"Select","data-testid":"file-input-multi-browse-button",icon:lL.W1M,iconRight:lL.v4q}),menu:(0,rz.jsx)(rN.v2,{children:e.map(e=>(0,rz.jsx)(rN.sN,{text:e.title,onClick:()=>{this.handleSelectImageFromAssetSource(e)},icon:e.icon||lL.XBm,disabled:t,"data-testid":"file-input-browse-button-".concat(e.name)},e.name))}),popover:xQ}):(0,rz.jsx)(rN.zx,{fontSize:2,text:"Select",icon:lL.W1M,mode:"ghost",onClick:()=>{this.handleSelectImageFromAssetSource(e[0])},"data-testid":"file-input-browse-button",disabled:t})}renderUploadPlaceholder(){let{schemaType:e,readOnly:t,directUploads:n,resolveUploader:i}=this.props,{hoveringFiles:r}=this.state,l=r.filter(t=>i(e,t)),a=r.length-l.length,o=oC()(e,"options.accept","image/*");return(0,rz.jsx)("div",{style:{padding:1},children:(0,rz.jsx)(rN.Zb,{tone:t?"transparent":"inherit",border:!0,padding:3,style:0===r.length?{borderStyle:"dashed"}:{borderStyle:"dashed",borderColor:"transparent"},children:(0,rz.jsx)(gK,{browse:this.renderBrowser(),onUpload:this.handleSelectFiles,readOnly:t,hoveringFiles:r,acceptedFiles:l,rejectedFilesCount:a,type:"image",accept:o,directUploads:n})})})}renderUploadState(e){var t;let{isUploading:n}=this.state,i=null==(t=this._assetElementRef)?void 0:t.offsetHeight;return(0,rz.jsx)(gF,{uploadState:e,onCancel:n?this.handleCancelUpload:void 0,onStale:this.handleStaleUpload,height:0===i?void 0:i})}renderAssetSource(){let{selectedAssetSource:e}=this.state,{value:t,observeAsset:n}=this.props;if(!e)return null;let i=e.component;return t&&t.asset?(0,rz.jsx)(gj,{observeAsset:n,reference:t.asset,children:e=>(0,rz.jsx)(i,{selectedAssets:[e],assetType:"image",selectionType:"single",onClose:this.handleAssetSourceClosed,onSelect:this.handleSelectAssetFromSource})}):(0,rz.jsx)(i,{selectedAssets:[],selectionType:"single",assetType:"image",onClose:this.handleAssetSourceClosed,onSelect:this.handleSelectAssetFromSource})}getFileTone(){let{schemaType:e,value:t,readOnly:n,directUploads:i,resolveUploader:r}=this.props,{hoveringFiles:l}=this.state,a=l.filter(t=>r(e,t)),o=l.length-a.length;return l.length>0&&(o>0||!i)?"critical":(null==t?void 0:t._upload)||n||!(l.length>0)?n?"transparent":(null==t?void 0:t._upload)&&(null==t?void 0:t.asset)?"transparent":"default":"primary"}renderAsset(){let{value:e,readOnly:t,elementProps:n}=this.props,{hoveringFiles:i,isStale:r}=this.state,l=Boolean((null==e?void 0:e._upload)||(null==e?void 0:e.asset));return!e||void 0===e.asset||(null==e?void 0:e._upload)||(0,aj.JZ)(e)?a=>(0,rz.jsxs)(rz.Fragment,{children:[r&&(0,rz.jsx)(rN.xu,{marginBottom:2,children:(0,rz.jsx)(g$,{onClearStale:this.handleClearUploadState})}),(0,rz.jsxs)(cH,{path:a.path.concat(xJ),hasFocus:!!a.focused,isChanged:a.changed,children:[!(null==e?void 0:e._upload)&&(0,rz.jsxs)(gA,d6(d6({},n),{},{tabIndex:0,disabled:Boolean(t),ref:this.setFocusElement,onFiles:this.handleSelectFiles,onFilesOver:this.handleFilesOver,onFilesOut:this.handleFilesOut,tone:this.getFileTone(),$border:l||i.length>0,style:{padding:1},sizing:"border",radius:2,children:[!(null==e?void 0:e.asset)&&this.renderUploadPlaceholder(),!(null==e?void 0:e._upload)&&(null==e?void 0:e.asset)&&(0,rz.jsxs)("div",{style:{position:"relative"},children:[this.renderPreview(),this.renderAssetMenu()]})]})),(null==e?void 0:e._upload)&&this.renderUploadState(e._upload)]})]}):()=>(0,rz.jsx)(xW,{onClearValue:this.handleClearField})}render(){let{members:e,renderInput:t,renderField:n,renderItem:i,renderPreview:r}=this.props,{selectedAssetSource:l}=this.state,a=e.find(e=>"field"===e.kind&&"hotspot"===e.name);return(0,rz.jsxs)(rN.Kq,{space:5,"data-testid":"image-input",children:[(0,rz.jsx)(Fx,{ref:this.setToast}),e.map(e=>"field"===e.kind&&("crop"===e.name||"hotspot"===e.name)?null:"field"===e.kind?(0,rz.jsx)(mO,{member:e,renderInput:"asset"===e.name?this.renderAsset():t,renderField:"asset"===e.name?xY:n,renderItem:i,renderPreview:r},e.key):"fieldSet"===e.kind?(0,rz.jsx)(mY,{member:e,renderInput:t,renderField:n,renderItem:i,renderPreview:r},e.key):"error"===e.kind?(0,rz.jsx)(mG,{member:e},e.key):(0,rz.jsxs)(rz.Fragment,{children:["Unknown member kind: $",e.kind]})),(null==a?void 0:a.open)&&(0,rz.jsx)(m8,d6(d6({},this.props),{},{absolutePath:a.field.path,renderInput:this.renderHotspotInput})),l&&this.renderAssetSource()]})}}let x1=()=>{},x2={isLoading:!0,result:void 0,error:void 0,retry:x1},x3={isLoading:!1,result:void 0,error:void 0,retry:x1};function x4(e,t){let[n,i]=(0,rF.useState)(0),r=(0,rF.useCallback)(()=>{i(e=>e+1)},[]),l=(0,rV.m2)(()=>e._id?t(e).pipe((0,r8.U)(e=>({isLoading:!1,result:e,error:void 0,retry:r})),(0,li.O)(x2),(0,le.K)(e=>(console.error(e),(0,rB.of)({isLoading:!1,result:void 0,error:e,retry:r})))):(0,rB.of)(x3),[n,t,null==e?void 0:e._id,null==e?void 0:e._type,r],x2),a=he(e._id,e._id);return a!==e._id?x2:l}let x5=(0,lO.ZP)(rN.kC)(ew||(ew=d4(["\n  /* this is a hack to avoid layout jumps while previews are loading\n  or the message is not tall enough to fill the card\n  there's probably better ways of solving this */\n  min-height: 36px;\n"]))),x6=(0,lO.ZP)(rN.kC)(ek||(ek=d4(["\n  /* This limits the width of the tooltip content */\n  max-width: 250px;\n"])));function x8(e){return(0,rz.jsx)(x6,{padding:3,children:(0,rz.jsx)(rN.xu,{flex:1,children:(0,rz.jsx)(rN.xu,{children:(0,rz.jsx)(rN.xv,{as:"p",size:1,children:e.children})})})})}function x7(e){var t,n,i;let{refType:r,showStudioUrlIcon:l,hasStudioUrl:a,showTypeLabel:o,availability:s,preview:d,id:c,dataset:u,projectId:p}=e,h=(null==s?void 0:s.reason)==="NOT_FOUND",f=(null==s?void 0:s.reason)==="PERMISSION_DENIED",m=null==(t=d.published)?void 0:t.media,g=(0,rF.useMemo)(()=>{if(m){let e=void 0!==(null==m?void 0:m.asset)&&(0,aj.JZ)(m),t=rF.isValidElement(m);return e||t?function(e){let{dimensions:n}=e;return t?m:(0,rz.jsx)("img",{src:ay()({dataset:u,projectId:p}).image(m).withOptions(n).url(),alt:"Image preview of referenced document",referrerPolicy:"strict-origin-when-cross-origin"})}:null}return(null==r?void 0:r.icon)?(0,rF.createElement)(r.icon):null},[m,u,p,null==r?void 0:r.icon]);return(0,rz.jsxs)(x5,{align:"center",justify:"center",flex:1,"data-testid":"preview",children:[(null==s?void 0:s.available)?(0,rz.jsx)(rN.xu,{flex:1,children:(0,rz.jsx)(RH,{title:null==(n=d.published)?void 0:n.title,subtitle:null==(i=d.published)?void 0:i.subtitle,media:g||!1})}):(0,rz.jsx)(rN.xu,{flex:1,children:(0,rz.jsx)(rN.kC,{align:"center",children:(0,rz.jsx)(rN.xu,{flex:1,paddingY:2,children:(0,rz.jsx)(rN.xv,{muted:!0,children:"Document unavailable"})})})}),(0,rz.jsx)(rN.xu,{paddingLeft:3,children:(0,rz.jsxs)(rN.gF,{space:4,children:[r&&o&&(0,rz.jsx)(rN.__,{size:1,muted:!0,children:r.title||r.type}),(f||h)&&(0,rz.jsx)(rN.xu,{children:(0,rz.jsx)(rN.u,{portal:!0,content:h?(0,rz.jsxs)(x8,{children:["The referenced document no longer exist and might have been deleted.",(0,rz.jsx)("br",{}),"(id: ",(0,rz.jsx)("code",{children:c}),")"]}):(0,rz.jsx)(x8,{children:"The referenced document could not be accessed due to insufficient permissions"}),children:(0,rz.jsx)(uc,{tone:"default",children:f?(0,rz.jsx)(lL.vaB,{}):(0,rz.jsx)(lL.BHU,{})})})}),!(h||f)&&l&&(0,rz.jsx)(rN.xu,{children:(0,rz.jsx)(rN.u,{portal:!0,content:(0,rz.jsx)(x6,{padding:2,children:a?(0,rz.jsx)(rN.xv,{size:1,children:"This document opens in another Studio"}):(0,rz.jsxs)(rN.xv,{size:1,children:["This document cannot be opened ",(0,rz.jsx)("br",{})," (unable to resolve URL to Studio)"]})}),children:(0,rz.jsx)(uc,{size:1,tone:"default",muted:!a,children:(0,rz.jsx)(lL.buG,{})})})})]})})]})}function x9(){let e=IW(uX);return e.config().projectId}function ve(e){var t;let{isLoading:n,result:i,error:r}=x4(e.document,e.getReferenceInfo),l=x9();if(n)return(0,rz.jsxs)(rN.Kq,{space:2,padding:1,children:[(0,rz.jsx)(rN.Qr,{style:{maxWidth:320},radius:1,animated:!0}),(0,rz.jsx)(rN.Qr,{style:{maxWidth:200},radius:1,size:1,animated:!0})]});if(r)return(0,rz.jsx)(rN.Kq,{space:2,padding:1,children:(0,rz.jsxs)(p9,{title:"Failed to load referenced document",children:["Error: ",r.message]})});if(!i)return null;if((null==(t=i.availability)?void 0:t.reason)==="PERMISSION_DENIED")return(0,rz.jsx)(rN.Kq,{space:2,padding:1,children:"Insufficient permissions to view this document"});let a=e.referenceType.to.find(e=>e.type===i.type);return a?i&&a&&(0,rz.jsx)(x7,{id:i.id,availability:i.availability,preview:i.preview,refType:a,dataset:e.referenceType.dataset,projectId:l,showTypeLabel:e.referenceType.to.length>1}):(0,rz.jsxs)(rN.Kq,{space:2,padding:1,children:["Search returned a type that's not valid for this reference: \"$",i.type,'"']})}function vt(e){var t,n;let{value:i,type:r,showStudioUrlIcon:l,hasStudioUrl:a,referenceInfo:o}=e,s=x9();if(o.isLoading||o.error)return(0,rz.jsxs)(rN.Kq,{space:2,padding:1,children:[(0,rz.jsx)(rN.Qr,{style:{maxWidth:320},radius:1,animated:!o.error}),(0,rz.jsx)(rN.Qr,{style:{maxWidth:200},radius:1,size:1,animated:!o.error})]});let d=r.to.length>1,c=null==(t=o.result)?void 0:t.type,u=r.to.find(e=>e.type===c);return(null==(n=o.result.availability)?void 0:n.available)&&!u?(0,rz.jsx)(rN.Kq,{space:2,padding:2,children:(0,rz.jsxs)(rN.xv,{as:"p",children:["The referenced document is of invalid type: (",c||"unknown",")",(0,rz.jsx)("pre",{children:JSON.stringify(i,null,2)})]})}):(0,rz.jsx)(x7,{availability:o.result.availability,hasStudioUrl:a,showStudioUrlIcon:l,preview:o.result.preview,refType:u,projectId:s,dataset:r.dataset,id:i._ref,showTypeLabel:d})}let vn=(0,lO.ZP)(rN.J2)(eC||(eC=d4(["\n  & > div {\n    overflow: auto;\n    -webkit-overflow-scrolling: touch;\n  }\n"]))),vi=(0,lO.ZP)(rN.xv)(e_||(e_=d4(["\n  word-break: break-word;\n"]))),vr=(0,rF.forwardRef)(function(e,t){let n=e.options&&e.options.length>0,i=(0,rF.useCallback)((t,i)=>{let{content:r,hidden:l,inputElement:a,onMouseEnter:o,onMouseLeave:s}=t;return(0,rz.jsx)(vn,{"data-testid":"autocomplete-popover",placement:"bottom-start",arrow:!1,constrainSize:!0,onMouseEnter:o,onMouseLeave:s,content:(0,rz.jsx)("div",{ref:i,children:n?r:(0,rz.jsx)(rN.xu,{padding:4,children:(0,rz.jsx)(rN.kC,{align:"center",height:"fill",justify:"center",children:(0,rz.jsxs)(vi,{align:"center",muted:!0,children:["No results for ",(0,rz.jsxs)("strong",{children:["“",e.searchString,"”"]})]})})})}),open:!e.loading&&!l,ref:e.portalRef,portal:!0,referenceElement:e.referenceElement||a,matchReferenceWidth:!0})},[n,e.searchString,e.loading,e.portalRef,e.referenceElement]);return(0,rz.jsx)(rN.F2,d6(d6({},e),{},{ref:t,renderPopover:i}))}),vl=(0,lO.ZP)(rN.zx)(eS||(eS=d4(["\n  width: 100%;\n"])));function va(e){let{value:t,onClearValue:n}=e,i=(0,rF.useMemo)(()=>Boolean(null==t?void 0:t._ref),[null==t?void 0:t._ref]);return(0,rz.jsxs)(rN.Zb,{tone:"caution",padding:4,border:!0,radius:2,"data-testid":"alert-cross-dataset-reference-feature-disabled",children:[(0,rz.jsxs)(rN.kC,{gap:4,marginBottom:i?4:void 0,children:[(0,rz.jsx)(rN.xu,{children:(0,rz.jsx)(rN.xv,{size:1,children:(0,rz.jsx)(lL.foC,{})})}),(0,rz.jsxs)(rN.Kq,{space:3,children:[(0,rz.jsx)(rN.xv,{as:"h2",size:1,weight:"semibold",children:"Unavailable feature: Cross dataset reference"}),i&&(0,rz.jsxs)(rN.Kq,{space:3,children:[(0,rz.jsxs)(rN.xv,{as:"p",size:1,children:["This feature has been disabled. Read how to enable it in"," ",(0,rz.jsx)("a",{href:"https://www.sanity.io/docs/cross-dataset-references",target:"_blank",rel:"noreferrer",children:"documentation"})]}),(0,rz.jsx)(rN.xv,{as:"p",size:1,children:"You can still clear this field's existing reference, but that cannot be revoked as long as the feature is disabled."})]}),!i&&(0,rz.jsxs)(rN.xv,{as:"p",size:1,children:["Read how to enable it in"," ",(0,rz.jsx)("a",{href:"https://www.sanity.io/docs/cross-dataset-references",target:"_blank",rel:"noreferrer",children:"documentation"})]})]})]}),n&&i&&(0,rz.jsx)(vl,{icon:lL.X5P,text:"Reset value",onClick:n,mode:"ghost"})]})}let vo={isLoading:!0,enabled:!0,features:[]},vs={hits:[],isLoading:!1},vd=()=>!0,vc=["_ref"];function vu(e){var t,n,r,l,a;let{changed:o,focused:s,focusPath:d,getReferenceInfo:c,onChange:u,onPathFocus:p,onSearch:h,path:f,readOnly:m,schemaType:g,validation:x,value:v,elementProps:b}=e,y=x9(),[j,w]=(0,rF.useState)(vs),k=(0,rF.useCallback)(e=>{if(!e){u(p5()),p([]);return}let t=j.hits.find(t=>t.id===e);if(!t)throw Error("Selected an item that wasnt part of the result set");u(p4({_type:g.name,_ref:cb(e),_projectId:y,_dataset:g.dataset,_weak:g.weak,_key:null==v?void 0:v._key})),p([])},[null==v?void 0:v._key,j.hits,g.name,g.dataset,g.weak,y,u,p]),C=(0,rF.useCallback)(()=>{u(p5())},[u]),_=(0,rF.useCallback)(e=>{27===e.keyCode&&(null==p||p([]))},[p]),S=(0,rF.useCallback)(e=>c(e,g),[c,g]),E=(0,rF.useMemo)(()=>({_id:null==v?void 0:v._ref}),[null==v?void 0:v._ref]),T=x4(E,S),A=function(e){let t=IW(uX);i||(i=(function(e){let{versionedClient:t}=e;return t.observable.request({uri:"/features",tag:"features"})})({versionedClient:t}).pipe((0,ln.d)()));let n=(0,rV.m2)(()=>i.pipe((0,r8.U)(function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return{isLoading:!1,enabled:Boolean(null==t?void 0:t.includes(e)),features:t}}),(0,li.O)(vo),(0,le.K)(e=>(console.error(e),(0,rB.of)({isLoading:!1,enabled:!0,features:[]})))),[e],vo);return n}("crossDatasetReferences"),P=(0,rF.useRef)(null),I=1===d.length&&"_ref"===d[0],M=b.ref;ht({hasFocusAt:I,ref:null==v?void 0:v._ref},(e,t)=>{var n;let i=(null==e?void 0:e.ref)!==t.ref,r=(null==e?void 0:e.hasFocusAt)!==t.hasFocusAt;(r||i)&&t.hasFocusAt&&(null==(n=M.current)||n.focus())});let z=(null==v?void 0:v._weak)?"weak":"strong",R=!0===g.weak?"weak":"strong",F=Boolean(null==v?void 0:v._ref),O=(0,rF.useCallback)(()=>{u(!0===g.weak?p4(!0,["_weak"]):p5(["_weak"]))},[u,g]),{push:D}=(0,rN.pm)(),Z=(0,rF.useMemo)(()=>x.filter(e=>"error"===e.level),[x]),L=(0,rF.useCallback)(e=>{e.currentTarget===b.ref.current&&(null==p||p([rR.Zg]))},[b.ref,p]),q=(0,rF.useCallback)(e=>{e.currentTarget===b.ref.current&&(null==p||p(vc))},[b.ref,p]),N=(0,rF.useCallback)(()=>{null==p||p(vc)},[p]),V=(0,rF.useId)(),B=(0,rV.W2)(e=>e.pipe((0,lt.h)(cf),(0,r9.x)(),(0,r6.w)(e=>(0,rU.z)((0,rB.of)({isLoading:!0}),h(e).pipe((0,r8.U)(t=>({hits:t,searchString:e,isLoading:!1})),(0,le.K)(e=>(D({title:"Reference search failed",description:e.message,status:"error",id:"reference-search-fail-".concat(V)}),console.error(e),(0,rB.of)({hits:[]})))))),(0,r7.R)((e,t)=>d6(d6({},e),t),vs),(0,lr.b)(w)),[V,D]),U=(0,rF.useCallback)(()=>{B("")},[B]),K=!T.isLoading&&F&&z!==R,H=(null==v?void 0:v._ref)&&(null==(n=g.studioUrl)?void 0:n.call(g,{id:null==v?void 0:v._ref,type:null==(t=null==T?void 0:T.result)?void 0:t.type}))||null,$=(0,rF.useCallback)(e=>(0,rz.jsx)(us,{as:"button",type:"button",radius:2,children:(0,rz.jsx)(rN.xu,{paddingX:3,paddingY:1,children:(0,rz.jsx)(ve,{referenceType:g,document:e.hit.published,getReferenceInfo:S})})}),[g,S]),X=null==(r=T.result)?void 0:r.preview.published,W=I||!(null==v?void 0:v._ref),G=(0,rF.useRef)(null),Y=(0,rF.useRef)(null),J=(0,rF.useRef)(null);return l=[G,Y,J],a=()=>{I&&p([])},(0,rF.useEffect)(()=>{let e=e=>{let t=e.target;if(t instanceof HTMLElement){if(l.some(e=>{var n;return null==(n=e.current)?void 0:n.contains(t)}))return;a(e)}};return document.addEventListener("mousedown",e),document.addEventListener("touchstart",e),()=>{document.removeEventListener("mousedown",e),document.removeEventListener("touchstart",e)}},[l,a]),(0,rz.jsxs)(rz.Fragment,{children:[!A.isLoading&&!A.enabled&&(0,rz.jsx)(va,{value:v,onClearValue:C}),(A.isLoading||A.enabled)&&(0,rz.jsx)(rN.Kq,{space:1,children:W?(0,rz.jsx)(rN.Kq,{space:2,ref:G,children:(0,rz.jsx)(cH,{path:f,isChanged:o,hasFocus:!!s,children:(0,rz.jsx)("div",{ref:P,children:(0,rz.jsx)(vr,d6(d6({},b),{},{"data-testid":"autocomplete",loading:j.isLoading,referenceElement:P.current,portalRef:Y,id:V||"",options:j.hits.map(e=>({value:e.id,hit:e})),onFocus:q,radius:1,placeholder:"Type to search",onKeyDown:_,readOnly:m,disabled:T.isLoading,onQueryChange:B,searchString:j.searchString,onChange:k,filterOption:vd,renderOption:$,openButton:{onClick:U}}))})})}):(0,rz.jsx)(cH,{path:f,isChanged:o,hasFocus:!!s,children:(0,rz.jsxs)(rN.Zb,{padding:0,border:!0,flex:1,radius:1,tone:m?"transparent":T.error||Z.length>0?"critical":"default",children:[(0,rz.jsxs)(rN.kC,{align:"center",padding:1,children:[H?(0,rz.jsx)(us,{as:"a",target:"_blank",rel:"noopener noreferrer",href:H,"data-as":"a",flex:1,padding:1,paddingRight:3,radius:2,tone:"inherit",__unstable_focusRing:!0,tabIndex:0,onFocus:L,ref:b.ref,children:(0,rz.jsx)(vt,{value:v,referenceInfo:T,showStudioUrlIcon:!0,hasStudioUrl:!!H,type:g})}):(0,rz.jsx)(us,{flex:1,padding:1,paddingRight:3,radius:2,tone:"inherit",__unstable_focusRing:!0,tabIndex:0,onFocus:L,ref:b.ref,children:(0,rz.jsx)(vt,{value:v,referenceInfo:T,showStudioUrlIcon:!0,type:g})}),(0,rz.jsx)(rN.gF,{paddingX:1,children:(0,rz.jsx)(rN.j2,{button:(0,rz.jsx)(rN.zx,{padding:2,mode:"bleed",icon:lL.zGg,"data-testid":"menu-button"}),id:"".concat(V,"-menuButton"),menu:(0,rz.jsx)(rN.v2,{children:!m&&(0,rz.jsxs)(rz.Fragment,{children:[(0,rz.jsx)(rN.sN,{text:"Clear",tone:"critical",icon:lL.X5P,"data-testid":"menu-item-clear",onClick:C}),(0,rz.jsx)(rN.sN,{text:"Replace",icon:lL.bnu,"data-testid":"menu-item-replace",onClick:N})]})}),placement:"right",popover:{portal:!0,tone:"default"}})})]}),K&&(0,rz.jsx)(fY,{padding:1,title:"Reference strength mismatch",status:"warning","data-testid":"alert-reference-strength-mismatch",children:(0,rz.jsxs)(rN.Kq,{space:3,children:[(0,rz.jsxs)(rN.xv,{as:"p",muted:!0,size:1,children:["This reference is ",(0,rz.jsx)("em",{children:z}),", but according to the current schema it should be ",(0,rz.jsxs)("em",{children:[R,"."]})]}),(0,rz.jsx)(rN.xv,{as:"p",muted:!0,size:1,children:g.weak?(0,rz.jsxs)(rz.Fragment,{children:['It will not be possible to delete the "',null==X?void 0:X.title,'"-document without first removing this reference.']}):(0,rz.jsxs)(rz.Fragment,{children:['This makes it possible to delete the "',null==X?void 0:X.title,'"-document without first deleting this reference, leaving this field referencing a nonexisting document.']})}),(0,rz.jsx)(rN.zx,{onClick:O,text:(0,rz.jsxs)(rz.Fragment,{children:["Convert to ",R," reference"]}),tone:"caution"})]})}),T.error&&(0,rz.jsx)(fY,{padding:1,title:"Unable to load reference metadata",status:"warning","data-testid":"alert-reference-info-failed",children:(0,rz.jsxs)(rN.Kq,{space:3,children:[(0,rz.jsxs)(rN.xv,{as:"p",muted:!0,size:1,children:["Error: ",T.error.message]}),(0,rz.jsx)(rN.zx,{onClick:T.retry,text:(0,rz.jsx)(rz.Fragment,{children:"Retry"}),tone:"primary"})]})})]})})})]})}let vp=(0,rF.createContext)(null);function vh(){let e=(0,rF.useContext)(vp);if(!e)throw Error("UserColorManager: missing context value");return e}let vf=["green","red","gray"],vm=aT.mE.filter(e=>!vf.includes(e)),vg=e=>{let t="dark"===e;return{background:t?"900":"100",border:t?"700":"300",text:t?"200":"700"}},vx=e=>{let{background:t,border:n,text:i}=vg(e);return vm.reduce((e,r)=>(e[r]={name:r,background:aT.VG[r][t].hex,border:aT.VG[r][n].hex,text:aT.VG[r][i].hex,tints:aT.VG[r]},e),{})},vv=e=>{let{background:t,border:n,text:i}=vg(e);return{name:"gray",background:aT.VG.gray[t].hex,border:aT.VG.gray[n].hex,text:aT.VG.gray[i].hex,tints:aT.VG.gray}};function vb(e){let{children:t,manager:n}=e,{scheme:i}=E8(),r=(0,rF.useMemo)(()=>n||function(e){let t;let{anonymousColor:n,colors:i,currentUserColor:r,scheme:l}=e,a=i||vx(l),o=n||vv(l),s=r||"purple";if(!a.hasOwnProperty(s))throw Error("'colors' must contain 'currentUserColor' (".concat(s,")"));let d=Object.keys(a),c=new Map,u=new Map,p=d.reduce((e,t)=>(e[t]=0,e),{}),h=new Map;return(null==e?void 0:e.userStore)&&e.userStore.me.subscribe(e=>{var n;t=n=e?e.id:null,p[s]+=n?1:-1}),{get:function(e){return e?a[f(e)]:o},listen:function(e){let t=c.get(e);if(t)return t;let n=f(e);return t=new rQ.y(t=>{let i=a[n];return t.next(i),()=>{c.delete(e),h.delete(e),p[n]--}}).pipe((0,ln.d)({refCount:!0})),c.set(e,t),t}};function f(e){let n,i;if(e===t)return s;let r=h.get(e);if(r)return r;let l=u.get(e);if(l&&(0===p[l]||!Boolean(d.find(e=>0===p[e]))))return m(e,l);let a=function(e){let t=0;for(let n=0;n<e.length;n++)t=(t<<5)-t+e.charCodeAt(n)|0;return d[Math.abs(t)%d.length]}(e);return 0===p[a]?m(e,a):m(e,(n=1/0,i=[],d.forEach(e=>{let t=p[e];t===n?i.push(e):t<n&&(n=t,i=[e])}),l&&i.includes(l)?l:i[0]))}function m(e,t){return h.set(e,t),u.set(e,t),p[t]++,t}}({scheme:i}),[n,i]);return(0,rz.jsx)(vp.Provider,{value:r,children:t})}let vy=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,vj=/_key\s*==\s*['"](.*)['"]/;function vw(e){if(!Array.isArray(e))throw Error("Path is not an array");return e.reduce((e,t,n)=>{let i=typeof t;if("number"===i)return"".concat(e,"[").concat(t,"]");if("string"===i)return"".concat(e).concat(0===n?"":".").concat(t);if((0,rM.Fd)(t)&&t._key)return"".concat(e,'[_key=="').concat(t._key,'"]');if(Array.isArray(t)){let[r,l]=t;return"".concat(e,"[").concat(r,":").concat(l,"]")}throw Error("Unsupported path segment `".concat(JSON.stringify(t),"`"))},"")}function vk(e,t){let n=t[0];if(!n)return e;let i=t.slice(1);if((0,rM.dw)(n))return vk(Array.isArray(e)?e[n]:void 0,i);if((0,rM.Fd)(n))return vk(Array.isArray(e)?e.find(e=>e._key===n._key):void 0,i);if("string"==typeof n)return vk(cC(e)?e[n]:void 0,i);throw Error("Unknown segment type ".concat(JSON.stringify(n)))}function vC(e){return(0,rM.dw)(e)?Number(e.replace(/[^\d]/g,"")):(0,rM.Fd)(e)?function(e){let t=e.match(vj);if(!t)throw Error("Invalid key segment");return{_key:t[1]}}(e):(0,rM.lo)(e)?function(e){let[t,n]=e.split(":").map(e=>""===e?e:Number(e));return[t,n]}(e):e}function v_(e,t){return e.length===t.length&&e.every((e,n)=>{let i=t[n];return(0,rM.Fd)(e)&&(0,rM.Fd)(i)?e._key===i._key:(0,rM.dw)(e)?Number(e)===Number(i):(0,rM.lo)(e)&&(0,rM.lo)(i)?e[0]===i[0]&&e[1]===i[1]:e===i})}function vS(e){return(0,rM.fU)(e)?e._key:void 0}function vE(e){let t=vS(e);return t?{_key:t}:void 0}function vT(e,t){return e.get((null==t?void 0:t.author)||null)}function vA(e,t){let n=Array.isArray(t)?t:function(e){let t=e.match(vy);if(!t)throw Error("Invalid path string");return t.map(vC)}(t);return function(e,t){let n=function e(t,n){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];if(0===n.length)return t;let r=n[0],l=n.slice(1);if((0,rM.lo)(r))throw Error("Index tuples are not supported in diff paths");if((0,rM.dw)(r)||(0,rM.Fd)(r)){let a=(0,rM.dw)(r)?"at index ".concat(r):"with key ".concat(r._key);if("array"!==t.type){"Failed to get item ".concat(a," at path ").concat(vw(i)," (not an array)");return}let o=t.items.find((0,rM.dw)(r)?e=>e.toIndex===r:e=>(function(e,t){let n=e.diff;return"object"===n.type&&!!n.toValue&&n.toValue._key===t})(e,r));if(!o){"Failed to get item ".concat(a," at path ").concat(vw(i)," (item missing)");return}return e(o.diff,l,i.concat(r))}if("object"!==t.type){"Failed to get property ".concat(r," at path ").concat(vw(i)," (not an object)");return}let s=t.fields[r];if(void 0===s){"Failed to get property ".concat(r," at path ").concat(vw(i)," (field did not exist)");return}return e(s,l,i.concat(r))}(e,t);if(n&&"unchanged"!==n.action)return n.annotation||void 0}(e,n)}function vP(e){let t=vh();return vT(t,e)}function vI(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=vh(),i=(0,rF.useMemo)(()=>vA(e,t),[e,t]);return(0,rF.useMemo)(()=>vT(n,i),[i,n])}function vM(e){if("diff"in e){let{diff:t,path:n=[]}=e,i=d3(e,sV),r=vA(t,n);return(0,rz.jsx)(vz,d6(d6({},i),{},{annotations:r?[r]:[]}))}return(0,rz.jsx)(vz,d6({},e))}function vz(e){let{annotations:t,children:n,description:i="Changed"}=e,r=d3(e,sB);if(!t)return n;let l=(0,rz.jsxs)(rN.Kq,{padding:3,space:2,children:[(0,rz.jsx)(rN.__,{size:1,style:{textTransform:"uppercase"},muted:!0,children:i}),(0,rz.jsx)(rN.Kq,{space:2,children:t.map((e,t)=>(0,rz.jsx)(vR,{annotation:e},t))})]});return(0,rz.jsx)(Fy,{zOffset:"paneFooter",children:(0,rz.jsx)(rN.u,d6(d6({content:l,portal:!0,allowedAutoPlacements:["top","bottom"]},r),{},{children:n}))})}function vR(e){let{annotation:t}=e,{author:n,timestamp:i}=t,[r]=Mn(n),l=vP(t),a=I7(i,{minimal:!0});return(0,rz.jsxs)(rN.gF,{space:2,children:[(0,rz.jsxs)(rN.kC,{align:"center",paddingRight:3,style:{backgroundColor:l.background,color:l.text,borderRadius:"calc(23px / 2)"},children:[(0,rz.jsx)(Rw,{user:n}),(0,rz.jsx)(rN.gF,{paddingLeft:2,children:(0,rz.jsx)(rN.xv,{muted:!0,size:1,style:{color:l.text},children:r?r.displayName:"Loading…"})})]}),(0,rz.jsx)(rN.xv,{as:"time",muted:!0,size:1,dateTime:i,children:a})]})}let vF=(0,lO.ZP)(rN.Zb)(eE||(eE=d4(["\n  --diff-card-radius: ",";\n  --diff-card-bg-color: ",";\n\n  max-width: 100%;\n  position: relative;\n  border-radius: var(--diff-card-radius);\n\n  &:not(del) {\n    text-decoration: none;\n  }\n\n  &[data-hover] {\n    &::after {\n      content: '';\n      display: block;\n      position: absolute;\n      left: 0;\n      right: 0;\n      bottom: 0;\n    }\n\n    &:hover {\n      border-bottom-left-radius: 0;\n      border-bottom-right-radius: 0;\n\n      &::after {\n        bottom: -3px;\n        border-top: 1px solid var(---diff-card-bg-color);\n        border-bottom: 2px solid currentColor;\n        border-bottom-left-radius: var(--diff-card-radius);\n        border-bottom-right-radius: var(--diff-card-radius);\n      }\n    }\n\n    [data-from-to-layout]:hover & {\n      border-bottom-left-radius: 0;\n      border-bottom-right-radius: 0;\n\n      &::after {\n        bottom: -3px;\n        border-top: 1px solid var(---diff-card-bg-color);\n        border-bottom: 2px solid currentColor;\n        border-bottom-left-radius: var(--diff-card-radius);\n        border-bottom-right-radius: var(--diff-card-radius);\n      }\n    }\n  }\n"])),e=>{let{theme:t}=e;return(0,rN.hO)(t.sanity.radius[2])},e=>{let{theme:t}=e;return t.sanity.color.card.enabled.bg}),vO=[],vD=(0,rF.forwardRef)(function(e,t){let{annotation:n,as:i="div",children:r,className:l,diff:a,disableHoverEffect:o,path:s=vO,style:d={},tooltip:c}=e,u=d3(e,sU),p=(0,rF.useMemo)(()=>n||vA(a,s),[n,a,s]),h=vP(p),f=(0,rz.jsx)(vF,d6(d6({},u),{},{as:i,className:l,"data-hover":o||!p?void 0:"",ref:t,radius:1,style:d6(d6({},d),{},{backgroundColor:h.background,color:h.text}),children:r}));return c&&p?(0,rz.jsx)(vM,{annotations:[p],description:c&&"object"==typeof c&&c.description,children:f}):f}),vZ=lO.ZP.div(eT||(eT=d4(["\n  border-radius: ",";\n  padding: ",";\n"])),e=>{let{theme:t}=e;return(0,rN.hO)(t.sanity.radius[2])},e=>{let{theme:t}=e;return(0,rN.hO)(t.sanity.space[1])}),vL=(0,lO.ZP)(rN.xv)(eA||(eA=d4(["\n  &:not([hidden]) {\n    color: inherit;\n  }\n"])));function vq(e){let{change:t,segment:n}=e;if("string"==typeof n)return(0,rz.jsx)(rN.xu,{style:n.length>30?{maxWidth:100}:{},children:(0,rz.jsx)(rN.xv,{title:n,size:1,weight:"semibold",textOverflow:"ellipsis",children:n})});let{hasMoved:i,fromIndex:r,toIndex:l,annotation:a}=n;return void 0===r?(0,rz.jsx)(vN,{annotation:a,change:t,toIndex:l}):void 0===l?(0,rz.jsx)(vV,{annotation:a,fromIndex:r}):i&&void 0!==l&&void 0!==r?(0,rz.jsx)(vB,{annotation:a,fromIndex:r,toIndex:l}):(0,rz.jsx)(rN.xu,{padding:1,children:(0,rz.jsxs)(rN.xv,{size:1,weight:"semibold",children:["#",(l||0)+1]})})}function vN(e){let{annotation:t,change:n,toIndex:i=0}=e,r=i+1,l=(0,rz.jsxs)(rz.Fragment,{children:["#",r]}),a=(null==n?void 0:n.diff)?vA(n.diff,[]):void 0,o=a||t;return o?(0,rz.jsx)(vD,{annotation:o,tooltip:{description:"Added in position ".concat(r)},as:vZ,children:(0,rz.jsx)(vL,{size:1,weight:"semibold",forwardedAs:"ins",style:{textDecoration:"none"},children:l})}):(0,rz.jsx)(rN.xv,{size:1,weight:"semibold",children:l})}function vV(e){let{annotation:t,fromIndex:n=0}=e,i=n+1;return(0,rz.jsx)(vD,{annotation:t||null,as:vZ,tooltip:{description:"Removed from position ".concat(i)},children:(0,rz.jsxs)(vL,{size:1,weight:"semibold",forwardedAs:"del",children:["#",i]})})}function vB(e){let{annotation:t,fromIndex:n,toIndex:i}=e,r=i-n,l=Math.abs(r),a="Moved ".concat(l," position").concat(1===l?"":"s"," ").concat(r<0?"up":"down");return(0,rz.jsxs)(rz.Fragment,{children:[(0,rz.jsx)(rN.xu,{padding:1,children:(0,rz.jsxs)(vL,{size:1,weight:"semibold",children:["#",i+1]})}),(0,rz.jsx)(vD,{annotation:t,as:vZ,tooltip:{description:a},children:(0,rz.jsxs)(vL,{size:1,weight:"semibold",children:[r<0?"↑":"↓",Math.abs(r)]})})]})}function vU(e){let{change:t,titlePath:n}=e;return(0,rz.jsx)(rN.Oo,{separator:(0,rz.jsx)(rN.xv,{muted:!0,size:1,children:"/"}),children:n.map((e,n)=>{let i="string"==typeof e||!t||t.showIndex;return i?(0,rz.jsx)(vq,{change:t,segment:e},n):null})})}let vK=e=>{let{checkProperty:t=!1,checkPropertyKey:n,document:i,parent:r,value:l}=e,a=cp(l),o=Mi(),s=function(e,t,n){let{currentUser:i,document:r,parent:l,value:a}=n,o=(0,rF.useRef)(!1);return(0,rF.useMemo)(()=>{var n;let s=!1;if("boolean"==typeof e||void 0===e)return e||!1;try{s=e({document:r,parent:l,value:a,currentUser:i})}catch(d){return console.error("An error occurred while running the callback from `".concat(t,"`: ").concat(d.message)),!1}return cC(n=s)&&"function"==typeof(null==n?void 0:n.then)&&!o.current?(console.warn("The `".concat(t,"` option is either a promise or a promise returning function. Async callbacks for `").concat(t,"` option is not currently supported.")),!1):(void 0===s&&console.warn("The `".concat(t,"` option is or returned `undefined`. `").concat(t,"` should return a boolean.")),s)},[e,r,l,a,i,t])}(t,n,{currentUser:o,document:i,parent:r,value:a});return s},vH=(0,rF.createContext)({path:[]});function v$(e,t){let{jsonType:n}=t,i=Array.isArray(e)?"array":typeof e;if(null!==e&&"undefined"!==i){var r;if(i!==n)return{message:"Value is ".concat(i,", expected ").concat(n),value:e};if("object"===t.jsonType&&null!==(r=e)&&!Array.isArray(r)&&"object"==typeof r)for(let l of t.fields){let a=v$(e[l.name],l.type);if(a)return a}}}function vX(e,t){let n=(0,rM.ay)(t)?t._type:Array.isArray(t)?"array":null===t?"null":typeof t,i=e.of.find(e=>e.name===n);return i||(1===e.of.length?e.of[0]:void 0)}let vW=[["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""]],vG=[["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""]],vY=["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""],vJ=new a2.diff_match_patch,vQ=vG.map(e=>e[0]).concat(vW.map(e=>e[0])),v0=vG.map(e=>e[1]).concat(vW.map(e=>e[1])),v1=vQ.concat(v0).concat(vY).concat("").concat("⁠"),v2=RegExp("".concat(v1.join("|")),"g"),v3=RegExp("".concat(v1.join("|"),"|\n"),"g");function v4(e){return"object"===e.jsonType&&"block"===e.name}function v5(e,t){let n=e.fields.children;return n.items.filter(e=>e.diff.isChanged&&(e.diff.toValue===t||e.diff.fromValue===t)).map(e=>e.diff).map(e=>e)[0]}function v6(e,t){let n=e.find(e=>"children"===e.name),i=n&&n.type&&"array"===n.type.jsonType&&n.type.of.find(e=>e.name===t._type)||void 0;return i}function v8(e){return e.decorators?a1()(e.decorators,["value"],["asc"]):[]}function v7(e,t){return v8(t).some(t=>t.value===e)}function v9(e,t,n,i,r){return t?t.children.map(t=>{var l;let a=(0,rM.NG)(t)?null==(l=t.text)?void 0:l.replace(v2,""):"";if((0,rM.NG)(t)){let o=bt(e,t),s=null==o?void 0:o.fields.text;s&&s.toValue===t.text&&"string"===s.type&&"unchanged"!==s.action&&(a=s.segments.filter(e=>"removed"!==e.action).map(e=>e.text.replace(v2,"")).join("⁠")),t.marks&&t.marks.forEach(e=>{let t=!!n[e];t?a="".concat(n[e][0]).concat(a).concat(n[e][1]):i[e]&&(a="".concat(i[e][0]).concat(a).concat(i[e][1]))})}else a=r[t._key];return"".concat("").concat(a)}).join(""):""}function be(e){let t=[...e.toValue?e.toValue.children.filter(e=>"span"!==e._type):[]],n=e.fromValue?e.fromValue.children.filter(e=>"span"!==e._type):[];return n.forEach(e=>{t.some(t=>e._key===t._key)||t.push(e)}),a1()(t,["_key"],["asc"])}function bt(e,t){let n=e.fields.children&&"unchanged"!==e.fields.children.action&&"array"===e.fields.children.type&&e.fields.children.items.find(e=>e.diff&&"object"===e.diff.type&&("removed"===e.diff.action?e.diff.fromValue&&e.diff.fromValue._key===t._key:(e.diff.toValue&&e.diff.toValue._key)===t._key));if(n)return n.diff}function bn(e){return e&&lM()(Object.keys(e),["_key","_type"])||!1}function bi(e){let t=[...e.toValue&&e.toValue.markDefs?e.toValue.markDefs:[]],n=e.fromValue&&e.fromValue.markDefs?e.fromValue.markDefs:[];return n.forEach(e=>{t.some(t=>e._key===t._key)||t.push(e)}),a1()(t,["_key"],["asc"])}let br=[];function bl(e){let{checked:t,color:n}=e;return(0,rz.jsxs)("svg",{width:"17",height:"17",viewBox:"0 0 17 17",xmlns:"http://www.w3.org/2000/svg",fill:null==n?void 0:n.background,children:[(0,rz.jsx)("rect",{x:"0",y:"0",width:"17",height:"17",rx:"2.5"}),void 0===t&&(0,rz.jsx)("path",{d:"M4.07996 8.5H12.92",stroke:null==n?void 0:n.text,strokeWidth:"2"}),t&&(0,rz.jsx)("path",{d:"M3.5 8L7 11.5L13.5 5",stroke:null==n?void 0:n.text,strokeWidth:"2"})]})}function ba(e){let{checked:t,color:n}=e;return(0,rz.jsxs)("svg",{width:"38",height:"22",viewBox:"0 0 38 22",xmlns:"http://www.w3.org/2000/svg",children:[(0,rz.jsx)("rect",{width:"38",height:"22",rx:"11",fill:t?null==n?void 0:n.border:null==n?void 0:n.background}),void 0===t&&(0,rz.jsx)("rect",{x:"11",y:"3",width:"16",height:"16",rx:"8",fill:"white"}),t&&(0,rz.jsx)("rect",{x:"18",y:"3",width:"16",height:"16",rx:"8",fill:"white"}),"boolean"==typeof t&&!t&&(0,rz.jsx)("rect",{x:"4",y:"3",width:"16",height:"16",rx:"8",fill:"white"})]})}let bo=e=>{let{diff:t,schemaType:n}=e,{fromValue:i,toValue:r}=t,{title:l,options:a}=n,o=(null==a?void 0:a.layout)==="checkbox"?bl:ba,s=vI(t,[]),d=null!=r;return(0,rz.jsxs)(rN.kC,{align:"center",children:[(0,rz.jsx)(vM,{diff:t,children:(0,rz.jsxs)(rN.kC,{align:"center",children:[(0,rz.jsx)(o,{checked:i,color:s}),d&&(0,rz.jsxs)(rz.Fragment,{children:[(0,rz.jsx)(rN.xu,{marginX:2,children:(0,rz.jsx)(yS,{})}),(0,rz.jsx)(o,{checked:r,color:s})]})]})}),d&&l&&(0,rz.jsx)(rN.xu,{marginLeft:2,children:(0,rz.jsx)(rN.xv,{size:1,weight:"semibold",children:l})})]})},bs=(0,rF.createContext)(null);function bd(){let e=(0,rF.useContext)(bs);if(!e)throw Error("DocumentChange: missing context value");return e}function bc(e){let[t,n]=(0,rF.useState)(void 0),i=IW(uX);return(0,rF.useEffect)(()=>{if(!e)return;let t=i.observable.getDocument(e).subscribe(n);return()=>{t.unsubscribe()}},[i,e]),e?t:void 0}let bu=lO.ZP.div(eP||(eP=d4(["\n  ","\n  &:not([hidden]) {\n    display: inline-block;\n  }\n\n  [data-number='positive'] {\n    color: var(--size-diff-positive);\n  }\n\n  [data-number='negative'] {\n    color: var(--size-diff-negative);\n  }\n"])),e=>{let{theme:t}=e;return"\n    --size-diff-positive: ".concat(t.sanity.color.solid.positive.enabled.bg,";\n    --size-diff-negative: ").concat(t.sanity.color.solid.critical.enabled.bg,";\n  ")}),bp=e=>{let{diff:t,schemaType:n}=e,{fromValue:i,toValue:r,fields:l}=t,a=null==i?void 0:i.asset,o=null==r?void 0:r.asset,s=bc(null==a?void 0:a._ref),d=bc(null==o?void 0:o._ref),c=Object.entries(l).filter(e=>{let[t,n]=e;return n.isChanged&&"_type"!==t}).map(e=>{let[t]=e;return t}),u=c.includes("asset"),p=n.fields.filter(e=>"asset"!==e.name&&c.includes(e.name)).map(e=>e.name),h=(null==s?void 0:s.size)&&s.size/1e3/1e3,f=(null==d?void 0:d.size)&&d.size/1e3/1e3,m=h&&f?Math.round((f-h)/h*100):0,g=h?h.toFixed(2):void 0,x=f?f.toFixed(2):void 0,v=(0,rF.useMemo)(()=>({display:"block",flex:1}),[]),b=s&&(0,rz.jsx)(vD,{as:"del",diff:t,path:"asset._ref",style:v,children:(0,rz.jsx)(y7,{title:s.originalFilename||"Untitled",icon:lL.$lS,children:(0,rz.jsx)(rN.xv,{size:0,style:{color:"inherit"},children:"".concat(g,"MB")})})}),y=d&&(0,rz.jsx)(vD,{as:"ins",diff:t,path:"asset._ref",style:v,children:(0,rz.jsx)(y7,{title:d.originalFilename||"Untitled",icon:lL.$lS,children:(0,rz.jsxs)(rN.kC,{align:"center",children:[(0,rz.jsx)(rN.xv,{size:0,style:{color:"inherit"},children:"".concat(x,"MB")}),0!==m&&(0,rz.jsx)(rN.Zb,{radius:2,padding:1,as:bu,marginLeft:2,children:(0,rz.jsxs)(rN.xv,{size:0,"data-number":m>0?"positive":"negative",children:[m>0&&"+",m,"%"]})})]})})}),j=(0,rz.jsxs)(rz.Fragment,{children:[b&&!y&&(0,rz.jsx)(vM,{diff:t,path:"asset._ref",description:"Removed",children:b}),b&&y&&(0,rz.jsx)(vM,{diff:t,path:"asset._ref",children:(0,rz.jsx)(yO,{from:b,layout:"grid",to:y})}),!b&&y&&(0,rz.jsx)(vM,{diff:t,path:"asset._ref",description:"Added",children:y})]});return(0,rz.jsxs)(rz.Fragment,{children:[u&&j,p.length>0&&(0,rz.jsx)(rN.xu,{marginTop:u?4:3,children:(0,rz.jsx)(y2,{diff:t,schemaType:n,fields:p})})]})};function bh(e,t){let n=(/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e)||[]).slice(1).map(e=>parseInt(e,16)).concat(t);return"rgba(".concat(n.join(", "),")")}function bf(e){let{crop:t,diff:n,hash:i,hotspot:r,width:l=100,height:a=100}=e,o=d3(e,sK),s=vI(n,"crop"),d=vI(n,"hotspot");return(0,rz.jsxs)("svg",d6(d6({},o),{},{fill:"none",width:l,height:a,viewBox:"0 0 ".concat(l," ").concat(a),children:[(0,rz.jsx)("defs",{children:t&&r&&(0,rz.jsxs)("mask",{id:"mask-hotspot-".concat(i),children:[(0,rz.jsx)("rect",{x:0,y:0,width:l,height:a,fill:"#fff"}),(0,rz.jsx)(bg,{hotspot:r,fill:"#000",offset:1,width:l,height:a,stroke:"#000",strokeWidth:3})]})}),t&&(0,rz.jsx)(vM,{diff:n,path:"crop",description:"Crop changed",children:(0,rz.jsx)("g",{children:(0,rz.jsx)(bm,{crop:t,fill:bh(s.border,.25),mask:r?"url(#mask-hotspot-".concat(i,")"):void 0,stroke:s.border,strokeWidth:1,width:l,height:a})})}),r&&(0,rz.jsx)(vM,{diff:n,path:"hotspot",description:"Hotspot changed",children:(0,rz.jsx)("g",{children:(0,rz.jsx)(bg,{hotspot:r,fill:bh(d.border,.25),stroke:d.border,strokeWidth:1,width:l,height:a})})})]}))}function bm(e){let{crop:t,width:n,height:i}=e,r=d3(e,sH),l={x:t.left*n,y:t.top*i,width:(1-t.right-t.left)*n,height:(1-t.bottom-t.top)*i};return(0,rz.jsx)("rect",d6(d6(d6({},r),l),{},{style:{vectorEffect:"non-scaling-stroke"}}))}function bg(e){let{hotspot:t,offset:n=0,width:i,height:r}=e,l=d3(e,s$),a={cx:t.x*i,cy:t.y*r,rx:t.width/2*i+n,ry:t.height/2*r+n};return(0,rz.jsx)("ellipse",d6(d6(d6({},l),a),{},{style:{vectorEffect:"non-scaling-stroke"}}))}let bx=["originalFilename"],bv=()=>(0,rz.jsx)(rN.Zb,{flex:1,tone:"transparent",padding:4,radius:2,height:"stretch",children:(0,rz.jsx)(rN.kC,{align:"center",justify:"center",height:"fill",children:(0,rz.jsx)(rN.xv,{size:1,muted:!0,children:"(no image)"})})}),bb=lO.ZP.div(eI||(eI=d4(["\n  height: 100%;\n  max-height: 190px;\n  position: relative;\n\n  /* Ideally the checkerboard component currently in the form builder should be made available and used here */\n  background-color: ",";\n  background-image: linear-gradient(45deg, "," 25%, transparent 25%),\n    linear-gradient(-45deg, "," 25%, transparent 25%),\n    linear-gradient(45deg, transparent 75%, "," 75%),\n    linear-gradient(-45deg, transparent 75%, "," 75%);\n  background-size: 16px 16px;\n  background-position: 0 0, 0 8px, 8px -8px, -8px 0;\n\n  &::after {\n    content: '';\n    display: block;\n    position: absolute;\n    top: 0;\n    left: 0;\n    right: 0;\n    bottom: 0;\n    box-shadow: inset 0 0 0 1px var(--card-border-color);\n    pointer-events: none;\n  }\n\n  &[data-changed] {\n    opacity: 0.45;\n  }\n"])),aT.VG.gray[100].hex,aT.VG.gray[50].hex,aT.VG.gray[50].hex,aT.VG.gray[50].hex,aT.VG.gray[50].hex),by=lO.ZP.img(eM||(eM=d4(["\n  display: block;\n  flex: 1;\n  min-height: 0;\n  object-fit: contain;\n  width: 100%;\n  height: 100%;\n\n  &[data-action='removed'] {\n    opacity: 0.45;\n  }\n"]))),bj=lO.ZP.div(ez||(ez=d4(["\n  svg {\n    display: block;\n    position: absolute;\n    top: 0;\n    left: 0;\n    width: 100%;\n    height: 100%;\n  }\n"])));function bw(e){var t,n,i,r;let{id:l,action:a,diff:o,hotspot:s,crop:d,is:c}=e,u=IW(uX),[p,h]=rF.useState(),{value:f}=function(e,t){let n=Rm(),i=(0,rF.useMemo)(()=>e?n.observePaths({_type:"reference",_ref:e},t):(0,rB.of)(void 0),[e,n,t]);return cZ(i)}(l,bx),m=(0,aj.pz)(l),g=(0,rF.useMemo)(()=>ay()(u),[u]),x=null===f,v=f&&f.originalFilename||"Untitled",b=g.image(l).height(190).dpr(function(){let e=Math.ceil(window.devicePixelRatio||1);return Math.min(3,Math.max(1,e))}()).fit("max"),y=(null==(n=null==(t=o.fromValue)?void 0:t.asset)?void 0:n._ref)!==(null==(r=null==(i=o.toValue)?void 0:i.asset)?void 0:r._ref),j="changed"===a?void 0:a;return(0,rz.jsxs)(rN.kC,{direction:"column",height:"fill",flex:1,children:[(0,rz.jsx)(rN.xu,{flex:1,padding:2,paddingBottom:0,children:(0,rz.jsxs)(rN.kC,{as:bb,direction:"column","data-changed":"from"===c&&y?"":void 0,"data-error":p?"":void 0,children:[!x&&!p&&(0,rz.jsx)(by,{src:b.toString()||"",alt:v,"data-action":j,onError:h,width:m.width,height:m.height}),(x||p)&&(0,rz.jsx)(rN.xu,{paddingY:5,children:(0,rz.jsx)(rN.xv,{size:1,muted:!0,align:"center",children:x?"Image is deleted":"Error loading image"})}),(0,rz.jsx)(bj,{children:(0,rz.jsx)(bf,{crop:d&&!(0,aj.aM)(d)?d:void 0,diff:o,hash:function(e){let t=0;if(0==e.length)return t.toString();for(let n=0;n<e.length;n++){let i=e.charCodeAt(n);t=(t<<5)-t+i,t&=t}return t.toString()}("".concat(b.toString()||"","-").concat(c)),hotspot:s&&!(0,aj.Rq)(s)?s:void 0,width:m.width,height:m.height})})]})}),(0,rz.jsx)(y7,{title:v,icon:lL.XBm,markRemoved:y&&"from"===c,children:j?(0,rz.jsx)("div",{children:j}):(0,rz.jsxs)("div",{children:[m.width," \xd7 ",m.height]})})]})}let bk=["asset","crop","hotspot"],bC={flex:1},b_=e=>{var t,n;let{diff:i,schemaType:r}=e,{fromValue:l,toValue:a,fields:o,isChanged:s}=i,d=null==(t=null==l?void 0:l.asset)?void 0:t._ref,c=null==(n=null==a?void 0:a.asset)?void 0:n._ref,u=vA(i,["asset","_ref"]),p=Object.keys(o).filter(e=>o[e].isChanged&&"_type"!==e),h=r.fields.filter(e=>!bk.includes(e.name)&&p.includes(e.name)).map(e=>e.name),f="changed";!d&&c?f="added":!c&&d&&(f="removed");let m=p.includes("asset"),g=p.includes("crop"),x=p.includes("hotspot"),v=g||x,b=m||v,y=v&&!m,j=l&&d?(0,rz.jsx)(vD,{annotation:u,style:bC,children:(0,rz.jsx)(bw,{is:"from",id:d,diff:i,action:f,hotspot:y&&x?l.hotspot:void 0,crop:y&&g?l.crop:void 0})}):(0,rz.jsx)(bv,{}),w=a&&c?(0,rz.jsx)(vD,{annotation:u,style:bC,children:(0,rz.jsx)(bw,{is:"to",id:c,diff:i,hotspot:y&&x?a.hotspot:void 0,crop:y&&g?a.crop:void 0})}):(0,rz.jsx)(bv,{});if(!j&&!w)return(0,rz.jsx)(rN.Zb,{padding:4,radius:2,tone:"transparent",children:(0,rz.jsx)(rN.xv,{muted:!0,size:1,align:"center",children:"Image not set"})});if(!s)return c?(0,rz.jsx)(vD,{annotation:u,style:bC,children:(0,rz.jsx)(bw,{id:c,is:"to",diff:i})}):null;let k=(0,rz.jsx)(yO,{align:"center",from:j,layout:"grid",to:w});return(0,rz.jsxs)(rz.Fragment,{children:[b&&(m?(0,rz.jsx)(vM,{annotations:u?[u]:[],description:"".concat(f[0].toUpperCase()).concat(f.slice(1)),children:k}):k),h.length>0&&(0,rz.jsx)(rN.xu,{marginTop:b?4:3,children:(0,rz.jsx)(y2,{diff:i,schemaType:r,fields:h})})]})},bS=lO.ZP.div(eR||(eR=d4(["\n  display: inline-block;\n  word-break: break-all;\n"]))),bE=e=>{let{value:t}=e;return(0,rz.jsx)(rN.xu,{as:bS,paddingX:2,paddingY:1,children:t})},bT=e=>{let{diff:t,schemaType:n}=e;return(0,rz.jsx)(yZ,{diff:t,schemaType:n,previewComponent:bE,layout:"inline"})},bA=lO.ZP.blockquote(eF||(eF=d4(["\n  margin: 0;\n"])));function bP(e){let{children:t}=e;return(0,rz.jsx)("div",{children:(0,rz.jsx)(bA,{children:t})})}let bI={h1:2,h2:1,h3:0,h4:0,h5:0,h6:0},bM=(0,lO.ZP)(rN.X6)(eO||(eO=d4(["\n  &:not([hidden]) {\n    display: inline;\n    text-transform: none;\n    margin: 0;\n\n    &::before,\n    &::after {\n      content: unset;\n    }\n  }\n"])));function bz(e){let{style:t,children:n}=e;return(0,rz.jsx)(bM,{size:bI[t],children:n})}let bR=lO.ZP.p(eD||(eD=d4(["\n  text-transform: none;\n  white-space: wrap;\n  overflow-wrap: break-word;\n  margin: 0;\n"])));function bF(e){let{children:t}=e;return(0,rz.jsx)(bR,{children:t})}let bO=[];function bD(e){var t,n,i;let r;let{diff:l,block:a,children:o}=e,s=vI(l,bO),{path:d}=(0,rF.useContext)(vH),{onSetFocus:c}=(0,rF.useContext)(cc),u="removed"===l.action,p=o,h=(0,rF.useCallback)(e=>{e.stopPropagation(),u||c(d)},[d,u,c]);if(p="blockquote"===a.style?(0,rz.jsx)(bP,{children:p}):a.style&&(0,rM.DG)(a)&&a.style&&["h1","h2","h3","h4","h5","h6"].includes(a.style)?(0,rz.jsx)(bz,{style:a.style,children:p}):(0,rz.jsx)(bF,{children:p}),"changed"===l.origin.action&&l.origin.fields.style&&"changed"===l.origin.fields.style.action&&l.origin.fields.style.annotation){r=null==(n=null==(t=null==l?void 0:l.origin)?void 0:t.fromValue)?void 0:n.style;let f=s?{background:s.background,color:s.text}:{};p=(0,rz.jsx)(rN.Zb,{padding:3,border:!0,radius:2,style:{borderStyle:"dotted"},"diff-block-action":l.action,"data-block-note":"changed_from_style_".concat(r||"undefined"),children:(0,rz.jsxs)(rN.Kq,{space:2,children:[(0,rz.jsx)(vM,{annotations:[null==(i=l.origin.fields.style)?void 0:i.annotation],diff:l.origin.fields.style,children:(0,rz.jsxs)(rN.xv,{size:0,children:["Changed block style from '",r,"'"]})}),(0,rz.jsx)(rN.xu,{style:f,children:p})]})})}return(0,rz.jsx)("div",{onClick:h,"data-diff-block-action":l.action,"data-block-note":"changed_from_style_".concat(r||"undefined"),children:p})}let bZ=(0,lO.ZP)(rN.xu)(eZ||(eZ=d4(["\n  &:not([hidden]) {\n    display: inline;\n    align-items: center;\n\n    &[data-changed] {\n      cursor: pointer;\n    }\n  }\n"]))),bL=(0,lO.ZP)(rN.xv)(eL||(eL=d4(["\n  &:not([hidden]) {\n    display: inline;\n    color: inherit;\n  }\n"]))),bq=(0,lO.ZP)(rN.xu)(eq||(eq=d4(["\n  &:not([hidden]) {\n    display: inline-flex;\n    align-items: center;\n\n    ",' [data-ui="Text"] {\n      opacity: 0.5;\n    }\n  }\n'])),bZ),bN=(0,lO.ZP)(rN.xu)(eN||(eN=d4(["\n  min-width: 160px;\n  max-height: 40vh;\n  overflow-y: auto;\n"]))),bV=lO.ZP.div(eV||(eV=d4(["\n  text-decoration: none;\n  display: inline;\n  position: relative;\n  border: 0;\n  padding: 0;\n  border-bottom: 2px dotted currentColor;\n  box-shadow: inset 0 0 0 1px var(--card-border-color);\n  white-space: nowrap;\n  align-items: center;\n  background-color: color(var(--card-fg-color) a(10%));\n\n  &[data-changed] {\n    cursor: pointer;\n  }\n\n  &[data-removed] {\n    text-decoration: line-through;\n  }\n\n  &:hover "," {\n    opacity: 1;\n  }\n"])),bq);function bB(e){let{children:t,diff:n,object:i,schemaType:r,path:l}=e,a=d3(e,sX);return r?n&&"unchanged"!==n.action?(0,rz.jsx)(bU,d6(d6({},a),{},{diff:n,object:i,schemaType:r,path:l,children:t})):(0,rz.jsx)(bV,{children:t}):(0,rz.jsx)(bV,d6(d6({},a),{},{children:"Unknown schema type"}))}function bU(e){let{diff:t,children:n,object:i,schemaType:r,path:l}=e,a=d3(e,sW),{onSetFocus:o}=(0,rF.useContext)(cc),{path:s}=(0,rF.useContext)(vH),[d,c]=(0,rF.useState)(null),u=vI(t,[]),p=(0,rF.useMemo)(()=>u?{background:u.background,color:u.text}:{},[u]),h="removed"===t.action,[f,m]=(0,rF.useState)(!1),g=i&&bn(i),x=(0,rF.useMemo)(()=>[l[0]].concat(["markDefs",{_key:i._key}]),[i._key,l]),v=(0,rF.useMemo)(()=>s.slice(0,s.findIndex(e=>(0,rM.Fd)(e)&&e._key===i._key)),[s,i._key]),b=(0,rF.useMemo)(()=>v.concat(l),[l,v]),y=(0,rF.useMemo)(()=>v.concat(x),[x,v]),j="field-".concat((0,rR.BB)(y)),w=cs(),k=(0,rF.useMemo)(()=>w.filter(e=>{let[t]=e;return t.startsWith(j)}).length>0,[j,w]);(0,rF.useEffect)(()=>{!f&&k&&(m(!0),o(y))},[k,y,o,f]);let C=(0,rF.useCallback)(e=>{e.stopPropagation(),m(!0),h||(e.preventDefault(),o(b),setTimeout(()=>o(y),10))},[b,h,y,o]),_=(0,rF.useCallback)(()=>{k||m(!1)},[k]);(0,rN.O8)(_,[d]);let S="unchanged"!==t.action&&t.annotation||null,E=(0,rF.useMemo)(()=>S?[S]:[],[S]),T=(0,rz.jsx)(vH.Provider,{value:{path:y},children:(0,rz.jsx)(bN,{padding:3,children:(0,rz.jsxs)("div",{children:[g&&(0,rz.jsxs)(rN.__,{size:1,muted:!0,children:["Empty ",r.title]}),!g&&(0,rz.jsx)(y2,{diff:t,schemaType:r})]})})});return(0,rz.jsx)(bV,d6(d6({},a),{},{onClick:C,style:p,"data-changed":"","data-removed":"removed"===t.action?"":void 0,children:(0,rz.jsx)(rN.J2,{content:T,open:f,ref:c,portal:!0,children:(0,rz.jsx)(bq,{paddingLeft:1,children:(0,rz.jsx)(vM,{annotations:E,description:"".concat(t.action," annotation"),children:(0,rz.jsxs)(bZ,{style:{display:"inline-flex"},children:[(0,rz.jsx)("span",{children:n}),(0,rz.jsx)(rN.kC,{align:"center",paddingX:1,children:(0,rz.jsx)(bL,{size:0,children:(0,rz.jsx)(lL.v4q,{})})})]})})})})}))}let bK=lO.ZP.span(eB||(eB=d4(["\n  display: inline;\n  ","\n"])),e=>{let{theme:t,decoration:n}=e;switch(n){case"strong":return"font-weight: bold;";case"em":return"font-style: italic;";case"underline":return"text-decoration: underline;";case"overline":return"text-decoration: overline;";case"strike-through":return"text-decoration: line-through;";case"code":return"\n          font-family: ".concat(t.sanity.fonts.code.family,";\n          background: ").concat(t.sanity.color.muted.default.enabled.bg,";\n        ");default:return""}});function bH(e){let{mark:t,children:n}=e;return(0,rz.jsx)(bK,{decoration:t,children:n})}let b$=(0,lO.ZP)(rN.Zb)(eU||(eU=d4(["\n  &:not([hidden]) {\n    display: inline;\n    cursor: pointer;\n    white-space: nowrap;\n    align-items: center;\n\n    &[data-removed] {\n      text-decoration: line-through;\n    }\n\n    "," {\n      display: inline-flex;\n    }\n  }\n"])),bZ);function bX(e){let{diff:t,object:n,schemaType:i}=e,r=d3(e,sG);return i?t?(0,rz.jsx)(bW,d6(d6({},r),{},{diff:t,object:n,schemaType:i})):(0,rz.jsx)(b$,{children:(0,rz.jsx)(_S,{schemaType:i,value:n,layout:"inline"})}):(0,rz.jsxs)(b$,d6(d6({},r),{},{border:!0,radius:1,children:["Unknown schema type: ",n._type]}))}function bW(e){let{diff:t,object:n,path:i,schemaType:r}=e,l=d3(e,sY),{path:a}=(0,rF.useContext)(vH),{onSetFocus:o}=(0,rF.useContext)(cc),s=vI(t,[]),d=(0,rF.useMemo)(()=>s?{background:s.background,color:s.text}:{},[s]),[c,u]=(0,rF.useState)(!1),p=n&&bn(n),h="removed"===t.action,f=a.slice(0,a.findIndex(e=>(0,rM.Fd)(e)&&e._key===n._key)),m=f.concat(i),g="field-".concat((0,rR.BB)(m)),x=cs(),v=x.filter(e=>{let[t]=e;return t.startsWith(g)}).length>0,b=a.slice(0,-1).concat(i).concat([rR.Zg]);(0,rF.useEffect)(()=>{v&&(u(!0),o(b))},[v]);let y=(0,rF.useCallback)(e=>{if(e.stopPropagation(),u(!0),!h){o(b);return}e.preventDefault()},[b]),j=(0,rF.useCallback)(()=>{u(!1)},[]),w=(0,rz.jsx)(vH.Provider,{value:{path:m},children:(0,rz.jsx)(bG,{diff:t,emptyObject:p,onClose:j,schemaType:r})}),k="unchanged"!==t.action&&t.annotation||null;return(0,rz.jsx)(b$,d6(d6({},l),{},{onClick:y,style:d,"data-removed":"removed"===t.action?"":void 0,border:!0,radius:2,children:(0,rz.jsx)(rN.J2,{content:w,open:c,portal:!0,children:(0,rz.jsx)(bq,{children:(0,rz.jsx)(vM,{annotations:k?[k]:[],description:"".concat(t.action," inline object"),children:(0,rz.jsxs)(bZ,{children:[(0,rz.jsx)(_S,{schemaType:r,value:n,layout:"inline"}),(0,rz.jsx)(rN.kC,{align:"center",paddingX:1,children:(0,rz.jsx)(bL,{size:0,children:(0,rz.jsx)(lL.v4q,{})})})]})})})})}))}function bG(e){let{diff:t,emptyObject:n,onClose:i,schemaType:r}=e,[l,a]=(0,rF.useState)(null),o=(0,rF.useCallback)(()=>{i()},[i]);return(0,rN.O8)(o,[l]),(0,rz.jsxs)(bN,{ref:a,padding:3,children:[n&&(0,rz.jsxs)(rN.__,{size:1,muted:!0,children:["Empty ",r.title]}),!n&&(0,rz.jsx)(y2,{diff:t,schemaType:r})]})}function bY(e){let{diff:t,childDiff:n,children:i,path:r,segment:l}=e,a=d3(e,sJ),o=t||n,s=o&&"unchanged"!==o.action&&"unchanged"!==l.action;return s?(0,rz.jsx)(bJ,d6(d6({},a),{},{childDiff:n,diff:t,segment:l,path:r,children:i})):(0,rz.jsx)(bZ,{children:i})}function bJ(e){let{diff:t,childDiff:n,children:i,path:r,segment:l}=e,a=d3(e,sQ),{onSetFocus:o}=rF.useContext(cc),{path:s}=rF.useContext(vH),d=(0,rF.useMemo)(()=>r.slice(-2,1)[0],[r]),c=t&&"removed"===t.action,u=s.slice(0,s.findIndex(e=>(0,rM.Fd)(e)&&(0,rM.Fd)(d)&&e._key===d._key)),p=u.concat(r),h=(0,rF.useCallback)(e=>{e.stopPropagation(),c||(e.preventDefault(),o(p))},[p,c,o]),f=t&&t.segments.find(e=>e.text===l.text),m=f||t||n,g=m&&"unchanged"!==m.action&&m.annotation||null,x=g&&"unchanged"!==l.action?(0,rz.jsx)(vD,{annotation:g,as:"removed"===l.action?"del":"ins",tooltip:{description:"".concat(l$()(l.action)," text")},children:i}):null;return(0,rz.jsx)(bZ,d6(d6({},a),{},{onClick:h,"data-changed":"",children:(0,rz.jsx)("span",{children:(0,rz.jsx)(rz.Fragment,{children:x||i})})}))}let bQ=vG.map(e=>e[0]),b0=vG.map(e=>e[1]),b1=vW.map(e=>e[0]),b2=vW.map(e=>e[1]),b3=bQ.concat(b1),b4=b0.concat(b2),b5=bQ.concat(b0),b6=RegExp("".concat(b5.concat(b4).join("|")),"g");function b8(e){let{diff:t,schemaType:n}=e,i=t.origin.toValue||t.origin.fromValue,r=(0,rF.useMemo)(()=>t.origin.toValue?be(t.origin):[],[t.origin]),l=(0,rF.useCallback)(e=>{let l=v6(n.fields,e),a=[];if(l){let o;a=v8(l);let s=t.fields.children,d=s.items[0].diff&&"object"===s.items[0].diff.type&&"string"===s.items[0].diff.fields.text.type&&s.items[0].diff.fields.text.segments||[],c=[],u={};if(1===i.children.length&&"span"===i.children[0]._type&&"string"==typeof i.children[0].text&&""===i.children[0].text&&"unchanged"!==t.origin.action&&("added"===t.origin.action||"removed"===t.origin.action)){let p=v5(t.origin,i.children[0])||t.origin;if(p&&"unchanged"!==p.action)return(0,rz.jsx)(vD,{annotation:p.annotation,as:"removed"===p.action?"del":"ins",tooltip:{description:"".concat(l$()(p.action)," empty text")},children:(0,rz.jsx)("span",{children:"↲"})},"empty-block-".concat(i._key))}let h=-1,f=-1,m=[],g=bi(t.origin);return d.forEach(e=>{var s,d,p,x,v,b,y;f++;let j=vY.includes(e.text),w=b3.includes(e.text),k=b4.includes(e.text),C=""===e.text,_="removed"===e.action;if(C)!_&&h++;else if(w||k){if(w&&b1.includes(e.text)){let S=g[b1.indexOf(e.text)];S&&m.push({mark:S._key,symbols:[e.text,b2[b1.indexOf(e.text)]],object:S})}k&&b2.includes(e.text)&&(o=m.pop())}else if(j){let E=vY.findIndex(t=>t===e.text),T=null==(s=r[E])?void 0:s._key,A=r[E];if(T){let P=v6(n.fields,A),I=v5(t.origin,A);c.push((0,rz.jsx)(bX,{object:A,path:[{_key:i._key},"children",{_key:A._key}],diff:I,schemaType:P},"inline-object-".concat(A._key)))}}else if(e.text){let M=i.children[h]||(null==(x=t.origin.fromValue)?void 0:x.children.find(t=>t.text&&t.text.match(e.text.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&")))),z=M&&bt(t.origin,M);if(!M)throw Error("Could not find child");let R=(null==(d=null==z?void 0:z.fields)?void 0:d.text)?null==(p=null==z?void 0:z.fields)?void 0:p.text:void 0,F=(0,rz.jsx)(bY,{diff:R,path:[{_key:i._key},"children",{_key:M._key}],childDiff:z,segment:e,children:function(e){let{diff:t,child:n,decoratorTypes:i,seg:r,segIndex:l,spanSchemaType:a}=e;if("\n"===r.text)return(0,rz.jsx)("br",{});let o=(0,rz.jsx)("span",{children:r.text.replace(/ /g," ")},"text-".concat(l)),s=n&&bt(t.origin,n),d=(0,rM.NG)(n)&&n.marks||[];return s&&(o=function(e){var t;let{activeMarks:n,decoratorTypes:i,diff:r,children:l,seg:a,segIndex:o,spanDiff:s,spanSchemaType:d}=e,c=(0,rz.jsx)("span",{children:l},"text-segment-".concat(o)),u=r.origin.fromValue&&r.fromValue&&r.fromValue.children[0].text||"",p=s&&"unchanged"!==s.action&&s.annotation||void 0,h=null==(t=null==s?void 0:s.fields)?void 0:t.marks,f=h&&"unchanged"!==h.action&&h.annotation||p,m=[],g=u.split("").filter(e=>!!e).join(""),x=g.substring(0,g.indexOf(a.text)+a.text.length),v=x.substring(0,x.indexOf(a.text)),b=[],y=[...v.matchAll(b6)];return y.forEach(e=>{var t;let n=e[0],r=vG.concat(vW).find(e=>e.indexOf(n)>-1);if(r){let l=n===r[0],a=(null==(t=i[l?bQ.indexOf(n):b0.indexOf(n)])?void 0:t.value)||n,o=v.lastIndexOf(n)>v.lastIndexOf(r[1]);o&&b.push(a)}}),m=or()(n,aV()(b)),f&&m.length>0&&m.some(e=>v7(e,d))&&(c=(0,rz.jsx)(vD,{annotation:f,as:"ins",tooltip:{description:"Changed formatting"},children:c},"diffcard-annotation-".concat(o,"-").concat(m.join("-")))),c}({activeMarks:d,decoratorTypes:i,diff:t,children:o,seg:r,segIndex:l,spanDiff:s,spanSchemaType:a})),d&&d.length>0&&d.forEach(e=>{v7(e,a)&&(o=(0,rz.jsx)(bH,{mark:e,children:o},"decorator-".concat(e,"-").concat(n._key,"-").concat(l)))}),o}({diff:t,child:M,decoratorTypes:a,seg:e,segIndex:f,spanSchemaType:l})},"text-".concat(M._key,"-").concat(f));if(m.length>0&&m.forEach(e=>{u[e.mark]=u[e.mark]||[],u[e.mark].push(F)}),o){let O="annotation-".concat(o.object._key),D=c[c.length-1];if(D&&D.key!==O){let Z=(v=t.origin,b=o.mark,v.fields.markDefs&&v.fields.markDefs.isChanged&&"array"===v.fields.markDefs.type&&(null==(y=v.fields.markDefs.items.find(e=>e.diff&&"object"===e.diff.type&&(e.diff.toValue&&e.diff.toValue._key&&e.diff.toValue._key===b||e.diff.fromValue&&e.diff.fromValue._key&&e.diff.fromValue._key===b)))?void 0:y.diff)||void 0),L=o&&l.annotations&&l.annotations.find(e=>o&&o.object&&e.name===o.object._type);c.push((0,rz.jsx)(bB,{object:o.object,diff:Z,path:[{_key:i._key},"children",{_key:M._key}],schemaType:L,children:(0,rz.jsx)(rz.Fragment,{children:u[o.mark]})},O))}o=void 0}0===m.length&&c.push(F)}}),rF.createElement("div",{key:i._key},...c)}throw Error("'span' schemaType not found")},[i,t,r,n]);return(0,rz.jsx)(bD,{block:t.displayValue,diff:t,children:(0,rz.jsx)(rz.Fragment,{children:(t.displayValue.children||[]).map(e=>l(e))})})}let b7=e=>{let{diff:t,schemaType:n}=e,i=(0,rF.useMemo)(()=>(function(e,t){let n="removed"===e.action?e.fromValue:e.toValue,i=d6(d6({},e),{},{origin:e,displayValue:n});if(n){let r={},l={},a={},o=v6(t.fields,{_key:"bogus",_type:"span"});o&&v8(o).forEach((e,t)=>{l[e.value]=vG[t]});let s=bi(i.origin);s.forEach((e,t)=>{r[e._key]=vW[t]});let d=be(i.origin);d.forEach((e,t)=>{a[e._key]=vY[t]});let c=v9(i.origin,i.fromValue,l,r,a),u=v9(i.origin,i.toValue,l,r,a),p=d6(d6({},n),{},{children:[{_type:"span",_key:"pseudoSpanKey",text:u,marks:[]}]}),h={displayValue:n,children:[{_type:"span",_key:"pseudoSpanKey",text:c,marks:[]}]},f={origin:e,action:"changed",type:"object",displayValue:p,fromValue:h,toValue:p,isChanged:!0,fields:{children:{action:"changed",type:"array",isChanged:!0,items:[{diff:{action:"changed",type:"object",isChanged:!0,fields:{text:{type:"string",action:"changed",isChanged:!0,fromValue:c,toValue:u,segments:(function(e,t){let n=[],i=vJ.diff_main(e,t);vJ.diff_cleanupEfficiency(i);let r=0,l=0;for(let[a,o]of i)switch(a){case a2.DIFF_EQUAL:n.push({type:"stringSegment",action:"unchanged",text:o}),r+=o.length,l+=o.length;break;case a2.DIFF_DELETE:n.push({type:"stringSegment",action:"removed",text:e.substring(r,r+o.length),annotation:null}),r+=o.length;break;case a2.DIFF_INSERT:n.push({type:"stringSegment",action:"added",text:t.substring(l,l+o.length),annotation:null}),l+=o.length}return aH()(n.map(e=>{let t=[];if(e.text.length>1){let n=[...e.text.matchAll(v3)],i=-1;n.forEach(r=>{let l=r.index||0;l>i&&(t.push(d6(d6({},e),{},{text:e.text.substring(i+1,l)})),t.push(d6(d6({},e),{},{text:r[0]}))),r===n[n.length-1]&&t.push(d6(d6({},e),{},{text:e.text.substring(l+1)})),i=l}),0===n.length&&t.push(e)}else t.push(e);return t}))})(c,u).map(e=>d6(d6({},e),"unchanged"!==i.action&&i.annotation?{annotation:i.annotation}:{}))}},fromValue:h.children[0],toValue:p.children[0]},annotation:null,fromIndex:0,toIndex:0,hasMoved:!1}],fromValue:h.children,toValue:p.children}}};return f}throw Error("Can not display this diff")})(t,n),[t,n]);return(0,rz.jsx)("div",{"data-diff-action":t.action,children:(0,rz.jsx)(b8,{diff:i,schemaType:n})})},b9=lO.ZP.div(eK||(eK=d4(["\n  word-wrap: break-word;\n"]))),ye=e=>{let{value:t,schemaType:n}=e;return(0,rz.jsx)(rN.xu,{as:b9,padding:2,children:(0,rz.jsx)(_S,{schemaType:n,value:t,layout:"default"})})},yt=e=>{let{diff:t,schemaType:n}=e;return(0,rz.jsx)(yZ,{align:"center",diff:t,layout:"grid",path:"_ref",previewComponent:ye,schemaType:n})},yn=lO.ZP.div(eH||(eH=d4(["\n  display: inline-block;\n  word-break: break-all;\n  white-space: pre-wrap;\n"]))),yi=e=>{let{value:t}=e;return(0,rz.jsx)(rN.xu,{as:yn,paddingX:2,paddingY:1,children:t})},yr=lO.ZP.div(e$||(e$=d4(["\n  white-space: pre-wrap;\n  word-wrap: break-word;\n"]))),yl=e=>{let{diff:t,schemaType:n}=e,{options:i}=n;return(null==i?void 0:i.list)?(0,rz.jsx)(yZ,{diff:t,previewComponent:yi,schemaType:n}):(0,rz.jsx)(yr,{children:(0,rz.jsx)(y6,{diff:t})})},ya={block:b7,boolean:{component:bo,showHeader:!1},file:bp,image:b_,number:bT,reference:yt,string:yl};function yo(e,t){var n;let i=e;for(;i;){let r=(null==(n=null==i?void 0:i.components)?void 0:n.diff)||function(e,t){let n;for(let i of br){if("function"!=typeof i){console.error("Diff component resolver is not a function: ",i);continue}if(n=i({schemaType:e,parentSchemaType:t}))return n}}(i,t)||ya[i.name];if(r)return r;i=i.type}return ya[e.jsonType]}function ys(e){return"field"===e.type}function yd(e){return null!=e&&""!==e}function yc(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{},l=yo(e,r.parentSchema);if(!l){if("object"===e.jsonType&&"object"===t.type)return yu(e,t,n,i,r);if("array"===e.jsonType&&"array"===t.type)return function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],r=t.items.filter(e=>e.hasMoved&&e.fromIndex!==e.toIndex||"unchanged"!==e.diff.action);if(0===r.length)return[];let l=e.of.some(v4),a=r.reduce((r,a)=>{var o;let s="added"===(o=a.diff).action?{toType:vX(e,o.toValue)}:"changed"===o.action?{fromType:vX(e,o.fromValue),toType:vX(e,o.toValue)}:"removed"===o.action?{fromType:vX(e,o.fromValue)}:{toType:vX(e,o.toValue)},d=s.toType||s.fromType;if(!d)return console.warn("Could not determine schema type for item at %s",vw(n)),r;let c=vE(a.diff.fromValue)||vE(a.diff.toValue)||t.items.indexOf(a),u=n.concat(c),p={itemDiff:a,parentDiff:t,parentSchema:e},h=i.concat({hasMoved:a.hasMoved,toIndex:a.toIndex,fromIndex:a.fromIndex,annotation:"unchanged"===a.diff.action?a.annotation:a.diff.annotation}),f=e=>("field"===e.type&&v_(u,e.path)&&(e.itemDiff=a),e),m=yc(d,a.diff,u,h,p).map(f);return l&&m.filter(ys).forEach((e,t,n)=>{e.showHeader=1===n.length,e.showIndex=a.fromIndex!==a.toIndex&&a.hasMoved}),0===m.length?r.push(...yp(d,a.diff,u,h,p)):r.push(...m),r},[]);return a.length>1?[{type:"group",key:vw(n)||"root",path:n,titlePath:i,changes:yh(a,i.length),schemaType:e}]:a}(e,t,n,i)}return yp(e,t,n,i,r)}function yu(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{},l=[],a=d6(d6({},r),{},{parentSchema:e}),o=e.fieldsets||e.fields.map(e=>({single:!0,field:e}));for(let s of o)s.single?l.push(...function(e,t,n,i){let r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{},{fieldFilter:l}=r,a=d3(r,s0),o=t.fields[e.name];if(!o||!o.isChanged||l&&!l.includes(e.name))return[];let s=n.concat([e.name]),d=i.concat([e.type.title||e.name]);return yc(e.type,o,s,d,a)}(s.field,t,n,i,a)):l.push(...function(e,t,n,i){let r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{},{fields:l,name:a,title:o,readOnly:s,hidden:d}=e,{fieldFilter:c}=r,u=d3(r,s1),p=i.concat([o||a]),h=[];for(let f of l){let m=t.fields[f.name];if(!m||!m.isChanged||c&&!c.includes(f.name))continue;let g=n.concat([f.name]),x=p.concat([f.type.title||f.name]);h.push(...yc(d6({readOnly:s,hidden:d},f.type),m,g,x,u))}return h.length<2?h:[{type:"group",key:vw(n)||"root",fieldsetName:a,path:n,titlePath:p,changes:yh(h,p.length),readOnly:s,hidden:d}]}(s,t,n,i,a));return l.length<2?l:[{type:"group",key:vw(n)||"root",path:n,titlePath:i,changes:yh(l,i.length),schemaType:e}]}function yp(e,t,n,i){let r,l,{itemDiff:a,parentDiff:o,parentSchema:s}=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{},{fromValue:d,toValue:c,type:u}=t;if("array"===u&&yf(d)&&yf(c))return[];void 0!==d&&(r=v$(d,e)),r||void 0===c||(r=v$(c,e));let p=!0,h=yo(e,s);return h&&"function"==typeof h?l=h:h&&(l=h.component,p=void 0===h.showHeader?p:h.showHeader),[{type:"field",diff:t,path:n,error:r,itemDiff:a,parentDiff:o,titlePath:i,schemaType:e,showHeader:p,showIndex:!0,key:vw(n)||"root",diffComponent:r?void 0:l,parentSchema:s}]}function yh(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return e.map(e=>(e.titlePath=e.titlePath.slice(t),e))}function yf(e){return Array.isArray(e)&&0===e.length||null==e}let ym=e=>"field"===e.type&&"added"===e.diff.action,yg=e=>{if("group"!==e.type)return[e];let t=[];return e.changes.forEach(e=>{t.push(...yg(e))}),t},yx=(e,t)=>{if(t.length>=e.length)return!1;for(let n=0;n<t.length;n++)if(t[n]!==e[n])return!1;return!0},yv=(e,t)=>{let n=e[t],i=vS(n);if(i)return{_key:i};let r=Array.isArray(e);return r?parseInt(t,10):t},yb={diffMatchPatch:{enabled:!1}};function yy(e,t,n){if(!t)return;let i=[];if("group"===e.type){let r=yg(e),l=r.filter(ym);r.filter(e=>!ym(e)).forEach(e=>yy(e,t,n)),i.push(...yj(t,l.map(e=>e.path)))}else"added"===e.diff.action?i.push(...yj(t,[e.path])):"field"===e.type&&e.itemDiff&&e.parentDiff&&"array"===e.parentDiff.type&&e.itemDiff.hasMoved?i.push(...function(e,t,n){let i;let r=n.slice(0,-1),{parentValue:l,fromIndex:a,fromValue:o}=function(e,t){if(e.fromValue&&"number"==typeof t.fromIndex){let n=e.fromValue[t.fromIndex];return{parentValue:e.fromValue,fromIndex:t.fromIndex,fromValue:n}}throw Error("Failed to find item at index ".concat(t.fromIndex))}(t,e);if(0===a)i={before:vw([...r,0])};else{let s=a-1,d=vE(l[s]);i={after:vw([...r,d||s])}}return[{unset:[vw(n)]},{insert:d6(d6({},i),{},{items:[o]})}]}(e.itemDiff,e.parentDiff,e.path)):i.push(...function(e,t,n){let i=(0,oI.C)(e.toValue,e.fromValue,yb,n),r=i.filter(e=>"insert"===e.op).map(e=>{let{after:t,items:n}=e;return{insert:{after:vw(t),items:n}}}),l=i.filter(e=>"unset"===e.op).reduce((e,t)=>e.concat(vw(t.path)),[]),a=new Set,o=[],s=!1,d=i.filter(e=>"set"===e.op).reduce((e,n)=>(s=!0,o.push(...function(e,t,n){let i=t.fromValue,r=t.toValue,l=[];for(let a=1;a<=e.length;a++){let o=e.slice(0,a),s=vw(o);if(n.has(s))continue;let d=e[a],c=(0,rM.Fd)(d)||(0,rM.dw)(d),u=vk(i,o),p=yw(u);if(c&&Array.isArray(u)&&!vk(r,e.slice(0,a+1))){let h=function(e,t){return"number"==typeof t||(0,rM.Fd)(t)?"number"==typeof t?t:e.findIndex(e=>(0,rM.fU)(e)&&e._key===t._key):-1}(u,d),f=u[h-1],m=vk(i,o.concat(d)),g=(0,rM.fU)(f)?{_key:f._key}:h-1,x=vw(o.concat(h<1?0:g));l.push({setIfMissing:{[s]:[]}}),l.push({insert:{after:x,items:[yw(m)]}}),a++;continue}void 0!==p&&(n.add(s),l.push({setIfMissing:{[s]:p}}))}return l}(n.path,t,a)),e[vw(n.path)]=n.value,e),{});return[...o,...r,...l.length>0?[{unset:l}]:[],...s?[{set:d}]:[]]}(e.diff,t,e.path));n.patch.execute(i)}function yj(e,t){let n=[];for(let i=0;i<t.length;i++){let r=n.some(e=>yx(t[i],e));r||n.push(function(e,t,n){let i=e.toValue;return function e(t,n){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],r=arguments.length>3?arguments[3]:void 0;if(n.length<=0){if(!r)throw Error("Root has no ancestor");return r}let l=n.slice(0,-1),a=vk(t,l),o=[l,...i.filter(e=>!yx(e,l))];return!function e(t,n,i){let r=null==i?void 0:i.some(e=>vw(e)===vw(n)),l=Array.isArray(t)&&t.length<=0;return r||null==t||l||"object"==typeof t&&null!==t&&Object.keys(t).length<=0||function(t,n,i){if(!cC(t)||!Array.isArray(t))return!1;for(let r in t){if(!Object.prototype.hasOwnProperty.call(t,r)||"_type"===r||"_key"===r)continue;let l=[...n,yv(t,r)];if(!e(t[r],l,i))return!1}return!0}(t,n,i)}(a,l,i)?n:e(t,l,o,r)}(i,t,n)}(e,t[i],t))}return[{unset:[...new Set(n.map(vw))]}]}function yw(e){if(Array.isArray(e))return[];if("object"!=typeof e||null===e)return;let t={};return(0,rM.fU)(e)&&(t._key=e._key),(0,rM.ay)(e)&&(t._type=e._type),t}let yk=(0,rF.createContext)(null);class yC extends rF.Component{constructor(){super(...arguments),this.state={}}static getDerivedStateFromError(e){return{error:e}}componentDidCatch(e){console.error("Error rendering diff component: "),console.error(e)}render(){let{error:e}=this.state;return e?(0,rz.jsx)(rN.Zb,{padding:3,radius:2,tone:"critical",children:(0,rz.jsxs)(rN.kC,{children:[(0,rz.jsx)(rN.xv,{size:1,children:(0,rz.jsx)(lL.uIy,{})}),(0,rz.jsxs)(rN.xu,{paddingLeft:3,children:[(0,rz.jsx)(rN.xv,{as:"h3",size:1,weight:"medium",children:"Rendering the changes to this field caused an error"}),mD&&(0,rz.jsx)(rN.xu,{marginTop:2,children:(0,rz.jsx)(rN.xv,{as:"p",size:1,children:"Check the developer console for more information"})})]})]})}):this.props.children}}let y_={down:lL.veu,right:lL.LZ3};function yS(e){let{direction:t="right"}=e,n=d3(e,s2),i=y_[t];return(0,rz.jsx)(rN.xv,d6(d6({muted:!0,size:1},n),{},{children:(0,rF.createElement)(i)}))}let yE=lO.ZP.pre(eX||(eX=d4(["\n  overflow-x: auto;\n  position: relative;\n"]))),yT=lO.ZP.div(eW||(eW=d4(["\n  position: absolute;\n  top: 0;\n  right: 0;\n"])));function yA(e){let{children:t,as:n,change:i}=e,r=d3(e,s3),l=(0,rF.useRef)(!1),[a,o]=(0,rF.useState)(!1),s=(0,rF.useCallback)(()=>o(e=>!e),[o]),d=(0,rF.useCallback)(()=>l.current=!0,[]),c=(0,rF.useCallback)(()=>l.current=!1,[l]);return(0,rF.useEffect)(()=>{function e(e){let{metaKey:t,key:n}=e;t&&"i"===n&&l.current&&s()}return window.addEventListener("keydown",e,!1),()=>window.removeEventListener("keydown",e,!1)},[s]),(0,rz.jsx)(rN.xu,d6(d6({as:n,onMouseEnter:d,onMouseLeave:c},r),{},{children:a?(0,rz.jsx)(yI,{change:i}):t}))}let yP=e=>{let{title:t}=e;return(0,rz.jsx)(rN.xu,{padding:3,display:"inline-block",as:yT,children:(0,rz.jsx)(rN.__,{size:1,muted:!0,children:t})})};function yI(e){var t,n,i;let{change:r}=e;return(0,rz.jsxs)(rN.Kq,{space:3,children:[(0,rz.jsxs)(rN.Zb,{padding:3,tone:"transparent",as:yE,radius:1,children:[(0,rz.jsx)(yP,{title:"meta"}),(0,rz.jsx)(rN.EK,{language:"json",size:1,children:function(e){let t=[];return Object.entries(e).forEach(e=>{let[n,i]=e;null!=i&&t.push("".concat(n,": ").concat(i))}),t.join("\n")}({path:vw(r.path),fromIndex:null==(t=r.itemDiff)?void 0:t.fromIndex,toIndex:null==(n=r.itemDiff)?void 0:n.toIndex,hasMoved:null==(i=r.itemDiff)?void 0:i.hasMoved,action:r.diff.action,isChanged:r.diff.isChanged})})]}),(0,rz.jsxs)(rN.Zb,{as:yE,tone:"critical",padding:3,radius:1,children:[(0,rz.jsx)(yP,{title:"from"}),(0,rz.jsx)(rN.EK,{language:"json",size:1,children:yM(r.diff.fromValue)})]}),(0,rz.jsx)(rN.Zb,{children:(0,rz.jsx)(yS,{direction:"down",align:"center"})}),(0,rz.jsxs)(rN.Zb,{as:yE,tone:"positive",padding:3,radius:1,children:[(0,rz.jsx)(yP,{title:"to"}),(0,rz.jsx)(rN.EK,{language:"json",size:1,children:yM(r.diff.toValue)})]})]})}function yM(e){return void 0===e?"undefined":JSON.stringify(e,null,2)}let yz={flexShrink:0},yR={alignItems:"stretch"},yF={top:"flex-start",center:"center",bottom:"flex-end",default:"flex-start"},yO=(0,rF.forwardRef)(function(e,t){let{align:n="top",layout:i="inline",from:r,to:l,style:a}=e,o=d3(e,s4),s=(0,rN.Fg)(),d="inline"===i?rN.kC:rN.rj,c=(0,rF.useMemo)(()=>d6(d6({},a),"inline"===i?{maxWidth:"100%",display:"inline-flex"}:{gridTemplateColumns:"minmax(0, 1fr) ".concat((0,rN.hO)(s.sanity.space[5])," minmax(0, 1fr)")}),[i,a,s]),u="inline"===i?yz:yR;return(0,rz.jsxs)(d,d6(d6({},o),{},{ref:t,style:c,"data-from-to-layout":!0,children:[r&&(0,rz.jsxs)(rz.Fragment,{children:[(0,rz.jsx)(rN.kC,{align:yF[n],style:u,children:r}),(0,rz.jsx)(rN.kC,{align:"center",justify:"center",padding:2,children:(0,rz.jsx)(yS,{})})]}),(0,rz.jsx)(rN.kC,{align:yF[n],style:u,children:l})]}))}),yD={flex:1,minWidth:0,display:"block",whiteSpace:"break-spaces"};function yZ(e){let{align:t,cardClassName:n,diff:i,layout:r,path:l,previewComponent:a,schemaType:o}=e,{action:s}=i,d=function(e){let t=yd(e.fromValue),n=yd(e.toValue);return!t&&n?"Added":!n&&t?"Removed":"Changed"}(i);if("unchanged"===s)return(0,rz.jsx)(vD,{className:n,style:yD,children:(0,rF.createElement)(a,{schemaType:o,value:i.toValue})});let c=void 0!==i.fromValue&&null!==i.fromValue&&(0,rz.jsx)(vD,{as:"del",className:n,diff:i,path:l,style:yD,children:(0,rF.createElement)(a,{schemaType:o,value:i.fromValue})}),u=void 0!==i.toValue&&null!==i.toValue&&(0,rz.jsx)(vD,{as:"ins",className:n,diff:i,path:l,style:yD,children:(0,rF.createElement)(a,{schemaType:o,value:i.toValue})});return c&&!u?(0,rz.jsx)(vM,{description:d,diff:i,path:l,children:c}):!c&&u?(0,rz.jsx)(vM,{description:d,diff:i,path:l,children:u}):(0,rz.jsx)(vM,{description:d,diff:i,path:l,children:(0,rz.jsx)(yO,{align:t,from:c,layout:r,to:u})})}let yL=e=>{let{value:t,schemaType:n}=e;return(0,rz.jsx)(rN.xu,{padding:2,children:(0,rz.jsx)(_S,{schemaType:n,value:t,layout:"default"})})},yq=e=>{let{diff:t,schemaType:n}=e;return(0,rz.jsx)(yZ,{diff:t,schemaType:n,previewComponent:yL,layout:"grid"})},yN=(0,lO.ZP)(rN.zx)(eG||(eG=d4(["\n  [data-ui='Text'] {\n    font-weight: normal;\n  }\n\n  div[data-ui='Box'] {\n    display: none;\n  }\n\n  &:not([data-disabled='true']):hover,\n  &:not([data-disabled='true']):focus {\n    --card-fg-color: ",";\n    --card-bg-color: transparent;\n    --card-border-color: transparent;\n\n    div[data-ui='Box'] {\n      display: block;\n    }\n  }\n"])),e=>{let{theme:t}=e;return t.sanity.color.solid.critical.enabled.bg}),yV=(0,rF.forwardRef)(function(e,t){let{selected:n}=e,i=d3(e,s5);return(0,rz.jsx)(yN,d6({icon:lL.V13,selected:n,text:"Revert changes",mode:"bleed",padding:1,fontSize:1,space:2,ref:t},i))});function yB(e){let{error:t}=e;return(0,rz.jsx)(rN.Zb,{tone:"critical",padding:3,children:(0,rz.jsxs)(rN.kC,{align:"flex-start",children:[(0,rz.jsx)(rN.xu,{children:(0,rz.jsx)(rN.xv,{children:(0,rz.jsx)(lL.uIy,{})})}),(0,rz.jsx)(rN.xu,{flex:1,paddingLeft:3,children:(0,rz.jsxs)(rN.xv,{size:1,as:"p",children:["Value error: ",t.message]})})]})})}let yU=lO.ZP.div(eY||(eY=d4(["\n  --field-change-error: ",";\n  &[data-revert-all-changes-hover] [data-revert-all-hover]::before {\n    border-left: 2px solid var(--field-change-error);\n  }\n"])),e=>{let{theme:t}=e;return t.sanity.color.solid.critical.enabled.bg}),yK=lO.ZP.div(eJ||(eJ=d4(["\n  --field-change-error: ",";\n  --diff-inspect-padding-xsmall: ",";\n  --diff-inspect-padding-small: ",";\n\n  position: relative;\n  padding: var(--diff-inspect-padding-xsmall) 0 var(--diff-inspect-padding-xsmall)\n    var(--diff-inspect-padding-small);\n\n  &::before {\n    content: '';\n    display: block;\n    position: absolute;\n    top: 0;\n    left: 0;\n    bottom: 0;\n    border-left: 1px solid var(--card-border-color);\n  }\n\n  &[data-error]:hover::before,\n  &[data-revert-field-hover]:hover::before {\n    border-left: 2px solid var(--field-change-error);\n  }\n"])),e=>{let{theme:t}=e;return t.sanity.color.solid.critical.enabled.bg},e=>{let{theme:t}=e;return(0,rN.hO)(t.sanity.space[1])},e=>{let{theme:t}=e;return(0,rN.hO)(t.sanity.space[2])}),yH=(0,lO.ZP)(rN.J2)(eQ||(eQ=d4(["\n  /* hides the popover when the target of it has left the visible part of the window.\n   without it, the popover will be on top of the headers (document title & changes)\n   and footers (changed notifications, publish button etc)*/\n  &[data-popper-reference-hidden='true'] {\n    display: none;\n  }\n"])));function y$(e){var t;let{change:n,hidden:i,readOnly:r}=e,l=null!=(t=function(){let e=(0,rF.useContext)(yk);return e&&e.readOnly||null}())?t:r,a=n.diffComponent||yq,{documentId:o,schemaType:s,rootDiff:d,isComparingCurrent:c,FieldWrapper:u=rF.Fragment}=bd(),p=IQ(o,s.name),[h,f]=(0,rF.useState)(!1),[m,g]=(0,rF.useState)(!1),[x,v]=(0,rF.useState)(null),[b,y]=zh({id:o,type:s.name,permission:"update"}),j=(0,rF.useCallback)(()=>{yy(n,d,p)},[n,d,p]),w=(0,rF.useCallback)(()=>{f(!0)},[]),k=rF.useCallback(()=>{f(!1)},[]),C=(0,rF.useCallback)(()=>{g(!0)},[]),_=(0,rF.useCallback)(()=>{g(!1)},[]),S=(0,rF.useCallback)(()=>f(!1),[]);(0,rN.O8)(S,[x]);let E=(0,rF.useMemo)(()=>i?null:(0,rz.jsxs)(rN.Kq,{space:1,as:yU,children:[n.showHeader&&(0,rz.jsx)(vU,{change:n,titlePath:n.titlePath}),(0,rz.jsx)(u,{path:n.path,hasHover:m,children:(0,rz.jsxs)(yA,{change:n,as:yK,"data-revert-field-hover":m?"":void 0,"data-error":n.error?"":void 0,"data-revert-all-hover":!0,children:[n.error?(0,rz.jsx)(yB,{error:n.error}):(0,rz.jsx)(yC,{children:(0,rz.jsx)(vH.Provider,{value:{path:n.path},children:(0,rz.jsx)(a,{diff:n.diff,schemaType:n.schemaType})})}),c&&!y&&(null==b?void 0:b.granted)&&(0,rz.jsx)(yH,{content:(0,rz.jsxs)(rN.xu,{padding:3,sizing:"border",children:["Are you sure you want to revert the changes?",(0,rz.jsxs)(rN.rj,{columns:2,gap:2,marginTop:2,children:[(0,rz.jsx)(rN.zx,{mode:"ghost",onClick:k,children:(0,rz.jsx)(rN.xv,{align:"center",children:"Cancel"})}),(0,rz.jsx)(rN.zx,{tone:"critical",onClick:j,children:(0,rz.jsx)(rN.xv,{align:"center",children:"Revert change"})})]})]}),open:h,portal:!0,placement:"left",ref:v,children:(0,rz.jsx)(rN.xu,{flex:1,children:(0,rz.jsx)(yV,{onClick:w,onMouseEnter:C,onMouseLeave:_,selected:h,disabled:l,"data-testid":"single-change-revert-button-".concat(null==n?void 0:n.key)})})})]})})]}),[n,k,l,h,a,u,i,C,_,j,w,c,y,b,m]);return E}let yX=lO.ZP.div(e0||(e0=d4(["\n  display: grid;\n  grid-template-columns: minmax(0, 1fr);\n"]))),yW=lO.ZP.div(e1||(e1=d4(["\n  --field-change-error: ",";\n  --diff-inspect-padding-xsmall: ",";\n  --diff-inspect-padding-small: ",";\n\n  position: relative;\n  padding: var(--diff-inspect-padding-xsmall) var(--diff-inspect-padding-small);\n\n  &::before {\n    content: '';\n    display: block;\n    position: absolute;\n    top: 0;\n    left: 0;\n    bottom: 0;\n    border-left: 1px solid var(--card-border-color);\n  }\n\n  &[data-error]:hover::before,\n  &[data-revert-group-hover]:hover::before,\n  &[data-revert-all-groups-hover]::before {\n    border-left: 2px solid var(--field-change-error);\n  }\n"])),e=>{let{theme:t}=e;return t.sanity.color.solid.critical.enabled.bg},e=>{let{theme:t}=e;return(0,rN.hO)(t.sanity.space[1])},e=>{let{theme:t}=e;return(0,rN.hO)(t.sanity.space[2])}),yG=(0,lO.ZP)(rN.J2)(e2||(e2=d4(["\n  /* hides the popover when the target of it has left the visible part of the window.\n   without it, the popover will be on top of the headers (document title & changes)\n   and footers (changed notifications, publish button etc)*/\n  &[data-popper-reference-hidden='true'] {\n    display: none;\n  }\n"])));function yY(e){let{change:t,readOnly:n,hidden:i}=e,r=d3(e,s6),{titlePath:l,changes:a,path:o}=t,{path:s}=(0,rF.useContext)(vH),{documentId:d,schemaType:c,FieldWrapper:u,rootDiff:p,isComparingCurrent:h}=bd(),f=a.every(e=>ys(e)&&v4(e.schemaType)),m=v_(s,o),[g,x]=function(){let e=(0,rF.useRef)(null),[t,n]=(0,rF.useState)(!1);return(0,rF.useEffect)(()=>{let t=e.current;if(!t)return()=>void 0;let i=()=>n(!0),r=()=>n(!1);return t.addEventListener("mouseover",i),t.addEventListener("mouseout",r),()=>{t.removeEventListener("mouseover",i),t.removeEventListener("mouseout",r)}},[]),[e,t]}(),v=IQ(d,c.name),[b,y]=(0,rF.useState)(!1),[j,w]=(0,rF.useState)(null),[k,C]=zh({id:d,type:c.name,permission:"update"}),_=(0,rF.useCallback)(()=>yy(t,p,v),[t,p,v]),S=(0,rF.useCallback)(()=>{y(!0)},[]),E=(0,rF.useCallback)(()=>{y(!1)},[]);(0,rN.O8)(()=>y(!1),[j]);let T=(0,rF.useMemo)(()=>i?null:(0,rz.jsxs)(rN.Kq,{space:1,as:yW,"data-revert-group-hover":x?"":void 0,"data-portable-text":f?"":void 0,children:[(0,rz.jsx)(rN.Kq,{as:yX,space:5,children:a.map(e=>(0,rz.jsx)(yJ,{change:e,readOnly:n,hidden:i},e.key))}),h&&!C&&(null==k?void 0:k.granted)&&(0,rz.jsx)(yG,{content:(0,rz.jsxs)(rN.xu,{children:["Are you sure you want to revert the changes?",(0,rz.jsxs)(rN.rj,{columns:2,gap:2,marginTop:2,children:[(0,rz.jsx)(rN.zx,{mode:"ghost",onClick:E,children:(0,rz.jsx)(rN.xv,{align:"center",children:"Cancel"})}),(0,rz.jsx)(rN.zx,{tone:"critical",onClick:_,children:(0,rz.jsx)(rN.xv,{align:"center",children:"Revert change"})})]})]}),portal:!0,padding:4,placement:"left",open:b,ref:w,children:(0,rz.jsx)(rN.xu,{children:(0,rz.jsx)(yV,{onClick:S,ref:g,selected:b,disabled:n,"data-testid":"group-change-revert-button-".concat(t.fieldsetName)})})})]}),[a,E,b,n,t.fieldsetName,_,S,i,h,x,C,f,k,g]);return i?null:(0,rz.jsxs)(rN.Kq,d6(d6({space:1},r),{},{children:[(0,rz.jsx)(vU,{titlePath:l}),m||!u?T:(0,rz.jsx)(u,{hasHover:x,path:t.path,children:T})]}))}function yJ(e){var t,n;let{change:i,hidden:r,readOnly:l}=e,{value:a}=bd(),o=vK({document:a,checkProperty:r||(null==(t=i.schemaType)?void 0:t.hidden),checkPropertyKey:"hidden",value:"field"===i.type?i.diff.toValue:void 0}),s=vK({document:a,checkProperty:l||(null==(n=i.schemaType)?void 0:n.readOnly),checkPropertyKey:"readOnly",value:"field"===i.type?i.diff.toValue:void 0});return o?null:"field"===i.type?(0,rz.jsx)(y$,{change:i,readOnly:s}):"group"===i.type?(0,rz.jsx)(yY,{change:i,"data-testid":"group-change-".concat(i.fieldsetName),readOnly:s}):(0,rz.jsxs)(rN.xv,{children:["Unknown change type: ",(0,rz.jsx)("code",{children:i.type||"undefined"})]})}function yQ(){return(0,rz.jsxs)(rN.Kq,{space:3,children:[(0,rz.jsx)(rN.xv,{size:1,weight:"semibold",as:"h3",children:"There are no changes"}),(0,rz.jsx)(rN.xv,{as:"p",size:1,muted:!0,children:"Edit the document or select an older version in the timeline to see a list of changes appear in this panel."})]})}let y0=lO.ZP.div(e3||(e3=d4(["\n  display: grid;\n  grid-template-columns: minmax(0, 1fr);\n"]))),y1=(0,lO.ZP)(rN.J2)(e4||(e4=d4(["\n  /* hides the popover when the target of it has left the visible part of the window.\n   without it, the popover will be on top of the headers (document title & changes)\n   and footers (changed notifications, publish button etc)*/\n  &[data-popper-reference-hidden='true'] {\n    display: none;\n  }\n"])));function y2(e){let{diff:t,fields:n,schemaType:i}=e,{documentId:r,isComparingCurrent:l,value:a}=bd(),o=IQ(r,i.name),{path:s}=(0,rF.useContext)(vH),d=0===s.length,[c,u]=(0,rF.useState)(!1),[p,h]=(0,rF.useState)(!1),f=vK({document:a,value:void 0,checkProperty:i.readOnly,checkPropertyKey:"readOnly"});if("object"!==i.jsonType)throw Error("Only object schema types are allowed in ChangeList");let[m,g]=zh({id:r,type:i.name,permission:"update"}),x=(0,rF.useMemo)(()=>yu(i,t,s,[],{fieldFilter:n}),[i,n,s,t]),v=(0,rF.useMemo)(()=>n&&0===n.length?[]:1===x.length&&"group"===x[0].type&&0===x[0].path.length?x[0].changes:x,[x,n]),b=x[0],y=(0,rF.useCallback)(()=>{yy(b,t,o),u(!1)},[b,t,o]),j=(0,rF.useCallback)(()=>{u(!0)},[]),w=(0,rF.useCallback)(()=>{h(!0)},[]),k=(0,rF.useCallback)(()=>{h(!1)},[]),C=(0,rF.useCallback)(()=>{u(!1)},[]),[_,S]=(0,rF.useState)(null),E=(0,rF.useCallback)(()=>u(!1),[]);if((0,rN.O8)(E,[_]),0===v.length)return d?(0,rz.jsx)(yQ,{}):null;let T=d&&v.length>1;return(0,rz.jsx)(rN.Zb,{children:(0,rz.jsxs)(rN.Kq,{space:5,children:[(0,rz.jsx)(rN.Kq,{as:y0,space:5,children:v.map(e=>(0,rz.jsx)("div",{children:(0,rz.jsx)(yJ,{change:e,"data-revert-all-changes-hover":p?"":void 0,readOnly:f||(null==e?void 0:e.readOnly),hidden:null==e?void 0:e.hidden},e.key)},e.key))}),T&&l&&!g&&(null==m?void 0:m.granted)&&(0,rz.jsx)(y1,{content:(0,rz.jsxs)(rN.xu,{children:["Are you sure you want to revert all ",v.length," changes?",(0,rz.jsxs)(rN.rj,{columns:2,gap:2,marginTop:2,children:[(0,rz.jsx)(rN.zx,{mode:"ghost",text:"Cancel",onClick:C}),(0,rz.jsx)(rN.zx,{tone:"critical",text:"Revert all",onClick:y})]})]}),open:c,padding:4,placement:"left",portal:!0,ref:S,children:(0,rz.jsx)(rN.Kq,{children:(0,rz.jsx)(rN.zx,{tone:"critical",mode:"ghost",text:"Revert all changes",icon:lL.V13,onClick:j,onMouseEnter:w,onMouseLeave:k,disabled:f})})})]})})}let y3=lO.ZP.span(e5||(e5=d4(["\n  border-radius: ",";\n"])),e=>{let{theme:t}=e;return(0,rN.hO)(t.sanity.radius[1])}),y4=(0,lO.ZP)(rN.xv)(e6||(e6=d4(["\n  &:not([hidden]) {\n    display: inline;\n    line-height: calc(1.25em + 2px);\n  }\n\n  &:hover {\n    background-color: none !important;\n    background-image: linear-gradient(\n      to bottom,\n      var(--card-bg-color) 0,\n      var(--card-bg-color) 33.333%,\n      currentColor 33.333%,\n      currentColor 100%\n    );\n    background-size: 1px 3px;\n    background-repeat: repeat-x;\n    background-position-y: bottom;\n    padding-bottom: 3px;\n    box-shadow: 0 0 0 1px var(--card-bg-color);\n    z-index: 1;\n  }\n"])));function y5(e){let{segment:t}=e,{text:n}=t;return"added"===t.action?(0,rz.jsx)(vD,{annotation:t.annotation,disableHoverEffect:!0,tooltip:{description:"Added"},as:y3,children:(0,rz.jsx)(y4,{as:"ins",style:{textDecoration:"none"},children:n})}):"removed"===t.action?(0,rz.jsx)(vD,{annotation:t.annotation,as:y3,disableHoverEffect:!0,tooltip:{description:"Removed"},children:(0,rz.jsx)(y4,{as:"del",children:n})}):(0,rz.jsx)(rN.Zb,{as:"span",radius:2,style:{display:"inline"},children:n})}function y6(e){let{diff:t}=e;return(0,rz.jsx)(rz.Fragment,{children:(t.segments||[]).map((e,t)=>(0,rz.jsx)(y5,{segment:e},t))})}let y8=(0,lO.ZP)(rN.xv)(e8||(e8=d4(["\n  color: inherit;\n"])));function y7(e){let{title:t,action:n,icon:i,children:r,markRemoved:l}=e;return(0,rz.jsxs)(rN.kC,{padding:2,align:"center",children:[i&&(0,rz.jsx)(rN.xu,{padding:2,children:(0,rz.jsx)(y8,{size:4,forwardedAs:l?"del":"div",children:(0,rF.createElement)(i)})}),(0,rz.jsxs)(rN.Kq,{space:2,paddingLeft:2,children:[(0,rz.jsx)(y8,{size:1,weight:"semibold",forwardedAs:l?"del":"h3",textOverflow:"ellipsis",children:t}),n&&(0,rz.jsx)("div",{children:n}),(0,rz.jsx)(y8,{size:0,textOverflow:"ellipsis",children:r})]})]})}function y9(e){let t=cp(e),{getDocument:n,patchChannel:i}=hi().__internal,r=(0,rF.useMemo)(()=>new rH.xQ,[]),l=(0,rF.useMemo)(()=>r.asObservable(),[r]),[a,o]=(0,rF.useState)(()=>vk(n(),t));return(0,rF.useEffect)(()=>i.subscribe(()=>r.next(n())),[r,n,i]),(0,rF.useEffect)(()=>{let e=l.pipe((0,r8.U)(e=>0===t.length?e:vk(e,t)),(0,r9.x)((e,t)=>lM()(e,t))),n=e.subscribe(o);return()=>n.unsubscribe()},[l,t]),a}lO.ZP.div(e7||(e7=d4(["\n  display: inline-block;\n  word-wrap: break-word;\n"]))),lO.ZP.div(e9||(e9=d4(["\n  display: inline-block;\n  word-break: break-all;\n  white-space: pre-wrap;\n"])));let je={available:!0,reason:"READABLE"},jt={available:!1,reason:"PERMISSION_DENIED"},jn={available:!1,reason:"NOT_FOUND"};async function ji(e,t,n){if(!e)return{};if("function"==typeof e.filter){let i=n.slice(0,-1),r=(0,rR.U2)(t,i);return e.filter({document:t,parentPath:i,parent:r})}return{filter:e.filter,params:"filterParams"in e?e.filterParams:void 0}}async function jr(e,t,n){if(!e)return{};if("function"==typeof e.filter){let i=n.slice(0,-1),r=rR.U2(t,i);return e.filter({document:t,parentPath:i,parent:r})}return{filter:e.filter,params:"filterParams"in e?e.filterParams:void 0}}function jl(e){var t,n,i,r;let{path:l,schemaType:a}=e,o=IW(uX),s=I3(),d=Rm(),c=(0,rF.useMemo)(()=>o.withConfig({apiVersion:"2021-03-25"}),[o]),{EditReferenceLinkComponent:u,onEditReference:p,activePath:h,initialValueTemplateItems:f}=h_(),m=y9([]),g=function(e){let t=(0,rF.useRef)(e);return t.current=e,t}(m),x=null==(t=g.current)?void 0:t._type,v=(0,rF.useMemo)(()=>{var e;return null==(e=s.get(x))?void 0:e.liveEdit},[x,s]),b=(null==(n=a.options)?void 0:n.disableNew)===!0,y=(0,rF.useCallback)(e=>(0,r1.D)(jr(a.options,g.current,l)).pipe((0,ls.zg)(t=>{let{filter:n,params:i}=t;return pQ(c,e,a,d6(d6({},a.options),{},{filter:n,params:i,tag:"search.reference"}))}),(0,le.K)(e=>{var t;let n=e.details&&"queryParseError"===e.details.type;return(null==(t=a.options)?void 0:t.filter)&&n&&(e.message='Invalid reference filter, please check the custom "filter" option'),(0,rW._)(e)})),[g,l,c,a]),j=null==(r=null==(i=e.value)?void 0:i._strengthenOnPublish)?void 0:r.template,w=(0,rF.useMemo)(()=>(0,rF.forwardRef)(function(e,t){return u?(0,rz.jsx)(u,d6(d6({},e),{},{ref:t,parentRefPath:l,template:j})):null}),[u,l,j]),k=(0,rF.useCallback)(e=>{null==p||p({parentRefPath:l,id:e.id,type:e.type,template:e.template})},[p,l]),C=rR.Ny(l,(null==h?void 0:h.path)||[])?null==h?void 0:h.state:"none",_=(0,rF.useMemo)(()=>b?[]:(f||[]).filter(e=>a.to.some(t=>{var n;return t.name===(null==(n=e.template)?void 0:n.schemaType)})).map(e=>{var t;return(null==(t=e.template)?void 0:t.schemaType)?{id:e.id,title:e.title||"".concat(e.template.schemaType," from template ").concat(e.template.id),type:e.template.schemaType,icon:e.icon,template:{id:e.template.id,params:e.parameters},permission:{granted:e.granted,reason:e.reason}}:void 0}).filter(cf),[b,f,a.to]),S=(0,rF.useCallback)(e=>pJ(d,e,a),[d,a]);return{selectedState:C,handleSearch:y,isCurrentDocumentLiveEdit:v,handleEditReference:k,EditReferenceLink:w,createOptions:_,getReferenceInfo:S}}function ja(e){let{getReferenceInfo:t,id:n,renderPreview:i}=e,{isLoading:r,result:l,error:a}=f5(n,t);if(r)return(0,rz.jsxs)(rN.Kq,{space:2,padding:1,children:[(0,rz.jsx)(rN.Qr,{style:{maxWidth:320},radius:1,animated:!0}),(0,rz.jsx)(rN.Qr,{style:{maxWidth:200},radius:1,size:1,animated:!0})]});if(a)return(0,rz.jsx)(rN.Kq,{space:2,padding:1,children:(0,rz.jsx)(p9,{title:"Failed to load referenced document",children:(0,rz.jsxs)(rN.xv,{muted:!0,size:1,children:["Error: ",a.message]})})});if(!l)return null;if("PERMISSION_DENIED"===l.availability.reason)return(0,rz.jsx)(rN.Kq,{space:2,padding:1,children:"Insufficient permissions to view this document"});let o=e.type.to.find(e=>e.name===l.type);return o?l&&o&&(0,rz.jsx)(f7,{availability:l.availability,id:l.id,layout:"default",preview:l.preview,refType:o,renderPreview:i,showTypeLabel:e.type.to.length>1}):(0,rz.jsxs)(rN.Kq,{space:2,padding:1,children:["Search returned a type that's not valid for this reference: \"$",l.type,'"']})}function jo(e){let{enabled:t}=e,n=d3(e,s8);return t?(0,rz.jsx)(rN.u,d6({},n)):(0,rz.jsx)(rz.Fragment,{children:e.children})}let js={display:"inline-flex"},jd={width:"100%"};function jc(e){let{createOptions:t,onCreate:n,id:i}=e,r=d3(e,s7),l=t.some(e=>e.permission.granted);return l?t.length>1?(0,rz.jsx)(rN.j2,{button:(0,rz.jsx)(rN.zx,d6(d6({},r),{},{text:"Create new…",mode:"ghost",icon:lL.dtP})),id:i,menu:(0,rz.jsx)(rN.v2,{ref:e.menuRef,children:t.map(e=>(0,rz.jsx)(jo,{enabled:!e.permission.granted,content:(0,rz.jsx)(rN.xu,{padding:2,children:(0,rz.jsx)(ul,{operationLabel:"create this type of document"})}),portal:!0,children:(0,rz.jsx)("div",{children:(0,rz.jsx)(rN.sN,{disabled:!e.permission.granted,icon:e.icon,text:e.title,onClick:()=>n(e)})})},e.id))}),placement:"right",popover:{portal:!0,tone:"default",constrainSize:!0}}):(0,rz.jsx)(rN.zx,d6(d6({},r),{},{text:"Create new",mode:"ghost",disabled:!t[0].permission.granted,onClick:()=>n(t[0]),icon:lL.dtP})):(0,rz.jsx)(rN.u,{content:(0,rz.jsx)(rN.xu,{padding:2,children:(0,rz.jsx)(ul,{operationLabel:"create a new reference"})}),children:(0,rz.jsx)("div",{style:js,children:(0,rz.jsx)(rN.zx,{text:"Create new",mode:"ghost",disabled:!0,icon:lL.dtP,style:jd})})})}let ju=(0,lO.ZP)(rN.J2)(te||(te=d4(["\n  & > div {\n    overflow: auto;\n    -webkit-overflow-scrolling: touch;\n  }\n"]))),jp=(0,lO.ZP)(rN.xv)(tt||(tt=d4(["\n  word-break: break-word;\n"]))),jh=(0,rF.forwardRef)(function(e,t){let n=e.options&&e.options.length>0,i=(0,rF.useCallback)((t,i)=>{var r;let{content:l,hidden:a,inputElement:o,onMouseEnter:s,onMouseLeave:d}=t;return(0,rz.jsx)(ju,{placement:"bottom-start",arrow:!1,constrainSize:!0,onMouseEnter:s,onMouseLeave:d,content:(0,rz.jsx)("div",{ref:i,children:n?l:(0,rz.jsx)(rN.xu,{padding:4,children:(0,rz.jsx)(rN.kC,{align:"center",height:"fill",justify:"center",children:(0,rz.jsxs)(jp,{align:"center",muted:!0,children:["No results for ",(0,rz.jsxs)("strong",{children:["“",e.searchString,"”"]}),(null==(r=e.searchString)?void 0:r.toLowerCase())==="capybara"?(0,rz.jsx)(rz.Fragment,{children:". What a shame. There should be more Capybaras."}):null]})})})}),open:!e.loading&&!a,ref:e.portalRef,portal:!0,referenceElement:e.referenceElement||o,matchReferenceWidth:!0})},[n,e.searchString,e.loading,e.portalRef,e.referenceElement]);return(0,rz.jsx)(rN.F2,d6(d6({},e),{},{ref:t,renderPopover:i}))}),jf=(0,lO.iv)(tn||(tn=d4(["\n  grid-template-columns: minmax(0px, 1fr);\n"]))),jm=(0,lO.iv)(ti||(ti=d4(["\n  grid-template-columns: 1fr min-content;\n"]))),jg=(0,lO.ZP)(rN.rj)(e=>e.$narrow?jf:jm),jx=(0,rF.forwardRef)(function(e,t){let[n,i]=(0,rF.useState)(null),r=(0,rF.useCallback)(e=>{var n;"function"==typeof(n=t)?n(e):n&&(n.current=e),i(e)},[t]),l=(0,rN.XL)(n);return(0,rz.jsx)(jg,{ref:r,gap:1,$narrow:480>((null==l?void 0:l.width)||0),children:e.children})}),jv=(0,lO.ZP)(us)(tr||(tr=d4(["\n  /* this is a hack to avoid layout jumps while previews are loading\n  there's probably better ways of solving this */\n  min-height: 36px;\n"]))),jb={hits:[],isLoading:!1},jy=()=>!0;function jj(e){return null!==e}function jw(e){var t,n,i,r,l,a,o;let{createOptions:s,onChange:d,onEditReference:c,onSearch:u,schemaType:p,readOnly:h,id:f,onPathFocus:m,value:g,renderPreview:x,path:v,elementProps:b}=e,{getReferenceInfo:y}=jl({path:v,schemaType:p,value:g}),[j,w]=(0,rF.useState)(jb),k=(0,rF.useCallback)(e=>{let t=(0,aY.Z)(),n=[p2({}),p4(p.name,["_type"]),p4(t,["_ref"]),p4(!0,["_weak"]),p4({type:e.type,weak:p.weak,template:e.template},["_strengthenOnPublish"])].filter(cf);d(n),c({id:t,type:e.type,template:e.template}),m([])},[d,c,m,p]),C=(0,rF.useCallback)(e=>{if(!e){d(p5()),m([]);return}let t=j.hits.find(t=>t.id===e);if(!t)throw Error("Selected an item that wasnt part of the result set");let n=[p2({}),p4(p.name,["_type"]),p4(cb(e),["_ref"]),t.published&&!p.weak?p5(["_weak"]):p4(!0,["_weak"]),t.published?p5(["_strengthenOnPublish"]):p4({type:null==t?void 0:t.type,weak:p.weak},["_strengthenOnPublish"])].filter(cf);d(n),m([])},[d,m,p.name,p.weak,j.hits]),_=(0,rF.useCallback)(()=>{d(p5())},[d]),S=(0,rF.useCallback)(e=>{"Escape"===e.key&&m([])},[m]),E=f5(null==g?void 0:g._ref,y),T=(0,rF.useRef)(null),{push:A}=(0,rN.pm)(),P=(0,rV.W2)(e=>e.pipe((0,lt.h)(jj),(0,r9.x)(),(0,r6.w)(e=>(0,rU.z)((0,rB.of)({isLoading:!0}),u(e).pipe((0,r8.U)(t=>({hits:t,searchString:e,isLoading:!1})),(0,le.K)(e=>(A({title:"Reference search failed",description:e.message,status:"error",id:"reference-search-fail-".concat(f)}),console.error(e),(0,rB.of)({hits:[]})))))),(0,r7.R)((e,t)=>d6(d6({},e),t),jb),(0,lr.b)(w)),[f,u,A]),I=(0,rF.useCallback)(()=>{P("")},[P]),M=(0,rF.useCallback)(e=>{"Escape"===e.key&&m([])},[m]),z=(0,rF.useCallback)(e=>{var t,n;let i=(null==(t=e.hit.draft)?void 0:t._id)||(null==(n=e.hit.published)?void 0:n._id)||e.value;return(0,rz.jsx)(jv,{forwardedAs:"button",type:"button",radius:2,tone:"inherit",children:(0,rz.jsx)(rN.xu,{paddingX:3,paddingY:1,children:(0,rz.jsx)(ja,{getReferenceInfo:y,id:i,renderPreview:x,type:p})})})},[p,y,x]),R=(0,rF.useCallback)(()=>{var e,t,n,i;return(null==(t=null==(e=E.result)?void 0:e.preview.draft)?void 0:t.title)||(null==(i=null==(n=E.result)?void 0:n.preview.published)?void 0:i.title)||""},[null==(n=null==(t=E.result)?void 0:t.preview.draft)?void 0:n.title,null==(r=null==(i=E.result)?void 0:i.preview.published)?void 0:r.title]),F=(0,rF.useCallback)(()=>m(["_ref"]),[m]),O=(0,rF.useCallback)(t=>{var n;(null==(n=T.current)?void 0:n.contains(t.relatedTarget))||e.elementProps.onBlur(t)},[e.elementProps]),D=(null==(a=null==(l=null==E?void 0:E.result)?void 0:l.availability)?void 0:a.reason)==="NOT_FOUND"&&!(null==g?void 0:g._strengthenOnPublish)&&(null==g?void 0:g._weak);ht((null==(o=e.focusPath)?void 0:o[0])==="_ref",(e,t)=>{var n;!e&&t&&(null==(n=b.ref.current)||n.focus())});let Z=(0,rF.useMemo)(()=>j.hits.map(e=>({value:e.id,hit:e})),[j.hits]);return(0,rz.jsx)(rN.Kq,{space:1,"data-testid":"reference-input",children:(0,rz.jsxs)(rN.Kq,{space:2,children:[D?(0,rz.jsx)(p9,{"data-testid":"alert-nonexistent-document",title:"Nonexistent document reference",suffix:(0,rz.jsx)(rN.Kq,{padding:2,children:(0,rz.jsx)(rN.zx,{text:"Clear",onClick:_})}),children:(0,rz.jsxs)(rN.xv,{size:1,children:["This field is currently referencing a document that doesn't exist (ID:",(0,rz.jsx)("code",{children:g._ref}),"). You can either remove the reference or replace it with another document."]})}):null,(0,rz.jsxs)(jx,{ref:T,children:[(0,rz.jsx)(jh,d6(d6({},b),{},{onFocus:F,onBlur:O,"data-testid":"autocomplete",loading:j.isLoading,referenceElement:T.current,options:Z,radius:1,placeholder:"Type to search",onKeyDown:S,readOnly:E.isLoading,onQueryChange:P,searchString:j.searchString,onChange:C,filterOption:jy,renderOption:z,renderValue:R,value:null==g?void 0:g._ref,openButton:{onClick:I}})),!h&&s.length>0&&(0,rz.jsx)(jc,{id:"".concat(f,"-selectTypeMenuButton"),createOptions:s,onCreate:k,onKeyDown:M})]})]})})}async function jk(e,t,n){if(!e)return{};if("function"==typeof e.filter){let i=n.slice(0,-1),r=(0,rR.U2)(t,i);return e.filter({document:t,parentPath:i,parent:r})}return{filter:e.filter,params:"filterParams"in e?e.filterParams:void 0}}function jC(e){var t,n,i,r;let l=IW(uX),a=I3(),o=Rm(),{path:s,schemaType:d}=e,{EditReferenceLinkComponent:c,onEditReference:u,activePath:p,initialValueTemplateItems:h}=h_(),f=y9([]),m=function(e){let t=(0,rF.useRef)(e);return t.current=e,t}(f),g=null==(t=m.current)?void 0:t._type,x=a.get(g),v=(0,rF.useMemo)(()=>null==x?void 0:x.liveEdit,[x]),b=(null==(n=d.options)?void 0:n.disableNew)===!0,y=(0,rF.useCallback)(e=>(0,r1.D)(jk(d.options,m.current,s)).pipe((0,ls.zg)(t=>{let{filter:n,params:i}=t;return pQ(l,e,d,d6(d6({},d.options),{},{filter:n,params:i,tag:"search.reference"}))}),(0,le.K)(e=>{var t;let n=e.details&&"queryParseError"===e.details.type;return(null==(t=d.options)?void 0:t.filter)&&n&&(e.message='Invalid reference filter, please check the custom "filter" option'),(0,rW._)(e)})),[m,s,l,d]),j=null==(r=null==(i=e.value)?void 0:i._strengthenOnPublish)?void 0:r.template,w=(0,rF.useMemo)(()=>(0,rF.forwardRef)(function(e,t){return c?(0,rz.jsx)(c,d6(d6({},e),{},{ref:t,parentRefPath:s,template:j})):null}),[c,s,j]),k=(0,rF.useCallback)(e=>{null==u||u({parentRefPath:s,id:e.id,type:e.type,template:e.template})},[u,s]),C=rR.Ny(s,(null==p?void 0:p.path)||[])?null==p?void 0:p.state:"none",_=(0,rF.useMemo)(()=>b?[]:(h||[]).filter(e=>d.to.some(t=>{var n;return t.name===(null==(n=e.template)?void 0:n.schemaType)})).map(e=>{var t,n,i;return(null==(t=e.template)?void 0:t.schemaType)?{id:e.id,title:e.title||"".concat(e.template.schemaType," from template ").concat(null==(n=e.template)?void 0:n.id),type:e.template.schemaType,icon:e.icon,template:{id:null==(i=e.template)?void 0:i.id,params:e.parameters},permission:{granted:e.granted,reason:e.reason}}:void 0}).filter(cf),[b,h,d.to]),S=(0,rF.useCallback)((e,t)=>pJ(o,e,t),[o]);return(0,rz.jsx)(jw,d6(d6({},e),{},{onSearch:y,liveEdit:v,getReferenceInfo:S,selectedState:C,editReferenceLinkComponent:w,createOptions:_,onEditReference:k}))}function j_(e,t){if(e===t)return!0;if(typeof e!=typeof t)return!1;if("object"!=typeof e&&!Array.isArray(e))return e===t;if(e._key&&e._key===t._key)return!0;if(Array.isArray(e))return!e.length===t.length&&e.every((n,i)=>j_(e[i],t[i]));let n=Object.keys(e),i=Object.keys(e);return n.length===i.length&&n.every(n=>j_(e[n],t[n]))}function jS(e,t){return!!e&&e.some(e=>j_(e,t))}let jE=[];function jT(e){var t,n;let{renderPreview:i,schemaType:r,onChange:l,onPathFocus:a,value:o=[],readOnly:s,elementProps:d,path:c,changed:u}=e,p=(0,rF.useMemo)(()=>{var e;return((null==(e=r.options)?void 0:e.list)||jE).map((e,t)=>(0,rM.fU)(e)?e:d6(d6({},e),{},{_key:"auto-generated-".concat(t)}))},[null==(t=r.options)?void 0:t.list]),h=(0,rF.useCallback)((e,t)=>{if(!e&&(0,rM.fU)(t)){l(p5([{_key:t._key}]));return}let n=p.filter(n=>j_(t,n)?e:jS(o,n));l(n.length>0?p4(n):p5())},[l,p,o]),f=(0,rF.useCallback)(e=>{a([e])},[a]),m=(null==(n=r.options)?void 0:n.layout)==="grid";return(0,rz.jsx)(cH,{path:c,isChanged:u,hasFocus:!1,children:(0,rz.jsx)(rN.rj,d6(d6({gap:2,columns:m?Math.min(p.length,4):1,tabIndex:0},d),{},{children:p.map((e,t)=>{let n=r.of.find(t=>t.name===(0,a3.wq)(e)),l=jS(o,e),a=!n;return(0,rz.jsxs)(rN.kC,{align:"center",as:"label",muted:a,children:[(0,rz.jsx)(rN.XZ,{disabled:a,checked:l,onChange:t=>h(t.currentTarget.checked,e),onFocus:()=>f(t),readOnly:s}),(0,rz.jsx)(rN.xu,{flex:1,marginLeft:2,children:n?i({layout:"default",schemaType:n,value:e}):(0,rz.jsx)(rN.Zb,{tone:"caution",radius:2,children:(0,rz.jsx)(m2,{value:e,onFocus:()=>f(t)})})})]},t)})}))})}let jA=(0,lO.ZP)(rN.Zb)(tl||(tl=d4(["\n  max-width: ","px;\n"])),e=>{let{theme:t}=e;return t.sanity.container[1]});function jP(e){let{value:t,onFocus:n,vertical:i}=e,r=d3(e,s9),[l,a]=rF.useState(!1),[o,s]=rF.useState(null);(0,rN.O8)(()=>a(!1),[o]);let d=rF.useCallback(e=>{("Escape"===e.key||"Tab"===e.key)&&a(!1)},[]),c=(0,rF.useCallback)(()=>{a(e=>!e)},[]),u=(0,a3.wq)(t);return(0,rz.jsx)(rN.J2,{open:l,ref:s,onKeyDown:d,portal:!0,constrainSize:!0,tone:"default",content:(0,rz.jsx)(jA,{margin:1,padding:3,onKeyDown:d,tabIndex:0,overflow:"auto",children:(0,rz.jsxs)(rN.Kq,{space:4,children:[(0,rz.jsx)(rN.xu,{children:(0,rz.jsx)(rN.xv,{weight:"semibold",children:"Why is this happening?"})}),(0,rz.jsxs)(rN.xv,{size:1,children:["The current schema does not declare items of type ",(0,rz.jsx)("code",{children:u})," as valid for this list. This could mean that the type has been removed as a valid item type, or that someone else has added it to their own local schema that is not yet deployed."]}),(0,rz.jsx)(rN.xu,{children:(0,rz.jsxs)(rN.xv,{size:1,children:[(0,rz.jsx)(lL.sLo,{})," You can still move or delete this item, but it cannot be edited since the schema definition for its type is nowhere to be found."]})}),(0,rz.jsxs)(rN.Kq,{space:2,children:[(0,rz.jsx)(rN.xv,{size:1,weight:"semibold",children:"JSON representation of this item:"}),(0,rz.jsx)(rN.Zb,{padding:2,overflow:"auto",border:!0,children:(0,rz.jsx)(rN.EK,{size:1,as:"pre",language:"json",children:JSON.stringify(t,null,2)})})]})]})}),children:(0,rz.jsx)(rN.Zb,d6(d6({as:"button",type:"button",radius:2,tone:"inherit",paddingX:2,paddingY:3,flex:1,onFocus:n,onClick:c,onKeyDown:d,__unstable_focusRing:!0},r),{},{children:(0,rz.jsxs)(rN.kC,{align:"center",children:[(0,rz.jsx)(rN.xu,{marginRight:3,children:(0,rz.jsx)(rN.xv,{children:(0,rz.jsx)(lL.Tzq,{})})}),(0,rz.jsx)(rN.xu,{flex:1,children:(0,rz.jsxs)(rN.xv,{size:1,textOverflow:"ellipsis",children:["Item of type ",(0,rz.jsx)("code",{children:u})," not valid for this list"]})})]})}))})}function jI(e){var t,n;let{schemaType:i,onChange:r,value:l=[],readOnly:a,path:o,changed:s,onIndexFocus:d,elementProps:c}=e,u=(0,rF.useMemo)(()=>{var e;return((null==(e=i.options)?void 0:e.list)||[]).map(e=>Boolean(e&&"object"==typeof e&&"title"in e&&"value"in e)?{title:e.title||l$()(String(e.value)),value:e.value}:{title:l$()(String(e)),value:e})},[null==(t=i.options)?void 0:t.list]),p=(e,t)=>{let n=u.map(e=>e.value).filter(n=>n===t?e:l.includes(n));r(n.length>0?p4(n):p5())},h=(null==(n=i.options)?void 0:n.layout)==="grid";return(0,rz.jsx)(cH,{path:o,isChanged:s,hasFocus:!1,children:(0,rz.jsx)(rN.rj,d6(d6({gap:2,columns:h?Math.min(u.length,4):1},c),{},{children:u.map((e,t)=>{let n=i.of.find(t=>t.name===(0,a3.wq)(e.value)),r=l.includes(e.value),o=!n;return(0,rz.jsxs)(rN.kC,{align:"center",as:"label",muted:o,children:[(0,rz.jsx)(rN.XZ,{disabled:o,checked:r,onChange:t=>p(t.currentTarget.checked,e.value),onFocus:()=>d(t),readOnly:a}),(0,rz.jsx)(rN.xu,{padding:2,children:(0,rz.jsx)(rN.xv,{children:e.title})}),!n&&(0,rz.jsx)(jP,{value:e,onFocus:()=>d(t)})]},t)})}))})}function jM(e){return(0,rM.M1)(e.schemaType)?(0,rz.jsx)(jT,d6({},e)):(0,rz.jsx)(jI,d6({},e))}let jz=lO.ZP.div(ta||(ta=d4(["\n  position: relative;\n"]))),jR=lO.ZP.div(to||(to=d4(["\n  z-index: 13;\n  opacity: 0;\n  transition: opacity 300ms linear;\n"]))),jF=(0,lO.ZP)(rN.Zb)(ts||(ts=d4(["\n  border: 1px solid var(--card-border-color);\n  position: absolute;\n  top: 0;\n  left: 0;\n  width: 100%;\n  height: 100%;\n  z-index: 12;\n  transition: opacity 150ms ease-in-out;\n  opacity: 0;\n  box-sizing: border-box;\n"]))),jO=(0,lO.ZP)(rN.kC)(td||(td=d4(["\n  position: absolute;\n  top: 0;\n  left: 0;\n  width: 100%;\n  height: 100%;\n\n  :hover,\n  :focus {\n    & "," {\n      opacity: 0.9;\n    }\n\n    & "," {\n      opacity: 1;\n    }\n  }\n"])),jF,jR),jD=()=>"undefined"!=typeof window&&"ontouchstart"in window||"undefined"!=typeof navigator&&navigator.maxTouchPoints>0;function jZ(e){let{children:t,message:n,onActivate:i,isOverlayActive:r}=e,[l,a]=(0,rF.useState)(!1),o=(0,rF.useCallback)(()=>{i&&i()},[i]),s=(0,rF.useCallback)(e=>{r&&"Space"===e.code&&i&&(e.preventDefault(),i())},[r,i]),d=(0,rF.useCallback)(()=>{a(!0)},[]),c=(0,rF.useCallback)(()=>{a(!1)},[]),u=(0,rF.useMemo)(()=>{let e=jD(),t=e?"Tap":"Click";l&&!e&&(t+=" or press space");let i=n||"".concat(t," to activate");return(0,rz.jsx)(rN.xv,{weight:"semibold",children:i})},[l,n]);return(0,rz.jsxs)(jz,{onBlur:c,onClick:o,onFocus:d,onKeyDown:s,children:[r&&(0,rz.jsxs)(jO,{tabIndex:0,align:"center",justify:"center",children:[(0,rz.jsx)(jF,{radius:1}),(0,rz.jsx)(jR,{children:u})]}),t]})}let jL=lO.ZP.div(tc||(tc=d4(["\n  display: flex;\n  pointer-events: 'all';\n"])));function jq(e){let t=(0,a4._F)(),{block:n,onChange:i,renderBlockActions:r}=e,l=(0,rF.useMemo)(()=>t.schemaTypes.decorators.map(e=>e.value),[t]),a=(0,rF.useMemo)(()=>{if(r){let e={block:n,value:a4.q$.getValue(t),set:function(e){let{allowedDecorators:t,block:n,onChange:i}=e;return e=>{let r=[p4((0,od.nX)(e,{allowedDecorators:t}),[{_key:n._key}])];return i(r)}}({allowedDecorators:l,block:n,onChange:i}),unset:function(e){let{block:t,onChange:n}=e;return()=>{let e=[p5([{_key:t._key}])];return n(e)}}({block:n,onChange:i}),insert:function(e){let t;let{allowedDecorators:n,block:i,onChange:r}=e;return e=>{t=(t=Array.isArray(e)?e:[e]).map(e=>(0,od.nX)(e,{allowedDecorators:n}));let l=[p3(t,"after",[{_key:i._key}])];return r(l)}}({allowedDecorators:l,block:n,onChange:i})};return r(e)}},[r,n,t,i,l]),o=(0,rF.useCallback)(()=>{a4.q$.blur(t)},[t]);return a?(0,rz.jsx)(jL,{contentEditable:!1,onKeyDown:o,onMouseDown:o,children:a}):null}let jN=lO.ZP.div(e=>{let{theme:t}=e,{radius:n,space:i,color:r}=t.sanity,l=(0,rN.m4)(r.spot.yellow,.2);return(0,lO.iv)(tu||(tu=d4(["\n    position: absolute;\n    border-radius: ","px;\n    top: -","px;\n    bottom: -","px;\n    left: ","px;\n    right: 0;\n    background-color: ",";\n  "])),n[3],i[2],i[1]+i[1],i[4]+i[1],l)}),jV=(0,lO.ZP)(cH)(()=>(0,lO.iv)(tp||(tp=d4(["\n    width: 1px;\n    height: 100%;\n\n    & > div {\n      height: 100%;\n    }\n  "]))));function jB(e,t){return function e(t,n,i){if(t===n)return t;if(null==t||null==n||typeof t!=typeof n)return n;if(Array.isArray(n)){i.add(n);let r=t.length===n.length,l=[];for(let a=0;a<n.length;a++){if(i.has(n[a]))return n;let o=e(t[a],n[a],i);o!==t[a]&&(r=!1),l[a]=o}return r?t:l}if("object"==typeof n){i.add(n);let s=Object.keys(n),d=Object.keys(t).length===s.length,c={};for(let u of s){if(i.has(n[u]))return n;let p=e(t[u],n[u],i);p!==t[u]&&(d=!1),c[u]=p}return d?t:c}return n}(e,t,new WeakSet)}function jU(e){return e.type?jU(e.type):"block"===e.name}function jK(e){return"field"===e.kind&&"array"===e.field.schemaType.jsonType}let jH=["@@_NONEXISTENT_PATH_@@"];function j$(e){let t=(0,rF.useRef)(null),n=(null==e?void 0:e.validation)&&e.validation.length>0?e.validation:cw,i=hv((null==e?void 0:e.path)||jH),r=(0,rF.useMemo)(()=>(null==e?void 0:e.schemaType)&&jU(null==e?void 0:e.schemaType)?n:n.concat(i),[i,e,n]),[l,a,o]=(0,rF.useMemo)(()=>[r.filter(e=>"error"===e.level).length>0,r.filter(e=>"warning"===e.level).length>0,r.filter(e=>"info"===e.level).length>0],[r]),s=jB(t.current,r);return t.current=s,(0,rF.useMemo)(()=>({validation:s,hasError:l,hasWarning:a,hasInfo:o}),[s,l,a,o])}let jX=(0,rF.createContext)([]);function jW(e){return(0,rz.jsx)(jX.Provider,{value:e.markers,children:e.children})}function jG(e){let t=(0,rF.useContext)(jX);if(!t)throw Error("Form context not provided");let n=(0,rF.useMemo)(()=>t.filter(t=>(0,rR.Xy)(t.path,e)),[t,e]);return n}let jY=(0,rF.createContext)([]);function jJ(e){return(0,rz.jsx)(jY.Provider,{value:e.memberItems,children:e.children})}function jQ(e){let t=(0,rF.useContext)(jY);if(!t)throw Error("Form context not provided");return t.find(t=>t.key===e)}function j0(){let e=(0,rF.useContext)(jY);if(!e)throw Error("Form context not provided");return e}function j1(e){}let j2={constrainSize:!0,placement:"bottom",portal:"default",tone:"default"};function j3(e){let{focused:t,isActive:n,onClickingDelete:i,onClickingEdit:r,readOnly:l,renderPreview:a,type:o,value:s}=e,{isTopLayer:d}=(0,rN.sJ)(),c=(0,a4._F)(),u=(0,rF.useId)(),p=(0,rF.useRef)(null),h=(0,rF.useRef)(!1),f=u0("image",o),m=(0,rF.useMemo)(()=>"_ref"in s&&s._ref?(0,rF.forwardRef)(function(e,t){return(0,rz.jsx)(lq.nR,d6(d6({},e),{},{intent:"edit",params:{id:s._ref},ref:t}))}):void 0,[s]);(0,rN.qh)((0,rF.useCallback)(e=>{t&&("Escape"===e.key&&d&&(h.current=!1,a4.q$.focus(c)),"Tab"===e.key&&p.current&&!h.current&&(e.preventDefault(),e.stopPropagation(),p.current.focus(),h.current=!0))},[t,d,c]));let g=(0,rz.jsx)(rN.j2,{button:(0,rz.jsx)(rN.zx,{"aria-label":"Open menu",fontSize:1,iconRight:lL.zGg,mode:"bleed",paddingX:2,tabIndex:n?0:1}),ref:p,id:u,menu:(0,rz.jsx)(rN.v2,{children:(0,rz.jsxs)(rz.Fragment,{children:["_ref"in s&&s._ref&&(0,rz.jsx)(rN.sN,{as:m,"data-as":"a",icon:lL.xPt,text:"Open reference"}),l&&(0,rz.jsx)(rN.sN,{icon:lL.hsE,onClick:r,text:"View"}),!l&&(0,rz.jsx)(rN.sN,{icon:lL.dY8,onClick:r,text:"Edit"}),!l&&(0,rz.jsx)(rN.sN,{icon:lL.XHJ,onClick:i,text:"Delete",tone:"critical"})]})}),popover:j2});return(0,rz.jsx)(rz.Fragment,{children:a({actions:g,layout:f?"blockImage":"block",schemaType:o,value:s})})}let j4=(0,lO.ZP)(rN.Zb)(e=>{var t;let{color:n,radius:i,space:r}=e.theme.sanity,l=(0,lO.iv)(th||(th=d4(["\n    pointer-events: none;\n    content: '';\n    position: absolute;\n    top: -","px;\n    bottom: -","px;\n    left: -","px;\n    right: -","px;\n    border-radius: ","px;\n    mix-blend-mode: ",";\n  "])),r[1],r[1],r[1],r[1],i[2],n.dark?"screen":"multiply");return(0,lO.iv)(tf||(tf=d4(["\n    box-shadow: 0 0 0 1px var(--card-border-color);\n    border-radius: ","px;\n    pointer-events: all;\n    position: relative;\n\n    &[data-focused] {\n      box-shadow: 0 0 0 1px ",";\n    }\n\n    &:not([data-focused]):not([data-selected]) {\n      @media (hover: hover) {\n        &:hover {\n          --card-border-color: ",";\n        }\n      }\n    }\n\n    &[data-markers] {\n      &:after {\n        ","\n        background-color: ",";\n      }\n    }\n\n    &[data-warning] {\n      &:after {\n        ","\n        background-color: ",";\n      }\n\n      @media (hover: hover) {\n        &:hover {\n          --card-border-color: ",";\n        }\n      }\n    }\n\n    &[data-invalid] {\n      &:after {\n        ","\n        background-color: ",";\n      }\n\n      @media (hover: hover) {\n        &:hover {\n          --card-border-color: ",";\n        }\n      }\n    }\n  "])),i[1],null==(t=n.selectable)?void 0:t.primary.selected.border,n.input.default.hovered.border,l,n.dark?aT.VG.purple[950].hex:aT.VG.purple[50].hex,l,n.muted.caution.hovered.bg,n.muted.caution.hovered.border,l,n.input.invalid.enabled.bg,n.input.invalid.hovered.border)}),j5=(0,lO.ZP)(rN.kC)(tm||(tm=d4(["\n  user-select: none;\n  pointer-events: none;\n"]))),j6=lO.ZP.div(e=>{let{theme:t,$hasChanges:n}=e,{space:i}=t.sanity;return(0,lO.iv)(tg||(tg=d4(["\n      position: absolute;\n      width: ","px;\n      right: 0;\n      top: 0;\n      bottom: 0;\n      padding-left: ","px;\n      user-select: none;\n\n      ","\n\n      [data-dragged] & {\n        visibility: hidden;\n      }\n    "])),i[2],i[1],!n&&(0,lO.iv)(tx||(tx=d4(["\n        display: none;\n      "]))))}),j8=(0,lO.ZP)(rN.kC)(tv||(tv=d4(["\n  position: relative;\n\n  [data-dragged] > & {\n    opacity: 0.5;\n  }\n"]))),j7=(0,lO.ZP)(rN.xu)(tb||(tb=d4(["\n  width: 25px;\n  position: relative;\n\n  [data-dragged] & {\n    visibility: hidden;\n  }\n"]))),j9=(0,lO.ZP)(rN.kC)(ty||(ty=d4(["\n  position: absolute;\n  right: 0;\n  [data-dragged] & {\n    visibility: hidden;\n  }\n"]))),we=(0,lO.ZP)(rN.xu)(tj||(tj=d4(["\n  max-width: 250px;\n"]))),wt=(0,lO.ZP)(rN.xu)(tw||(tw=d4([""])));function wn(e){var t;let{block:n,focused:i,isActive:r,isFullscreen:l,onChange:a,onItemOpen:o,onItemClose:s,path:d,readOnly:c,renderBlockActions:u,renderCustomMarkers:p,renderPreview:h,selected:f,type:m}=e,{Markers:g}=hi().__internal.components,x=(0,rF.useRef)(null),[v,b]=(0,rF.useState)(!1),y=jG(d),j=(0,a4._F)(),w=jQ(vw(d)),k=(0,rF.useCallback)(()=>b(!0),[]),C=(0,rF.useCallback)(()=>b(!1),[]),_=(0,rF.useCallback)(()=>{w&&o(w.node.path)},[o,w]),S=(0,rF.useCallback)(e=>{e.preventDefault(),e.stopPropagation(),a4.q$.blur(j),_()},[j,_]),E=(0,rF.useCallback)(()=>{a4.q$.delete(j,{focus:{path:d,offset:0},anchor:{path:d,offset:0}},{mode:"blocks"}),setTimeout(()=>a4.q$.focus(j))},[j,d]),T=(0,rF.useCallback)(e=>{e.preventDefault(),e.stopPropagation(),E()},[E]),A=(0,rF.useMemo)(()=>(0,rz.jsx)(j3,{focused:i,isActive:r,onClickingDelete:T,onClickingEdit:_,readOnly:c,renderPreview:h,type:m,value:n}),[i,r,E,_,c,h,m,n]),P=f||i?"primary":"default",I=(0,rF.useMemo)(()=>l&&!u?{paddingX:5}:l&&u?{paddingLeft:5,paddingRight:2}:u?{paddingLeft:3,paddingRight:2}:{paddingX:3},[l,u]),{validation:M,hasError:z,hasWarning:R,hasInfo:F}=j$(null==w?void 0:w.node),O=Boolean(y.length>0),D=(null==w?void 0:w.node.schemaType.name)==="image",Z=z||R||F||O,L=(0,rF.useMemo)(()=>Z&&(M.length>0||y.length>0)&&(0,rz.jsx)(we,{padding:2,children:(0,rz.jsx)(g,{markers:y,validation:M,renderCustomMarkers:p})})||null,[g,y,p,Z,M]),q=(0,rF.useMemo)(()=>(0,rz.jsx)(rN.kC,{paddingBottom:1,marginY:3,contentEditable:!1,style:j1(),children:(0,rz.jsxs)(j8,{flex:1,children:[(0,rz.jsx)(j5,d6(d6({flex:1},I),{},{children:(0,rz.jsx)(rN.u,{placement:"top",portal:"editor",disabled:!Z,content:L,children:(0,rz.jsx)(j4,{"data-focused":i?"":void 0,"data-image-preview":D?"":void 0,"data-invalid":z?"":void 0,"data-markers":O&&p?"":void 0,"data-read-only":c?"":void 0,"data-selected":f?"":void 0,"data-testid":"pte-block-object","data-warning":R?"":void 0,flex:1,onDoubleClick:S,padding:D?0:1,ref:x,tone:P,children:(0,rz.jsx)(wt,{ref:null==w?void 0:w.elementRef,children:A})})})})),(0,rz.jsx)(j7,{marginRight:1,children:(0,rz.jsx)(j9,{children:u&&n&&i&&!c&&(0,rz.jsx)(jq,{onChange:a,block:n,renderBlockActions:u})})}),l&&w&&(0,rz.jsx)(j6,{onMouseOver:k,onMouseOut:C,$hasChanges:w.member.item.changed,children:(0,rz.jsx)(jV,{withHoverEffect:!1,hasFocus:i,path:w.member.item.path,isChanged:w.member.item.changed})}),v&&(0,rz.jsx)(jN,{})]})}),[n,A,i,S,C,k,z,O,R,I,l,D,w,a,c,u,p,v,f,P,L,Z]),N=null==(t=m.components)?void 0:t.block,V=(0,rF.useCallback)(()=>q,[q]);return N?(0,rz.jsx)(N,{focused:i,open:(null==w?void 0:w.member.open)||!1,onOpen:_,onClose:s,onRemove:E,path:(null==w?void 0:w.node.path)||d,selected:f,value:n,renderDefault:V,children:(0,rz.jsx)(wt,{ref:null==w?void 0:w.elementRef,children:A})}):q}let wi=(0,lO.ZP)(rN.J2)(tk||(tk=d4(["\n  &[data-popper-reference-hidden='true'] {\n    display: none !important;\n  }\n"]))),wr=["top","bottom"];function wl(e){let{onClose:t,onEdit:n,onDelete:i,referenceElement:r,scrollElement:l,title:a,open:o}=e,{sanity:s}=(0,rN.Fg)(),d=(0,rF.useRef)(null),c=s.color.dark?"light":"dark",u=(0,rF.useRef)(!1);return(0,rN.qh)((0,rF.useCallback)(e=>{var n;"Escape"===e.key&&(e.preventDefault(),e.stopPropagation(),u.current=!1,t()),"Tab"!==e.key||u.current||(e.preventDefault(),e.stopPropagation(),null==(n=d.current)||n.focus(),u.current=!0)},[t])),(0,rF.useEffect)(()=>{var e;u.current&&(null==(e=d.current)||e.focus())},[]),(0,rz.jsx)("div",{contentEditable:!1,children:(0,rz.jsx)(wi,{boundaryElement:l,constrainSize:!0,content:(0,rz.jsx)(rN.xu,{padding:1,children:(0,rz.jsxs)(rN.gF,{space:1,children:[(0,rz.jsx)(rN.xu,{padding:2,children:(0,rz.jsx)(rN.xv,{weight:"semibold",size:1,children:a})}),(0,rz.jsx)(rN.zx,{icon:lL.dY8,mode:"bleed",onClick:n,padding:2,ref:d,alt:"Edit object"}),(0,rz.jsx)(rN.zx,{icon:lL.XHJ,mode:"bleed",padding:2,onClick:i,tone:"critical",alt:"Remove object"})]})}),fallbackPlacements:wr,open:o,placement:"top",portal:"editor",referenceElement:r,scheme:c})})}let wa=(0,lO.ZP)(rN.Zb)(function(e){var t,n,i;let{theme:r}=e,{color:l,radius:a}=r.sanity;return(0,lO.iv)(tC||(tC=d4(["\n    line-height: 0;\n    border-radius: ","px;\n    padding: 2px;\n    box-shadow: inset 0 0 0 1px var(--card-border-color);\n    height: calc(1em - 1px);\n    margin-top: 0.0625em;\n    cursor: default;\n\n    &:not([hidden]) {\n      display: inline-flex;\n      align-items: center;\n      vertical-align: top;\n    }\n\n    &[data-ready-only] {\n      cursor: default;\n    }\n\n    &[data-focused] {\n      box-shadow: inset 0 0 0 1px ",";\n      color: ",";\n    }\n\n    &[data-selected] {\n      background-color: ",";\n    }\n\n    &:not([data-focused]):not([data-selected]) {\n      @media (hover: hover) {\n        &:hover {\n          --card-border-color: ",";\n        }\n      }\n    }\n\n    &[data-markers] {\n      --card-bg-color: ",";\n    }\n\n    &[data-warning] {\n      --card-bg-color: ",";\n\n      @media (hover: hover) {\n        &:hover {\n          --card-border-color: ",";\n        }\n      }\n    }\n\n    &[data-invalid] {\n      --card-bg-color: ",";\n      --card-border-color: ",";\n\n      @media (hover: hover) {\n        &:hover {\n          --card-border-color: ",";\n        }\n      }\n    }\n  "])),a[2],null==(t=l.selectable)?void 0:t.primary.selected.border,null==(n=l.selectable)?void 0:n.primary.pressed.fg,null==(i=l.selectable)?void 0:i.primary.pressed.bg,l.input.default.hovered.border,l.dark?aT.VG.purple[950].hex:aT.VG.purple[50].hex,l.muted.caution.hovered.bg,l.muted.caution.hovered.border,l.input.invalid.enabled.bg,l.input.invalid.enabled.border,l.input.invalid.hovered.border)}),wo=lO.ZP.span(t_||(t_=d4(["\n  display: block;\n  max-width: calc(5em + 80px);\n  position: relative;\n"]))),ws=(0,lO.ZP)(rN.xu)(tS||(tS=d4(["\n  max-width: 250px;\n"]))),wd=rF.forwardRef(function(e,t){var n;let{focused:i,onItemOpen:r,path:l,readOnly:a,renderCustomMarkers:o,renderPreview:s,scrollElement:d,selected:c,type:u,value:p}=e,{Markers:h}=hi().__internal.components,f=(0,a4._F)(),m=jG(l),g=jQ(vw(l)),{validation:x,hasError:v,hasWarning:b}=j$(null==g?void 0:g.node),y=x.length>0,[j,w]=(0,rF.useState)(!0),k=(0,rF.useMemo)(()=>v?"critical":b?"caution":c||i?"primary":void 0,[i,v,b,c]),C=(0,rF.useMemo)(()=>(0,rz.jsx)(wo,{children:s({fallbackTitle:"Click to edit",layout:"inline",schemaType:u,value:p})}),[s,u,p]),_=(0,rF.useMemo)(()=>m.length>0||x.length>0?(0,rz.jsx)(rN.u,{placement:"bottom",portal:"editor",content:(0,rz.jsx)(ws,{padding:2,children:(0,rz.jsx)(h,{markers:m,validation:x,renderCustomMarkers:o})}),children:C}):void 0,[h,m,x,C,o]),S=(0,rF.useCallback)(e=>{e.preventDefault(),e.stopPropagation();let t={path:l,offset:0};a4.q$.delete(f,{anchor:t,focus:t},{mode:"children"}),a4.q$.focus(f)},[f,l]),E=(0,rF.useCallback)(()=>{a4.q$.blur(f),g&&(r(g.node.path),w(!1))},[f,g,r]),T=(0,rF.useCallback)(()=>{(null==g?void 0:g.member.open)&&w(!0),w(!1)},[null==g?void 0:g.member.open]);return(0,rF.useEffect)(()=>{(null==g?void 0:g.member.open)?w(!1):i?w(!0):w(!1)},[f,i,null==g?void 0:g.member.open,c]),(0,rz.jsxs)(rz.Fragment,{children:[(0,rz.jsx)(wa,{"data-focused":i||void 0,"data-invalid":v||void 0,"data-warning":b||void 0,"data-selected":c||void 0,"data-read-only":a||void 0,"data-markers":y||void 0,tone:k,forwardedAs:"span",contentEditable:!1,ref:null==g?void 0:g.elementRef,onClick:a?E:void 0,onDoubleClick:E,children:(0,rz.jsx)("span",{ref:t,children:_||C})}),i&&!a&&(0,rz.jsx)(wl,{open:j,onDelete:S,onEdit:E,onClose:T,referenceElement:(null==(n=null==g?void 0:g.elementRef)?void 0:n.current)||null,scrollElement:d,title:(null==u?void 0:u.title)||u.name})]})}),wc=(0,lO.ZP)(rN.J2)(tE||(tE=d4(["\n  &[data-popper-reference-hidden='true'] {\n    display: none !important;\n  }\n"]))),wu=["top","bottom"];function wp(e){let{scrollElement:t,annotationElement:n,textElement:i,title:r,onEdit:l,onDelete:a}=e,[o,s]=(0,rF.useState)(!1),[d,c]=(0,rF.useState)(null),[u,p]=(0,rF.useState)(null),h=(0,rF.useRef)(!1),f=(0,rF.useRef)(null),m=(0,rF.useRef)(null),g=(0,rF.useRef)(!1),{sanity:x}=(0,rN.Fg)(),v=x.color.dark?"light":"dark",b=(0,rF.useMemo)(()=>d?{getBoundingClientRect:()=>d}:null,[d]);return((0,rF.useEffect)(()=>{if(!o||!t)return;let e=()=>{f.current&&c(f.current.getBoundingClientRect())};return t.addEventListener("scroll",e,{passive:!0}),()=>{t.removeEventListener("scroll",e)}},[o,t]),(0,rN.qh)((0,rF.useCallback)(e=>{var t;o&&("Escape"===e.key&&(e.preventDefault(),e.stopPropagation(),s(!1),g.current=!1),"Tab"!==e.key||g.current||(e.preventDefault(),e.stopPropagation(),null==(t=m.current)||t.focus(),g.current=!0))},[o])),(0,rF.useEffect)(()=>{function e(){if(!i)return;let e=window.getSelection();if(!e)return;let{anchorNode:t,anchorOffset:n,focusNode:r,focusOffset:l}=e;p({anchorNode:t,anchorOffset:n,focusNode:r,focusOffset:l})}return document.addEventListener("selectionchange",e,{passive:!0}),()=>{document.removeEventListener("selectionchange",e)}},[i]),(0,rF.useEffect)(()=>{var e;if(!u||h.current)return;let{anchorNode:t,focusNode:i}=u;if(!g.current){if(n&&n.contains(t)&&t===i){let r=null==(e=window.getSelection())?void 0:e.getRangeAt(0),l=null==r?void 0:r.getBoundingClientRect();f.current=r||null,l&&c(l),s(!0)}else s(!1),c(null),f.current=null}},[u,n]),o)?(0,rz.jsx)(wc,{content:(0,rz.jsx)(rN.xu,{padding:1,children:(0,rz.jsxs)(rN.gF,{space:1,children:[(0,rz.jsx)(rN.xu,{padding:2,children:(0,rz.jsx)(rN.xv,{weight:"semibold",size:1,children:r})}),(0,rz.jsx)(rN.zx,{ref:m,icon:lL.dY8,mode:"bleed",onClick:l,padding:2,alt:"Edit annotation"}),(0,rz.jsx)(rN.zx,{icon:lL.XHJ,mode:"bleed",padding:2,onClick:a,tone:"critical",alt:"Remove annotation"})]})}),fallbackPlacements:wu,open:o,placement:"top",portal:"default",referenceElement:b,scheme:v}):null}let wh=lO.ZP.span(e=>{var t,n,i,r;let{$toneKey:l="default",theme:a}=e;return(0,lO.iv)(tT||(tT=d4(["\n      text-decoration: none;\n      display: inline;\n      background-color: ",";\n      border-bottom: 1px dashed ",";\n      color: ",";\n\n      &[data-link] {\n        border-bottom: 1px solid ",";\n      }\n\n      &[data-custom-markers] {\n        background-color: ",";\n      }\n\n      &[data-warning] {\n        background-color: ",";\n      }\n\n      &[data-error] {\n        background-color: ",";\n      }\n    "])),null==(t=a.sanity.color.selectable)?void 0:t[l].enabled.bg,null==(n=a.sanity.color.selectable)?void 0:n[l].enabled.fg,null==(i=a.sanity.color.selectable)?void 0:i[l].enabled.fg,null==(r=a.sanity.color.selectable)?void 0:r[l].enabled.fg,a.sanity.color.dark?aT.VG.purple[950].hex:aT.VG.purple[50].hex,a.sanity.color.muted.caution.hovered.bg,a.sanity.color.muted.critical.hovered.bg)}),wf=(0,lO.ZP)(rN.xu).attrs({forwardedAs:"span"})(tA||(tA=d4(["\n  max-width: 250px;\n"]))),wm=function(e){var t;let{onItemOpen:n,onItemClose:i,renderCustomMarkers:r,scrollElement:l,renderProps:a,readOnly:o}=e,{children:s,type:d,value:c,path:u,selected:p,focused:h}=a,{Markers:f=hs}=hi().__internal.components,m=(0,rF.useRef)(null),g=(0,a4._F)(),x=(0,rF.useMemo)(()=>[u[0]].concat(["markDefs",{_key:c._key}]),[u,c._key]),[v,b]=(0,rF.useState)(null),y=jQ(vw(x)),{validation:j,hasError:w,hasWarning:k}=j$(null==y?void 0:y.node),C=jG(u),_=null==(t=d.components)?void 0:t.annotation,S=(0,rF.useMemo)(()=>(0,rz.jsx)("span",{ref:b,"data-annotation":"",children:s}),[s]),E=(0,rF.useCallback)(()=>{y&&n(y.node.path)},[y,n]),T=(0,rF.useMemo)(()=>j.length>0||C.length>0?(0,rz.jsx)(rN.u,{placement:"bottom",portal:"default",content:(0,rz.jsx)(wf,{padding:2,children:(0,rz.jsx)(f,{markers:C,renderCustomMarkers:r,validation:j})}),children:(0,rz.jsx)("span",{children:S})}):void 0,[f,C,r,S,j]),A=(0,rF.useCallback)(e=>{a4.q$.blur(g),e.preventDefault(),e.stopPropagation(),E()},[g,E]),P=(0,rF.useCallback)(e=>{e.preventDefault(),e.stopPropagation(),a4.q$.removeAnnotation(g,d),a4.q$.focus(g)},[g,d]),I="link"===d.name,M=(0,rF.useMemo)(()=>w?"critical":k?"caution":I?"primary":"default",[I,w,k]),z=C.length>0,R=(0,rz.jsxs)(wh,{$toneKey:M,ref:m,"data-link":I?"":void 0,"data-error":w?"":void 0,"data-warning":k?"":void 0,"data-custom-markers":z?"":void 0,onClick:o?E:void 0,children:[(0,rz.jsx)("span",{ref:null==y?void 0:y.elementRef,children:T||S}),!o&&(0,rz.jsx)(wp,{textElement:v||void 0,annotationElement:m.current||void 0,scrollElement:l||void 0,onEdit:A,onDelete:P,title:(null==d?void 0:d.title)||d.name})]});return _&&y?(0,rz.jsx)(_,{focused:h,open:y.member.open,onOpen:E,onClose:i,onRemove:()=>{a4.q$.removeAnnotation(g,d),a4.q$.focus(g)},path:(null==y?void 0:y.node.path)||u,renderDefault:()=>R,selected:p,value:c,children:(0,rz.jsx)("span",{ref:null==y?void 0:y.elementRef,children:S})}):R},wg=[1,2,3,4,5,6,7,8,9],wx=["●","○","■"],wv=["number","lower-alpha","lower-roman"],wb={em:"em","strike-through":"s",underline:"u",strong:"strong",code:"code"},wy={h1:{paddingTop:5,paddingBottom:4},h2:{paddingTop:4,paddingBottom:4},h3:{paddingTop:4,paddingBottom:3},h4:{paddingTop:4,paddingBottom:3},h5:{paddingTop:4,paddingBottom:3},h6:{paddingTop:4,paddingBottom:2},normal:{paddingTop:2,paddingBottom:3},blockquote:{paddingTop:2,paddingBottom:3}},wj=lO.ZP.span(tP||(tP=d4(["\n  /* Make sure the annotation styling is visible */\n  &[data-mark='code'] {\n    mix-blend-mode: multiply;\n    color: inherit;\n  }\n"])));function ww(e){let{mark:t,children:n}=e,i=wb[t];return(0,rz.jsx)(wj,{as:i,"data-mark":t,children:n})}function wk(e){return"list-level-".concat(e)}let wC=lO.ZP.div(function(e){var t;let{$level:n,theme:i}=e,{color:r,fonts:l,radius:a,space:o}=i.sanity,s=wv[(n-1)%wv.length],d=wx[(n-1)%wx.length];return(0,lO.iv)(tI||(tI=d4(["\n    --marker-bg-color: transparent;\n\n    mix-blend-mode: ",";\n    position: relative;\n\n    & > [data-ui='TextBlock_inner'] {\n      position: relative;\n      flex: 1;\n    }\n\n    & > div:before {\n      content: '';\n      position: absolute;\n      top: -","px;\n      bottom: -","px;\n      left: -","px;\n      right: -","px;\n      border-radius: ","px;\n      background-color: var(--marker-bg-color);\n    }\n\n    &[data-markers] {\n      --marker-bg-color: ",";\n    }\n\n    &[data-warning] {\n      --card-border-color: ",";\n      --marker-bg-color: ",";\n    }\n\n    &[data-error] {\n      --card-border-color: ",";\n      --marker-bg-color: ",";\n    }\n\n    & [data-list-prefix] {\n      position: absolute;\n      margin-left: -4.5rem;\n      width: 3.75rem;\n      text-align: right;\n      box-sizing: border-box;\n    }\n\n    &[data-list-item='number'] [data-list-prefix] {\n      font-variant-numeric: tabular-nums;\n\n      & > span:before {\n        content: counter(",") '.';\n        content: counter(",", ",") '.';\n      }\n    }\n\n    &[data-list-item='bullet'] [data-list-prefix] {\n      & > span {\n        position: relative;\n        top: -0.1875em;\n\n        &:before {\n          content: '","';\n          font-size: 0.46666em;\n        }\n      }\n    }\n\n    & [data-text] {\n      overflow-wrap: anywhere;\n      text-transform: none;\n      white-space: pre-wrap;\n      font-family: ",";\n      flex: 1;\n\n      *::selection {\n        background-color: ",";\n      }\n    }\n  "])),r.dark?"screen":"multiply",o[1],o[1],o[1],o[1],a[2],r.dark?aT.VG.purple[950].hex:aT.VG.purple[50].hex,r.muted.caution.enabled.border,r.muted.caution.hovered.bg,r.muted.critical.enabled.border,r.muted.critical.hovered.bg,wk(n),wk(n),s,d,l.text.family,null==(t=r.selectable)?void 0:t.primary.pressed.bg)}),w_=(0,lO.ZP)(rN.xu)(tM||(tM=d4(["\n  position: relative;\n  display: flex;\n"]))),wS=lO.ZP.div(tz||(tz=d4(["\n  user-select: none;\n  white-space: nowrap;\n"]))),wE=(0,lO.ZP)(rN.xu)(tR||(tR=d4(["\n  user-select: none;\n"]))),wT=(0,lO.ZP)(rN.xu)(tF||(tF=d4(["\n  line-height: 0;\n  width: 25px;\n  position: relative;\n"]))),wA=(0,lO.ZP)(rN.kC)(e=>{let{theme:t}=e,{fonts:n,space:i}=t.sanity,r=n.text.sizes[1],l=n.text.sizes[2],a=r.lineHeight-r.ascenderHeight-r.descenderHeight,o=l.lineHeight-l.ascenderHeight-l.descenderHeight,s=a+i[2]+i[2];return(0,lO.iv)(tO||(tO=d4(["\n    user-select: none;\n    position: absolute;\n    right: 0;\n    top: ","px;\n  "])),0-(s-o)/2)}),wP=(0,lO.ZP)(rN.xu)(tD||(tD=d4(["\n  max-width: 250px;\n"]))),wI=(0,lO.ZP)(rN.kC)(tZ||(tZ=d4(["\n  position: relative;\n  padding-left: ","px;\n"])),e=>{let{$level:t}=e;return t?32*t:0}),wM=lO.ZP.div(e=>{let{theme:t,$hasChanges:n}=e,{space:i}=t.sanity;return(0,lO.iv)(tL||(tL=d4(["\n      position: absolute;\n      width: ","px;\n      right: 0;\n      top: 0;\n      bottom: 0;\n      padding-left: ","px;\n      user-select: none;\n\n      ","\n    "])),i[2],i[1],!n&&(0,lO.iv)(tq||(tq=d4(["\n        display: none;\n      "]))))}),wz=lO.ZP.div(tN||(tN=d4(["\n  display: block;\n"]))),wR=e=>{let{children:t}=e,n=d3(e,de);return(0,rz.jsx)(rN.xv,d6(d6({"data-testid":"text-style--normal"},n),{},{children:(0,rz.jsx)(wz,{children:t})}))},wF=e=>{let{children:t}=e,n=d3(e,dt);return(0,rz.jsx)(rN.X6,d6(d6({as:"h1","data-testid":"text-style--h1",size:5},n),{},{children:(0,rz.jsx)(wz,{children:t})}))},wO=e=>{let{children:t}=e,n=d3(e,dn);return(0,rz.jsx)(rN.X6,d6(d6({as:"h2","data-testid":"text-style--h2",size:4},n),{},{children:(0,rz.jsx)(wz,{children:t})}))},wD=e=>{let{children:t}=e,n=d3(e,di);return(0,rz.jsx)(rN.X6,d6(d6({as:"h3","data-testid":"text-style--h3",size:3},n),{},{children:(0,rz.jsx)(wz,{children:t})}))},wZ=e=>{let{children:t}=e,n=d3(e,dr);return(0,rz.jsx)(rN.X6,d6(d6({as:"h4","data-testid":"text-style--h4",size:2},n),{},{children:(0,rz.jsx)(wz,{children:t})}))},wL=e=>{let{children:t}=e,n=d3(e,dl);return(0,rz.jsx)(rN.X6,d6(d6({as:"h5","data-testid":"text-style--h5",size:1},n),{},{children:(0,rz.jsx)(wz,{children:t})}))},wq=e=>{let{children:t}=e,n=d3(e,da);return(0,rz.jsx)(rN.X6,d6(d6({as:"h6","data-testid":"text-style--h6",size:0},n),{},{children:(0,rz.jsx)(wz,{children:t})}))},wN=lO.ZP.blockquote(tV||(tV=d4(["\n  position: relative;\n  display: block;\n  margin: 0;\n  padding-left: ","px;\n\n  &::before {\n    content: '';\n    position: absolute;\n    left: 0;\n    top: -4px;\n    bottom: -4px;\n    width: 3px;\n    background: var(--card-border-color);\n  }\n"])),e=>{let{theme:t}=e;return t.sanity.space[3]}),wV=e=>{let{children:t}=e,n=d3(e,ds);return(0,rz.jsx)(wN,d6(d6({"data-testid":"text-style--blockquote"},n),{},{children:(0,rz.jsx)(rN.xv,{as:"p",children:t})}))},wB={normal:wR,h1:wF,h2:wO,h3:wD,h4:wZ,h5:wL,h6:wq,blockquote:wV};function wU(e){var t;let{block:n,children:i,focused:r,isFullscreen:l,onChange:a,path:o,readOnly:s,renderBlockActions:d,renderCustomMarkers:c,selected:u,spellCheck:p,type:h}=e,{Markers:f}=hi().__internal.components,[m,g]=(0,rF.useState)(!1),x=jG(o),v=jQ(vw(o)),b=(0,a4._F)(),y=(0,rF.useCallback)(()=>g(!0),[]),j=(0,rF.useCallback)(()=>g(!1),[]),{validation:w,hasError:k,hasWarning:C,hasInfo:_}=j$(null==v?void 0:v.node),S=Boolean(c)&&x.length>0,E=k||C||S||_,T=(0,rF.useMemo)(()=>(0,rz.jsxs)(wI,{align:"flex-start",$level:null==n?void 0:n.level,children:[n.listItem&&(0,rz.jsx)(wS,{contentEditable:!1,children:(0,rz.jsx)(rN.xv,{"data-list-prefix":"",children:(0,rz.jsx)(wz,{})})}),(0,rz.jsx)("div",{"data-text":"",style:j1(),children:i})]}),[n.listItem,n.level,i]),A=(0,rF.useMemo)(()=>l&&!d?{paddingX:5}:l&&d?{paddingLeft:5,paddingRight:2}:d?{paddingLeft:3,paddingRight:2}:{paddingX:3},[l,d]),P=(0,rF.useMemo)(()=>n.listItem?{paddingY:2}:wy[n.style||"normal"]||{paddingY:2},[n]),I=(0,rF.useMemo)(()=>(0,rz.jsx)(rN.xu,d6(d6({"data-testid":"text-block"},P),{},{children:(0,rz.jsx)(w_,{"data-testid":"text-block__wrapper",children:(0,rz.jsxs)(rN.kC,d6(d6({flex:1},A),{},{ref:null==v?void 0:v.elementRef,children:[(0,rz.jsx)(rN.xu,{flex:1,children:(0,rz.jsx)(rN.u,{placement:"top",portal:"editor",disabled:!E,content:E&&(0,rz.jsx)(wP,{padding:2,children:(0,rz.jsx)(f,{markers:x,validation:w,renderCustomMarkers:c})}),children:(0,rz.jsx)(wC,{"data-error":k?"":void 0,"data-list-item":n.listItem,"data-markers":S?"":void 0,"data-read-only":s,"data-testid":"text-block__text","data-warning":C?"":void 0,$level:n.level||1,spellCheck:p,children:T})})}),(0,rz.jsxs)(wE,{contentEditable:!1,children:[(0,rz.jsx)(wT,{marginRight:1,children:(0,rz.jsx)(wA,{children:d&&r&&!s&&(0,rz.jsx)(jq,{onChange:a,block:n,renderBlockActions:d})})}),l&&v&&(0,rz.jsx)(wM,{$hasChanges:v.member.item.changed,onMouseEnter:y,onMouseLeave:j,children:(0,rz.jsx)(jV,{hasFocus:r,isChanged:v.member.item.changed,path:v.member.item.path,withHoverEffect:!1})})]}),m&&(0,rz.jsx)(jN,{})]}))})})),[f,n,r,y,j,k,S,C,A,l,x,v,a,P,s,d,c,m,p,T,E,w]),M=(0,rF.useCallback)(()=>{a4.q$.delete(b,{focus:{path:o,offset:0},anchor:{path:o,offset:0}},{mode:"blocks"}),setTimeout(()=>a4.q$.focus(b))},[b,o]),z=null==(t=h.components)?void 0:t.block,R=(0,rF.useCallback)(()=>I,[I]),F=(0,rF.useCallback)(()=>{console.warn("Regular text blocks don't open or close, but are edited inline.")},[]);return z?(0,rz.jsx)(z,{focused:r,onClose:F,onOpen:F,onRemove:M,open:(null==v?void 0:v.member.open)||!1,path:(null==v?void 0:v.node.path)||o,renderDefault:R,selected:u,value:n,children:(0,rz.jsx)(wC,{"data-error":k?"":void 0,"data-list-item":n.listItem,"data-markers":S?"":void 0,"data-read-only":s,"data-testid":"text-block__text","data-warning":C?"":void 0,$level:n.level||1,spellCheck:p,children:T})}):I}let wK={portal:!0,constrainSize:!0};function wH(e){let{disableRestoreFocusOnClose:t,menuButton:n,menuButtonProps:i,menuOptionsArray:r,onMenuClose:l}=e;return(0,rz.jsx)(rN.j2,d6(d6({__unstable_disableRestoreFocusOnClose:t,id:"menu-button",onClose:l,popover:wK},i),{},{button:n,menu:(0,rz.jsx)(rN.v2,{children:r.map((e,t)=>{let n=e.props,{collapsedProps:i={},expandedProps:r={},tooltipProps:l={},tooltipText:a,dividerBefore:o,fontSize:s,padding:d,text:c,icon:u,selected:p}=n,h=d3(n,dd);return(0,rz.jsxs)(rF.Fragment,{children:[o&&0!==t&&(0,rz.jsx)(rN.R,{}),(0,rz.jsx)(rN.sN,d6({text:c,icon:u,pressed:p},h))]},e.key)})})}))}let w$=lO.ZP.div(tB||(tB=d4(["\n  border-right: 1px solid var(--card-border-color);\n  height: auto;\n\n  &[data-hidden] {\n    opacity: 0;\n  }\n"])));function wX(e){let{hidden:t}=e,n=d3(e,du);return(0,rz.jsx)(w$,d6({"data-ui":"CollapseMenuDivider","data-hidden":t?"":void 0},n))}let wW=(0,lO.iv)(tU||(tU=d4(["\n  list-style: none;\n  display: flex;\n  white-space: nowrap;\n\n  &[data-hidden='true'] {\n    opacity: 0;\n    visibility: hidden;\n  }\n"]))),wG=(0,lO.ZP)(rN.kC)(tK||(tK=d4(["\n  padding: ","px;\n  margin: -","px;\n  box-sizing: border-box;\n"])),3,3),wY=(0,lO.ZP)(rN.kC)(tH||(tH=d4(["\n  border-radius: inherit;\n  position: relative;\n"]))),wJ=(0,lO.ZP)(rN.kC)(t$||(t$=d4(["\n  width: max-content;\n\n  &[data-hidden='true'] {\n    height: 0px;\n    visibility: hidden;\n  }\n"]))),wQ=(0,lO.ZP)(function(e){let{callback:t,children:n,options:i}=e,r=d3(e,dc),[l,a]=(0,rF.useState)(null);return(0,rF.useEffect)(()=>{if(!l)return;let e=new IntersectionObserver(t,i);return e.observe(l),()=>{e.unobserve(l),e.disconnect()}},[l,t,i]),(0,rz.jsx)(rN.kC,d6(d6({ref:a},r),{},{children:n}))})(tX||(tX=d4(["\n  ","\n"])),wW),w0=(0,lO.ZP)(rN.kC)(tW||(tW=d4(["\n  ","\n"])),wW);function w1(e){return Boolean(e)}let w2=(0,rF.forwardRef)(function(e,t){let{children:n,collapsed:i,collapseText:r=!0,disableRestoreFocusOnClose:l,gap:a,menuButtonProps:o,onMenuClose:s}=e,d=d3(e,dp),[c,u]=(0,rF.useState)(null),[p,h]=(0,rF.useState)(null),f=(0,rN.XL)(c),[m,g]=(0,rF.useState)([]),x=(0,rF.useMemo)(()=>!!f&&!!c&&!!p&&f.width<p.scrollWidth,[p,c,f]),v=(0,rF.useMemo)(()=>(null==o?void 0:o.button)||(0,rz.jsx)(rN.zx,{icon:lL.zGg,mode:"bleed"}),[o]),b=(0,rF.useMemo)(()=>({root:c,threshold:1,rootMargin:"2px"}),[c]),y=(0,rF.useMemo)(()=>rF.Children.toArray(n).filter(w1),[n]),j=(0,rF.useMemo)(()=>y.filter(e=>{let{key:t}=e;return m.find(e=>e.key===t)}),[y,m]),w=(0,rF.useMemo)(()=>i||j.length>0,[i,j.length]),k=(0,rF.useCallback)(e=>j.some(t=>t.key===e),[j]),C=(0,rF.useCallback)((e,t)=>{let n=k(t.key);if(e.isIntersecting||n||g(e=>[t,...e]),e.isIntersecting&&n){let i=j.filter(e=>{let{key:n}=e;return n!==t.key});g(i)}},[k,j]),_=(0,rF.useMemo)(()=>y.map(e=>{let{collapsedProps:t,expandedProps:n}=e.props,i=x&&r?void 0:e.props.text;return(0,rF.cloneElement)(e,d6(d6({},x?t:n),{},{text:i}))}),[y,r,x]);return i?(0,rz.jsx)(wH,{disableRestoreFocusOnClose:l,menuButton:v,menuButtonProps:o,menuOptionsArray:y,onMenuClose:s}):(0,rz.jsxs)(wG,d6(d6({align:"center","data-ui":"CollapseMenu",overflow:"hidden",sizing:"border",ref:t},d),{},{children:[(0,rz.jsxs)(wY,{direction:"column",flex:1,justify:"center",ref:u,children:[(0,rz.jsx)(wJ,{gap:a,children:_.map((e,t)=>{let{dividerBefore:n,tooltipText:i="",tooltipProps:r={}}=e.props,l=k(e.key);return(0,rz.jsxs)(rF.Fragment,{children:[n&&0!==t&&(0,rz.jsx)(wX,{hidden:l}),(0,rz.jsx)(wQ,{options:b,callback:t=>C(t[0],e),"aria-hidden":l,"data-hidden":l,children:(0,rz.jsx)(rN.u,d6(d6({portal:!0,disabled:!i,content:(0,rz.jsx)(rN.xu,{padding:2,sizing:"border",children:(0,rz.jsx)(rN.xv,{size:1,children:i})})},r),{},{children:(0,rz.jsx)(rN.kC,{children:(0,rF.cloneElement)(e,{disabled:e.props.disabled||l,"aria-hidden":l})})}))})]},e.key)})}),(0,rz.jsx)(wJ,{"data-hidden":!0,"aria-hidden":"true",gap:a,ref:h,children:y.map((e,t)=>{let{dividerBefore:n}=e.props;return(0,rz.jsxs)(rF.Fragment,{children:[n&&0!==t&&(0,rz.jsx)(wX,{}),(0,rz.jsx)(w0,{children:(0,rF.cloneElement)(e,{disabled:!0,"aria-hidden":!0})},e.key)]},e.key)})})]}),w&&(0,rz.jsx)(rN.kC,{marginLeft:a,children:(0,rz.jsx)(wH,{disableRestoreFocusOnClose:l,menuButton:v,menuButtonProps:o,menuOptionsArray:j,onMenuClose:s})})]}))}),w3=(0,rF.forwardRef)(function(e,t){let{collapsedProps:n={},expandedProps:i={},tooltipProps:r={},tooltipText:l,dividerBefore:a}=e,o=d3(e,dh);return(0,rz.jsx)(rN.zx,d6(d6({"data-ui":"CollapseMenuButton"},o),{},{ref:t}))}),w4=lO.ZP.div(tG||(tG=d4(["\n  width: 1em;\n  height: 1em;\n  border-radius: inherit;\n  background-origin: content-box;\n  background-position: center;\n  background-repeat: no-repeat;\n  background-size: cover;\n  transform: scale(0.7);\n"])));function w5(e){let{icon:t,active:n}=e,i=(0,rF.useMemo)(()=>({backgroundImage:"url(".concat(t,")"),filter:n?"invert(100%)":"invert(0%)"}),[n,t]);return(0,rz.jsx)(w4,{style:i})}function w6(e,t){let n=oC()(e,"to[0].icon");return e.icon||e.type&&e.type.icon||n||t}let w8={link:lL.xPt},w7={strong:lL.mY4,em:lL.h32,"strike-through":lL.dwl,underline:lL.Adg,code:lL.dNJ},w9={number:lL.NvX,bullet:lL.AEM};function ke(){let e=(0,a4._F)(),t=(0,a4.L9)();return(0,rF.useMemo)(()=>a4.q$.focusBlock(e),[e,t])}let kt=(0,rF.memo)(w2),kn={constrainSize:!0,portal:!0},ki={padding:2,mode:"bleed"},kr=(0,rF.memo)(function(e){let{disabled:t,groups:n,isFullscreen:i,collapsed:r}=e,l=ke(),a=(0,a4._F)(),o=(null==l?void 0:l._type)!==a.schemaTypes.block.name,s=!o&&Array.isArray(l.children)&&1===l.children.length&&(null==l?void 0:l.children[0].text)==="",d=t||o,c=(0,rF.useMemo)(()=>n.reduce((e,t)=>e.concat(t.actions.map((e,t)=>0===t?d6(d6({},e),{},{firstInGroup:!0}):e)),[]),[n]),u=function(e){let{actions:t}=e,n=(0,a4._F)(),i=(0,a4.L9)();return cp((0,rF.useMemo)(()=>{let e=a4.q$.activeAnnotations(n).map(e=>e._type);return t.filter(t=>"annotation"===t.type?e.includes(t.key):"listStyle"===t.type?a4.q$.hasListStyle(n,t.key):a4.q$.isMarkActive(n,t.key)).map(e=>e.key)},[n,i]))}({actions:c}),p=(0,rF.useCallback)(()=>{a4.q$.focus(a)},[a]),h=(0,rF.useMemo)(()=>c.map(e=>{let t="annotation"===e.type&&s,n=u.includes(e.key);return(0,rF.createElement)(w3,d6(d6({disabled:d||t},ki),{},{dividerBefore:e.firstInGroup,icon:e.icon?"string"==typeof e.icon?(0,rz.jsx)(w5,{active:n,icon:e.icon}):e.icon:"annotation"===e.type?w8[e.key]||lL.Tzq:"listStyle"===e.type?w9[e.key]||lL.Tzq:w7[e.key]||lL.Tzq,key:e.key,onClick:()=>e.handle(n),selected:n,text:e.title||e.key,tooltipText:e.title||e.key,tooltipProps:{disabled:d||t,placement:i?"bottom":"top",portal:"default"}}))}),[c,u,d,s,i]),f=(0,rF.useMemo)(()=>({button:(0,rz.jsx)(rN.zx,{icon:lL.zGg,mode:"bleed",padding:2,disabled:d}),popover:kn}),[d]);return(0,rz.jsx)(kt,{collapsed:r,disableRestoreFocusOnClose:!0,gap:1,menuButtonProps:f,onMenuClose:p,children:h})}),kl=(0,rF.memo)(rN.j2),ka=(0,lO.ZP)(rN.sN)(tY||(tY=d4(["\n  // Change the border color variable used by BlockQuote\n  // to make the border visible when the MenuItem is selected\n  &[data-selected] {\n    [data-option='blockquote'] {\n      --card-border-color: var(--card-muted-fg-color);\n    }\n  }\n"]))),ko=(0,lO.ZP)(rN.zx)(tJ||(tJ=d4(["\n  width: 100%;\n"]))),ks={constrainSize:!0,placement:"bottom-start",portal:"default"},kd={h1:e=>(0,rz.jsx)(wF,{children:e}),h2:e=>(0,rz.jsx)(wO,{children:e}),h3:e=>(0,rz.jsx)(wD,{children:e}),h4:e=>(0,rz.jsx)(wZ,{children:e}),h5:e=>(0,rz.jsx)(wL,{children:e}),h6:e=>(0,rz.jsx)(wq,{children:e}),normal:e=>(0,rz.jsx)(wR,{children:e}),blockquote:e=>(0,rz.jsx)(wV,{"data-option":"blockquote",children:e})},kc=Object.keys(kd),ku=e=>e.preventDefault(),kp={key:"style-none",style:"",title:"No style"},kh=(0,rF.memo)(function(e){let{disabled:t,items:n}=e,i=(0,a4._F)(),r=ke(),[l,a]=(0,rF.useState)(!1),o=t||!!r&&i.schemaTypes.block.name!==r._type,s=function(e){let{items:t}=e,n=(0,a4._F)(),i=ke(),r=(0,a4.L9)();return cp((0,rF.useMemo)(()=>t.filter(e=>a4.q$.hasBlockStyle(n,e.style)).map(e=>e.style),[i,r]))}({items:n}),{activeItems:d,items:c}=(0,rF.useMemo)(()=>{let e=n.filter(e=>s.includes(e.style)),t=n;return 0===e.length&&t.length>1&&(t=t.concat([kp]),e.push(kp)),{activeItems:e,items:t}},[s,n]),u=(0,rF.useMemo)(()=>d.length>1?"Multiple":1===d.length?d[0].title:kp.title,[d]),p=(0,rF.useCallback)(e=>{r&&e.style!==r.style&&a4.q$.toggleBlockStyle(i,e.style),a(!0)},[i,r]),h=(0,rF.useCallback)((e,t)=>{let n=kc.includes(e),i=kd[e];return n?i(t):(0,rz.jsx)(rN.xv,{children:t})},[]),f=(0,rF.useMemo)(()=>(0,rz.jsx)(ko,{disabled:o,iconRight:lL.GVG,mode:"bleed",onClick:ku,padding:2,text:u}),[o,u]),m=(0,rF.useMemo)(()=>(0,rz.jsx)(rN.v2,{disabled:o,children:c.map(e=>(0,rz.jsx)(ka,{pressed:d.includes(e),onClick:o?void 0:()=>p(e),children:h(e.style,(null==e?void 0:e.title)||e.style)},e.key))}),[o,d,p,c,h]);return(0,rF.useEffect)(()=>{l&&(a4.q$.focus(i),a(!1))},[d,l,i]),(0,rz.jsx)(kl,{popover:ks,id:"block-style-select",button:f,menu:m})}),kf=(0,rF.memo)(w2),km={constrainSize:!0,portal:!0},kg=(0,rF.memo)(function(e){let{disabled:t,items:n,isFullscreen:i,collapsed:r}=e,l=ke(),a=(0,a4._F)(),o=l&&l._type!==a.schemaTypes.block.name,s=(0,rF.useCallback)(()=>{a4.q$.focus(a)},[a]),d=(0,rF.useMemo)(()=>n.map(e=>{var n;let r=e.type.title||(null==(n=e.type.type)?void 0:n.name);return(0,rz.jsx)(w3,{"aria-label":"Insert ".concat(r).concat(e.inline?" (inline)":" (block)"),padding:2,mode:"bleed",disabled:t||o&&!0===e.inline,icon:e.icon,onClick:e.handle,text:r,tooltipText:"Insert ".concat(r),tooltipProps:{disabled:t,placement:i?"bottom":"top",portal:"default"}},e.key)}),[n,t,o,i]),c=(0,rF.useMemo)(()=>({button:(0,rz.jsx)(rN.zx,{icon:lL.dtP,mode:"bleed",padding:2,disabled:t}),popover:km}),[t]);return(0,rz.jsx)(kf,{collapsed:r,collapseText:!1,disableRestoreFocusOnClose:!0,gap:1,menuButtonProps:c,onMenuClose:s,children:d})}),kx=(0,lO.ZP)(rN.kC)(tQ||(tQ=d4(["\n  width: 100%;\n"]))),kv=(0,lO.ZP)(rN.xu)(t0||(t0=d4(["\n  width: 8em;\n"]))),kb=(0,lO.ZP)(rN.kC)(t1||(t1=d4(["\n  border-right: 1px solid var(--card-border-color);\n"]))),ky=(0,lO.ZP)(rN.xu)(t2||(t2=d4(["\n  ","\n"])),e=>{let{$withInsertMenu:t}=e;return t&&(0,lO.iv)(t3||(t3=d4(["\n      max-width: max-content;\n      border-right: 1px solid var(--card-border-color);\n    "])))}),kj=(0,lO.ZP)(rN.xu)(t4||(t4=d4(["\n  border-left: 1px solid var(--card-border-color);\n"]))),kw="undefined"!=typeof window&&/Mac|iPod|iPhone|iPad/.test(window.navigator.platform),kk=(0,rF.memo)(function(e){let{actionGroups:t,blockStyles:n,disabled:i,insertMenuItems:r,isFullscreen:l,onToggleFullscreen:a}=e,o=t.reduce((e,t)=>e+t.actions.length,0),s=r.length>0,[d,c]=(0,rF.useState)(null),u=(0,rN.XL)(d),p=!!u&&(null==u?void 0:u.width)<400,h=n.length>1;return Fg({rootElement:d}),(0,rz.jsxs)(kx,{align:"center",ref:c,children:[h&&(0,rz.jsx)(kb,{flex:p?1:void 0,children:(0,rz.jsx)(kv,{padding:l?2:1,children:(0,rz.jsx)(kh,{disabled:i,items:n})})}),(0,rz.jsxs)(rN.kC,{flex:1,children:[o>0&&(0,rz.jsx)(ky,{flex:p?void 0:1,padding:l?2:1,$withInsertMenu:s,children:(0,rz.jsx)(kr,{disabled:i,collapsed:p,groups:t,isFullscreen:l})}),s&&(0,rz.jsx)(rN.xu,{flex:p?void 0:1,padding:l?2:1,children:(0,rz.jsx)(kg,{disabled:i,collapsed:p,items:r,isFullscreen:l})})]}),(0,rz.jsx)(kj,{padding:l?2:1,children:(0,rz.jsx)(rN.u,{content:(0,rz.jsxs)(rN.kC,{align:"center",padding:1,children:[(0,rz.jsx)(rN.xu,{flex:1,paddingX:1,children:(0,rz.jsx)(rN.xv,{size:1,children:"".concat(l?"Collapse":"Expand"," editor")})}),(0,rz.jsx)(rN.xu,{marginLeft:1,children:(0,rz.jsx)(rN.p8,{keys:["".concat(kw?"Cmd":"Ctrl"),"Enter"]})})]}),placement:l?"bottom":"top",portal:"default",children:(0,rz.jsx)(rN.zx,{padding:2,icon:l?lL.W5x:lL.Qq,mode:"bleed",onClick:a})})})]})});function kC(e){let{hotkeys:t,isFullscreen:n,readOnly:i,onMemberOpen:r,onToggleFullscreen:l}=e,a=(0,a4._F)(),o=(0,a4.L9)(),s=zu(),d=i||!o,{push:c}=(0,rN.pm)(),u=(0,rF.useCallback)(e=>{let t=!1,n=setTimeout(()=>{t=!0,c({id:"resolving-initial-value",status:"info",title:"Resolving initial value…"})},300);return s(e,{}).then(e=>(t&&c({id:"resolving-initial-value",status:"info",duration:500,title:"Initial value resolved"}),e)).catch(t=>{c({title:"Could not resolve initial value",id:"resolving-initial-value",description:"Unable to resolve initial value for type: ".concat(e.name,": ").concat(t.message,"."),status:"error"})}).finally(()=>clearTimeout(n))},[c]),p=(0,rF.useCallback)(async e=>{let t=await u(e),n=a4.q$.insertBlock(a,e,t);n&&r(n)},[a,r,u]),h=(0,rF.useCallback)(async e=>{let t=await u(e),n=a4.q$.insertChild(a,e,t);n&&r(n)},[a,r,u]),f=function(e){let{hotkeys:t,onMemberOpen:n,resolveInitialValue:i,disabled:r}=e,l=(0,a4._F)(),a=(0,rF.useCallback)(async e=>{let t=await i(e),r=a4.q$.addAnnotation(l,e,t);r&&r.markDefPath&&n(r.markDefPath)},[l,n,i]);return(0,rF.useMemo)(()=>l?[{name:"format",actions:function(e,t,n){let i=e.schemaTypes;return i.decorators.map(i=>{let r=Object.keys(n.marks||{}).find(e=>{var t;return(null==(t=n.marks)?void 0:t[e])===i.value}),l=[];return r&&(l=[r]),{type:"format",disabled:t,icon:null==i?void 0:i.icon,key:i.value,handle:()=>{a4.q$.toggleMark(e,i.value),a4.q$.focus(e)},hotkeys:l,title:i.title}})}(l,r,t)},{name:"list",actions:function(e,t){let n=e.schemaTypes;return n.lists.map(n=>({type:"listStyle",key:n.value,disabled:t,icon:null==n?void 0:n.icon,handle:()=>{a4.q$.toggleList(e,n.value)},title:n.title}))}(l,r)},{name:"annotation",actions:function(e,t,n){let i=e.schemaTypes,r=a4.q$.focusChild(e),l=r&&r.text;return i.annotations.map(i=>({type:"annotation",disabled:!l||t,icon:oC()(i,"icon")||oC()(i,"type.icon")||oC()(i,"type.to.icon")||oC()(i,"type.to[0].icon"),key:i.name,handle:t=>{t?(a4.q$.removeAnnotation(e,i),a4.q$.focus(e)):n(i)},title:i.title||oO()(i.name)}))}(l,r,a)}]:[],[r,l,a,t])}({hotkeys:t,onMemberOpen:r,resolveInitialValue:u,disabled:!0}),m=(0,rF.useMemo)(()=>a.schemaTypes.styles.map(e=>({key:"style-".concat(e.value),style:e.value,styleComponent:e&&e.component,title:e.title})),[a]),g=(0,rF.useMemo)(()=>(function(e,t,n,i){let r=e.blockObjects.map((e,t)=>({handle:()=>n(e),icon:w6(e,lL.sTT),inline:!1,key:"block-".concat(t),type:e})),l=e.inlineObjects.map((e,t)=>({handle:()=>i(e),icon:w6(e,lL.Kz2),inline:!0,key:"inline-".concat(t),type:e})),a=r.concat(l).filter(e=>{var t;return!(null==(t=e.type)?void 0:t.hidden)});return a})(a.schemaTypes,0,p,h),[d,a,p,h]);return(0,rz.jsx)(kk,{actionGroups:f,blockStyles:m,disabled:d,insertMenuItems:g,isFullscreen:n,onToggleFullscreen:l})}let k_=(0,lO.ZP)(rN.Zb)(t5||(t5=d4(["\n  height: ",";\n\n  &:not([hidden]) {\n    display: flex;\n  }\n\n  flex-direction: column;\n"])),e=>{let{$fullscreen:t}=e;return t?"100%":"15em"}),kS=(0,lO.ZP)(rN.Zb)(t6||(t6=d4(["\n  z-index: 10;\n  line-height: 0;\n"]))),kE=(0,lO.ZP)(rN.Zb)(t8||(t8=d4(["\n  position: relative;\n  overflow: hidden;\n\n  & > [data-portal] {\n    position: absolute;\n    top: 0;\n    left: 0;\n    right: 0;\n    bottom: 0;\n    pointer-events: none;\n\n    & > * {\n      pointer-events: initial;\n    }\n  }\n\n  &::selection,\n  *::selection {\n    background-color: transparent;\n  }\n"]))),kT=(0,lO.ZP)(cW)(t7||(t7=d4(["\n  position: relative;\n  overflow: auto;\n  height: 100%;\n  display: flex;\n  flex-direction: column;\n\n  & > * {\n    flex: 1;\n    min-height: auto;\n  }\n"]))),kA=(0,lO.ZP)(rN.W2)(t9||(t9=d4(["\n  /* @todo: calculate from theme */\n  /* max-width: 728px; */\n"]))),kP=(0,lO.ZP)(rN.Zb)(ne||(ne=d4(["\n  height: 100%;\n  width: 100%;\n  counter-reset: ",";\n  overflow: hidden;\n\n  & > div {\n    height: 100%;\n  }\n\n  & .pt-editable {\n    display: block;\n    width: 100%;\n    height: 100%;\n\n    ","\n\n    & > .pt-list-item-bullet + .pt-list-item-number,\n    & > .pt-list-item-number + .pt-list-item-bullet {\n      margin-top: ","px;\n      counter-reset: ",";\n    }\n\n    & > :not(.pt-list-item) + .pt-list-item {\n      margin-top: ","px;\n    }\n\n    /* Reset the list count if the element is not a numbered list item */\n    & > :not(.pt-list-item-number) {\n      counter-reset: ",";\n    }\n\n    ","\n\n    & > .pt-list-item + :not(.pt-list-item) {\n      margin-top: ","px;\n    }\n\n    & > :first-child {\n      padding-top: ","px;\n    }\n\n    & > :last-child {\n      padding-bottom: ","px;\n    }\n\n    /* & > .pt-block {\n      & .pt-inline-object {\n      }\n    } */\n\n    & .pt-drop-indicator {\n      pointer-events: none;\n      border: 1px solid var(--card-focus-ring-color) !important;\n      height: 0px !important;\n      border-radius: 1px;\n      margin-top: -3px;\n      left: calc(\n        "," - 1px\n      );\n      right: calc(\n        "," - 1px\n      );\n      width: calc(\n        100% -\n          "," + 2px\n      ) !important;\n    }\n  }\n"])),wg.map(e=>wk(e)).join(" "),wg.map(e=>(0,lO.iv)(nt||(nt=d4(["\n        & > .pt-list-item-number[class~='pt-list-item-level-","'] {\n          counter-increment: ",";\n        }\n      "])),e,wk(e))),e=>{let{theme:t}=e;return t.sanity.space[3]},wg.map(e=>wk(e)).join(" "),e=>{let{theme:t}=e;return t.sanity.space[2]},wg.map(e=>wk(e)).join(" "),wg.slice(1).map(e=>(0,lO.iv)(nn||(nn=d4(["\n        & > .pt-list-item-level-"," + .pt-list-item-level-"," {\n          counter-reset: ",";\n        }\n      "])),e,e-1,wk(e))),e=>{let{theme:t}=e;return t.sanity.space[3]},e=>{let{$isFullscreen:t,theme:n}=e;return n.sanity.space[t?5:3]},e=>{let{$isFullscreen:t,theme:n}=e;return n.sanity.space[t?9:5]},e=>{let{$isFullscreen:t,theme:n}=e;return t?(0,rN.hO)(n.sanity.space[5]):(0,rN.hO)(n.sanity.space[3])},e=>{let{$isFullscreen:t,theme:n}=e;return t?(0,rN.hO)(n.sanity.space[5]):(0,rN.hO)(n.sanity.space[3])},e=>{let{$isFullscreen:t,theme:n}=e;return t?(0,rN.hO)(2*n.sanity.space[5]):(0,rN.hO)(2*n.sanity.space[3])}),kI=e=>{let{block:t,focused:n,children:i,selected:r,type:l,value:a}=e,o=(0,rF.useMemo)(()=>(t.style&&wB[t.style]?wB[t.style]:wB[0])||wR,[t.style]),s=(0,rF.useMemo)(()=>(0,rz.jsx)(o,{children:i}),[o,i]),d=(0,rF.useCallback)(()=>s,[s]),c=l.component;return c?(0,rz.jsx)(rN.xv,{"data-testid":"text-style--".concat(a),children:(0,rz.jsx)(c,{block:t,title:l.title,value:l.value,selected:r,focused:n,renderDefault:d,children:i})}):s},kM=e=>{let{block:t,children:n,type:i,selected:r,focused:l,level:a,value:o}=e,s=(0,rF.useCallback)(()=>(0,rz.jsx)(rz.Fragment,{children:n}),[n]),d=i.component;return d?(0,rz.jsx)(d,{block:t,focused:l,level:a,renderDefault:s,selected:r,title:i.title,value:o,children:n}):n},kz=e=>{let{children:t,value:n,type:i,focused:r,selected:l}=e,a=i.component;return a?(0,rz.jsx)(a,{focused:r,selected:l,title:i.title,value:n,renderDefault:()=>(0,rz.jsx)(ww,{mark:n,children:t}),children:t}):(0,rz.jsx)(ww,{mark:n,children:t})},kR=e=>(0,rz.jsx)(kI,d6({},e)),kF=e=>(0,rz.jsx)(kM,d6({},e));function kO(e){let{hotkeys:t,initialSelection:n,isActive:i,isFullscreen:r,onCopy:l,onItemOpen:a,onPaste:o,onToggleFullscreen:s,path:d,readOnly:c,renderAnnotation:u,renderBlock:p,renderChild:h,scrollElement:f,setPortalElement:m,setScrollElement:g}=e,{isTopLayer:x}=(0,rN.sJ)(),v=(0,rF.useRef)(null),b=(0,a4._F)(),{element:y}=(0,rN.sz)();(0,rN.qh)((0,rF.useCallback)(e=>{x&&r&&"Escape"===e.key&&s()},[s,r,x]));let j=(0,rF.useCallback)(e=>{var t;e.target instanceof Node&&!(null==(t=v.current)?void 0:t.contains(e.target))&&(e.preventDefault(),e.stopPropagation())},[]),w=(0,rF.useCallback)(()=>(0,rz.jsx)(rz.Fragment,{children:"Empty"}),[]),k=function(){let e=(0,a4._F)();return(0,rF.useMemo)(()=>{var t;let n=null==(t=e.schemaTypes.block.options)?void 0:t.spellCheck,i="undefined"!=typeof navigator&&/Chrome\/96/.test(navigator.userAgent);return(void 0!==n||!0!==i)&&n},[e])}(),C=(0,rF.useMemo)(()=>(e,t)=>{let n=a4.q$.getSelection(e);if(n){let i=t.startContainer.parentElement;if(!i)return;(0,a5.Z)(i,{scrollMode:"if-needed",boundary:f,block:"start",inline:"nearest"})}},[f]),_=(0,rF.useMemo)(()=>(0,rz.jsx)(a4.iV,{hotkeys:t,onCopy:l,onPaste:o,ref:v,renderAnnotation:u,renderBlock:p,renderChild:h,renderDecorator:kz,renderListItem:kF,renderPlaceholder:w,renderStyle:kR,scrollSelectionIntoView:C,selection:n,spellCheck:k}),[t,n,l,o,u,p,h,w,C,k]),S=(0,rF.useCallback)(e=>{a4.q$.blur(b),a(d.concat(e))},[b,a,d]);return(0,rz.jsxs)(k_,{$fullscreen:r,"data-testid":"pt-editor",onMouseDown:j,children:[i&&(0,rz.jsx)(kS,{"data-testid":"pt-editor__toolbar-card",shadow:1,children:(0,rz.jsx)(kC,{isFullscreen:r,hotkeys:t,onMemberOpen:S,readOnly:c,onToggleFullscreen:s})}),(0,rz.jsxs)(kE,{flex:1,tone:c?"transparent":"default",children:[(0,rz.jsx)(kT,{ref:g,children:(0,rz.jsx)(kA,{padding:r?2:0,sizing:"border",width:1,children:(0,rz.jsx)(kP,{$isFullscreen:r,tone:c?"transparent":"default",children:(0,rz.jsx)(rN.NM,{element:r?f:y,children:_})})})}),(0,rz.jsx)("div",{"data-portal":"",ref:m})]})]})}let kD=lO.ZP.div(e=>{let{theme:t}=e,{focusRing:n,input:i}=t.sanity,r=t.sanity.color.base,l=t.sanity.color.input,a={color:l.default.enabled.border,width:i.border.width};return(0,lO.iv)(ni||(ni=d4(["\n    --input-box-shadow: ",";\n\n    position: relative;\n\n    & [data-wrapper] {\n      overflow: hidden;\n      position: relative;\n      z-index: 1;\n      padding: ","px;\n    }\n\n    & [data-border] {\n      position: absolute;\n      top: 0;\n      left: 0;\n      right: 0;\n      bottom: 0;\n      box-shadow: var(--input-box-shadow);\n      z-index: 2;\n      border-radius: 1px;\n      pointer-events: none;\n    }\n\n    &:not([data-read-only])[data-focused] [data-border] {\n      --input-box-shadow: ",";\n    }\n  "])),gS(a),i.border.width,gE({base:r,border:a,focusRing:n}))}),kZ=(0,lO.ZP)(rN.mh)(nr||(nr=d4(["\n  position: absolute;\n  top: 0;\n  left: 0;\n  right: 0;\n  bottom: 0;\n"]))),kL=e=>Array.isArray(e)?e.flatMap(kL):"number"==typeof e?[e]:"auto"===e?["auto"]:[],kq=e=>"dialog"===e||"popover"===e?e:void 0;function kN(e){var t;let{onClose:n,children:i,title:r,width:l=1}=e,a=(0,rF.useId)(),o=(0,rN.vI)();return(0,rz.jsx)(rN.Vq,{__unstable_autoFocus:!0,id:a||"",onClose:n,header:r,portal:"default",width:l,children:(0,rz.jsx)(fo,{margins:[0,0,1,0],children:(0,rz.jsx)(rN.xu,{padding:4,children:(0,rz.jsx)(rN.Xp,{element:null==(t=o.elements)?void 0:t.default,children:i})})})})}let kV=(0,lO.ZP)(rN.J2)(nl||(nl=d4(["\n  &[data-popper-reference-hidden='true'] {\n    visibility: hidden;\n    pointer-events: none;\n  }\n\n  & > div {\n    overflow: hidden;\n  }\n"]))),kB=(0,lO.ZP)(rN.W2)(na||(na=d4(["\n  &:not([hidden]) {\n    display: flex;\n  }\n  direction: column;\n"]))),kU=(0,lO.ZP)(rN.xu)(no||(no=d4(["\n  /* Prevent overflow caused by change indicator */\n  overflow-x: hidden;\n  overflow-y: auto;\n"]))),kK=(0,lO.ZP)(rN.xu)(ns||(ns=d4(["\n  box-shadow: 0 1px 0 var(--card-shadow-outline-color);\n  position: relative;\n  z-index: 10;\n  min-height: auto;\n"]))),kH=["top","bottom"];function k$(e){let{width:t,elementRef:n,onClose:i,scrollElement:r}=e;(0,rN.qh)((0,rF.useCallback)(e=>{"Escape"===e.key&&i()},[i]));let[l,a]=(0,rF.useState)(0),o=(0,rF.useMemo)(()=>{var e;return(null==(e=null==n?void 0:n.current)?void 0:e.getBoundingClientRect())?{contextElement:n.current||void 0,getBoundingClientRect:()=>{var e;return(null==(e=n.current)?void 0:e.getBoundingClientRect())||null}}:null},[null==n?void 0:n.current,l]),[s,d]=(0,rF.useState)(null),c=(0,rF.useCallback)(()=>{a(l+1)},[l]);return(0,rF.useEffect)(()=>(r&&r.addEventListener("scroll",c,!0),()=>{r&&r.removeEventListener("scroll",c,!0)}),[c,r]),(0,rz.jsx)(kV,{constrainSize:!0,content:(0,rz.jsx)(kX,d6(d6({},e),{},{rootElement:s,width:t})),fallbackPlacements:kH,placement:"bottom",open:!0,portal:"default",ref:d,referenceElement:o||null})}function kX(e){var t;let{onClose:n,rootElement:i,width:r=0,title:l}=e,{element:a}=(0,rN.sz)(),o=(0,rN.vI)();return(0,rN.O8)(n,[i],a),(0,rz.jsx)(kB,{width:r,children:(0,rz.jsxs)(rN.kC,{direction:"column",flex:1,children:[(0,rz.jsx)(kK,{padding:1,children:(0,rz.jsxs)(rN.kC,{align:"center",children:[(0,rz.jsx)(rN.xu,{flex:1,padding:2,children:(0,rz.jsx)(rN.xv,{weight:"semibold",children:l})}),(0,rz.jsx)(rN.zx,{icon:lL.Two,mode:"bleed",onClick:n,padding:2})]})}),(0,rz.jsx)(kU,{flex:1,children:(0,rz.jsx)(fo,{margins:[0,0,1,0],children:(0,rz.jsx)(rN.xu,{padding:3,children:(0,rz.jsx)(rN.Xp,{element:null==(t=o.elements)?void 0:t.default,children:e.children})})})})]})})}function kW(e){var t;let{memberItem:n,onClose:i,scrollElement:r,kind:l}=e,{schemaType:a}=n.node,o=(0,rF.useMemo)(()=>(function(e){var t;let n=null==(t=e.options)?void 0:t.modal;return"object"==typeof n&&null!==n?{type:kq(n.type),width:kL(n.width)}:void 0})(a),[a]),s=(0,rF.useMemo)(()=>(null==o?void 0:o.type)?o.type:"inlineObject"===l||"annotation"===l?"popover":"dialog",[l,o]),[d,c]=(0,rF.useState)(null),u=(0,a4._F)(),p=(0,rF.useRef)(a4.q$.getSelection(u)),h=(0,rF.useCallback)(()=>{a4.q$.focus(u),a4.q$.select(u,p.current),i()},[u,i]),f=(0,rz.jsxs)(rz.Fragment,{children:["Edit ",n.node.schemaType.title]});return((0,rF.useEffect)(()=>{if(d)return;let e=n.node.members.find(e=>"field"===e.kind);if(e&&"field"===e.kind){let t=document.getElementById(e.field.id);t&&(c(t),t.focus())}},[d,n]),"popover"===s)?(null==(t=n.elementRef)?void 0:t.current)?(0,rz.jsx)(k$,{elementRef:n.elementRef,onClose:h,width:null==o?void 0:o.width,scrollElement:r,title:f,children:e.children}):null:(0,rz.jsx)(kN,{title:f,onClose:h,width:null==o?void 0:o.width,children:e.children})}function kG(e){let{changed:t,focusPath:n=cw,focused:i,hasFocus:r,hotkeys:l,isActive:a,isFullscreen:o,onChange:s,onCopy:d,onActivate:c,onItemClose:u,onItemOpen:p,onItemRemove:h,onPaste:f,onToggleFullscreen:m,path:g,renderBlockActions:x,renderCustomMarkers:v,value:b,readOnly:y,renderPreview:j}=e,w=(0,a4._F)(),[k,C]=(0,rF.useState)(null),[_,S]=(0,rF.useState)(null),E=j0(),{element:T}=(0,rN.sz)();!function(e){let{editorRootPath:t,scrollElement:n,hasFormFocus:i,onItemClose:r}=e,l=j0(),a=(0,a4._F)(),o=(0,rF.useMemo)(()=>l.filter(e=>e.member.open).sort((e,t)=>t.member.item.path.length-e.member.item.path.length)[0],[l]);(0,rF.useEffect)(()=>{var e,l;if(!i&&(null==(e=null==o?void 0:o.elementRef)?void 0:e.current)&&((0,a5.Z)(null==(l=o.elementRef)?void 0:l.current,{boundary:n,scrollMode:"if-needed"}),"textBlock"===o.kind)){let s=o.member.item.path.slice(t.length);a4.q$.select(a,{anchor:{path:s,offset:0},focus:{path:s,offset:0}}),a4.q$.focus(a),r()}},[a,i,t.length,o,n,r])}({hasFormFocus:n.length>0,editorRootPath:g,scrollElement:_,onItemClose:u});let A=(0,rF.useCallback)(()=>{m()},[m]),P=(0,rF.useMemo)(()=>d6(d6({},l),{},{custom:d6({"mod+enter":m},(null==l?void 0:l.custom)||{})}),[l,m]),I=function(e){let t=(0,a4._F)(),n=(0,rF.useMemo)(()=>e,[]);return n!==e&&console.warn("Make sure that hotkeys are a stable object across renders, or there will be issues with key handling in the Portable Text Editor."),(0,rF.useMemo)(()=>{let e={marks:{}};return t.schemaTypes.decorators.forEach(t=>{switch(t.value){case"strong":e.marks["mod+b"]=t.value;break;case"em":e.marks["mod+i"]=t.value;break;case"underline":e.marks["mod+u"]=t.value;break;case"code":e.marks["mod+'"]=t.value}}),{marks:d6(d6({},e.marks),(n||{}).marks),custom:n.custom}},[t,n])}(P),M=b&&x?x:void 0,z=b&&v?v:void 0,R=(0,rF.useMemo)(()=>n.length>0?{anchor:{path:n,offset:0},focus:{path:n,offset:0}}:null,[]),F=(0,rF.useCallback)(e=>{let{children:t,focused:n,path:i,selected:r,type:l,value:a}=e,d=a._type===w.schemaTypes.block.name;return d?(0,rz.jsx)(wU,{block:a,focused:n,isFullscreen:o,onChange:s,path:i,readOnly:y,renderBlockActions:M,renderCustomMarkers:z,selected:r,type:l,children:t}):(0,rz.jsx)(wn,{block:a,focused:n,isFullscreen:o,onChange:s,onItemOpen:p,onItemClose:u,onItemRemove:h,path:i,readOnly:y,renderBlockActions:M,renderCustomMarkers:z,renderPreview:j,selected:r,type:l})},[M,z,w.schemaTypes.block.name,o,s,p,u,h,y,j]),O=(0,rF.useCallback)(e=>{let{children:t,focused:n,path:i,selected:r,schemaType:l,value:a}=e,o=a._type===w.schemaTypes.span.name;return o?t:(0,rz.jsx)(wd,{focused:n,onItemOpen:p,path:i,readOnly:y,renderCustomMarkers:v,renderPreview:j,scrollElement:_,selected:r,type:l,value:a})},[w,p,y,v,j,_]),D=(0,rF.useCallback)(e=>(0,rz.jsx)(wm,{renderProps:e,onItemOpen:p,onItemClose:u,readOnly:y,renderCustomMarkers:v,scrollElement:_}),[p,u,y,v,_]),[Z,L]=(0,rF.useState)(null),q=(0,rF.useMemo)(()=>E.filter(e=>e.member.open&&!jU(e.node.schemaType)),[E]),N=(0,rF.useMemo)(()=>(0,rz.jsx)(kO,{hotkeys:I,initialSelection:R,isActive:a,isFullscreen:o,onItemOpen:p,onCopy:d,onPaste:f,onToggleFullscreen:A,path:g,readOnly:y,renderAnnotation:D,renderBlock:F,renderChild:O,setPortalElement:L,scrollElement:_,setScrollElement:S}),[I,A,R,a,o,d,p,f,g,y,D,F,O,_]),V=o?_:T,B=(0,rF.useCallback)(()=>{u()},[u]),U=(0,rF.useMemo)(()=>V&&(0,rz.jsxs)(rz.Fragment,{children:[N,(0,rz.jsx)(rN.NM,{element:V,children:q.map(t=>(0,rz.jsx)(kW,{kind:t.kind,memberItem:t,onClose:B,scrollElement:V,children:(0,rz.jsx)(m8,d6({absolutePath:t.node.path},e))},t.member.key))})]}),[V,N,q,e,B]),K=(0,rN.vI)(),H=(0,rF.useMemo)(()=>({collapsed:k,default:K.element,editor:Z,expanded:K.element}),[K.element,Z,k]);return(0,rz.jsx)(rN.Xp,{__unstable_elements:H,children:(0,rz.jsx)(jZ,{onActivate:c,isOverlayActive:!a,children:(0,rz.jsx)(cH,{disabled:o,hasFocus:Boolean(i),isChanged:t,path:g,children:(0,rz.jsxs)(kD,{"data-focused":r?"":void 0,"data-read-only":y?"":void 0,children:[(0,rz.jsx)("div",{"data-wrapper":"",ref:C,children:(0,rz.jsx)(rN.h_,{__unstable_name:o?"expanded":"collapsed",children:o?(0,rz.jsx)(kZ,{children:U}):U})}),(0,rz.jsx)("div",{"data-border":""})]})})})})}function kY(e){let{onChange:t,onIgnore:n,resolution:i}=e,r=(0,rF.useCallback)(()=>{i&&t({type:"mutation",patches:i.patches})},[t,i]);return i?(0,rz.jsx)(p9,{suffix:(0,rz.jsxs)(rN.Kq,{padding:2,children:[i.action&&(0,rz.jsxs)(rN.rj,{columns:[1,2],gap:1,children:[(0,rz.jsx)(rN.zx,{mode:"ghost",onClick:n,text:"Ignore"}),(0,rz.jsx)(rN.zx,{onClick:r,text:i.action,tone:"caution"})]}),(0,rz.jsx)(rN.xu,{padding:3,children:i.action&&(0,rz.jsx)(rN.xv,{as:"p",muted:!0,size:1,children:"NOTE: It’s generally safe to perform the action above, but if you are in doubt, get in touch with those responsible for configuring your studio."})})]}),title:(0,rz.jsx)(rz.Fragment,{children:"Invalid Portable Text Editor value"}),children:(0,rz.jsxs)(rN.Kq,{space:3,children:[(0,rz.jsx)(rN.xv,{as:"p",muted:!0,size:1,children:i.description}),(0,rz.jsx)(rN.Zb,{border:!0,overflow:"auto",padding:2,tone:"inherit",children:(0,rz.jsx)(rN.EK,{language:"json",children:JSON.stringify(i.item,null,2)})})]})}):null}function kJ(e,t){if(e===t)return!0;if(!Array.isArray(e)||!Array.isArray(t)||e.length<t.length)return!1;for(let n=0,i=t.length;n<i;n++)if(!function(e,t){let n=typeof e;return n===typeof t&&("object"===n?aC()(e,t):e===t)}(t[n],e[n]))return!1;return!0}function kQ(e){let{focused:t,focusPath:n,hotkeys:i,markers:r=cw,members:l,onChange:a,onCopy:o,onPathFocus:s,onInsert:d,onPaste:c,path:u,readOnly:p,renderBlockActions:h,renderCustomMarkers:f,schemaType:m,value:g,elementProps:x}=e;(0,rF.useImperativeHandle)(x.ref,()=>({focus(){b.current&&a4.q$.focus(b.current)}}));let{subscribe:v}=function(e){let{path:t}=e,{patchChannel:n}=hi().__internal,i=(0,rF.useCallback)(e=>n.subscribe(n=>{let{snapshot:i,patches:r}=n,l=r.filter(e=>kJ(e.path,t)).map(e=>d6(d6({},e),{},{path:e.path.slice(t.length)}));l.length&&e({shouldReset:r.some(e=>{var n;return(0===(n=e.path).length||kJ(t,n)&&!kJ(n,t))&&("set"===e.type||"unset"===e.type)}),snapshot:cC(i)?t.reduce((e,t)=>"object"==typeof t?oS()(e,t):oC()(e,t),i):{},patches:l})}),[t,n]);return{subscribe:i}}({path:u}),b=(0,rF.useRef)(null),[y,j]=(0,rF.useState)(!1),[w,k]=(0,rF.useState)(!1),[C,_]=(0,rF.useState)(null),[S,E]=(0,rF.useState)(!1),[T,A]=(0,rF.useState)(!1);(0,rF.useEffect)(()=>{(y||n.length>1)&&A(!0)},[y,n]);let P=(0,rN.pm)(),I=(0,rF.useRef)([]),M=(0,rF.useMemo)(()=>new rH.xQ,[]),z=(0,rF.useMemo)(()=>M.asObservable(),[M]),R=(0,rF.useRef)(null),F=(0,rF.useCallback)(()=>{if(b.current){let e=a4.q$.getSelection(b.current);E(e=>!e),setTimeout(()=>{b.current&&(a4.q$.focus(b.current),e&&a4.q$.select(b.current,d6({},e)))})}},[]);(0,rF.useEffect)(()=>{C&&g!==C.value&&_(null)},[C,g]),(0,rF.useEffect)(()=>v(e=>{let{patches:t,snapshot:n}=e;M.next({patches:t,snapshot:n})}),[M,v]);let O=(0,rF.useMemo)(()=>{let e=[];for(let t of l)if("item"===t.kind&&(jU(t.item.schemaType)?(t.item.validation.length>0||t.item.changed)&&e.push({kind:"textBlock",member:t,node:t.item}):e.push({kind:"objectBlock",member:t,node:t.item}),jU(t.item.schemaType))){let n=t.item.members.find(e=>"field"===e.kind&&"children"===e.name);if(n&&"field"===n.kind&&mF(n))for(let i of n.field.members)"item"===i.kind&&"span"!==i.item.schemaType.name&&e.push({kind:"inlineObject",member:i,node:i.item});let r=t.item.members.filter(jK).find(e=>"markDefs"===e.name);if(r)for(let a of r.field.members)"item"===a.kind&&"object"===a.item.schemaType.jsonType&&e.push({kind:"annotation",member:a,node:a.item})}let o=e.map(e=>{let t=vw(e.node.path.slice(u.length)),n=I.current.find(e=>e.key===t);return n?(n.member=e.member,n.node=e.node,n):{kind:e.kind,key:t,member:e.member,node:e.node,elementRef:(0,rF.createRef)()}});return I.current=o,o},[l,u]),D=(0,rF.useMemo)(()=>O.some(e=>e.member.open),[O]),Z=(0,rF.useMemo)(()=>rL()(e=>{e&&y&&s(e.focus.path)},500,{trailing:!0,leading:!1}),[y,s]),L=(0,rF.useCallback)(e=>{switch(e.type){case"mutation":case"undo":case"redo":a(e.patches.map(e=>d6(d6({},e),{},{patchType:p1})));break;case"selection":Z(e.selection);break;case"focus":j(!0);break;case"blur":j(!1);break;case"invalidValue":_(e);break;case"error":P.push({status:e.level,description:e.description})}},[a,P,Z]),q=(0,rF.useCallback)(()=>{k(!0)},[]),N=(0,rF.useMemo)(()=>C&&C.resolution?(0,rz.jsx)(rN.xu,{marginBottom:2,children:(0,rz.jsx)(kY,{onChange:L,onIgnore:q,resolution:C.resolution})}):null,[L,q,C]),V=(0,rF.useCallback)(()=>{T||(A(!0),y||(b.current&&a4.q$.focus(b.current),j(!0)))},[y,T]);return(0,rF.useEffect)(()=>{!y&&D&&R.current&&(0,a5.Z)(R.current,{scrollMode:"if-needed"})},[t,y,D]),(0,rz.jsxs)(rN.xu,{ref:R,children:[!w&&N,(!C||w)&&(0,rz.jsx)(jW,{markers:r,children:(0,rz.jsx)(jJ,{memberItems:O,children:(0,rz.jsx)(a4.q$,{ref:b,incomingPatches$:z,onChange:L,maxBlocks:void 0,readOnly:p,schemaType:m,value:g,children:(0,rz.jsx)(kG,d6(d6({},e),{},{focused:t,focusPath:n,hasFocus:y,hotkeys:i,isActive:T,isFullscreen:S,onActivate:V,onChange:a,onCopy:o,onInsert:d,onPaste:c,onToggleFullscreen:F,readOnly:p,renderBlockActions:h,renderCustomMarkers:f,value:g}))})})})]})}function k0(e){return"inset 0 0 0 ".concat(e.width,"px ").concat(e.color)}let k1=(0,lO.ZP)(rN.xu)(e=>{let{theme:t}=e,{focusRing:n,input:i,radius:r}=t.sanity,l=t.sanity.color.input,a=(0,rN.hO)(t.sanity.space[1]);return{position:"relative",borderRadius:"".concat(r[1],"px"),color:l.default.enabled.fg,backgroundColor:l.default.enabled.bg,boxShadow:k0({color:l.default.enabled.border,width:i.border.width}),"& > .content":{position:"relative",lineHeight:0,margin:"-".concat(a," 0 0 -").concat(a)},"& > .content > div":{display:"inline-block",verticalAlign:"top",padding:"".concat(a," 0 0 ").concat(a)},"&:not([data-read-only])":{cursor:"text"},"@media(hover:hover)":{"&:not([data-disabled]):not([data-read-only]):hover":{borderColor:l.default.hovered.border}},"&:not([data-disabled]):not([data-read-only])[data-focused]":{boxShadow:function(e){let{base:t,border:n,focusRing:i}=e,r=i.offset+i.width,l=0-i.offset,a=t?t.bg:"var(--card-bg-color)";return[l>0&&"inset 0 0 0 ".concat(l,"px var(--card-focus-ring-color)"),n&&k0(n),l<0&&"0 0 0 ".concat(0-l,"px ").concat(a),r>0&&"0 0 0 ".concat(r,"px var(--card-focus-ring-color)")].filter(Boolean).join(",")}({border:{color:l.default.enabled.border,width:i.border.width},focusRing:n})},"*:disabled + &":{color:l.default.disabled.fg,backgroundColor:l.default.disabled.bg,boxShadow:k0({color:l.default.disabled.border,width:i.border.width})}}}),k2=lO.ZP.input(e=>{let{theme:t}=e,n=t.sanity.fonts.text,i=t.sanity.color.input,r=t.sanity.space[2],l=t.sanity.fonts.text.sizes[2];return{appearance:"none",background:"none",border:0,borderRadius:0,outline:"none",fontSize:(0,rN.hO)(l.fontSize),lineHeight:l.lineHeight/l.fontSize,fontFamily:n.family,fontWeight:n.weights.regular,margin:0,display:"block",minWidth:"1px",maxWidth:"100%",boxSizing:"border-box",paddingTop:(0,rN.hO)(r-l.ascenderHeight),paddingRight:(0,rN.hO)(r),paddingBottom:(0,rN.hO)(r-l.descenderHeight),paddingLeft:(0,rN.hO)(r),"&:not(:invalid):not(:disabled)":{color:i.default.enabled.fg},"&:not(:invalid):disabled":{color:i.default.disabled.fg}}}),k3=(0,lO.ZP)(rN.xu)(e=>{let{theme:t}=e,n=t.sanity.color.input;return(0,lO.iv)(nd||(nd=d4(["\n    position: absolute;\n    top: 0;\n    left: 0;\n    right: 0;\n    pointer-events: none;\n    --card-fg-color: ",";\n  "])),n.default.enabled.placeholder)}),k4=(0,rF.forwardRef)((e,t)=>{let{disabled:n,onChange:i,onFocus:r,placeholder:l,readOnly:a,value:o=[]}=e,s=d3(e,df),d=(0,rF.useMemo)(()=>l||("undefined"!=typeof window&&"ontouchstart"in window?"Enter tag…":"Enter tag and press ENTER…"),[l]),[c,u]=(0,rF.useState)(""),p=!n&&!a,[h,f]=(0,rF.useState)(!1),m=(0,rN.ts)(t),g=(0,rF.useRef)(null),x=(0,rF.useCallback)(e=>{let t=(0,rN.Re)(e.target)&&e.target.closest('[data-ui="Tag"]');if(t)return;let n=m.current;n&&setTimeout(()=>n.focus(),0)},[m]),v=(0,rF.useCallback)(()=>{f(!1)},[]),b=(0,rF.useCallback)(e=>{u(e.currentTarget.value)},[]),y=(0,rF.useCallback)(e=>{f(!0),r&&r(e)},[r]),j=(0,rF.useCallback)(e=>{if("Enter"===e.key&&(e.preventDefault(),e.stopPropagation(),i&&c)){let t=o.concat([{value:c}]);u(""),i&&i(t)}},[c,i,o]),w=(0,rF.useCallback)(e=>{if(!i)return;let t=o.slice(0);t.splice(e,1),i(t)},[i,o]);return(0,rF.useEffect)(()=>{let e=m.current;e&&(e.style.width="0",e.style.width="".concat(e.scrollWidth,"px"))},[m,c]),(0,rz.jsxs)(k1,{"data-disabled":n?"":void 0,"data-focused":h?"":void 0,"data-read-only":a?"":void 0,"data-ui":"TagInput",onPointerDown:x,padding:1,ref:g,children:[p&&(0,rz.jsx)(k3,{hidden:Boolean(c||o.length),padding:3,children:(0,rz.jsx)(rN.xv,{textOverflow:"ellipsis",children:d})}),(0,rz.jsxs)("div",{className:"content",children:[o.map((e,t)=>(0,rz.jsx)("div",{children:(0,rz.jsx)(k5,{enabled:p,index:t,muted:n,onRemove:w,tag:e})},"tag-".concat(t))),(0,rz.jsx)("div",{children:(0,rz.jsx)(k2,d6(d6({},s),{},{disabled:!p,onBlur:v,onChange:b,onFocus:y,onKeyDown:j,ref:m,type:"text",value:c}))},"tag-input")]})]})});function k5(e){let{enabled:t,index:n,muted:i,onRemove:r,tag:l}=e,a=(0,rF.useCallback)(()=>{r(n)},[n,r]);return(0,rz.jsx)(rN.Zb,{"data-ui":"Tag",padding:1,radius:2,tone:"transparent",children:(0,rz.jsxs)(rN.kC,{align:"center",children:[(0,rz.jsx)(rN.xu,{flex:1,padding:1,children:(0,rz.jsx)(rN.xv,{muted:i,children:l.value})}),t&&(0,rz.jsx)(rN.xu,{marginLeft:1,children:(0,rz.jsx)(rN.zx,{icon:lL.Two,mode:"bleed",onClick:a,padding:1})})]})})}function k6(e){let{onChange:t,readOnly:n,value:i=[],elementProps:r}=e,l=(0,rF.useMemo)(()=>null==i?void 0:i.map(e=>({value:e})),[i]),a=(0,rF.useCallback)(e=>{t(0===e.length?p5():p4(e.map(e=>e.value)))},[t]);return(0,rz.jsx)(k4,d6({onChange:a,readOnly:n,value:l},r))}k4.displayName="TagInput";let k8={portal:!0,tone:"default"};function k7(e){let{member:t,sortable:n,onRemove:i}=e,r=(0,rF.useId)();return(0,rz.jsx)(rN.xu,{paddingX:1,children:(0,rz.jsx)(fB,{dragHandle:n,tone:"caution",menu:(0,rz.jsx)(rN.j2,{button:(0,rz.jsx)(rN.zx,{padding:2,mode:"bleed",icon:lL.zGg}),id:"".concat(r,"-menuButton"),menu:(0,rz.jsx)(rN.v2,{children:(0,rz.jsx)(rN.sN,{text:"Remove",tone:"critical",icon:lL.XHJ,onClick:i})}),popover:k8}),children:"INVALID_ITEM_TYPE"===t.error.type?(0,rz.jsx)(jP,{value:t.error.value}):(0,rz.jsxs)("div",{children:["Unexpected Error: ",t.error.type]})})})}function k9(e){let{hoveringFiles:t,types:n,resolveUploader:i}=e,r=t.filter(e=>n.some(t=>i(t,e))),l=t.length-r.length,a=n.length>1;return(0,rz.jsx)(rz.Fragment,{children:r.length>0?(0,rz.jsxs)(rz.Fragment,{children:[(0,rz.jsxs)(rN.gF,{space:2,children:[(0,rz.jsx)(rN.xv,{children:(0,rz.jsx)(lL.rG2,{})}),(0,rz.jsxs)(rN.xv,{children:["Drop to upload"," ",a&&(0,rz.jsxs)(rz.Fragment,{children:[r.length," file",r.length>1?"s":""]})]})]}),l>0&&(0,rz.jsx)(rN.xu,{marginTop:4,children:(0,rz.jsxs)(rN.gF,{space:2,children:[(0,rz.jsx)(rN.xv,{muted:!0,size:1,children:(0,rz.jsx)(lL.vaB,{})}),(0,rz.jsxs)(rN.xv,{muted:!0,size:1,children:[l," file",l>1?"s":""," can't be uploaded here"]})]})})]}):(0,rz.jsxs)(rN.gF,{space:2,children:[(0,rz.jsx)(rN.xv,{children:(0,rz.jsx)(lL.vaB,{})}),(0,rz.jsxs)(rN.xv,{children:["Can't upload ",t.length>1?"any of these files":"this file"," here"]})]})})}let Ce=(0,lO.ZP)(rN.mh)(nc||(nc=d4(["\n  position: absolute;\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  justify-content: center;\n  top: -2px;\n  left: -2px;\n  right: -2px;\n  bottom: -2px;\n  background-color: var(--card-bg-color);\n  opacity: 0.8;\n"]))),Ct=lO.ZP.div(nu||(nu=d4(["\n  position: relative;\n"]))),Cn=function(e){let t=g_(e);return rF.forwardRef(function(e,n){let{children:i,resolveUploader:r,onUpload:l,types:a}=e,o=d3(e,dm),{push:s}=(0,rN.pm)(),d=rF.useCallback((e,t)=>{let{type:n,uploader:i}=t;null==l||l({file:e,schemaType:n,uploader:i})},[l]),c=rF.useCallback(e=>{if(!r)return;let t=e.map(e=>({file:e,uploaderCandidates:a.map(t=>({type:t,uploader:r(t,e)})).filter(e=>e.uploader)})),n=t.filter(e=>e.uploaderCandidates.length>0),i=t.filter(e=>0===e.uploaderCandidates.length);if(i.length>0){let l=i.length>1;s({closable:!0,status:"warning",title:"The following item".concat(l?"s":""," can't be uploaded because there's no known conversion from content type").concat(l?"s":""," to array item:"),description:i.map((e,t)=>(0,rz.jsxs)(rN.kC,{padding:2,children:[(0,rz.jsx)(rN.xu,{marginLeft:1,children:(0,rz.jsx)(rN.xv,{weight:"semibold",children:e.file.name})}),(0,rz.jsx)(rN.xu,{paddingLeft:2,children:(0,rz.jsxs)(rN.xv,{size:1,children:["(",e.file.type,")"]})})]},t))})}n.forEach(e=>{d(e.file,lZ()(e.uploaderCandidates,e=>e.uploader.priority)[0])})},[s,r,a,d]),[u,p]=rF.useState([]),h=rF.useCallback(()=>p([]),[]);return(0,rz.jsx)(Ct,{children:(0,rz.jsxs)(t,d6(d6({},o),{},{ref:n,onFiles:c,onFilesOver:p,onFilesOut:h,children:[r&&u.length>0&&(0,rz.jsx)(Ce,{zOffset:10,children:(0,rz.jsx)(k9,{hoveringFiles:u,types:a,resolveUploader:r})}),i]}))})})}(gT(rN.Zb)),Ci={portal:!0,tone:"default"},Cr=rF.forwardRef(function(e,t){let{sortable:n,value:i,insertableTypes:r,onInsert:l,onRemove:a,readOnly:o,inputId:s,validation:d,children:c,presence:u,schemaType:p}=e,h=d.filter(e=>"error"===e.level).length>0,f=d.filter(e=>"warning"===e.level).length>0,m=(0,rF.useCallback)((e,t)=>{l({position:e,items:[mQ(t)]})},[l]),g=(0,rF.useCallback)(()=>{i&&l({position:"after",items:[i]})},[l,i]),x=(0,rF.useMemo)(()=>h?"critical":f?"caution":void 0,[h,f]),v=(0,rz.jsx)(rN.j2,{button:(0,rz.jsx)(rN.zx,{padding:2,mode:"bleed",icon:lL.zGg}),id:"".concat(s,"-menuButton"),popover:Ci,menu:(0,rz.jsxs)(rN.v2,{children:[(0,rz.jsx)(rN.sN,{text:"Remove",tone:"critical",icon:lL.XHJ,onClick:a}),(0,rz.jsx)(rN.sN,{text:"Duplicate",icon:lL.TIy,onClick:g}),(0,rz.jsx)(f1,{types:r,onInsert:m})]})});return(0,rz.jsx)(fB,{tone:x,menu:!o&&v,dragHandle:!o&&n,presence:0===u.length?null:(0,rz.jsx)(hK,{presence:u,maxAvatars:1}),validation:d.length>0?(0,rz.jsx)(rN.xu,{marginLeft:1,paddingX:1,paddingY:3,children:(0,rz.jsx)(fu,{validation:d})}):null,children:(0,rz.jsx)(rN.kC,{align:p?"flex-end":"center",ref:t,children:(0,rz.jsx)(rN.kC,{align:"flex-end",flex:1,children:(0,rz.jsx)(rN.xu,{flex:1,marginRight:2,children:c})})})})});function Cl(e){let{schemaType:t,readOnly:n,children:i,onValueCreate:r,onItemAppend:l}=e,a=(0,rF.useId)(),o=rF.useCallback(e=>{l(r(e))},[r,l]),s=rF.useCallback(()=>{o(t.of[0])},[t,o]),d=(0,rF.useMemo)(()=>({constrainSize:!0,portal:!0}),[]);return n?(0,rz.jsx)(rN.u,{portal:!0,content:(0,rz.jsx)(rN.xu,{padding:2,sizing:"border",children:(0,rz.jsx)(rN.xv,{size:1,muted:!0,children:"This field is read-only"})}),children:(0,rz.jsx)(rN.rj,{children:(0,rz.jsx)(rN.zx,{icon:lL.dtP,mode:"ghost",disabled:!0,text:1===t.of.length?"Add item":"Add item..."})})}):(0,rz.jsxs)(rN.rj,{gap:1,style:{gridTemplateColumns:"repeat(auto-fit, minmax(100px, 1fr))"},children:[1===t.of.length?(0,rz.jsx)(rN.zx,{icon:lL.dtP,mode:"ghost",onClick:s,text:"Add item"}):(0,rz.jsx)(rN.j2,{button:(0,rz.jsx)(rN.zx,{icon:lL.dtP,mode:"ghost",text:"Add item…"}),id:a||"",menu:(0,rz.jsx)(rN.v2,{children:t.of.map((e,t)=>{var n,i;let r=(0,rM.dD)(e)&&1===(e.to||[]).length&&e.to[0].icon,l=e.icon||(null==(n=e.type)?void 0:n.icon)||r;return(0,rz.jsx)(rN.sN,{text:e.title||(null==(i=e.type)?void 0:i.name),onClick:()=>o(e),icon:l},t)})}),popover:d}),i]})}class Ca extends rF.PureComponent{constructor(e){super(e),this._element=null,this.handleAppend=e=>{let{value:t=[],onIndexFocus:n,onItemAppend:i}=this.props;i(e),n(t.length)},this.handlePrepend=e=>{let{onIndexFocus:t,value:n=[],onItemPrepend:i}=this.props;i(e),t(n.length)},this.handleSortEnd=e=>{let{onIndexFocus:t,onMoveItem:n,value:i}=this.props;i&&n(e),t(e.toIndex)},this.handleItemMoveStart=()=>{this.setState({disableTransition:!1})},this.handleItemMoveEnd=()=>{this.setState({disableTransition:!0})},this.renderArrayItem=e=>{var t;let{schemaType:n}=this.props,i=(null==(t=n.options)?void 0:t.sortable)!==!1;return(0,rz.jsx)(Cr,d6(d6({},e),{},{sortable:i,insertableTypes:n.of}))},this.state={disableTransition:!1}}focus(){this._element&&this._element.focus()}getSnapshotBeforeUpdate(e){var t;let{focusPath:n=[],value:i=[]}=e,{focusPath:r=[],value:l=[]}=this.props;if(n[0]===r[0]&&i.length!==l.length){let a=r[0],o=window.getSelection();if(!((null==o?void 0:o.focusNode)instanceof HTMLElement))return null;let s=null==(t=o.focusNode)?void 0:t.querySelector("input,textarea");return s instanceof HTMLInputElement?{prevFocusedIndex:a,restoreSelection:{text:o.toString(),start:s.selectionStart,end:s.selectionEnd,value:s.value}}:{}}return null}componentDidUpdate(e,t,n){var i;let{onIndexFocus:r}=this.props;if((null==n?void 0:n.restoreSelection)&&e.value){let l=e.value[n.prevFocusedIndex],a=function(e,t,n){let i=t-1,r=t,l=e.length;for(;i>-1||r<l;){let a=e[r];if(r<l&&n(a,r))return r;let o=e[i];if(i>-1&&n(o,i))return i;i--,r++}return -1}(this.props.value||[],n.prevFocusedIndex,e=>e===l);if(-1===a)return;let o=null==(i=this._element)?void 0:i.querySelector("[data-item-index='".concat(a,"'] input,textarea"));if(o instanceof HTMLInputElement){o.focus();try{o.setSelectionRange(n.restoreSelection.start,n.restoreSelection.end)}catch{}}r(a)}}render(){let{schemaType:e,members:t,readOnly:n,renderInput:i,onUpload:r,onItemRemove:l,resolveUploader:a,elementProps:o,arrayFunctions:s=Cl}=this.props,d=!n&&!1!==oC()(e,"options.sortable"),c=t.map(e=>({id:"".concat(e.key,"-").concat("item"===e.kind?e.item.value:"error"),member:e}));return(0,rz.jsxs)(rN.Kq,{space:3,"data-testid":"array-primitives-input",children:[(0,rz.jsx)(Cn,d6(d6({types:e.of,resolveUploader:a,onUpload:r},o),{},{tabIndex:0,children:(0,rz.jsx)(rN.Kq,{space:1,children:0===c.length?(0,rz.jsx)(rN.Zb,{padding:3,border:!0,style:{borderStyle:"dashed"},radius:2,children:(0,rz.jsx)(rN.xv,{align:"center",muted:!0,size:1,children:e.placeholder||(0,rz.jsx)(rz.Fragment,{children:"No items"})})}):(0,rz.jsx)(rN.Zb,{padding:1,border:!0,children:(0,rz.jsx)(fq,{onItemMove:this.handleSortEnd,onItemMoveStart:this.handleItemMoveStart,onItemMoveEnd:this.handleItemMoveEnd,items:c.map(e=>e.id),sortable:d,gap:1,children:c.map((e,t)=>{let{member:n,id:r}=e;return(0,rz.jsxs)(fN,{id:r,sortable:d,disableTransition:this.state.disableTransition,children:["item"===n.kind&&(0,rz.jsx)(m0,{member:n,renderItem:this.renderArrayItem,renderInput:i}),"error"===n.kind&&(0,rz.jsx)(k7,{sortable:d,member:n,onRemove:()=>l(t)})]},n.key)})})})})})),(0,rz.jsx)(s,{onChange:this.props.onChange,onItemAppend:this.handleAppend,onItemPrepend:this.handlePrepend,onValueCreate:mQ,readOnly:this.props.readOnly,schemaType:this.props.schemaType,value:this.props.value})]})}}let Co=(0,lO.ZP)(rN.kC)(np||(np=d4(["\n  min-height: 35px;\n"]))),Cs=(0,lO.ZP)(rN.kC)(nh||(nh=d4(["\n  position: absolute;\n  top: 0;\n  right: 0;\n  height: 35px;\n"]))),Cd=(0,lO.ZP)(rN.Zb)(nf||(nf=d4(["\n  position: absolute;\n  top: 0;\n  left: 0;\n"]))),Cc=(0,lO.ZP)(rN.Zb)(nm||(nm=d4(["\n  transition: border-color 250ms;\n  box-sizing: border-box;\n  position: relative;\n\n  @media (hover: hover) {\n    "," {\n      opacity: 0;\n    }\n\n    &:hover,\n    &:focus-within {\n      "," {\n        opacity: 1;\n      }\n    }\n  }\n\n  ."," & {\n    box-shadow: 0 0 0 0, 0 8px 17px 2px var(--card-shadow-umbra-color),\n      0 3px 14px 2px var(--card-shadow-penumbra-color),\n      0 5px 5px -3px var(--card-shadow-ambient-color);\n  }\n\n  &[aria-selected='true'] {\n    box-shadow: 0 0 0 2px var(--card-focus-ring-color);\n  }\n"])),Cd,Cd,fz);function Cu(e){let{validation:t,selected:n,tone:i,presence:r,children:l,dragHandle:a,menu:o,footer:s}=e,d=d3(e,dg);return(0,rz.jsxs)(Cc,d6(d6({forwardedAs:rN.kC,direction:"column",border:!0,selected:n,"aria-selected":n,radius:2,tone:i},d),{},{children:[l,a&&(0,rz.jsx)(Cd,{margin:1,radius:2,display:"flex",tone:"inherit","data-ui":"DragHandleCard",children:(0,rz.jsx)(fI,{grid:!0,padding:2,mode:"ghost"})}),r&&(0,rz.jsx)(Cs,{align:"center",marginX:1,children:r}),(0,rz.jsxs)(Co,{align:"center",paddingX:1,sizing:"border",justify:"space-between",children:[(0,rz.jsx)(rN.kC,{children:t}),(0,rz.jsx)(rN.xu,{children:s}),o]})]}))}let Cp=(0,lO.ZP)(rN.Zb)(ng||(ng=d4(["\n  border-top-right-radius: inherit;\n  border-top-left-radius: inherit;\n  height: 100%;\n  position: relative;\n\n  @media (hover: hover) {\n    &:hover {\n      filter: brightness(95%);\n    }\n  }\n\n  &:focus:focus-visible {\n    box-shadow: 0 0 0 2px var(--card-focus-ring-color);\n  }\n"]))),Ch={portal:!0,tone:"default"},Cf={position:"absolute",top:0,left:0,bottom:0,right:0};function Cm(e){var t,n,i,r,l,a;let{schemaType:o,parentSchemaType:s,path:d,readOnly:c,onRemove:u,value:p,open:h,onInsert:f,onFocus:m,onOpen:g,onClose:x,changed:v,focused:b,children:y,inputProps:{renderPreview:j}}=e,w=(null==(t=s.options)?void 0:t.sortable)!==!1,k=s.of,C=(0,rF.useRef)(null);hE(C,h),ht(b,(e,t)=>{var n;!e&&t&&C.current&&(null==(n=C.current)||n.focus())});let _=p._resolvingInitialValue,S=(0,rF.useCallback)(()=>{f({items:[d6(d6({},p),{},{_key:hA()})],position:"after"})},[f,p]),E=(0,rF.useCallback)((e,t)=>{f({items:[fQ(t)],position:e})},[f]),T=hm(d,!0),A=(0,rF.useMemo)(()=>0===T.length?null:(0,rz.jsx)(hK,{presence:T,maxAvatars:1}),[T]),P=hv(d,!0),I=(0,rF.useMemo)(()=>0===P.length?null:(0,rz.jsx)(rN.xu,{marginLeft:1,paddingX:1,paddingY:3,children:(0,rz.jsx)(fu,{validation:P,__unstable_showSummary:!0})}),[P]),M=P.some(e=>"error"===e.level),z=P.some(e=>"warning"===e.level),R=(0,rF.useMemo)(()=>c?null:(0,rz.jsx)(rN.j2,{button:(0,rz.jsx)(rN.zx,{padding:2,mode:"bleed",icon:lL.zGg}),id:"".concat(e.inputId,"-menuButton"),menu:(0,rz.jsxs)(rN.v2,{children:[(0,rz.jsx)(rN.sN,{text:"Remove",tone:"critical",icon:lL.XHJ,onClick:u}),(0,rz.jsx)(rN.sN,{text:"Duplicate",icon:lL.TIy,onClick:S}),(0,rz.jsx)(f1,{types:k,onInsert:E})]}),popover:Ch}),[S,E,u,k,e.inputId,c]),F=function(e){let{readOnly:t,hasErrors:n,hasWarnings:i}=e;return t?"transparent":n?"critical":i?"caution":"default"}({readOnly:c,hasErrors:M,hasWarnings:z}),O=(0,rz.jsx)(Cu,{menu:R,presence:A,validation:I,tone:F,radius:2,border:!0,focused:b,dragHandle:w,selected:h,children:(0,rz.jsxs)(Cp,{tone:"inherit",overflow:"auto",forwardedAs:"button","data-ui":"PreviewCard","data-as":"button",type:"button",flex:1,tabIndex:0,disabled:_,onClick:g,ref:C,onFocus:m,__unstable_focusRing:!0,children:[j({schemaType:o,value:p,layout:"media",withBorder:!1,withShadow:!1}),_&&(0,rz.jsx)(rN.Zb,{as:rN.kC,style:Cf,children:(0,rz.jsxs)(rN.kC,{align:"center",justify:"center",gap:1,padding:1,children:[(0,rz.jsx)(rN.xu,{padding:3,children:(0,rz.jsx)(rN.$j,{muted:!0})}),(0,rz.jsx)(rN.xv,{muted:!0,size:1,children:"Resolving initial value…"})]})})]})}),D=u$(o);return(0,rz.jsxs)(rz.Fragment,{children:[(0,rz.jsx)(cH,{path:d,isChanged:v,hasFocus:Boolean(b),children:O}),h&&(0,rz.jsx)(ge,{header:c?"View ".concat(D):"Edit ".concat(D),type:(null==(i=null==(n=null==s?void 0:s.options)?void 0:n.modal)?void 0:i.type)||"dialog",width:null!=(a=null==(l=null==(r=null==s?void 0:s.options)?void 0:r.modal)?void 0:l.width)?a:1,id:p._key,onClose:x,legacy_referenceElement:C.current,children:y})]})}let Cg=(0,lO.ZP)(rN.Zb)(nx||(nx=d4(["\n  max-width: ","px;\n"])),e=>{let{theme:t}=e;return t.sanity.container[1]});function Cx(e){let{value:t,onFocus:n,vertical:i}=e,r=d3(e,dx),[l,a]=rF.useState(!1),[o,s]=rF.useState(null);(0,rN.O8)(()=>a(!1),[o]);let d=rF.useCallback(e=>{("Escape"===e.key||"Tab"===e.key)&&a(!1)},[]),c=(0,rF.useCallback)(()=>{a(e=>!e)},[]),u=(0,a3.wq)(t);return(0,rz.jsx)(rN.J2,{open:l,ref:s,onKeyDown:d,portal:!0,constrainSize:!0,tone:"default",content:(0,rz.jsx)(Cg,{margin:1,padding:3,onKeyDown:d,tabIndex:0,overflow:"auto",children:(0,rz.jsxs)(rN.Kq,{space:4,children:[(0,rz.jsx)(rN.xu,{children:(0,rz.jsx)(rN.xv,{weight:"semibold",children:"Why is this happening?"})}),(0,rz.jsxs)(rN.xv,{size:1,children:["The current schema does not declare items of type ",(0,rz.jsx)("code",{children:u})," as valid for this list. This could mean that the type has been removed as a valid item type, or that someone else has added it to their own local schema that is not yet deployed."]}),(0,rz.jsx)(rN.xu,{children:(0,rz.jsxs)(rN.xv,{size:1,children:[(0,rz.jsx)(lL.sLo,{})," You can still move or delete this item, but it cannot be edited since the schema definition for its type is nowhere to be found."]})}),(0,rz.jsxs)(rN.Kq,{space:2,children:[(0,rz.jsx)(rN.xv,{size:1,weight:"semibold",children:"JSON representation of this item:"}),(0,rz.jsx)(rN.Zb,{padding:2,overflow:"auto",border:!0,children:(0,rz.jsx)(rN.EK,{size:1,as:"pre",language:"json",children:JSON.stringify(t,null,2)})})]})]})}),children:(0,rz.jsx)(rN.Zb,d6(d6({as:"button",type:"button",radius:2,tone:"inherit",paddingX:2,paddingY:3,style:{height:"100%"},onFocus:n,onClick:c,onKeyDown:d,__unstable_focusRing:!0},r),{},{children:(0,rz.jsxs)(rN.Kq,{space:4,marginTop:2,children:[(0,rz.jsx)(rN.xu,{margin:1,children:(0,rz.jsx)(rN.xv,{align:"center",size:4,children:(0,rz.jsx)(lL.Tzq,{})})}),(0,rz.jsxs)(rN.xv,{align:"center",size:1,children:["Items of type ",(0,rz.jsx)("code",{children:u})," is not valid for this list"]})]})}))})}let Cv={portal:!0,tone:"default"};function Cb(e){let{member:t,sortable:n}=e,i=(0,rF.useId)(),{onChange:r}=hp(),l=(0,rF.useCallback)(()=>{r(p6.from([p5([{_key:t.key}])]))},[r,t.key]);return(0,rz.jsx)(Cu,{dragHandle:n,tone:"caution",style:{height:"100%"},menu:(0,rz.jsx)(rN.j2,{button:(0,rz.jsx)(rN.zx,{padding:2,mode:"bleed",icon:lL.zGg}),id:"".concat(i,"-menuButton"),menu:(0,rz.jsx)(rN.v2,{children:(0,rz.jsx)(rN.sN,{text:"Remove",tone:"critical",icon:lL.XHJ,onClick:l})}),popover:Cv}),children:"INVALID_ITEM_TYPE"===t.error.type?(0,rz.jsx)(Cx,{value:t.error.value,vertical:!0}):(0,rz.jsxs)("div",{children:["Unexpected Error: ",t.error.type]})})}let Cy=[];function Cj(e){var t;let{schemaType:n,onChange:i,value:r=Cy,readOnly:l,members:a,elementProps:o,resolveUploader:s,onInsert:d,onItemMove:c,onUpload:u,renderPreview:p,renderField:h,renderInput:f,arrayFunctions:m=hl}=e,g=(0,rF.useCallback)(e=>{d({items:[e],position:"before",referenceItem:0})},[d]),x=(0,rF.useCallback)(e=>{d({items:[e],position:"after",referenceItem:-1})},[d]),v=(null==(t=n.options)?void 0:t.sortable)!==!1,b=(0,rF.useCallback)(e=>(0,rz.jsx)(Cm,d6({},e)),[]),y=(0,rF.useMemo)(()=>a.map(e=>e.key),[a]);return(0,rz.jsxs)(rN.Kq,{space:3,children:[(0,rz.jsx)(Cn,d6(d6({types:n.of,resolveUploader:s,onUpload:u},o),{},{tabIndex:0,children:(0,rz.jsxs)(rN.Kq,{"data-ui":"ArrayInput__content",space:3,children:[(null==a?void 0:a.length)===0&&(0,rz.jsx)(rN.Zb,{padding:3,border:!0,style:{borderStyle:"dashed"},radius:2,children:(0,rz.jsx)(rN.xv,{align:"center",muted:!0,size:1,children:n.placeholder||(0,rz.jsx)(rz.Fragment,{children:"No items"})})}),(null==a?void 0:a.length)>0&&(0,rz.jsx)(rN.Zb,{border:!0,radius:1,children:(0,rz.jsx)(fq,{columns:[2,3,4],gap:3,padding:1,margin:1,items:y,onItemMove:c,sortable:v,children:a.map(e=>(0,rz.jsxs)(fN,{sortable:v,id:e.key,flex:1,children:["item"===e.kind&&(0,rz.jsx)(mJ,{member:e,renderItem:b,renderField:h,renderInput:f,renderPreview:p}),"error"===e.kind&&(0,rz.jsx)(Cb,{sortable:v,member:e})]},e.key))})})]})})),(0,rz.jsx)(m,{onChange:i,onItemAppend:x,onItemPrepend:g,onValueCreate:fQ,readOnly:l,schemaType:n,value:r})]})}let Cw=[];function Ck(e){var t;let{schemaType:n,onChange:i,value:r=Cw,readOnly:l,members:a,elementProps:o,resolveUploader:s,onInsert:d,onItemMove:c,onUpload:u,renderPreview:p,renderField:h,renderItem:f,renderInput:m,arrayFunctions:g=hl}=e,x=(0,rF.useCallback)(e=>{d({items:[e],position:"before",referenceItem:0})},[d]),v=(0,rF.useCallback)(e=>{d({items:[e],position:"after",referenceItem:-1})},[d]),b=(null==(t=n.options)?void 0:t.sortable)!==!1,y=(0,rF.useMemo)(()=>a.map(e=>e.key),[a]);return(0,rz.jsxs)(rN.Kq,{space:3,children:[(0,rz.jsx)(Cn,d6(d6({types:n.of,resolveUploader:s,onUpload:u},o),{},{tabIndex:0,children:(0,rz.jsx)(rN.Kq,{"data-ui":"ArrayInput__content",space:3,children:0===a.length?(0,rz.jsx)(rN.Zb,{padding:3,border:!0,style:{borderStyle:"dashed"},radius:2,children:(0,rz.jsx)(rN.xv,{align:"center",muted:!0,size:1,children:n.placeholder||(0,rz.jsx)(rz.Fragment,{children:"No items"})})}):(0,rz.jsx)(rN.Zb,{border:!0,radius:1,children:(0,rz.jsx)(fq,{axis:"y",gap:1,paddingY:1,items:y,onItemMove:c,sortable:b,children:a.map(t=>(0,rz.jsxs)(fN,{sortable:b,id:t.key,children:["item"===t.kind&&(0,rz.jsx)(mJ,{member:t,renderItem:f,renderField:h,renderInput:m,renderPreview:p}),"error"===t.kind&&(0,rz.jsx)(k7,{sortable:b,member:t,onRemove:()=>e.onItemRemove(t.key)})]},t.key))})})})})),(0,rz.jsx)(g,{onChange:i,onItemAppend:v,onItemPrepend:x,onValueCreate:fQ,readOnly:l,schemaType:n,value:r})]})}function CC(e){var t;let n=(null==(t=e.schemaType.options)?void 0:t.layout)==="grid";return n?(0,rz.jsx)(Cj,d6({},e)):(0,rz.jsx)(Ck,d6({},e))}let C_=["string","number","boolean"];function CS(e){return(0,rM.n4)(e)?e:{title:oO()("".concat(e)),value:e}}let CE={title:"",value:void 0};function CT(e){var t,n;let{value:i,readOnly:r,validationError:l,schemaType:a,onChange:o,path:s,changed:d,focused:c,elementProps:u}=e,p=(0,rF.useMemo)(()=>{var e;return((null==(e=a.options)?void 0:e.list)||[]).map(CS)},[null==(t=a.options)?void 0:t.list]),h=p.find(e=>e.value===i),f=a.options&&"radio"===a.options.layout,m=(0,rF.useCallback)(e=>{let t=Number(e);return p[t]},[p]),g=(0,rF.useCallback)(e=>String(p.indexOf(e)),[p]),x=(0,rF.useId)(),v=rF.useCallback(e=>{o(p6.from(void 0===(null==e?void 0:e.value)?p5():p4(e.value)))},[o]),b=(0,rF.useCallback)(e=>{let t=m(e.currentTarget.value);if(!t){v(CE);return}v(t)},[v,m]),y=f?(0,rz.jsx)(CA,d6(d6({},u),{},{value:h,inputId:x,items:p,direction:(null==(n=a.options)?void 0:n.direction)||"vertical",customValidity:l,onChange:v,readOnly:r})):(0,rz.jsx)(rN.Ph,d6(d6({},u),{},{customValidity:l,value:g(h),readOnly:r,onChange:b,children:[CE,...p].map((e,t)=>(0,rz.jsx)("option",{value:t-1,children:e.title},"".concat(t-1)))}));return(0,rz.jsx)(cH,{path:s,isChanged:d,hasFocus:!!c,children:y})}let CA=(0,rF.forwardRef)(function(e,t){let{items:n,value:i,onChange:r,onFocus:l,readOnly:a,customValidity:o,direction:s,inputId:d}=e,c="horizontal"===s?rN.gF:rN.Kq;return(0,rz.jsx)(rN.Zb,{border:!0,padding:3,radius:1,children:(0,rz.jsx)(c,{space:3,role:"group",children:n.map((e,n)=>(0,rz.jsx)(CP,{customValidity:o,inputId:d,item:e,onChange:r,onFocus:l,readOnly:a,ref:0===n?t:null,value:i},n))})})}),CP=(0,rF.forwardRef)(function(e,t){let{customValidity:n,inputId:i,item:r,onChange:l,onFocus:a,readOnly:o,value:s}=e,d=(0,rF.useCallback)(()=>{l(r)},[r,l]);return(0,rz.jsxs)(rN.kC,{as:"label",align:"center",children:[(0,rz.jsx)(rN.Y8,{ref:t,checked:s===r,onChange:d,onFocus:a,readOnly:o,customValidity:n,name:i}),(0,rz.jsx)(rN.xu,{marginLeft:2,children:(0,rz.jsx)(rN.xv,{size:1,weight:"semibold",children:r.title})})]})});function CI(e){let{validationError:t,elementProps:n}=e;return(0,rz.jsx)(rN.oi,d6(d6({},n),{},{customValidity:t,"data-testid":"string-input"}))}let CM=(e,t)=>{if("function"==typeof e)throw Error('Schema type "'.concat((null==t?void 0:t.name)||"<not-found>","\"'s `validation` was not run though `inferFromSchema`"));return e?Array.isArray(e)?e:[e]:[]};function Cz(e,t){for(let n of CM(null==e?void 0:e.validation,e))for(let i of n._rules)if(i.flag===t)return i;return null}function CR(e){let{schemaType:t,validationError:n,elementProps:i}=e,r=Cz(t,"min"),l=Cz(t,"integer"),a=Cz(t,"precision"),o="number"==typeof(null==r?void 0:r.constraint)&&(null==r?void 0:r.constraint)>=0,s=l||(null==a?void 0:a.constraint)===0;return(0,rz.jsx)(rN.oi,d6(d6({},i),{},{type:"number",step:"any",inputMode:o?s?"numeric":"decimal":"text",customValidity:n,placeholder:t.placeholder,pattern:o?"[d]*":void 0,max:Number.MAX_SAFE_INTEGER,min:Number.MIN_SAFE_INTEGER}))}let CF=(0,lO.ZP)(rN.xu)(nv||(nv=d4(["\n  align-self: center;\n"]))),CO=(0,lO.ZP)(rN.xu)(nb||(nb=d4(["\n  line-height: 0;\n"])));function CD(e){let{fieldNames:t,onChange:n,readOnly:i,value:r}=e,l=t.length,a=(0,rF.useCallback)(e=>{n(p5([e]))},[n]);return(0,rz.jsxs)(p9,{status:"warning",title:(0,rz.jsxs)(rz.Fragment,{children:[1===l&&(0,rz.jsx)(rz.Fragment,{children:"Unknown field found"}),l>1&&(0,rz.jsx)(rz.Fragment,{children:"Unknown fields found"})]}),children:[(0,rz.jsx)(rN.xv,{as:"p",muted:!0,size:1,children:1===l?(0,rz.jsx)(rz.Fragment,{children:"Encountered a field that is not defined in the schema."}):(0,rz.jsxs)(rz.Fragment,{children:["Encountered ",l," fields that are not defined in the schema."]})}),(0,rz.jsxs)(fX,{marginTop:4,open:mD,title:(0,rz.jsx)(rz.Fragment,{children:"Developer info"}),children:[(0,rz.jsx)(rN.xu,{marginBottom:3,children:(0,rz.jsx)(rN.xv,{as:"p",muted:!0,size:1,children:1===l?(0,rz.jsx)(rz.Fragment,{children:"This field is not defined in the schema, which could mean that the field definition has been removed or that someone else has added it to their own local project and have not deployed their changes yet."}):(0,rz.jsx)(rz.Fragment,{children:"These fields are not defined in the document’s schema, which could mean that the field definitions have been removed or that someone else has added them to their own local project and have not deployed their changes yet."})})}),(0,rz.jsx)(rN.Kq,{as:"ul",space:3,children:t.map(e=>(0,rz.jsx)(CZ,{fieldName:e,onUnsetClick:a,readOnly:i,value:null==r?void 0:r[e]},e))})]})]})}function CZ(e){let{fieldName:t,onUnsetClick:n,readOnly:i,value:r}=e,l=(0,rF.useCallback)(()=>{n(t)},[t,n]);return(0,rz.jsx)(rN.Zb,{as:"li",padding:3,radius:2,shadow:1,tone:"caution",children:(0,rz.jsxs)(rN.Kq,{space:2,children:[(0,rz.jsxs)(rN.Zb,{border:!0,radius:1,children:[(0,rz.jsx)(rN.Zb,{borderBottom:!0,padding:3,children:(0,rz.jsx)(rN.EK,{weight:"medium",children:t})}),(0,rz.jsx)(rN.xu,{overflow:"auto",padding:3,children:(0,rz.jsx)(rN.EK,{language:"json",children:JSON.stringify(r,null,2)})})]}),i&&(0,rz.jsxs)(rN.xv,{as:"p",muted:!0,size:1,children:["This field is ",(0,rz.jsx)("strong",{children:"read only"})," according to the document’s schema and cannot be unset. If you want to be able to unset this in Studio, make sure you remove the"," ",(0,rz.jsx)("code",{children:"readOnly"})," field from the enclosing type in the schema."]}),!i&&(0,rz.jsx)(rN.zx,{icon:lL.XHJ,onClick:l,tone:"critical",text:(0,rz.jsx)(rz.Fragment,{children:"Remove field"})})]})})}let CL=(0,lO.ZP)(rN.Zb)(ny||(ny=d4(["\n  margin-bottom: ","px;\n  padding-bottom: ","px;\n"])),e=>{let{$level:t,theme:n}=e;return 0===t?0:-1*n.sanity.space[5]},e=>{let{$level:t,theme:n}=e;return n.sanity.space[4]}),Cq=(0,rF.forwardRef)(function(e,t){let{onClick:n}=e,i=rF.useCallback(()=>{null==n||n(e.name)},[e.name,n]);return(0,rz.jsx)(rN.OK,d6(d6({"data-testid":"group-tab-".concat(name),size:1,id:"".concat(e.name,"-tab"),label:e.title,ref:t},e),{},{onClick:i}))}),CN=e=>{let{name:t,title:n}=e,i=d3(e,dv),{selected:r}=e;return(0,rz.jsx)("option",{title:n,value:t,id:"".concat(t,"-tab"),"aria-controls":i["aria-controls"],"data-testid":"group-select-".concat(t),"aria-selected":r?"true":"false",children:n||t})},CV=(0,lO.ZP)(rN.iX)(nj||(nj=d4(["\n  /* Hide on small screens */\n  &[data-eq-max~='0'] [data-ui='TabList'] {\n    display: none;\n  }\n\n  /* Hide on medium to large screens */\n  [data-ui='Select'] {\n    display: none;\n  }\n\n  /* Show on small screens */\n  &[data-eq-max~='0'] [data-ui='Select'] {\n    display: block;\n  }\n"]))),CB=e=>{let{inputId:t,groups:n,onClick:i,shouldAutoFocus:r=!0,disabled:l}=e;return(0,rz.jsx)(rN.td,{space:2,"data-testid":"field-group-tabs",children:n.map(e=>(0,rz.jsx)(Cq,{"aria-controls":"".concat(t,"-field-group-fields"),autoFocus:r&&e.selected,disabled:l||e.disabled,icon:null==e?void 0:e.icon,name:e.name,onClick:i,selected:Boolean(e.selected),title:e.title||e.name},"".concat(t,"-").concat(e.name,"-tab"))).filter(Boolean)})},CU=e=>{var t;let{disabled:n,groups:i,inputId:r,onSelect:l,shouldAutoFocus:a=!0}=e,o=(0,rF.useCallback)(e=>{l(e.currentTarget.value)},[l]);return(0,rz.jsx)(rN.Ph,{"aria-label":"Field groups",autoFocus:a,"data-testid":"field-group-select",disabled:n,fontSize:2,muted:!0,onChange:o,value:null==(t=i.find(e=>e.selected))?void 0:t.name,children:i.map(e=>(0,rz.jsx)(CN,{"aria-controls":"".concat(r,"-field-group-fields"),disabled:e.disabled,name:e.name,selected:Boolean(e.selected),title:e.title||e.name},"".concat(r,"-").concat(e.name,"-tab")))})},CK=rF.memo(function(e){let{disabled:t=!1,onClick:n}=e,i=d3(e,db),r=(0,rF.useCallback)(e=>{null==n||n(e)},[n]);return(0,rz.jsxs)(CV,{"data-testid":"field-group-root",children:[(0,rz.jsx)(CB,d6(d6({},i),{},{disabled:t,onClick:r})),(0,rz.jsx)(CU,d6(d6({},i),{},{disabled:t,onSelect:r}))]})}),CH=(0,rF.memo)(function(e){let{schemaType:t,groups:n,members:i,onChange:r,renderInput:l,renderField:a,renderItem:o,renderPreview:s,level:d,value:c,id:u,path:p,onFieldGroupSelect:h}=e,{columns:f}=t.options||{},m=(0,rF.useMemo)(()=>{if(!t.fields)return null;let e=t.fields.map(e=>e.name),n=Object.keys(c||{}).filter(t=>!t.startsWith("_")&&!e.includes(t));return 0===n.length?null:(0,rz.jsx)(CD,{fieldNames:n,value:c,onChange:r})},[r,t.fields,c]),g=(0,rF.useCallback)(()=>(0,rz.jsx)(m5,{members:i,renderInput:l,renderField:a,renderItem:o,renderPreview:s}),[i,a,l,o,s]);return 0===i.length?null:(0,rz.jsxs)(rN.Kq,{space:5,children:[n.length>0?(0,rz.jsx)(CL,{$level:d,"data-testid":"field-groups",children:(0,rz.jsx)(CK,{groups:n,inputId:u,onClick:h,shouldAutoFocus:0===p.length})}):null,f?(0,rz.jsx)(rN.rj,{columns:f,gap:4,marginTop:1,children:g()}):g(),m]})});function C$(e){let{date:t,focused:n,isCurrentMonth:i,isToday:r,onSelect:l,selected:a}=e,o=(0,rF.useCallback)(()=>{l(t)},[t,l]);return(0,rz.jsx)("div",{"aria-selected":a,"data-ui":"CalendarDay",children:(0,rz.jsx)(rN.Zb,{"aria-label":t.toDateString(),"aria-pressed":a,as:"button",__unstable_focusRing:!0,"data-weekday":!0,"data-focused":n?"true":"",role:"button",tabIndex:-1,onClick:o,padding:3,radius:2,selected:a,tone:r||a?"primary":"default",children:(0,rz.jsx)(rN.xv,{muted:!a&&!i,style:{textAlign:"center"},weight:i?"medium":"regular",children:t.getDate()})})})}let CX=["January","February","March","April","May","June","July","August","September","October","November","December"],CW=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],CG=oN()(0,24),CY=["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"],CJ=[1,2,3,4,5,6],CQ=e=>{let t=(0,l1.Z)(e);return(0,l2.Z)({start:t,end:(0,l3.Z)(t)})},C0=e=>e.map(e=>[e,...CJ.map(t=>(0,l4.Z)(e,t))]),C1=e=>C0(CQ(e)).map(e=>({number:(0,l5.Z)(e[0]),days:e}));function C2(e){return(0,rz.jsx)(rN.xu,{"aria-hidden":e.hidden||!1,"data-ui":"CalendarMonth",children:(0,rz.jsxs)(rN.rj,{gap:1,style:{gridTemplateColumns:"repeat(7, minmax(44px, 46px))"},children:[CW.map(e=>(0,rz.jsx)(rN.xu,{paddingY:2,children:(0,rz.jsx)(rN.xv,{size:1,weight:"medium",style:{textAlign:"center"},children:e})},e)),C1(e.date).map((t,n)=>t.days.map((t,i)=>{let r=e.focused&&(0,l6.Z)(t,e.focused),l=e.selected&&(0,l6.Z)(t,e.selected),a=(0,l6.Z)(t,new Date),o=e.focused&&(0,l8.Z)(t,e.focused);return(0,rz.jsx)(C$,{date:t,focused:r,isCurrentMonth:o,isToday:a,onSelect:e.onSelect,selected:l},"".concat(n,"-").concat(i))}))]})})}let C3={dayPresets:!1,timePresets:!1},C4=rF.forwardRef(function(e,t){let{onChange:n,onBlur:i,onKeyPress:r,value:l}=e,a=d3(e,dy),[o,s]=rF.useState(),d=rF.useCallback(e=>{s(e.currentTarget.value)},[]),c=rF.useCallback(e=>{let t=e.currentTarget.value;t!=="".concat(l)&&n&&n(e),s(void 0)},[n,l]),u=rF.useCallback(e=>{c(e),i&&i(e)},[c,i]),p=rF.useCallback(e=>{"Enter"===e.key&&c(e),r&&r(e)},[c,r]);return(0,rz.jsx)(rN.oi,d6(d6({},a),{},{"data-testid":"date-input",ref:t,value:void 0===o?l:o,onChange:d,onBlur:u,onKeyPress:p}))}),C5=e=>{let{onChange:t}=e,n=d3(e,dj),i=rF.useCallback(e=>{let n=parseInt(e.currentTarget.value,10);isNaN(n)||t(n)},[t]);return(0,rz.jsx)(C4,d6(d6({},n),{},{onChange:i,inputMode:"numeric"}))},C6=(0,rz.jsx)("span",{"data-preserve-focus":!0,style:{overflow:"hidden",position:"absolute",outline:"none"},tabIndex:-1}),C8=(0,rF.forwardRef)(function(e,t){let{selectTime:n,onFocusedDateChange:i,selectedDate:r=new Date,focusedDate:l=r,timeStep:a=1,onSelect:o}=e,s=d3(e,dw),d=(0,rF.useCallback)(e=>i(e),[i]),c=(0,rF.useCallback)(e=>d((0,l7.Z)((0,l9.Z)(l,e),1)),[l,d]),u=(0,rF.useCallback)(e=>c(Number(e.currentTarget.value)),[c]),p=(0,rF.useCallback)(e=>d((0,ae.Z)(l,e)),[l,d]),h=(0,rF.useCallback)(e=>d((0,at.Z)(l,e)),[l,d]),f=(0,rF.useCallback)(e=>{o((0,an.Z)((0,ai.Z)(e,r.getHours()),r.getMinutes()))},[o,r]),m=(0,rF.useCallback)(e=>{let t=Number(e.currentTarget.value);o((0,an.Z)(r,t))},[o,r]),g=(0,rF.useCallback)(e=>{let t=Number(e.currentTarget.value);o((0,ai.Z)(r,t))},[o,r]);(0,rF.useCallback)((e,t)=>{o((0,ai.Z)((0,an.Z)(r,t),e))},[o,r]);let x=(0,rN.ts)(t),v=(0,rF.useCallback)(()=>{var e,t;null==(t=null==(e=x.current)?void 0:e.querySelector('[data-focused="true"]'))||t.focus()},[x]),b=(0,rF.useCallback)(e=>{var t,n;if(CY.includes(e.key)){if(e.preventDefault(),e.target.hasAttribute("data-calendar-grid")){v();return}"ArrowUp"===e.key&&i((0,l4.Z)(l,-7)),"ArrowDown"===e.key&&i((0,l4.Z)(l,7)),"ArrowLeft"===e.key&&i((0,l4.Z)(l,-1)),"ArrowRight"===e.key&&i((0,l4.Z)(l,1)),null==(n=null==(t=x.current)?void 0:t.querySelector("[data-preserve-focus]"))||n.focus()}},[x,v,i,l]);(0,rF.useEffect)(()=>{v()},[v]),(0,rF.useEffect)(()=>{var e;let t=null==(e=document.activeElement)?void 0:e.matches("[data-calendar-grid], [data-calendar-grid] [data-preserve-focus]");t&&v()},[x,v,l]),(0,rF.useCallback)(()=>f((0,l4.Z)(new Date,-1)),[f]),(0,rF.useCallback)(()=>f(new Date),[f]),(0,rF.useCallback)(()=>f((0,l4.Z)(new Date,1)),[f]);let y=(0,rF.useCallback)(()=>o(new Date),[o]);return(0,rz.jsxs)(rN.xu,d6(d6({"data-ui":"Calendar"},s),{},{ref:x,children:[(0,rz.jsxs)(rN.xu,{padding:2,children:[C3.dayPresets,(0,rz.jsxs)(rN.kC,{children:[(0,rz.jsx)(rN.xu,{flex:1,children:(0,rz.jsx)(C7,{moveFocusedDate:p,onChange:u,value:null==l?void 0:l.getMonth()})}),(0,rz.jsx)(rN.xu,{marginLeft:2,children:(0,rz.jsx)(C9,{moveFocusedDate:p,onChange:h,value:l.getFullYear()})})]}),(0,rz.jsxs)(rN.xu,{"data-calendar-grid":!0,onKeyDown:b,marginTop:2,overflow:"hidden",tabIndex:0,children:[(0,rz.jsx)(C2,{date:l,focused:l,onSelect:f,selected:r}),C6]})]}),n&&(0,rz.jsxs)(rN.xu,{padding:2,style:{borderTop:"1px solid var(--card-border-color)"},children:[(0,rz.jsxs)(rN.kC,{align:"center",children:[(0,rz.jsxs)(rN.kC,{align:"center",flex:1,children:[(0,rz.jsx)(rN.xu,{children:(0,rz.jsx)(rN.Ph,{"aria-label":"Select hour",value:null==r?void 0:r.getHours(),onChange:g,children:CG.map(e=>(0,rz.jsx)("option",{value:e,children:"".concat(e).padStart(2,"0")},e))})}),(0,rz.jsx)(rN.xu,{paddingX:1,children:(0,rz.jsx)(rN.xv,{children:":"})}),(0,rz.jsx)(rN.xu,{children:(0,rz.jsx)(rN.Ph,{"aria-label":"Select minutes",value:null==r?void 0:r.getMinutes(),onChange:m,children:oN()(0,60,a).map(e=>(0,rz.jsx)("option",{value:e,children:"".concat(e).padStart(2,"0")},e))})})]}),(0,rz.jsx)(rN.xu,{marginLeft:2,children:(0,rz.jsx)(rN.zx,{text:"Set to current time",mode:"bleed",onClick:y})})]}),C3.timePresets]})]}))});function C7(e){let{moveFocusedDate:t,onChange:n,value:i}=e,r=(0,rF.useCallback)(()=>t(-1),[t]),l=(0,rF.useCallback)(()=>t(1),[t]);return(0,rz.jsxs)(rN.kC,{flex:1,children:[(0,rz.jsx)(rN.zx,{"aria-label":"Go to previous month",onClick:r,mode:"bleed",icon:lL.wyc,paddingX:2,radius:0}),(0,rz.jsx)(rN.xu,{flex:1,children:(0,rz.jsx)(rN.Ph,{radius:0,value:i,onChange:n,children:CX.map((e,t)=>(0,rz.jsx)("option",{value:t,children:e},t))})}),(0,rz.jsx)(rN.zx,{"aria-label":"Go to next month",mode:"bleed",icon:lL.XCv,onClick:l,paddingX:2,radius:0})]})}function C9(e){let{moveFocusedDate:t,onChange:n,value:i}=e,r=(0,rF.useCallback)(()=>t(-12),[t]),l=(0,rF.useCallback)(()=>t(12),[t]);return(0,rz.jsxs)(rN.kC,{children:[(0,rz.jsx)(rN.zx,{"aria-label":"Previous year",onClick:r,mode:"bleed",icon:lL.wyc,paddingX:2,radius:0}),(0,rz.jsx)(C5,{value:i,onChange:n,radius:0,style:{width:65}}),(0,rz.jsx)(rN.zx,{"aria-label":"Next year",onClick:l,mode:"bleed",icon:lL.XCv,paddingX:2,radius:0})]})}let _e=rF.forwardRef(function(e,t){let{value:n=new Date,onChange:i}=e,r=d3(e,dk),[l,a]=rF.useState(),o=rF.useCallback(e=>{i(e),a(void 0)},[i]);return(0,rz.jsx)(C8,d6(d6({},r),{},{ref:t,selectedDate:n,onSelect:o,focusedDate:l||n,onFocusedDateChange:a}))}),_t=(0,rF.forwardRef)(function(e,t){let{value:n,inputValue:i,onInputChange:r,onChange:l,selectTime:a,timeStep:o}=e,s=d3(e,dC),[d,c]=(0,rF.useState)(null),u=(0,rN.ts)(t),p=(0,rF.useRef)(null),[h,f]=(0,rF.useState)(!1);(0,rN.O8)(()=>f(!1),[d]);let m=(0,rF.useCallback)(()=>{var e,t;null==(e=u.current)||e.focus(),null==(t=u.current)||t.select()},[u]),g=(0,rF.useCallback)(e=>{"Escape"===e.key&&f(!1)},[]),x=(0,rF.useCallback)(()=>f(!0),[]),v=(0,rz.jsx)(rN.xu,{padding:1,children:(0,rz.jsx)(rN.zx,{ref:p,icon:lL.Que,mode:"bleed",padding:2,onClick:x,style:{display:"block"},"data-testid":"select-date-button"})});return(0,rz.jsx)(C4,d6(d6({ref:u},s),{},{value:i,onChange:r,suffix:h?(0,rz.jsx)(rN.li,{zOffset:1e3,children:(0,rz.jsx)(rN.J2,{constrainSize:!0,"data-testid":"date-input-dialog",portal:!0,content:(0,rz.jsx)(rN.xu,{overflow:"auto",children:(0,rz.jsx)(a7.ZP,{onDeactivation:m,children:(0,rz.jsx)(_e,{selectTime:a,timeStep:o,onKeyUp:g,value:n,onChange:l})})}),open:!0,placement:"bottom",ref:c,radius:2,children:v})}):v}))}),_n=new Date,_i=rF.forwardRef(function(e,t){let{id:n,deserialize:i,formatInputValue:r,onChange:l,parseInputValue:a,placeholder:o,readOnly:s,selectTime:d,serialize:c,timeStep:u,value:p}=e,h=d3(e,d_),[f,m]=rF.useState(null);(0,rF.useEffect)(()=>{m(null)},[p]);let g=rF.useCallback(e=>{let t=e.currentTarget.value,n=""===t?null:a(t);null===n?(l(null),void 0===p&&f&&m(null)):n.isValid?l(c(n.date)):m(t)},[f,c,l,a]),x=rF.useCallback(e=>{l(e?c(e):null)},[c,l]),v=(0,rN.ts)(t),b=f?a(f):p?i(p):null,y=f||((null==b?void 0:b.isValid)?r(b.date):p);return s?(0,rz.jsx)(rN.oi,{value:y,readOnly:!0}):(0,rz.jsx)(_t,d6(d6({},h),{},{id:n,selectTime:d,timeStep:u,placeholder:o||"e.g. ".concat(r(_n)),ref:v,value:null==b?void 0:b.date,inputValue:y||"",readOnly:Boolean(s),onInputChange:g,onChange:x,customValidity:null==b?void 0:b.error}))});function _r(e){return e.toISOString()}function _l(e){let t=new Date(e);return t instanceof Date&&!isNaN(t.valueOf())?{isValid:!0,date:t}:{isValid:!1,error:'Invalid date value: "'.concat(e,'"')}}let _a="YYYY-MM-DD",_o=e=>(0,oM.Q)(e,_a),_s=e=>(0,oM.W)(e,_a),_d=(0,lO.ZP)(rN.Kx)(nw||(nw=d4(["\n  &[data-as='textarea'] {\n    resize: vertical;\n  }\n"]))),_c=(e,t)=>{var n;let i=null==(n=t.options)?void 0:n.maxLength;return e?oB()(e,{truncate:"number"==typeof i?i:200,symbols:!0}):""};async function _u(e,t,n){var i;if(!e)return e;let r=(null==(i=t.options)?void 0:i.slugify)||_c;return r(e,t,n)}async function _p(e,t,n){return"function"==typeof e?e(t,n):rR.U2(t,e)}let _h={document:CH,object:CH,array:function(e){let t=(0,rF.useMemo)(()=>{var t;return Array.isArray(null==(t=e.schemaType.options)?void 0:t.list)},[e.schemaType]);return t?(0,rz.jsx)(jM,d6({},e)):(0,rM.d7)(e.schemaType)?(0,rz.jsx)(Ca,d6({},e)):(0,rz.jsx)(CC,d6({},e))},boolean:function(e){var t;let{id:n,value:i,schemaType:r,readOnly:l,elementProps:a}=e,o=(null==(t=r.options)?void 0:t.layout)||"switch",s="checkbox"===o?rN.XZ:rN.rs;return(0,rz.jsx)(rN.Zb,{border:!0,"data-testid":"boolean-input",radius:1,children:(0,rz.jsxs)(rN.kC,{children:[(0,rz.jsx)(CO,{padding:3,children:(0,rz.jsx)(s,d6(d6({label:r.title},a),{},{indeterminate:"boolean"!=typeof i,checked:i||!1,style:{margin:-4},disabled:l}))}),(0,rz.jsx)(rN.xu,{flex:1,paddingY:3,children:(0,rz.jsx)(fm,{description:r.description,inputId:n,title:r.title})}),(0,rz.jsx)(CF,{paddingX:3,paddingY:1,children:(0,rz.jsx)(fT,{maxAvatars:1,position:"top"})})]})})},number:CR,text:function(e){let{schemaType:t,validationError:n,value:i,elementProps:r}=e;return(0,rz.jsx)(_d,d6({customValidity:n,value:i||"",placeholder:t.placeholder,rows:"number"==typeof t.rows?t.rows:10},r))},email:function(e){let{validationError:t,elementProps:n}=e;return(0,rz.jsx)(rN.oi,d6(d6({},n),{},{type:"email",inputMode:"email",customValidity:t}))},datetime:function(e){let{onChange:t,schemaType:n,value:i,elementProps:r}=e,{dateFormat:l,timeFormat:a,timeStep:o}=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{dateFormat:e.dateFormat||"YYYY-MM-DD",timeFormat:e.timeFormat||"HH:mm",timeStep:"timeStep"in e&&Number(e.timeStep)||1,calendarTodayLabel:e.calendarTodayLabel||"Today"}}(n.options),s=(0,rF.useCallback)(e=>{let n=e;null!==n&&o>1&&(n=function(e,t){if(!t||1===t)return e;let n=(0,ar.Z)(e),i=(0,al.Z)(n),r=i%t;return 0!==r?_r((0,an.Z)(n,i-r)):_r(n)}(n,o)),t(null===n?p5():p4(n))},[t,o]),d=rF.useCallback(e=>(0,oM.W)(e,"".concat(l," ").concat(a)),[l,a]),c=rF.useCallback(e=>(0,oM.Q)(e,"".concat(l," ").concat(a)),[l,a]);return(0,rz.jsx)(_i,d6(d6({},r),{},{onChange:s,deserialize:_l,formatInputValue:d,parseInputValue:c,placeholder:n.placeholder,selectTime:!0,serialize:_r,timeStep:o,value:i}))},date:function(e){let{readOnly:t,onChange:n,schemaType:i,elementProps:r,value:l}=e,{dateFormat:a}=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{dateFormat:e.dateFormat||_a,calendarTodayLabel:e.calendarTodayLabel||"Today"}}(i.options),o=(0,rF.useCallback)(e=>{n(null===e?p5():p4(e))},[n]),s=(0,rF.useCallback)(e=>(0,oM.W)(e,a),[a]),d=(0,rF.useCallback)(e=>(0,oM.Q)(e,a),[a]);return(0,rz.jsx)(_i,d6(d6({},r),{},{deserialize:_o,formatInputValue:s,onChange:o,parseInputValue:d,placeholder:i.placeholder,readOnly:t,selectTime:!1,serialize:_s,value:l}))},url:function(e){var t,n;let{schemaType:i,validationError:r,elementProps:l}=e,a=Cz(i,"uri"),o=(null==(n=null==(t=null==a?void 0:a.constraint)?void 0:t.options)?void 0:n.allowRelative)?"text":"url";return(0,rz.jsx)(rN.oi,d6({type:o,inputMode:"url",customValidity:r},l))},image:function(e){var t;let n=null==(t=e.schemaType.options)?void 0:t.sources,{image:i}=hi().__internal,r=Rm(),l=IW(uX),a=hi(),o=a.__internal.image.directUploads,s=(0,rF.useCallback)((e,t)=>o?mS(e,t):null,[o]),d=rF.useMemo(()=>n||i.assetSources,[i,n]),c=rF.useMemo(()=>ay()(l),[l]),u=(0,rF.useCallback)(e=>mu(r,e),[r]);return(0,rz.jsx)(x0,d6(d6({},e),{},{client:l,assetSources:d,directUploads:i.directUploads,imageUrlBuilder:c,observeAsset:u,resolveUploader:s}))},file:function(e){var t;let n=null==(t=e.schemaType.options)?void 0:t.sources,i=Rm(),{file:r}=hi().__internal,l=IW(uX),a=(0,rF.useCallback)((e,t)=>r.directUploads?mS(e,t):null,[r.directUploads]),o=(0,rF.useMemo)(()=>n||r.assetSources,[r,n]),s=(0,rF.useCallback)(e=>mu(i,e),[i]);return(0,rz.jsx)(g3,d6(d6({},e),{},{client:l,assetSources:o,directUploads:r.directUploads,observeAsset:s,resolveUploader:a}))},string:CI,slug:function(e){var t;let{getDocument:n}=hi().__internal,{path:i,value:r,schemaType:l,validation:a,onChange:o,readOnly:s,elementProps:d}=e,c=null==(t=l.options)?void 0:t.source,u=(0,rF.useMemo)(()=>a.filter(e=>"error"===e.level),[a]),p=function(){let{getClient:e}=SJ(),t=I3(),n=Mi(),i=I2(),r=IJ();return(0,rF.useMemo)(()=>({projectId:i,dataset:r,getClient:e,schema:t,currentUser:n}),[e,t,n,i,r])}(),h=(0,rF.useCallback)(e=>{if(!e){o(p6.from(p5([])));return}o(p6.from([p2({_type:l.name}),p4(e,["current"])]))},[o,l.name]),[f,m]=function(e,t){let[n,i]=rF.useState(null),r=rF.useRef(0),l=rF.useCallback(t=>{let n=++r.current;i({status:"pending"}),Promise.resolve().then(()=>e(t)).then(e=>{n===r.current&&i({status:"complete",result:e})},e=>{n===r.current&&i({status:"error",error:e})})},[e,...t]);return[n,l]}(()=>{if(!c)return Promise.reject(Error('Source is missing. Check source on type "'.concat(l.name,'" in schema')));let e=n()||{_type:l.name},t=function(e,t,n){let i=e.slice(0,-1),r=rR.U2(t,i);return d6({parentPath:i,parent:r},n)}(i,e,p);return _p(c,e,t).then(e=>_u(e||"",l,t)).then(e=>h(e))},[i,h,n,l,p]),g=(null==f?void 0:f.status)==="pending",x=rF.useCallback(e=>h(e.currentTarget.value),[h]);return(0,rz.jsx)(rN.Kq,{space:3,children:(0,rz.jsxs)(rN.kC,{children:[(0,rz.jsxs)(rN.xu,{flex:1,children:[(0,rz.jsx)(rN.oi,d6({customValidity:u.length>0?u[0].message:"",disabled:g,onChange:x,value:(null==r?void 0:r.current)||"",readOnly:s},d)),(null==f?void 0:f.status)==="error"&&(0,rz.jsx)(rN.Zb,{padding:2,tone:"critical",children:f.error.message})]}),c&&(0,rz.jsx)(rN.xu,{marginLeft:1,children:(0,rz.jsx)(rN.zx,{mode:"ghost",type:"button",disabled:s||g,onClick:m,text:(null==f?void 0:f.status)==="pending"?"Generating…":"Generate"})})]})})},crossDatasetReference:function(e){let{path:t,schemaType:n}=e,i=IW(uX),r=Rm(),l=(0,rF.useMemo)(()=>i.withConfig({dataset:n.dataset,apiVersion:"2022-03-07",ignoreBrowserTokenWarning:!0}).clone(),[i,n.dataset]),a=y9([]),o=function(e){let t=(0,rF.useRef)(e);return t.current=e,t}(a),s=(0,rF.useCallback)(e=>(0,r1.D)(ji(n.options,o.current,t)).pipe((0,ls.zg)(t=>{let{filter:i,params:r}=t;return function(e,t,n,i){let r=pX(n.to.map(e=>({name:e.type,__experimental_search:e.__experimental_search})),e,i);return r(t,{includeDrafts:!1}).pipe((0,r8.U)(e=>e.map(e=>e.hit)),(0,r8.U)(cy),(0,r8.U)(e=>e.map(e=>({id:e.id,type:e.type,published:e.published}))))}(l,e,n,d6(d6({},n.options),{},{filter:i,params:r,tag:"search.cross-dataset-reference"}))}),(0,le.K)(e=>{var t;let i=e.details&&"queryParseError"===e.details.type;return(null==(t=n.options)?void 0:t.filter)&&i&&(e.message='Invalid reference filter, please check the custom "filter" option'),(0,rW._)(e)})),[l,o,t,n]),d=(0,rF.useMemo)(()=>(function(e){let{client:t,documentPreviewStore:n}=e,{dataset:i,projectId:r}=t.config(),l=i&&r?{dataset:i,projectId:r}:void 0;return function(e,i){return(e._type?(0,rB.of)(e):n.observeDocumentTypeFromId(e._id,l).pipe((0,r8.U)(t=>({_id:e._id,_type:t})))).pipe((0,r6.w)(r=>{if(!r._type)return(function(e,t){let n={uri:e.getDataUrl("doc",t),json:!0,query:{excludeContent:"true"},tag:"".concat("cross-dataset-refs",".availability")};return e.observable.request(n).pipe((0,r8.U)(e=>{let n=aR()(e.omitted||[],e=>e.id),i=n[t];return i?"existence"===i.reason?jn:"permission"===i.reason?jt:null:je}))})(t,e._id).pipe((0,r8.U)(t=>({id:e._id,type:void 0,availability:t,preview:{published:void 0}})));let a=i.to.find(e=>e.type===r._type),o=[...pr(null==a?void 0:a.preview)||[],["_updatedAt"],["_createdAt"]],s=n.observePaths(e,o,l).pipe((0,r8.U)(e=>e?pS(e,a):e));return(0,r0.aj)([s]).pipe((0,r8.U)(t=>{let[n]=t;return{type:r._type,id:e._id,availability:je,preview:{published:cC(n)?n:void 0}}}))}))}})({client:l,documentPreviewStore:r}),[l,r]);return(0,rz.jsx)(vu,d6(d6({},e),{},{getReferenceInfo:d,onSearch:s}))}};function _f(e){var t,n,i,r;if(null==(t=e.components)?void 0:t.input)return e.components.input;let l=u0("array",e)?1===(n=e).of.length&&u0("string",n.of[0])&&(null==(i=n.options)?void 0:i.layout)==="tags"?k6:Boolean(null==(r=n.options)?void 0:r.list)?jM:n.of.every(e=>C_.includes(e.jsonType))?Ca:n.of.some(e=>u0("block",e))?kQ:CC:u0("reference",e)?jC:u0("string",e)?gs(e,"list")?CT:CI:u0("number",e)?gs(e,"list")?CT:CR:void 0;if(l)return l;let a=gh(e,new Set),o=a.reduce((e,t)=>(e[t.name]=t,e),{}),s=Object.values(o).find(e=>_h[e.name]);if(s)return _h[s.name];throw Error("Could not find input component for schema type `".concat(e.name,"`"))}function _m(e){var t;return(null==(t=e.components)?void 0:t.preview)?e.components.preview:u3}function _g(e){let{componentResolver:t,componentProps:n}=e;if(!n.schemaType)throw Error("the `schemaType` property must be defined");let i=t(n.schemaType),r=(0,rF.useCallback)(e=>{var n;if(!(null==(n=e.schemaType)?void 0:n.type))throw Error("Attempted to render form component of non-existent parent type");let i=e.schemaType,{components:r}=i,l=d3(i,dS),a=t(l);return(0,rF.createElement)(a,e)},[t]);return(0,rF.createElement)(i,d6(d6({},n),{},{renderDefault:r}))}function _x(e){return _g({componentProps:e,componentResolver:_f})}function _v(e){return _g({componentProps:e,componentResolver:gv})}function _b(e){return _g({componentProps:e,componentResolver:gl})}function _y(e){return _g({componentProps:e,componentResolver:_m})}function _j(e){var t,n;return null==(n=null==(t=e.form)?void 0:t.components)?void 0:n.input}function _w(e){var t,n;return null==(n=null==(t=e.form)?void 0:t.components)?void 0:n.field}function _k(e){var t,n;return null==(n=null==(t=e.form)?void 0:t.components)?void 0:n.preview}function _C(e){var t,n;return null==(n=null==(t=e.form)?void 0:t.components)?void 0:n.item}function __(){return uQ({defaultComponent:_y,pick:_k})}function _S(e){let t=__();return(0,rz.jsx)(pi,d6(d6({},e),{},{component:t}))}let _E=e=>{let{asset:t,assetType:n,referringDocuments:i}=e,r=i.length,l=t.originalFilename?(0,rz.jsx)("strong",{children:t.originalFilename}):"this ".concat(n);return r>0?(0,rz.jsxs)(rz.Fragment,{children:[(0,rz.jsx)(rN.Zb,{borderBottom:!0,marginTop:2,paddingBottom:2,marginBottom:1,children:(0,rz.jsxs)(rN.xv,{as:"h2",size:[1,1,2,2],weight:"regular",textOverflow:"ellipsis",children:[r," ",1===r?"document is":"documents are"," using ",l]})}),i.map(e=>(0,rz.jsx)(_T,{document:e},e._id))]}):(0,rz.jsxs)(rN.xv,{size:[1,1,2,2],as:"h2",weight:"regular",children:["No documents are using ",l]})},_T=e=>{let{document:t}=e,n=I3(),i=(0,rF.useCallback)(e=>(0,rz.jsx)(lq.nR,d6(d6({},e),{},{params:{id:t._id,type:t._type},intent:"edit"})),[t]);return(0,rz.jsx)(rN.Zb,{as:i,paddingY:2,paddingX:1,radius:2,"data-as":"a",tabIndex:0,children:(0,rz.jsx)(rN.kC,{align:"center",gap:2,children:(0,rz.jsx)(_S,{layout:"default",value:{_type:"reference",_ref:t._id},schemaType:n.get(t._type)})})},t._id)},_A={maxWidth:"100%",height:"120px",objectFit:"contain",objectPosition:"center"},_P={gridColumn:"span 1",overflow:"hidden",display:"flex",alignSelf:"center",justifyContent:"center"},_I={height:"100%"},_M=e=>{let{asset:t,assetType:n,hasResults:i=!1}=e,r="image"===n,l=t.originalFilename?(0,rz.jsxs)(rz.Fragment,{children:["The ",n," ",(0,rz.jsx)("strong",{children:t.originalFilename})]}):"this ".concat(n);return i?(0,rz.jsx)(rN.Zb,{tone:"caution",padding:[3,3,4],border:!0,radius:2,marginBottom:3,children:(0,rz.jsxs)(rN.rj,{columns:3,gap:[2,3,4],children:[(0,rz.jsxs)(rN.kC,{gap:[3,4],align:"center",style:{gridColumn:r?"span 2":"span 3"},children:[(0,rz.jsx)(rN.xv,{children:(0,rz.jsx)(lL.foC,{})}),(0,rz.jsxs)(rN.xv,{size:1,children:[l," cannot be deleted because it's being used. In order to delete the ",n," you need the remove all uses of it."]})]}),r&&(0,rz.jsx)(rN.Zb,{__unstable_checkered:!0,border:!0,radius:1,style:_P,children:(0,rz.jsx)(rN.kC,{align:"center",justify:"center",style:_I,children:(0,rz.jsx)("img",{src:"".concat(t.url,"?w=200"),style:_A,alt:"Preview of image",referrerPolicy:"strict-origin-when-cross-origin"})})})]})}):(0,rz.jsx)(rN.Zb,{paddingX:[2,3,4],paddingY:[3,3,3,4],children:(0,rz.jsxs)(rN.rj,{columns:3,gap:3,children:[(0,rz.jsx)(rN.kC,{style:{gridColumn:r?"span 2":"span 3"},align:"center",children:(0,rz.jsxs)(rN.xv,{children:["You are about to delete the ",n,t.originalFilename&&(0,rz.jsxs)(rz.Fragment,{children:[" ",(0,rz.jsx)("strong",{children:t.originalFilename})]})," ","and its metadata.",(0,rz.jsx)("br",{}),(0,rz.jsx)("br",{}),"Are you sure?"]})}),r&&(0,rz.jsx)(rN.Zb,{__unstable_checkered:!0,border:!0,radius:1,style:_P,children:(0,rz.jsx)(rN.kC,{align:"center",justify:"center",style:_I,children:(0,rz.jsx)("img",{src:"".concat(t.url,"?w=200"),style:_A,alt:"Preview of image",referrerPolicy:"strict-origin-when-cross-origin"})})})]})})},_z="confirmDelete",_R="listUsage";function _F(e){let t=Rg();return(0,rz.jsx)(RS,{documentStore:t,id:e.asset._id,children:t=>{let{isLoading:n,referringDocuments:i}=t;return(0,rz.jsx)(_O,d6(d6({},e),{},{assetIsLoading:n,referringDocuments:i}))}})}let _O=e=>{let{asset:t,assetType:n="image",mode:i=_R,isDeleting:r=!1,assetIsLoading:l=!1,referringDocuments:a=[],onClose:o,onDelete:s}=e,[d,c]=(0,rF.useState)(!1),[u,p]=(0,rF.useState)(!0),[h,f]=(0,rF.useState)([]),m=h.length>0,g=i===_z&&!m,x=i===_z?(0,rz.jsxs)(rN.rj,{padding:2,gap:2,columns:2,children:[(0,rz.jsx)(rN.zx,{mode:"bleed",text:"Cancel",onClick:o}),(0,rz.jsx)(rN.zx,{text:"Delete",tone:"critical",icon:lL.XHJ,onClick:s,loading:r,disabled:!d})]}):void 0;return(0,rF.useEffect)(()=>{let e=a.reduce((e,t)=>t._id.startsWith("drafts.")?e.concat(t._id.slice(7)):e,[]),t=a.filter(t=>!e.includes(t._id));f(t),c(0===t.length&&!l),p(l)},[l,a]),(0,rz.jsxs)(rN.Vq,{id:"asset-dialog",header:i===_R?"Documents using ".concat(n):"Delete ".concat(n),width:1,onClose:o,footer:x,__unstable_autoFocus:!u,children:[u&&(0,rz.jsx)(rN.xu,{padding:4,children:(0,rz.jsx)(uY,{text:"Loading..."})}),!u&&(0,rz.jsxs)(rN.Kq,{paddingX:g?0:[2,3,4],paddingY:g?0:[3,3,3,4],space:1,children:[i===_z&&(0,rz.jsx)(_M,{asset:t,assetType:n,hasResults:m}),(i===_R||m)&&(0,rz.jsx)(_E,{asset:t,referringDocuments:h,assetType:n})]})]})};function _D(e){let{isSelected:t,border:n=!0,onAction:i}=e;return(0,rz.jsx)(rN.j2,{button:(0,rz.jsx)(rN.zx,{padding:2,mode:n?"ghost":t?"default":"bleed",icon:lL.zGg,tone:n?"default":t?"primary":"default"}),id:"asset-menu",portal:!0,menu:(0,rz.jsxs)(rN.v2,{children:[(0,rz.jsx)(rN.sN,{text:"Show uses",icon:lL.xPt,onClick:()=>{i({type:"showUsage"})}}),(0,rz.jsx)(rN.sN,{text:"Delete",icon:lL.XHJ,tone:"critical",onClick:()=>{i({type:"delete"})}})]}),placement:"right"})}let _Z="undefined"!=typeof window&&window.devicePixelRatio?Math.round(window.devicePixelRatio):1,_L=lO.ZP.img(nk||(nk=d4(["\n  position: absolute;\n  z-index: 1;\n  top: 0;\n  left: 0;\n  width: 100%;\n  height: 100%;\n  display: block;\n  object-fit: contain;\n"]))),_q=(0,lO.ZP)(rN.Zb)(nC||(nC=d4(["\n  position: relative;\n  z-index: 1;\n  padding-bottom: 100%;\n"]))),_N=lO.ZP.div(n_||(n_=d4(["\n  position: relative;\n  display: inherit;\n"]))),_V=lO.ZP.div(nS||(nS=d4(["\n  box-sizing: border-box;\n  position: absolute;\n  z-index: 2;\n  display: none;\n  top: 3px;\n  right: 3px;\n\n  ",":hover & {\n    display: block;\n  }\n"])),_N),_B=rF.memo(function(e){let t=IW(uX),n=(0,rN.pm)(),i=(0,rF.useRef)(),{asset:r,onClick:l,onKeyPress:a,onDeleteFinished:o,isSelected:s}=e,[d,c]=(0,rF.useState)(!1),[u,p]=(0,rF.useState)(!1),[h,f]=(0,rF.useState)(!1);(0,rF.useEffect)(()=>()=>{i.current&&i.current.unsubscribe()},[]);let m=(0,rF.useCallback)(()=>{p(!0)},[p]),g=(0,rF.useCallback)(()=>{c(!1),p(!1)},[c,p]),x=(0,rF.useCallback)(()=>{c(!0)},[c]),v=(0,rF.useCallback)(e=>{n.push({closable:!0,status:"error",title:"Image could not be deleted",description:e.message})},[n]),b=(0,rF.useCallback)(()=>{n.push({status:"success",title:"Image was deleted"})},[n]),y=(0,rF.useCallback)(()=>{f(!0),i.current=t.observable.delete(r._id).subscribe({next:()=>{f(!1),o(r._id),p(!1),b()},error:e=>{f(!1),v(e),console.error("Could not delete asset",e)}})},[r._id,v,b,o]),j=(0,rF.useCallback)(e=>{"delete"===e.type&&m(),"showUsage"===e.type&&x()},[m,x]),{originalFilename:w,_id:k,url:C}=r,_=200*Math.max(1,_Z),S=C.includes(".gif")?"".concat(C,"?h=").concat(_,"&fit=max&fm=jpg"):"".concat(C,"?h=").concat(_,"&fit=max");return(0,rz.jsxs)(_N,{children:[(0,rz.jsx)(rN.zx,{tone:"primary",selected:s,tabIndex:0,"data-id":k,mode:"ghost",onKeyPress:a,padding:0,style:{padding:2},children:(0,rz.jsxs)(_q,{__unstable_checkered:!0,children:[(0,rz.jsx)(_L,{alt:w,src:S,onClick:l,"data-id":k}),h&&(0,rz.jsx)(uG,{})]})}),(0,rz.jsx)(_V,{children:(0,rz.jsx)(_D,{isSelected:s,onAction:j})}),(d||u)&&(0,rz.jsx)(_F,{asset:r,mode:u?"confirmDelete":"listUsage",onClose:g,onDelete:y,isDeleting:h})]})}),_U=["B","kB","MB","GB","TB","PB","EB","ZB","YB"],_K=["B","kiB","MiB","GiB","TiB","PiB","EiB","ZiB","YiB"],_H=["b","kbit","Mbit","Gbit","Tbit","Pbit","Ebit","Zbit","Ybit"],_$=["b","kibit","Mibit","Gibit","Tibit","Pibit","Eibit","Zibit","Yibit"],_X=(e,t,n)=>{let i=e;return"string"==typeof t||Array.isArray(t)?i=e.toLocaleString(t,n):(!0===t||void 0!==n)&&(i=e.toLocaleString(void 0,n)),i},_W={"image/bmp":{title:"Bitmap Image"},"image/jpeg":{title:"JPEG Image"},"image/gif":{title:"GIF Image"},"image/vnd.microsoft.icon":{title:"Icon"},"image/png":{title:"PNG Image"},"image/svg+xml":{title:"SVG Image"},"image/webp":{title:"WebP Image"},"image/tiff":{title:"TIFF Image"},"image/heic":{title:"HEIC Image"},"audio/midi":{title:"MIDI Audio"},"audio/midi-x":{title:"MIDI Audio"},"audio/mpeg":{title:"MP3 Audio"},"audio/ogg":{title:"OGG Audio"},"audio/wav":{title:"WAV Audio"},"audio/webm":{title:"WebM Audio"},"audio/aac":{title:"AAC Audio"},"video/x-msvideo":{title:"AVI Video"},"video/mp4":{title:"MP4 Video"},"video/mpeg":{title:"MPEG Video"},"video/ogg":{title:"OGG Video"},"video/webm":{title:"WebM Video"},"video/quicktime":{title:"QuickTime Video"},"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet":{title:"Excel Spreadsheet"},"application/vnd.ms-excel":{title:"Excel Spreadsheet"},"text/plain":{title:"Text"},"text/javascript":{title:"JavaScript"},"text/markdown":{title:"Markdown"},"text/csv":{title:"CSV"},"text/css":{title:"CSS"},"application/pdf":{title:"PDF Document"},"application/xml":{title:"XML Document"},"text/xml":{title:"XML Document"},"application/zip":{title:"ZIP Archive"},"application/vnd.rar":{title:"RAR Archive"},"application/x-7z-compressed":{title:"7-zip Archive"},"application/octet-stream":{title:"Binary"}},_G=lO.ZP.span(nE||(nE=d4(["\n  background-color: transparent;\n  flex-shrink: 0;\n"]))),_Y=(0,lO.ZP)(rN.kC)(nT||(nT=d4([""]))),_J=(0,lO.ZP)(rN.xv)(nA||(nA=d4([""]))),_Q=(0,lO.ZP)(rN.Zb)(nP||(nP=d4(["\n  &:hover-within "," {\n    --card-muted-fg-color: var(--card-muted-fg-color);\n    --card-fg-color: var(--card-fg-color);\n  }\n\n  ","\n"])),_J,e=>e.isSelected&&(0,lO.iv)(nI||(nI=d4(["\n      --card-muted-fg-color: var(--card-bg-color);\n      --card-fg-color: var(--card-bg-color);\n    "])))),_0=(0,lO.ZP)(rN.zx)(nM||(nM=d4(["\n  box-shadow: none;\n  min-width: 0;\n  cursor: pointer;\n  position: initial;\n\n  &:before,\n  &:after {\n    content: '';\n    position: absolute;\n    left: 0;\n    top: 0;\n    width: 100%;\n    height: 100%;\n    z-index: 2;\n  }\n\n  &:before {\n    z-index: 0;\n    pointer-events: none;\n    border-radius: 0.1875rem;\n  }\n\n  ","\n\n  ","\n"])),e=>e.isSelected&&(0,lO.iv)(nz||(nz=d4(["\n      --card-muted-fg-color: var(--card-bg-color);\n      --card-fg-color: var(--card-bg-color);\n\n      &:before {\n        background-color: var(--card-focus-ring-color);\n      }\n\n      "," {\n        --card-muted-fg-color: var(--card-bg-color);\n      }\n\n      "," {\n        --card-muted-fg-color: var(--card-bg-color);\n        --card-fg-color: var(--card-bg-color);\n      }\n    "])),_G,_Y),e=>!e.isSelected&&(0,lO.iv)(nR||(nR=d4(["\n      &:hover:before {\n        background-color: var(--card-bg-color);\n      }\n\n      &:focus:before {\n        background-color: var(--card-code-bg-color);\n      }\n\n      &:focus-within:before {\n        background-color: var(--card-bg-color);\n      }\n    "])))),_1={position:"relative"},_2={flexShrink:0},_3={minWidth:0},_4={zIndex:3,marginTop:"-0.5rem",marginBottom:"-0.5rem"},_5=e=>{let t=IW(uX),n=(0,rN.pm)(),i=(0,rF.useRef)(),[r,l]=(0,rF.useState)(!1),[a,o]=(0,rF.useState)(!1),[s,d]=(0,rF.useState)(!1),[c,u]=(0,rF.useState)(!1),{asset:p,onClick:h,onKeyPress:f,onDeleteFinished:m,isSelected:g,isMobile:x}=e,{originalFilename:v,_id:b,mimeType:y,size:j,_createdAt:w}=p,k=I7(w,{agoSuffix:!0}),C=(null==_W?void 0:_W[y])?_W[y].title:function(e){let t=e.replace("x-","").split("/")[1];return t.charAt(0).toUpperCase()+t.slice(1)}(y),_=function(e){let t,{bits:n=!1,binary:i=!1,signed:r=!1,minimumFractionDigits:l,maximumFractionDigits:a,locale:o}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},s=e;if(!Number.isFinite(s))throw TypeError("Expected a finite number, got ".concat(typeof s,": ").concat(s));let d=n?i?_$:_H:i?_K:_U;if(r&&0===s)return" 0 ".concat(d[0]);let c=s<0,u=c?"-":r?"+":"";if(c&&(s=-s),void 0!==l&&(t={minimumFractionDigits:l}),void 0!==a&&(t=d6({maximumFractionDigits:a},t)),s<1){let p=_X(s,o,t);return"".concat(u+p," ").concat(d[0])}let h=Math.min(Math.floor(i?Math.log(s)/Math.log(1024):Math.log10(s)/3),d.length-1);s/=(i?1024:1e3)**h,t||(s=s.toPrecision(3));let f=_X(Number(s),o,t),m=d[h];return"".concat(u+f," ").concat(m)}(j),S=(v||"").length>37,E=()=>{o(!0)},T=e=>{n.push({closable:!0,status:"error",title:"File could not be deleted",description:e.message})},A=()=>{n.push({status:"success",title:"File was deleted"})},P=()=>{d(!0),i.current=t.observable.delete(p._id).subscribe({next:()=>{d(!1),null==m||m(p._id),o(!1),A()},error:e=>{d(!1),T(e),console.error("Could not delete asset",e)}})},I=()=>{l(!1),o(!1)},M=()=>{l(!0)},z=()=>{u(!c)},R=e=>{"delete"===e.type&&E(),"showUsage"===e.type&&M()};return x?(0,rz.jsxs)(rN.Zb,{paddingBottom:2,style:_1,children:[(0,rz.jsxs)(rN.rj,{columns:4,gap:1,style:{position:"relative",gridTemplateColumns:"1fr 30px",opacity:s?.5:1},children:[(0,rz.jsx)(_0,{asset:p,mode:"bleed",padding:0,"data-id":b,onClick:h,paddingY:1,children:(0,rz.jsxs)(rN.kC,{gap:2,flex:2,align:"center",children:[(0,rz.jsx)(rN.Zb,{as:_G,padding:2,tone:"transparent",radius:2,children:(0,rz.jsx)(rN.xv,{muted:!0,size:2,style:_2,children:(0,rz.jsx)(lL.$lS,{})})}),(0,rz.jsx)(rN.xv,{size:1,align:"left",textOverflow:"ellipsis",style:_3,children:v})]})}),(0,rz.jsx)(rN.kC,{justify:"flex-end",align:"center",paddingRight:1,style:_4,children:(0,rz.jsx)(rN.zx,{mode:"bleed",fontSize:1,padding:2,onClick:z,icon:c?lL.g8U:lL.v4q})})]}),c&&(0,rz.jsxs)(rz.Fragment,{children:[(0,rz.jsxs)(rN.rj,{marginTop:3,columns:3,gap:1,children:[(0,rz.jsxs)(rN.Kq,{space:2,children:[(0,rz.jsx)(rN.__,{size:1,muted:!0,children:"Size"}),(0,rz.jsx)(rN.xv,{size:1,muted:!0,children:_})]}),(0,rz.jsxs)(rN.Kq,{space:2,children:[(0,rz.jsx)(rN.__,{size:1,muted:!0,children:"Type"}),(0,rz.jsx)(rN.xv,{size:1,muted:!0,children:C})]}),(0,rz.jsxs)(rN.Kq,{space:2,children:[(0,rz.jsx)(rN.__,{size:1,muted:!0,children:"Date added"}),(0,rz.jsx)(rN.xv,{size:1,muted:!0,children:k})]})]}),(0,rz.jsxs)(rN.Kq,{space:2,marginTop:3,children:[(0,rz.jsx)(rN.zx,{fontSize:1,tone:"default",mode:"ghost",text:"Show uses",onClick:M,icon:lL.xPt}),(0,rz.jsx)(rN.zx,{fontSize:1,tone:"critical",mode:"ghost",text:"Delete",icon:lL.XHJ,disabled:g,title:g?"Cannot delete current file":"Delete file",onClick:E})]})]}),(r||a)&&(0,rz.jsx)(_F,{assetType:"file",asset:p,mode:a?"confirmDelete":"listUsage",onClose:I,onDelete:P,isDeleting:s})]}):(0,rz.jsxs)(_Q,{asset:p,paddingBottom:1,style:_1,radius:0,overflow:"hidden",isSelected:g,"aria-selected":"true",children:[(0,rz.jsxs)(rN.rj,{columns:4,gap:1,"data-id":b,paddingY:1,style:{position:"relative",gridTemplateColumns:"3fr 1fr 1fr 2fr 30px",opacity:s?.5:1},children:[(0,rz.jsx)(_0,{asset:p,mode:"bleed","data-id":b,onClick:h,padding:0,onKeyPress:f,title:"Select the file ".concat(v),isSelected:g,children:(0,rz.jsxs)(_Y,{gap:2,flex:2,paddingRight:1,align:"center",onClick:h,onKeyPress:f,"data-id":b,title:"Select the file ".concat(v),children:[(0,rz.jsx)(rN.Zb,{as:_G,padding:2,tone:"transparent",radius:2,style:_2,children:(0,rz.jsx)(rN.xv,{muted:!0,size:2,children:(0,rz.jsx)(lL.$lS,{})})}),S&&(0,rz.jsx)(rN.u,{content:(0,rz.jsx)(rN.xu,{padding:2,children:(0,rz.jsx)(rN.xv,{size:1,children:v})}),fallbackPlacements:["right","left"],placement:"top",portal:!0,children:(0,rz.jsx)(rN.xv,{size:1,align:"left",textOverflow:"ellipsis",style:_3,children:v})}),!S&&(0,rz.jsx)(rN.xv,{size:1,align:"left",textOverflow:"ellipsis",style:_3,children:v})]})}),(0,rz.jsx)(_Y,{align:"center",children:(0,rz.jsx)(rN.xv,{size:1,muted:!0,children:_})}),(0,rz.jsx)(_Y,{align:"center",children:(0,rz.jsx)(rN.xv,{size:1,muted:!0,children:C})}),(0,rz.jsx)(_Y,{align:"center",children:(0,rz.jsx)(rN.xv,{as:"time",size:1,muted:!0,dateTime:w,children:k})}),(0,rz.jsx)(_Y,{justify:"flex-end",align:"center",paddingX:1,paddingY:1,style:_4,children:(0,rz.jsx)(_D,{border:!1,isSelected:!1,onAction:R})})]}),(r||a)&&(0,rz.jsx)(_F,{assetType:"file",asset:p,mode:a?"confirmDelete":"listUsage",onClose:I,onDelete:P,isDeleting:s})]})},_6={paddingLeft:"2.2rem"},_8={gridTemplateColumns:"3fr 1fr 1fr 2fr 30px"};function _7(e){let t=(0,rN.d2)(),n=t<2,{assets:i,onClick:r,onKeyPress:l,onDeleteFinished:a,selectedAssets:o,isLoading:s}=e;return(0,rz.jsxs)(rN.xu,{padding:4,children:[(0,rz.jsx)(rN.Zb,{borderBottom:!0,paddingBottom:2,marginBottom:1,children:n?(0,rz.jsx)(rN.rj,{style:_8,children:(0,rz.jsx)(rN.xu,{flex:2,paddingLeft:5,children:(0,rz.jsx)(rN.__,{muted:!0,size:1,children:"Filename"})})}):(0,rz.jsxs)(rN.rj,{gap:1,style:_8,children:[(0,rz.jsx)(rN.xu,{flex:2,style:_6,children:(0,rz.jsx)(rN.__,{muted:!0,size:1,children:"Filename"})}),(0,rz.jsx)(rN.xu,{flex:1,children:(0,rz.jsx)(rN.__,{muted:!0,size:1,children:"Size"})}),(0,rz.jsx)(rN.xu,{flex:1,children:(0,rz.jsx)(rN.__,{muted:!0,size:1,children:"Type"})}),(0,rz.jsx)(rN.xu,{flex:1,children:(0,rz.jsx)(rN.__,{muted:!0,size:1,children:"Date added"})})]})}),(0,rz.jsxs)(rN.Kq,{children:[s&&0===i.length&&(0,rz.jsx)(rN.xu,{paddingTop:4,paddingBottom:2,children:(0,rz.jsx)(rN.kC,{justify:"center",children:(0,rz.jsx)(rN.$j,{muted:!0})})}),i.map(e=>(0,rz.jsx)(_5,{asset:e,isMobile:n,isSelected:o.some(t=>t._id===e._id),onClick:r,onKeyPress:l,onDeleteFinished:a},e._id))]})]})}let _9="sanity.imageAsset",Se=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:200,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:_9;return'\n  *[_type == "'.concat(n,'"] | order(_updatedAt desc) [').concat(e,"...").concat(t,"] {\n    _id,\n    _updatedAt,\n    _createdAt,\n    url,\n    originalFilename,\n    mimeType,\n    extension,\n    size,\n    metadata {dimensions}\n  }\n")},St=(0,lO.ZP)(rN.rj)(nF||(nF=d4(["\n  grid-template-columns: repeat(auto-fill, minmax(120px, 1fr));\n"]))),Sn=(0,lO.ZP)(rN.Zb)(nO||(nO=d4(["\n  border-top: 1px solid var(--card-border-color);\n  position: sticky;\n  bottom: 0;\n  z-index: 200;\n"]))),Si=rF.memo(rF.forwardRef(function(e,t){let n=IW(uX),i=(0,rF.useMemo)(()=>n.withConfig({apiVersion:"1"}),[n]),r=(0,rF.useRef)("default-asset-source-".concat(l0()())),l=(0,rF.useRef)(0),a=(0,rF.useRef)(),[o,s]=(0,rF.useState)([]),[d,c]=(0,rF.useState)(!1),[u,p]=(0,rF.useState)(!1),[h,f]=(0,rF.useState)(!0),{selectedAssets:m,assetType:g="image",dialogHeaderTitle:x="Select image",onClose:v,onSelect:b}=e,y=(0,rF.useCallback)(e=>{let t=200*e,n="image"===g;f(!0),a.current=i.observable.fetch(Se(t,t+200,n?_9:"sanity.fileAsset"),{},{tag:n?"asset.image-list":"asset.file-list"}).subscribe(e=>{c(e.length<200),s(t=>t.concat(e)),f(!1)})},[g,f,s,c,i]),j=(0,rF.useCallback)(e=>{s(t=>t.filter(t=>t._id!==e))},[s]),w=(0,rF.useCallback)(e=>{let t=o.find(t=>t._id===e);t&&b([{kind:"assetDocumentId",value:e}])},[o,b]),k=(0,rF.useCallback)(e=>{e.preventDefault(),w(e.currentTarget.getAttribute("data-id"))},[w]),C=(0,rF.useCallback)(e=>{"Enter"===e.key&&(e.preventDefault(),w(e.currentTarget.getAttribute("data-id")))},[w]),_=(0,rF.useCallback)(()=>{v&&v()},[v]),S=(0,rF.useCallback)(e=>{e.preventDefault(),y(++l.current)},[y]);(0,rF.useEffect)(()=>(y(l.current),()=>{a.current&&a.current.unsubscribe()}),[y]),(0,rF.useEffect)(()=>{h||l.current&&0!==l.current||p(!0)},[h]);let E=(0,rF.useMemo)(()=>(0,rz.jsxs)(rN.xu,{padding:4,children:[(0,rz.jsx)(St,{gap:2,children:o.map(e=>(0,rz.jsx)(_B,{asset:e,isSelected:m.some(t=>t._id===e._id),onClick:k,onKeyPress:C,onDeleteFinished:j},e._id))}),h&&0===o.length&&(0,rz.jsx)(rN.kC,{justify:"center",children:(0,rz.jsx)(rN.$j,{muted:!0})}),!h&&0===o.length&&(0,rz.jsx)(rN.xv,{align:"center",muted:!0,children:"No images"})]}),[o,j,k,C,h,m]),T=(0,rF.useMemo)(()=>(0,rz.jsx)(_7,{isLoading:h,assets:o,selectedAssets:m,onClick:k,onKeyPress:C,onDeleteFinished:j}),[h,o,m,k,C,j]);return(0,rz.jsxs)(rN.Vq,{ref:t,id:r.current,header:x,width:2,onClose:_,__unstable_autoFocus:u,children:["image"===g&&E,"file"===g&&T,o.length>0&&!d&&(0,rz.jsx)(Sn,{tone:"default",padding:4,children:(0,rz.jsx)(rN.kC,{direction:"column",children:(0,rz.jsx)(rN.zx,{type:"button",icon:lL._8t,loading:h,onClick:S,text:"Load more",tone:"primary"})})})]})})),Sr={name:"sanity-default",title:"Uploaded files",component:Si,icon:lL.TAM},Sl={name:"sanity-default",title:"Uploaded images",component:Si,icon:lL.XBm};function Sa(e,t){return e.find(e=>e.name===t)}let So=[{fieldPath:"_updatedAt",icon:lL.Que,operators:[{name:"dateTimeLast",type:"item"},{type:"divider"},{name:"dateTimeAfter",type:"item"},{name:"dateTimeBefore",type:"item"},{type:"divider"},{name:"dateTimeEqual",type:"item"},{name:"dateTimeNotEqual",type:"item"}],title:"Updated at",name:"updatedAt",type:"pinned"},{fieldPath:"_createdAt",icon:lL.Que,operators:[{name:"dateTimeLast",type:"item"},{type:"divider"},{name:"dateTimeAfter",type:"item"},{name:"dateTimeBefore",type:"item"},{type:"divider"},{name:"dateTimeEqual",type:"item"},{name:"dateTimeNotEqual",type:"item"}],title:"Created at",name:"createdAt",type:"pinned"},{icon:lL.xPt,operators:[{name:"referencesDocument",type:"item"},{name:"referencesAssetImage",type:"item"},{name:"referencesAssetFile",type:"item"}],title:"Contains document, image or file",name:"references",type:"pinned"},{fieldType:"array",icon:lL.AEM,name:"array",operators:[{name:"defined",type:"item"},{name:"notDefined",type:"item"},{type:"divider"},{name:"arrayCountEqual",type:"item"},{name:"arrayCountNotEqual",type:"item"},{type:"divider"},{name:"arrayCountGt",type:"item"},{name:"arrayCountGte",type:"item"},{name:"arrayCountLt",type:"item"},{name:"arrayCountLte",type:"item"},{type:"divider"},{name:"arrayCountRange",type:"item"}],type:"field"},{fieldType:"array",icon:lL.AEM,name:"arrayList",operators:[{name:"arrayListIncludes",type:"item"},{name:"arrayListNotIncludes",type:"item"},{type:"divider"},{name:"defined",type:"item"},{name:"notDefined",type:"item"},{type:"divider"},{name:"arrayCountEqual",type:"item"},{name:"arrayCountNotEqual",type:"item"},{type:"divider"},{name:"arrayCountGt",type:"item"},{name:"arrayCountGte",type:"item"},{name:"arrayCountLt",type:"item"},{name:"arrayCountLte",type:"item"},{type:"divider"},{name:"arrayCountRange",type:"item"}],type:"field"},{fieldType:"array",icon:lL.AEM,name:"arrayReferences",operators:[{name:"arrayReferenceIncludes",type:"item"},{name:"arrayReferenceNotIncludes",type:"item"},{type:"divider"},{name:"defined",type:"item"},{name:"notDefined",type:"item"},{type:"divider"},{name:"arrayCountEqual",type:"item"},{name:"arrayCountNotEqual",type:"item"},{type:"divider"},{name:"arrayCountGt",type:"item"},{name:"arrayCountGte",type:"item"},{name:"arrayCountLt",type:"item"},{name:"arrayCountLte",type:"item"},{type:"divider"},{name:"arrayCountRange",type:"item"}],type:"field"},{fieldType:"boolean",icon:lL.nSX,name:"boolean",operators:[{name:"booleanEqual",type:"item"},{type:"divider"},{name:"notDefined",type:"item"}],type:"field"},{fieldType:"date",icon:lL.Que,name:"date",operators:[{name:"dateLast",type:"item"},{type:"divider"},{name:"dateAfter",type:"item"},{name:"dateBefore",type:"item"},{type:"divider"},{name:"dateEqual",type:"item"},{name:"dateNotEqual",type:"item"},{type:"divider"},{name:"defined",type:"item"},{name:"notDefined",type:"item"}],type:"field"},{fieldType:"datetime",icon:lL.Que,name:"datetime",operators:[{name:"dateTimeLast",type:"item"},{type:"divider"},{name:"dateTimeAfter",type:"item"},{name:"dateTimeBefore",type:"item"},{type:"divider"},{name:"dateTimeEqual",type:"item"},{name:"dateTimeNotEqual",type:"item"},{type:"divider"},{name:"defined",type:"item"},{name:"notDefined",type:"item"}],type:"field"},{fieldType:"email",icon:lL.Rhe,name:"email",operators:[{name:"stringMatches",type:"item"},{name:"stringNotMatches",type:"item"},{type:"divider"},{name:"stringEqual",type:"item"},{name:"stringNotEqual",type:"item"},{type:"divider"},{name:"defined",type:"item"},{name:"notDefined",type:"item"}],type:"field"},{fieldType:"file",icon:lL.$lS,name:"file",operators:[{name:"assetFileEqual",type:"item"},{name:"assetFileNotEqual",type:"item"},{type:"divider"},{name:"defined",type:"item"},{name:"notDefined",type:"item"}],type:"field"},{fieldType:"image",icon:lL.XBm,name:"image",operators:[{name:"assetImageEqual",type:"item"},{name:"assetImageNotEqual",type:"item"},{type:"divider"},{name:"defined",type:"item"},{name:"notDefined",type:"item"}],type:"field"},{fieldType:"number",icon:lL.yEv,name:"number",operators:[{name:"numberEqual",type:"item"},{name:"numberNotEqual",type:"item"},{type:"divider"},{name:"numberGt",type:"item"},{name:"numberGte",type:"item"},{name:"numberLt",type:"item"},{name:"numberLte",type:"item"},{type:"divider"},{name:"numberRange",type:"item"},{type:"divider"},{name:"defined",type:"item"},{name:"notDefined",type:"item"}],type:"field"},{fieldType:"array",icon:lL.aI,name:"portableText",operators:[{name:"portableTextMatches",type:"item"},{name:"portableTextNotMatches",type:"item"},{type:"divider"},{name:"portableTextEqual",type:"item"},{name:"portableTextNotEqual",type:"item"},{type:"divider"},{name:"defined",type:"item"},{name:"notDefined",type:"item"}],type:"field"},{fieldType:"reference",icon:lL.xPt,name:"reference",operators:[{name:"referenceEqual",type:"item"},{name:"referenceNotEqual",type:"item"},{type:"divider"},{name:"defined",type:"item"},{name:"notDefined",type:"item"}],type:"field"},{fieldType:"slug",icon:lL.Rhe,name:"slug",operators:[{name:"slugMatches",type:"item"},{name:"slugNotMatches",type:"item"},{type:"divider"},{name:"slugEqual",type:"item"},{name:"slugNotEqual",type:"item"},{type:"divider"},{name:"defined",type:"item"},{name:"notDefined",type:"item"}],type:"field"},{fieldType:"string",icon:lL.Rhe,name:"string",operators:[{name:"stringMatches",type:"item"},{name:"stringNotMatches",type:"item"},{type:"divider"},{name:"stringEqual",type:"item"},{name:"stringNotEqual",type:"item"},{type:"divider"},{name:"defined",type:"item"},{name:"notDefined",type:"item"}],type:"field"},{fieldType:"string",icon:lL.GVG,name:"stringList",operators:[{name:"stringListEqual",type:"item"},{name:"stringListNotEqual",type:"item"},{type:"divider"},{name:"stringMatches",type:"item"},{name:"stringNotMatches",type:"item"},{type:"divider"},{name:"defined",type:"item"},{name:"notDefined",type:"item"}],type:"field"},{fieldType:"text",icon:lL.Rhe,name:"text",operators:[{name:"stringMatches",type:"item"},{name:"stringNotMatches",type:"item"},{type:"divider"},{name:"stringEqual",type:"item"},{name:"stringNotEqual",type:"item"},{type:"divider"},{name:"defined",type:"item"},{name:"notDefined",type:"item"}],type:"field"},{fieldType:"url",icon:lL.Rhe,name:"url",operators:[{name:"stringMatches",type:"item"},{name:"stringNotMatches",type:"item"},{type:"divider"},{name:"stringEqual",type:"item"},{name:"stringNotEqual",type:"item"},{type:"divider"},{name:"defined",type:"item"},{name:"notDefined",type:"item"}],type:"field"}];function Ss(e){let{documentId:t,schemaType:n}=e,i=Rm(),{draft:r,published:l,isLoading:a}=(0,rV.m2)(()=>pa(i,n,t,""),[t,i,n]),o=(0,rF.useMemo)(()=>({_id:t,_type:n.name}),[t,n.name]),s=ps({draft:r,published:l,value:o});return a?(0,rz.jsx)(rN.Od,{animated:!0,marginLeft:1,radius:2,style:{width:"10ch",height:"1em"}}):(0,rz.jsx)(rz.Fragment,{children:s.title||t.slice(0,8)})}function Sd(e){let{value:t}=e,n=t?new Date(t):null;return n&&(0,aa.Z)(n)?(0,rz.jsx)(rz.Fragment,{children:(0,ao.Z)(n,"yyyy-MM-dd")}):null}function Sc(e){let{value:t}=e;return(0,rz.jsx)(rz.Fragment,{children:t})}function Su(e){let{value:t}=e;return(0,rz.jsxs)(rz.Fragment,{children:[t," ",(0,av.Z)("item",t)]})}function Sp(e){let{value:t}=e,n=I3(),i=t._ref,r=n.get(t._type);return r?(0,rz.jsx)(Ss,{documentId:i,schemaType:r}):null}function Sh(e){let{value:t}=e;return(0,rz.jsx)(rz.Fragment,{children:t})}let Sf=(0,rF.createContext)(void 0);function Sm(){let e=(0,rF.useContext)(Sf);if(void 0===e)throw Error("useSearchState must be used within an SearchProvider");return e}function Sg(e){let{value:t,onChange:n}=e,[i,r]=(0,rF.useState)(null!=t?t:""),{state:{fullscreen:l}}=Sm(),a=(0,rF.useCallback)(e=>{r(e.currentTarget.value);let t=parseFloat(e.currentTarget.value);n(Number.isFinite(t)?t:null)},[n]);return(0,rz.jsx)(rN.oi,{fontSize:l?2:1,onChange:a,placeholder:"Value",step:"any",type:"number",value:i})}function Sx(e){var t,n;let{onChange:i,value:r}=e,[l,a]=(0,rF.useState)(null!=(t=null==r?void 0:r.max)?t:""),[o,s]=(0,rF.useState)(null!=(n=null==r?void 0:r.min)?n:""),{state:{fullscreen:d}}=Sm(),c=(0,rF.useCallback)(e=>{var t;a(e.currentTarget.value);let n=parseFloat(e.currentTarget.value);i({max:Number.isFinite(n)?n:null,min:null!=(t=null==r?void 0:r.min)?t:null})},[null==r?void 0:r.min,i]),u=(0,rF.useCallback)(e=>{var t;s(e.currentTarget.value);let n=parseFloat(e.currentTarget.value);i({max:null!=(t=null==r?void 0:r.max)?t:null,min:Number.isFinite(n)?n:null})},[null==r?void 0:r.max,i]);return(0,rz.jsxs)(rN.kC,{gap:2,children:[(0,rz.jsx)(rN.xu,{flex:1,children:(0,rz.jsx)(rN.oi,{fontSize:d?2:1,onChange:u,placeholder:"Min value",step:"any",type:"number",value:o})}),(0,rz.jsx)(rN.xu,{flex:1,children:(0,rz.jsx)(rN.oi,{fontSize:d?2:1,onChange:c,placeholder:"Max value",step:"any",type:"number",value:l})})]})}function Sv(e,t){let n=t.split("."),i=n[0];if(i&&(0,rM.m$)(e)){let r=e.fields.find(e=>e.name===i);if(r){let l=n.slice(1).join(".");return l?Sv(r.type,l):r}}}let Sb=(0,lO.ZP)(rN.xu)(nD||(nD=d4(["\n  @supports (-webkit-overflow-scrolling: touch) {\n    * [data-ui='Box'] {\n      background-attachment: scroll;\n    }\n  }\n"]))),Sy=(0,lO.ZP)(rN.__)(nZ||(nZ=d4(["\n  max-width: 150px;\n"])));function Sj(e){let{documentId:t,presence:n,schemaType:i}=e,r=Rm(),{draft:l,published:a,isLoading:o}=(0,rV.m2)(()=>pa(r,i,t,""),[t,r,i]),s=(0,rF.useMemo)(()=>({_id:t,_type:i.name}),[t,i.name]),d=(0,rF.useMemo)(()=>o?null:(0,rz.jsxs)(rN.gF,{space:3,children:[n&&n.length>0&&(0,rz.jsx)(hR,{presence:n}),(0,rz.jsx)(Sy,{size:0,muted:!0,textOverflow:"ellipsis",children:i.title})]}),[o,n,i.title]);return(0,rz.jsx)(Sb,{children:(0,rz.jsx)(u3,d6(d6({},ps({draft:l,published:a,value:s})),{},{isPlaceholder:null==o||o,layout:"default",icon:i.icon,status:d}))})}let Sw=(0,lO.ZP)(rN.Zb).attrs({as:"a"})(nL||(nL=d4(['\n  // Intentionally left empty – we just want to use the attrs() to set the as prop to "a"\n'])));function Sk(e){let{compact:t,disableIntentLink:n,documentId:i,documentType:r,onClick:l}=e,a=d3(e,dE),o=I3(),s=o.get(r),d=Rn(i),{onClick:c,href:u}=(0,lq.PM)({intent:"edit",params:{id:i,type:null==s?void 0:s.name}}),p=(0,rF.useCallback)(e=>{n||c(e),null==l||l()},[n,l,c]);return s?(0,rz.jsx)(rN.xu,d6(d6({},a),{},{children:(0,rz.jsx)(us,{as:Sw,"data-as":"a","data-command-list-item":!0,flex:1,href:n?void 0:u,onClick:p,padding:t?1:2,radius:2,tabIndex:-1,children:(0,rz.jsx)(Sj,{documentId:i,presence:d,schemaType:s})})})):null}let SC="undefined"!=typeof window&&/Mac|iPod|iPhone|iPad/.test(window.navigator.platform),S_=SC?"Cmd":"Ctrl",SS=rN.Lg.space[1];function SE(e){var t;let{allowEmptyQueries:n,terms:i}=e,r=i.query.trim();return(n?void 0!==r:""!==r)||i.filter&&(null==(t=i.filter)?void 0:t.trim())!==""||i.types.length>0}function ST(e){return pZ(e).filter(e=>!1!==e.__experimental_omnisearch_visibility)}function SA(e,t){var n,i;return(null!=(n=e.title)?n:e.name).localeCompare(null!=(i=t.title)?i:t.name)}let SP={error:null,hits:[],loading:!1,terms:{query:"",types:[]}};function SI(e){return null!==e}function SM(e){return d6(d6({},e),{},{terms:d6(d6({},e.terms),{},{query:e.terms.query.trim()})})}function Sz(e){let{allowEmptyQueries:t,initialState:n,onComplete:i,onError:r,onStart:l,schema:a}=e,[o,s]=(0,rF.useState)(n),d=IW(uX),c=(0,rF.useMemo)(()=>pX(ST(a),d,{tag:"search.global",unique:!0}),[d,a]),u=(0,rV.W2)(e=>e.pipe((0,lt.h)(SI),(0,r8.U)(SM),(0,r9.x)(lM()),(0,lt.h)(e=>SE({allowEmptyQueries:t,terms:e.terms})),(0,lv.D)(e=>(0,rG.H)((null==e?void 0:e.debounceTime)||300)),(0,lr.b)(l),(0,r6.w)(e=>(0,rU.z)((0,rB.of)(d6(d6({},SP),{},{loading:!0,options:e.options,terms:e.terms})),c(e.terms,e.options).pipe((0,r8.U)(e=>({hits:e})),(0,lr.b)(e=>{let{hits:t}=e;return null==i?void 0:i(t)}),(0,le.K)(t=>(null==r||r(t),(0,rB.of)(d6(d6({},SP),{},{error:t,loading:!1,options:e.options,terms:e.terms}))))),(0,rB.of)({loading:!1}))),(0,r7.R)((e,t)=>d6(d6({},e),t),SP),(0,lr.b)(s)),[t,c]),p=(0,rF.useCallback)(()=>{s(SP),u({terms:SP.terms})},[u]),h=(0,rF.useCallback)(e=>u(e),[u]);return{handleSearch:h,handleClearSearch:p,searchState:o}}function SR(e){let t,{availableCharacters:n=40,types:i}=e,r=i.reduce((t=n,function(e,i,r){let l=SF(i);return t-=l.length,0===r?e.push(i):n>l.length&&t>l.length&&e.push(i),e}),[]),l=i.length-r.length;return i.length?["".concat(r.map(SF).join(", ")),...l?["+".concat(l," more")]:[]].join(" "):"All types"}function SF(e){var t;return null!=(t=e.title)?t:e.name}let SO=()=>!0,SD=(0,lO.ZP)(rN.xv)(nq||(nq=d4(["\n  word-break: break-word;\n"]))),SZ=(0,rF.forwardRef)(function(e,t){let{onSelect:n,types:i=[],value:r}=e,l=(0,rF.useRef)(null),a=I3(),{state:{fullscreen:o}}=Sm(),s=(0,rF.useId)(),[d,c]=(0,rF.useState)([]),{handleSearch:u,searchState:p}=Sz({allowEmptyQueries:!0,initialState:{hits:[],loading:!1,error:null,terms:{query:"",types:i}},onComplete:e=>{c(e.map(e=>({hit:e,value:e.hit._id})))},schema:a}),h=(0,rF.useCallback)(()=>{u({debounceTime:0,options:{limit:100},terms:{query:"",types:i}})},[u,i]),f=(0,rF.useCallback)(e=>{e?u({options:{limit:100},terms:{query:e||"",types:i}}):u({debounceTime:0,options:{limit:0},terms:{query:"",types:i}})},[u,i]),m=(0,rF.useCallback)(e=>{var t;let i=null==(t=d.find(t=>t.value===e))?void 0:t.hit.hit;i&&(null==n||n({_ref:cb(i._id),_type:i._type}))},[d,n]),g=(0,rF.useMemo)(()=>{let e=SR({types:i});return i.length>0?"Search for ".concat(e):"Search all documents"},[i]),x=(0,rF.useCallback)(e=>{let t=e.hit.hit._type;return(0,rz.jsx)(Sk,{compact:!0,disableIntentLink:!0,documentId:e.value,documentType:t})},[]),v=(0,rF.useCallback)((e,t)=>{let{content:n,hidden:i,onMouseEnter:r,onMouseLeave:a}=e,o=d&&d.length>0;return(0,rz.jsx)(rN.J2,{arrow:!1,constrainSize:!0,content:(0,rz.jsx)("div",{ref:t,children:o?n:p.terms.query&&(0,rz.jsx)(rN.xu,{padding:4,children:(0,rz.jsx)(rN.kC,{align:"center",height:"fill",justify:"center",children:(0,rz.jsxs)(SD,{align:"center",muted:!0,children:["No results for ",(0,rz.jsxs)("strong",{children:["“",p.terms.query,"”"]})]})})})}),matchReferenceWidth:!0,onMouseEnter:r,onMouseLeave:a,open:!p.loading&&!i,overflow:"auto",placement:"bottom-start",radius:2,referenceElement:l.current})},[d,p.loading,p.terms.query]);return(0,rz.jsx)("div",{ref:l,children:(0,rz.jsx)(rN.F2,{"aria-label":g,filterOption:SO,fontSize:o?2:1,id:s,loading:p.loading,openButton:{onClick:h},options:d,onQueryChange:f,onSelect:m,placeholder:g,radius:2,ref:t,renderOption:x,renderPopover:v,value:null==r?void 0:r._ref})})});function SL(e){let{fieldDefinition:t,onChange:n,value:i}=e,{onClose:r,state:{documentTypesNarrowed:l,fullscreen:a}}=Sm(),o=I3(),s=(0,rF.useCallback)(e=>n(e),[n]),d=(0,rF.useMemo)(()=>t?t.documentTypes.filter(e=>l.includes(e)).flatMap(e=>{let n=o.get(e);if(n){let i=Sv(n,t.fieldPath);if((0,rM.jB)(null==i?void 0:i.type))return null==i?void 0:i.type.of.filter(rM.dD).flatMap(e=>e.to);if((0,rM.dD)(null==i?void 0:i.type))return null==i?void 0:i.type.to}return[]}).reduce((e,t)=>(0>e.findIndex(e=>e.name===(null==t?void 0:t.name))&&e.push(t),e),[]):[],[l,t,o]),c=(0,rF.useCallback)(()=>s(null),[s]),u=(0,rF.useCallback)(()=>{null==r||r()},[r]);return(0,rz.jsx)(rN.xu,{style:{width:"min(calc(100vw - 40px), 420px)"},children:(null==i?void 0:i._ref)&&(null==i?void 0:i._type)?(0,rz.jsxs)(rN.Kq,{space:3,children:[(0,rz.jsx)(rN.Zb,{padding:1,radius:1,shadow:1,children:(0,rz.jsx)(Sk,{compact:!0,documentId:i._ref,documentType:i._type,onClick:u})}),(0,rz.jsx)(rN.zx,{fontSize:a?2:1,mode:"ghost",onClick:c,text:"Clear",tone:"critical"})]}):(0,rz.jsx)(SZ,{onSelect:s,types:d,value:i})})}function Sq(e){let{onClick:t,selected:n,title:i,value:r}=e,l=(0,rF.useCallback)(()=>t(r),[t,r]);return(0,rz.jsx)(rN.sN,{onClick:l,padding:3,pressed:n,tone:"default",children:(0,rz.jsx)(rN.kC,{align:"center",justify:"space-between",gap:3,children:(0,rz.jsxs)(rN.Kq,{paddingRight:2,space:2,children:[(0,rz.jsx)(rN.xv,{size:1,weight:"regular",children:i}),r&&(0,rz.jsx)(rN.EK,{muted:!0,size:0,children:r})]})})})}function SN(e){let{fieldDefinition:t,onChange:n,value:i}=e,r=(0,rF.useId)(),{state:{documentTypesNarrowed:l}}=Sm(),a=I3(),o=(0,rF.useMemo)(()=>{if(!t)return[];let e=t.documentTypes.filter(e=>l.includes(e)).map(e=>{let n=a.get(e);if(n){let i=Sv(n,t.fieldPath);return null==i?void 0:i.type.options}return null}).filter(cf),n=e.map(e=>e.list).flatMap(e=>null==e?void 0:e.map(e=>(0,rM.n4)(e)?e:{title:oO()("".concat(e)),value:e})).filter(cf);return n.reduce((e,t)=>{let n=e.findIndex(e=>e.value===(null==t?void 0:t.value));if(n>-1){let i=e[n];e[n]=d6(d6({},e[n]),{},{title:aV()([...i.title,t.title]).sort()})}else e.push(d6(d6({},t),{},{title:[t.title]}));return e},[])},[l,t,a]),s=(0,rF.useCallback)(e=>{n(e)},[n]);return(0,rz.jsx)(rN.j2,{button:(0,rz.jsx)(rN.zx,{mode:"ghost",padding:3,children:(0,rz.jsxs)(rN.kC,{align:"center",gap:2,justify:"space-between",children:[(0,rz.jsx)(rN.xv,{size:1,weight:"regular",children:i||"Select..."}),(0,rz.jsx)(rN.xu,{marginLeft:1,children:(0,rz.jsx)(rN.xv,{size:1,children:(0,rz.jsx)(lL.GVG,{})})})]})}),id:r||"",menu:(0,rz.jsx)(rN.v2,{children:o.map((e,t)=>(0,rz.jsx)(Sq,{onClick:s,selected:e.value===i,title:e.title.join(", "),value:e.value||""},t))}),placement:"bottom-start",popover:{constrainSize:!0,portal:!1,radius:2}})}let SV=()=>(0,rz.jsx)("svg",{width:"1em",height:"1em",viewBox:"0 0 25 25",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:(0,rz.jsx)("path",{d:"M7.04 19V17.512H17.36V19H7.04ZM7.04 15.328V13.624L12.08 11.872L15.32 10.816V10.72L12.08 9.664L7.04 7.912V6.208L17.36 9.88V11.656L7.04 15.328Z",fill:"currentColor"})}),SB=()=>(0,rz.jsx)("svg",{width:"1em",height:"1em",viewBox:"0 0 25 25",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:(0,rz.jsx)("path",{d:"M7.568 18.848V16.952L14.792 12.08V11.984L7.568 7.112V5.216L16.52 11.288V12.776L7.568 18.848Z",fill:"currentColor"})}),SU=()=>(0,rz.jsx)("svg",{width:"1em",height:"1em",viewBox:"0 0 25 25",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:(0,rz.jsx)("path",{d:"M7.04 19V17.512H17.36V19H7.04ZM17.36 15.328L7.04 11.656V9.88L17.36 6.208V7.912L12.32 9.664L9.08 10.72V10.816L12.32 11.872L17.36 13.624V15.328Z",fill:"currentColor"})}),SK=()=>(0,rz.jsx)("svg",{width:"1em",height:"1em",viewBox:"0 0 25 25",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:(0,rz.jsx)("path",{d:"M16.952 19.632L8 13.56V12.072L16.952 6V7.896L9.728 12.768V12.864L16.952 17.736V19.632Z",fill:"currentColor"})});function SH(e){return JSON.stringify(e)}let S$=(0,rF.createContext)(null);function SX(e){let{children:t,workspace:n}=e;return(0,rz.jsx)(S$.Provider,{value:n,children:t})}function SW(){let e=(0,rF.useContext)(S$);if(!e)throw Error("Workspace: missing context value");return e}let SG=(0,rF.createContext)(null);function SY(e){let{children:t}=e,n=d3(e,dT),i=(0,rF.useContext)(SG),{unstable_sources:r}=SW();if("source"in n){let{source:l}=n;return(0,rz.jsx)(SG.Provider,{value:l,children:t})}if("name"in n){let{name:a}=n,o=r.find(e=>e.name===a);if(!o)throw Error("Could not find source with name `".concat(a,"` in current workspace"));return i===o?(0,rz.jsx)(rz.Fragment,{children:t}):(0,rz.jsx)(SG.Provider,{value:o,children:t})}throw Error("Invalid props passed into SourceProvider. A `name` or a `source` object is required.")}function SJ(){let e=(0,rF.useContext)(SG);if(!e)throw Error("Could not find `source` context");return e}function SQ(e){return(0,rz.jsx)(rN.xu,d6(d6({},e),{},{children:(0,rz.jsxs)(rN.kC,{align:"flex-start",gap:3,children:[(0,rz.jsx)(uc,{tone:"caution",children:(0,rz.jsx)(lL.foC,{})}),(0,rz.jsxs)(rN.Kq,{space:4,children:[(0,rz.jsx)(uc,{size:1,tone:"caution",weight:"semibold",children:"No valid asset sources found."}),(0,rz.jsx)(uc,{size:1,tone:"caution",children:"Currently, only the default asset source is supported."}),(0,rz.jsx)(uc,{size:1,tone:"caution",children:"Please ensure it's enabled in your studio configuration file."})]})]})}))}function S0(e){let{reference:t}=e,n=Rm(),i=(0,rF.useCallback)(e=>mu(n,e),[n]);return(0,rz.jsx)(gj,{observeAsset:i,reference:t,waitPlaceholder:(0,rz.jsx)(S2,{}),children:e=>(0,rz.jsx)(S1,{asset:e})})}function S1(e){let{asset:t}=e;return(0,rz.jsx)(rN.Zb,{padding:2,shadow:1,children:(0,rz.jsxs)(rN.kC,{align:"center",justify:"space-between",wrap:"nowrap",children:[(0,rz.jsx)(rN.Zb,{padding:3,radius:1,shadow:1,tone:"transparent",children:(0,rz.jsx)(rN.xv,{children:(0,rz.jsx)(lL.bg6,{})})}),(0,rz.jsxs)(rN.Kq,{flex:1,space:2,marginLeft:3,children:[(0,rz.jsx)(rN.xv,{size:2,textOverflow:"ellipsis",muted:!0,children:(null==t?void 0:t.originalFilename)||t._id}),(0,rz.jsx)(rN.xv,{size:1,muted:!0,children:gG(t.size)})]})]})})}function S2(){return(0,rz.jsx)(rN.Zb,{padding:2,shadow:1,children:(0,rz.jsxs)(rN.kC,{align:"center",justify:"flex-start",children:[(0,rz.jsx)(rN.Zb,{padding:3,radius:1,shadow:1,tone:"transparent",children:(0,rz.jsx)(rN.xv,{children:(0,rz.jsx)(lL.bg6,{})})}),(0,rz.jsxs)(rN.Kq,{flex:1,space:2,marginLeft:3,children:[(0,rz.jsx)(rN.JQ,{animated:!0,style:{width:"100%"},radius:1}),(0,rz.jsx)(rN.JQ,{animated:!0,style:{width:"100%"},radius:1})]})]})})}let S3=(0,lO.ZP)(rN.Zb)(nN||(nN=d4(["\n  position: relative;\n  padding-bottom: 100%;\n"]))),S4=lO.ZP.img(nV||(nV=d4(["\n  position: absolute;\n  top: 0;\n  left: 0;\n  width: 100%;\n  height: 100%;\n  display: block;\n  object-fit: contain;\n"]))),S5=(0,lO.ZP)(rN.kC)(nB||(nB=d4(["\n  height: 100%;\n  position: absolute;\n  width: 100%;\n"])));function S6(e){let{reference:t}=e,n=Rm(),i=(0,rF.useCallback)(e=>mu(n,e),[n]);return(0,rz.jsx)(gj,{observeAsset:i,reference:t,children:e=>(0,rz.jsx)(S8,{asset:e})})}function S8(e){let{asset:t}=e,[n,i]=(0,rF.useState)(!1),r="".concat(t.url,"?h=800&fit=max"),l=(0,rF.useCallback)(()=>i(!0),[]);return(0,rz.jsxs)(S3,{__unstable_checkered:!0,border:!0,children:[!n&&(0,rz.jsx)(S5,{align:"center",justify:"center",children:(0,rz.jsx)(rN.$j,{})}),(0,rz.jsx)(S4,{onLoad:l,src:r})]})}function S7(e){let{reference:t}=e;return t?t._type.startsWith("sanity.fileAsset")?(0,rz.jsx)(S0,{reference:t}):t._type.startsWith("sanity.imageAsset")?(0,rz.jsx)(S6,{reference:t}):null:null}let S9={file:"sanity.fileAsset",image:"sanity.imageAsset"},Ee=(0,lO.ZP)(rN.xu)(nU||(nU=d4(["\n  width: min(calc(100vw - 40px), 320px);\n"])));function Et(e){return function(t){let{onChange:n,value:i}=t,[r,l]=(0,rF.useState)(null),[a,o]=(0,rF.useState)(null),{state:{fullscreen:s}}=Sm(),{file:d,image:c}=SJ().form,u=(0,rF.useMemo)(()=>{switch(e){case"file":return d.assetSources.filter(e=>e.name===Sr.name);case"image":return c.assetSources.filter(e=>e.name===Sl.name);default:throw Error("Unknown asset source found")}},[d.assetSources,c.assetSources]),p=(0,rF.useId)(),h=IW(uX),f=(0,rF.useCallback)(()=>{o(null),n(null)},[n]),m=(0,rF.useCallback)(()=>{l(null)},[]),g=(0,rF.useCallback)(e=>{let t=e[0];o(t),m()},[m]),x=(0,rF.useCallback)(e=>l(e),[]);(0,rF.useEffect)(()=>{(null==a?void 0:a.kind)==="assetDocumentId"&&"string"==typeof(null==a?void 0:a.value)&&e&&n({_ref:a.value,_type:S9[e]})},[h,n,a]);let v=null==r?void 0:r.component,b=s?2:1,y=i?"Change ".concat(e):"Select ".concat(e);return(0,rz.jsx)(Ee,{children:(0,rz.jsxs)(rN.Kq,{space:3,children:[r&&v&&(0,rz.jsx)(rN.h_,{children:(0,rz.jsx)(v,{assetType:e,dialogHeaderTitle:"Select ".concat(e),onClose:m,onSelect:g,selectedAssets:[],selectionType:"single"})}),i&&(0,rz.jsx)(S7,{reference:i}),(0,rz.jsxs)(rN.kC,{gap:2,children:[0===u.length&&(0,rz.jsx)(SQ,{padding:2}),u.length>0&&(0,rz.jsx)(rz.Fragment,{children:u.length>1?(0,rz.jsx)(rN.j2,{button:(0,rz.jsx)(rN.zx,{fontSize:b,icon:i?lL.UEU:lL.W1M,iconRight:lL.v4q,mode:"ghost",style:{flex:i?1:0},text:y}),id:p,menu:(0,rz.jsx)(rN.v2,{children:u.map(e=>(0,rz.jsx)(rN.sN,{fontSize:b,icon:e.icon||lL.XBm,onClick:()=>x(e),text:e.title},e.name))}),popover:{constrainSize:!0,portal:!1,radius:2}}):(0,rz.jsx)(rN.zx,{fontSize:b,icon:i?lL.UEU:lL.W1M,mode:"ghost",onClick:()=>x(u[0]),style:{flex:i?1:0},text:y})}),i&&(0,rz.jsx)(rN.zx,{fontSize:s?2:1,mode:"ghost",onClick:f,style:{flex:1},text:"Clear",tone:"critical"})]})]})})}}let En={assetFileEqual:{buttonLabel:"is",buttonValueComponent:Sp,groqFilter:e=>{let{fieldPath:t,value:n}=e;return(null==n?void 0:n._ref)&&t?"".concat(t,".asset._ref == ").concat(SH(n._ref)):null},initialValue:null,inputComponent:Et("file"),label:"is",type:"assetFileEqual"},assetFileNotEqual:{buttonLabel:"is not",buttonValueComponent:Sp,groqFilter:e=>{let{fieldPath:t,value:n}=e;return(null==n?void 0:n._ref)&&t?"".concat(t,".asset._ref != ").concat(SH(n._ref)):null},initialValue:null,inputComponent:Et("file"),label:"is not",type:"assetFileNotEqual"},assetImageEqual:{buttonLabel:"is",buttonValueComponent:Sp,groqFilter:e=>{let{fieldPath:t,value:n}=e;return(null==n?void 0:n._ref)&&t?"".concat(t,".asset._ref == ").concat(SH(n._ref)):null},initialValue:null,inputComponent:Et("image"),label:"is",type:"assetImageEqual"},assetImageNotEqual:{buttonLabel:"is not",buttonValueComponent:Sp,groqFilter:e=>{let{fieldPath:t,value:n}=e;return(null==n?void 0:n._ref)&&t?"".concat(t,".asset._ref != ").concat(SH(n._ref)):null},initialValue:null,inputComponent:Et("image"),label:"is not",type:"assetImageNotEqual"}},Ei=(0,lO.ZP)(rN.xu)(e=>{let{background:t,smallClearButton:n}=e;return(0,lO.iv)(nK||(nK=d4(["\n      width: 100%;\n\n      input + span {\n        background: ",";\n      }\n\n      [data-qa='clear-button'] {\n        background: none;\n        box-shadow: none;\n        display: flex; /* TODO: hack, currently used to vertically center <TextInput>'s clearButton */\n        transform: ",";\n        &:hover {\n          opacity: 0.5;\n        }\n      }\n    "])),e=>{let{theme:n}=e;return t?n.sanity.color.card.disabled.bg2:"transparent"},n?"scale(0.8)":"scale(1)")}),Er=(0,rF.forwardRef)(function(e,t){let{background:n,smallClearButton:i}=e,r=d3(e,dA);return(0,rz.jsx)(Ei,{background:n,smallClearButton:i,children:(0,rz.jsx)(rN.oi,d6(d6({},r),{},{radius:n?2:1,ref:t}))})}),El=(0,rF.createContext)(void 0);function Ea(){let e=(0,rF.useContext)(El);if(void 0===e)throw Error("useDatePicker must be used within an DatePickerProvider");return e}function Eo(e){let{date:t,focused:n,isCurrentMonth:i,isToday:r,onSelect:l,selected:a}=e,o=(0,rF.useCallback)(()=>{l(t)},[t,l]),{fontSize:s}=Ea();return(0,rz.jsx)("div",{"aria-selected":a,"data-ui":"CalendarDay",children:(0,rz.jsx)(rN.Zb,{"aria-label":t.toDateString(),"aria-pressed":a,as:"button",__unstable_focusRing:!0,"data-weekday":!0,"data-focused":n?"true":"",role:"button",tabIndex:-1,onClick:o,padding:3,radius:2,selected:a,tone:r||a?"primary":"default",children:(0,rz.jsx)(rN.xv,{muted:!a&&!i,size:s,style:{textAlign:"center"},weight:"regular",children:t.getDate()})})})}let Es=["January","February","March","April","May","June","July","August","September","October","November","December"],Ed=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],Ec=oN()(0,24),Eu=["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"],Ep=[1,2,3,4,5,6],Eh=e=>{let t=(0,l1.Z)(e);return(0,l2.Z)({start:t,end:(0,l3.Z)(t)})},Ef=e=>e.map(e=>[e,...Ep.map(t=>(0,l4.Z)(e,t))]),Em=e=>Ef(Eh(e)).map(e=>({number:(0,l5.Z)(e[0]),days:e}));function Eg(e){let{fontSize:t}=Ea();return(0,rz.jsx)(rN.xu,{"aria-hidden":e.hidden||!1,"data-ui":"CalendarMonth",children:(0,rz.jsxs)(rN.rj,{gap:1,style:{gridTemplateColumns:"repeat(7, minmax(44px, 46px))"},children:[Ed.map(e=>(0,rz.jsx)(rN.xu,{paddingY:2,children:(0,rz.jsx)(rN.xv,{size:t,weight:"medium",style:{textAlign:"center"},children:e})},e)),Em(e.date).map((t,n)=>t.days.map((t,i)=>{let r=e.focused&&(0,l6.Z)(t,e.focused),l=e.selected&&(0,l6.Z)(t,e.selected),a=(0,l6.Z)(t,new Date),o=e.focused&&(0,l8.Z)(t,e.focused);return(0,rz.jsx)(Eo,{date:t,focused:r,isCurrentMonth:o,isToday:a,onSelect:e.onSelect,selected:l},"".concat(n,"-").concat(i))}))]})})}let Ex=rF.forwardRef(function(e,t){let{onChange:n,onBlur:i,onKeyPress:r,value:l}=e,a=d3(e,dP),[o,s]=rF.useState(),{fontSize:d}=Ea(),c=rF.useCallback(e=>{s(e.currentTarget.value)},[]),u=rF.useCallback(e=>{let t=e.currentTarget.value;t!=="".concat(l)&&n&&n(e),s(void 0)},[n,l]),p=rF.useCallback(e=>{u(e),i&&i(e)},[u,i]),h=rF.useCallback(e=>{"Enter"===e.key&&u(e),r&&r(e)},[u,r]);return(0,rz.jsx)(rN.oi,d6(d6({},a),{},{"data-testid":"date-input",fontSize:d,ref:t,value:void 0===o?l:o,onChange:c,onBlur:p,onKeyPress:h}))}),Ev=e=>{let{onChange:t}=e,n=d3(e,dI),i=rF.useCallback(e=>{let n=parseInt(e.currentTarget.value,10);isNaN(n)||t(n)},[t]);return(0,rz.jsx)(Ex,d6(d6({},n),{},{onChange:i,inputMode:"numeric"}))},Eb=(0,rz.jsx)("span",{"data-preserve-focus":!0,style:{overflow:"hidden",position:"absolute",outline:"none"},tabIndex:-1}),Ey=(0,rF.forwardRef)(function(e,t){let{selectTime:n,onFocusedDateChange:i,selectedDate:r=new Date,focusedDate:l=r,timeStep:a=1,onSelect:o}=e,s=d3(e,dM),{fontSize:d}=Ea(),c=(0,rF.useCallback)(e=>i(e),[i]),u=(0,rF.useCallback)(e=>c((0,l7.Z)((0,l9.Z)(l,e),1)),[l,c]),p=(0,rF.useCallback)(e=>u(Number(e.currentTarget.value)),[u]),h=(0,rF.useCallback)(e=>c((0,ae.Z)(l,e)),[l,c]),f=(0,rF.useCallback)(e=>c((0,at.Z)(l,e)),[l,c]),m=(0,rF.useCallback)(e=>{o((0,an.Z)((0,ai.Z)(e,r.getHours()),r.getMinutes()))},[o,r]),g=(0,rF.useCallback)(e=>{let t=Number(e.currentTarget.value);o((0,an.Z)(r,t))},[o,r]),x=(0,rF.useCallback)(e=>{let t=Number(e.currentTarget.value);o((0,ai.Z)(r,t))},[o,r]),v=(0,rN.ts)(t),b=(0,rF.useCallback)(()=>{var e,t;null==(t=null==(e=v.current)?void 0:e.querySelector('[data-focused="true"]'))||t.focus()},[v]),y=(0,rF.useCallback)(e=>{var t,n;if(Eu.includes(e.key)){if(e.preventDefault(),e.target.hasAttribute("data-calendar-grid")){b();return}"ArrowUp"===e.key&&i((0,l4.Z)(l,-7)),"ArrowDown"===e.key&&i((0,l4.Z)(l,7)),"ArrowLeft"===e.key&&i((0,l4.Z)(l,-1)),"ArrowRight"===e.key&&i((0,l4.Z)(l,1)),null==(n=null==(t=v.current)?void 0:t.querySelector("[data-preserve-focus]"))||n.focus()}},[v,b,i,l]);(0,rF.useEffect)(()=>{b()},[b]),(0,rF.useEffect)(()=>{var e;let t=null==(e=document.activeElement)?void 0:e.matches("[data-calendar-grid], [data-calendar-grid] [data-preserve-focus]");t&&b()},[v,b,l]);let j=(0,rF.useCallback)(()=>o(new Date),[o]);return(0,rz.jsxs)(rN.xu,d6(d6({"data-ui":"Calendar"},s),{},{ref:v,children:[(0,rz.jsxs)(rN.xu,{paddingBottom:2,children:[(0,rz.jsxs)(rN.kC,{children:[(0,rz.jsx)(rN.xu,{flex:1,children:(0,rz.jsx)(Ej,{fontSize:d,moveFocusedDate:h,onChange:p,value:null==l?void 0:l.getMonth()})}),(0,rz.jsx)(rN.xu,{marginLeft:2,children:(0,rz.jsx)(Ew,{moveFocusedDate:h,onChange:f,value:null==l?void 0:l.getFullYear()})})]}),(0,rz.jsxs)(rN.xu,{"data-calendar-grid":!0,onKeyDown:y,marginTop:2,overflow:"hidden",tabIndex:0,children:[(0,rz.jsx)(Eg,{date:l,focused:l,onSelect:m,selected:r}),Eb]})]}),n&&(0,rz.jsx)(rN.xu,{children:(0,rz.jsxs)(rN.kC,{align:"center",children:[(0,rz.jsxs)(rN.kC,{align:"center",flex:1,children:[(0,rz.jsx)(rN.xu,{children:(0,rz.jsx)(rN.Ph,{"aria-label":"Select hour",fontSize:d,value:null==r?void 0:r.getHours(),onChange:x,children:Ec.map(e=>(0,rz.jsx)("option",{value:e,children:"".concat(e).padStart(2,"0")},e))})}),(0,rz.jsx)(rN.xu,{paddingX:1,children:(0,rz.jsx)(rN.xv,{children:":"})}),(0,rz.jsx)(rN.xu,{children:(0,rz.jsx)(rN.Ph,{"aria-label":"Select minutes",fontSize:d,value:null==r?void 0:r.getMinutes(),onChange:g,children:oN()(0,60,a).map(e=>(0,rz.jsx)("option",{value:e,children:"".concat(e).padStart(2,"0")},e))})})]}),(0,rz.jsx)(rN.xu,{marginLeft:2,children:(0,rz.jsx)(rN.zx,{fontSize:d,text:"Set to now",mode:"bleed",onClick:j})})]})})]}))});function Ej(e){let{fontSize:t,moveFocusedDate:n,onChange:i,value:r}=e;return(0,rz.jsx)(rN.kC,{flex:1,children:(0,rz.jsx)(rN.xu,{flex:1,children:(0,rz.jsx)(rN.Ph,{"aria-label":"Select month",fontSize:null!=t?t:1,radius:0,value:r,onChange:i,children:Es.map((e,t)=>(0,rz.jsx)("option",{value:t,children:e},t))})})})}function Ew(e){let{moveFocusedDate:t,onChange:n,value:i}=e;return(0,rz.jsx)(rN.kC,{children:(0,rz.jsx)(Ev,{"aria-label":"Selected year",value:i,onChange:n,radius:0,style:{width:65}})})}function Ek(e){let{children:t,fontSize:n=1}=e;return(0,rz.jsx)(El.Provider,{value:{fontSize:n},children:t})}let EC=rF.forwardRef(function(e,t){let{value:n=new Date,onChange:i}=e,r=d3(e,dz),[l,a]=rF.useState(),{state:{fullscreen:o}}=Sm(),s=rF.useCallback(e=>{i(e),a(void 0)},[i]);return(0,rz.jsx)(Ek,{fontSize:o?2:1,children:(0,rz.jsx)(Ey,d6(d6({},r),{},{ref:t,selectedDate:n,onSelect:s,focusedDate:l||n,onFocusedDateChange:a}))})});function E_(e){let{onChange:t,selectTime:n,value:i}=e,r=(0,rF.useMemo)(()=>["yyyy-MM-dd",...n?["HH:mm"]:[]].join(" "),[n]),{state:{fullscreen:l}}=Sm(),[a,o]=(0,rF.useState)(void 0),[s,d]=(0,rF.useState)(()=>i?(0,ao.Z)(new Date(i),r):""),c=(0,rF.useCallback)(e=>{let n=null==e?void 0:e.toISOString();n&&t(n)},[t]),u=(0,rF.useCallback)(()=>{if(s){let e=(0,as.Z)(s,r,new Date),n=(0,aa.Z)(e);t(n?e.toISOString():null),o(n?void 0:"Invalid date")}},[r,s,t]),p=(0,rF.useCallback)(()=>{u()},[u]),h=(0,rF.useCallback)(e=>{d(e.currentTarget.value)},[]),f=(0,rF.useCallback)(()=>{t(null),o(void 0),d("")},[t]),m=(0,rF.useCallback)(e=>{"Enter"===e.key&&u()},[u]);(0,rF.useEffect)(()=>{let e=i&&new Date(i);e&&(0,aa.Z)(e)&&(d((0,ao.Z)(e,r)),o(void 0))},[r,i]);let g=(0,rF.useMemo)(()=>(0,ao.Z)(new Date,r),[r]);return(0,rz.jsxs)(rN.Kq,{space:3,children:[(0,rz.jsx)(Er,{"aria-label":"Date",clearButton:!!s,customValidity:a,fontSize:l?2:1,onBlur:p,onChange:h,onClear:f,onKeyDown:m,placeholder:"Example: ".concat(g),value:s}),(0,rz.jsx)(EC,{onChange:c,selectTime:n,value:i?new Date(i):void 0})]})}function ES(e){return(0,rz.jsx)(E_,d6({},e))}function EE(e){let{onChange:t,value:n}=e,[i,r]=(0,rF.useState)((null==n?void 0:n.value)||""),l=(0,rF.useRef)("days"),a=(0,rF.useRef)((null==n?void 0:n.value)||null),{state:{fullscreen:o}}=Sm(),s=(0,rF.useCallback)(()=>{t({unit:null==l?void 0:l.current,value:null==a?void 0:a.current})},[t]),d=(0,rF.useCallback)(e=>{l.current=e.currentTarget.value,s()},[s]),c=(0,rF.useCallback)(e=>{r(e.currentTarget.value);let t=parseFloat(e.currentTarget.value);a.current=Number.isFinite(t)?t:null,s()},[s]);return(0,rz.jsxs)(rN.kC,{gap:2,children:[(0,rz.jsx)(rN.xu,{flex:1,children:(0,rz.jsx)(rN.oi,{"aria-label":"Unit value",fontSize:o?2:1,onChange:c,pattern:"\\d*",step:"1",type:"number",value:i})}),(0,rz.jsx)(rN.xu,{flex:1,children:(0,rz.jsxs)(rN.Ph,{"aria-label":"Select unit",fontSize:o?2:1,onChange:d,value:null==n?void 0:n.unit,children:[(0,rz.jsx)("option",{value:"days",children:"Days"}),(0,rz.jsx)("option",{value:"months",children:"Months"}),(0,rz.jsx)("option",{value:"years",children:"Years"})]})})]})}function ET(e){return(0,rz.jsx)(E_,d6(d6({},e),{},{selectTime:!0}))}let EA={dateAfter:{buttonLabel:"after",buttonValueComponent:Sd,initialValue:(0,ad.Z)().toISOString(),label:"is after"},dateBefore:{buttonLabel:"before",buttonValueComponent:Sd,initialValue:(0,ad.Z)().toISOString(),label:"is before"},dateEqual:{buttonLabel:"is",buttonValueComponent:Sd,groqFilter:e=>{let{fieldPath:t,value:n}=e;return n&&t?"".concat(t," == ").concat(SH(n)):null},initialValue:(0,ad.Z)().toISOString(),label:"is"},dateLast:{buttonLabel:"last",buttonValueComponent:function(e){var t;let{value:n}=e;return(0,rz.jsxs)(rz.Fragment,{children:[Math.floor(null!=(t=null==n?void 0:n.value)?t:0)," ",n.unit]})},label:"is in the last"},dateNotEqual:{buttonLabel:"is not",buttonValueComponent:Sd,groqFilter:e=>{let{fieldPath:t,value:n}=e;return n&&t?"".concat(t," != ").concat(SH(n)):null},initialValue:(0,ad.Z)().toISOString(),label:"is not"}},EP={dateAfter:d6(d6({},EA.dateAfter),{},{groqFilter:e=>{let{fieldPath:t,value:n}=e;return n&&t?"".concat(t," > ").concat(SH(n)):null},inputComponent:ES,type:"dateAfter"}),dateBefore:d6(d6({},EA.dateBefore),{},{groqFilter:e=>{let{fieldPath:t,value:n}=e;return n&&t?"".concat(t," < ").concat(SH(n)):null},inputComponent:ES,type:"dateBefore"}),dateEqual:d6(d6({},EA.dateEqual),{},{inputComponent:ES,type:"dateEqual"}),dateLast:d6(d6({},EA.dateLast),{},{groqFilter:e=>{let{fieldPath:t,value:n}=e,i="number"==typeof(null==n?void 0:n.value)?Math.floor(n.value):void 0,r=Number.isFinite(i)?(0,ac.Z)(new Date,{days:(null==n?void 0:n.unit)==="days"?i:0,months:(null==n?void 0:n.unit)==="months"?i:0,years:(null==n?void 0:n.unit)==="years"?i:0}).toISOString():null;return r&&t?"".concat(t," > ").concat(SH(r)):null},inputComponent:EE,initialValue:{unit:"days",value:7},type:"dateLast"}),dateNotEqual:d6(d6({},EA.dateNotEqual),{},{inputComponent:ES,type:"dateNotEqual"}),dateTimeAfter:d6(d6({},EA.dateAfter),{},{groqFilter:e=>{let{fieldPath:t,value:n}=e;return n&&t?"dateTime(".concat(t,") > dateTime(").concat(SH(n),")"):null},inputComponent:ET,type:"dateTimeAfter"}),dateTimeBefore:d6(d6({},EA.dateBefore),{},{groqFilter:e=>{let{fieldPath:t,value:n}=e;return n&&t?"dateTime(".concat(t,") < dateTime(").concat(SH(n),")"):null},inputComponent:ET,type:"dateTimeBefore"}),dateTimeEqual:d6(d6({},EA.dateEqual),{},{inputComponent:ET,type:"dateTimeEqual"}),dateTimeLast:d6(d6({},EA.dateLast),{},{groqFilter:e=>{let{fieldPath:t,value:n}=e,i="number"==typeof(null==n?void 0:n.value)?Math.floor(n.value):void 0,r=Number.isFinite(i)?(0,ac.Z)(new Date,{days:(null==n?void 0:n.unit)==="days"?i:0,months:(null==n?void 0:n.unit)==="months"?i:0,years:(null==n?void 0:n.unit)==="years"?i:0}).toISOString():null;return r&&t?"dateTime(".concat(t,") > dateTime(").concat(SH(r),")"):null},initialValue:{unit:"days",value:7},inputComponent:EE,type:"dateTimeLast"}),dateTimeNotEqual:d6(d6({},EA.dateNotEqual),{},{inputComponent:ET,type:"dateTimeNotEqual"})};function EI(e){let{onChange:t,value:n}=e,{state:{fullscreen:i}}=Sm(),r=(0,rF.useCallback)(e=>t(e.currentTarget.value||null),[t]);return(0,rz.jsx)(rN.oi,{fontSize:i?2:1,onChange:r,placeholder:"Value",value:n||""})}let EM={referenceEqual:{buttonLabel:"is",buttonValueComponent:Sp,groqFilter:e=>{let{fieldPath:t,value:n}=e;return(null==n?void 0:n._ref)&&t?"".concat(t,"._ref == ").concat(SH(n._ref)):null},initialValue:null,inputComponent:SL,label:"is",type:"referenceEqual"},referenceNotEqual:{buttonLabel:"is not",buttonValueComponent:Sp,groqFilter:e=>{let{fieldPath:t,value:n}=e;return(null==n?void 0:n._ref)&&t?"".concat(t,"._ref != ").concat(SH(n._ref)):null},initialValue:null,inputComponent:SL,label:"is not",type:"referenceNotEqual"},referencesAssetFile:{buttonLabel:"→",buttonValueComponent:Sp,groqFilter:e=>{let{value:t}=e;return(null==t?void 0:t._ref)?"references(".concat(SH(t._ref),")"):null},initialValue:null,inputComponent:Et("file"),label:"file",type:"referencesAssetFile"},referencesAssetImage:{buttonLabel:"→",buttonValueComponent:Sp,groqFilter:e=>{let{value:t}=e;return(null==t?void 0:t._ref)?"references(".concat(SH(t._ref),")"):null},initialValue:null,inputComponent:Et("image"),label:"image",type:"referencesAssetImage"},referencesDocument:{buttonLabel:"→",buttonValueComponent:Sp,groqFilter:e=>{let{value:t}=e;return(null==t?void 0:t._ref)?"references(".concat(SH(t._ref),")"):null},initialValue:null,inputComponent:SL,label:"document",type:"referencesDocument"}},Ez=d6(d6(d6(d6(d6(d6(d6(d6(d6(d6({},{arrayCountEqual:{buttonLabel:"has",buttonValueComponent:Su,groqFilter:e=>{let{fieldPath:t,value:n}=e;return Number.isFinite(n)&&t?"count(".concat(t,") == ").concat(SH(n)):null},initialValue:null,inputComponent:Sg,label:"quantity is",type:"arrayCountEqual"},arrayCountGt:{buttonLabel:"has >",buttonValueComponent:Su,groqFilter:e=>{let{fieldPath:t,value:n}=e;return Number.isFinite(n)&&t?"count(".concat(t,") > ").concat(SH(n)):null},icon:SB,initialValue:null,inputComponent:Sg,label:"quantity greater than",type:"arrayCountGt"},arrayCountGte:{buttonLabel:"has ≥",buttonValueComponent:Su,groqFilter:e=>{let{fieldPath:t,value:n}=e;return Number.isFinite(n)&&t?"count(".concat(t,") >= ").concat(SH(n)):null},icon:SV,initialValue:null,inputComponent:Sg,label:"quantity greater than or equal to",type:"arrayCountGte"},arrayCountLt:{buttonLabel:"has <",buttonValueComponent:Su,groqFilter:e=>{let{fieldPath:t,value:n}=e;return Number.isFinite(n)&&t?"count(".concat(t,") < ").concat(SH(n)):null},icon:SK,initialValue:null,inputComponent:Sg,label:"quantity less than",type:"arrayCountLt"},arrayCountLte:{buttonLabel:"has ≤",buttonValueComponent:Su,groqFilter:e=>{let{fieldPath:t,value:n}=e;return Number.isFinite(n)&&t?"count(".concat(t,") <= ").concat(SH(n)):null},icon:SU,initialValue:null,inputComponent:Sg,label:"quantity less than or equal to",type:"arrayCountLte"},arrayCountNotEqual:{buttonLabel:"does not have",buttonValueComponent:Su,groqFilter:e=>{let{fieldPath:t,value:n}=e;return Number.isFinite(n)&&t?"count(".concat(t,") != ").concat(SH(n)):null},initialValue:null,inputComponent:Sg,label:"quantity is not",type:"arrayCountNotEqual"},arrayCountRange:{buttonLabel:"has between",buttonValueComponent:function(e){let{value:t}=e;return(0,rz.jsxs)(rz.Fragment,{children:[t.min," → ",t.max," items"]})},groqFilter:e=>{let{fieldPath:t,value:n}=e;return Number.isFinite(null==n?void 0:n.max)&&Number.isFinite(null==n?void 0:n.min)&&t?"count(".concat(t,") > ").concat(SH(null==n?void 0:n.min)," && count(").concat(t,") < ").concat(SH(null==n?void 0:n.max)):""},initialValue:null,inputComponent:Sx,label:"quantity is between",type:"arrayCountRange"},arrayListIncludes:{buttonLabel:"includes",buttonValueComponent:Sh,groqFilter:e=>{let{fieldPath:t,value:n}=e;return n&&t?"".concat(SH(n)," in ").concat(t):null},initialValue:null,inputComponent:SN,label:"includes",type:"arrayListIncludes"},arrayListNotIncludes:{buttonLabel:"does not include",buttonValueComponent:Sh,groqFilter:e=>{let{fieldPath:t,value:n}=e;return n&&t?"!(".concat(SH(n)," in ").concat(t,")"):null},initialValue:null,inputComponent:SN,label:"does not include",type:"arrayListNotIncludes"},arrayReferenceIncludes:{buttonLabel:"includes",buttonValueComponent:Sp,groqFilter:e=>{let{fieldPath:t,value:n}=e;return(null==n?void 0:n._ref)&&t?"".concat(SH(n._ref)," in ").concat(t,"[]._ref"):null},initialValue:null,inputComponent:SL,label:"includes",type:"arrayReferenceIncludes"},arrayReferenceNotIncludes:{buttonLabel:"does not include",buttonValueComponent:Sp,groqFilter:e=>{let{fieldPath:t,value:n}=e;return(null==n?void 0:n._ref)&&t?"!(".concat(SH(n._ref)," in ").concat(t,"[]._ref)"):null},initialValue:null,inputComponent:SL,label:"does not include",type:"arrayReferenceNotIncludes"}}),En),{booleanEqual:{buttonLabel:"is",buttonValueComponent:function(e){let{value:t}=e;return(0,rz.jsx)(rz.Fragment,{children:t?"True":"False"})},groqFilter:e=>{let{fieldPath:t,value:n}=e;return void 0!==n&&t?"".concat(t," == ").concat(SH(n)):null},initialValue:!0,inputComponent:function(e){let{onChange:t,value:n}=e,{state:{fullscreen:i}}=Sm(),r=(0,rF.useCallback)(e=>{t("true"===e.currentTarget.value)},[t]);return(0,rz.jsxs)(rN.Ph,{fontSize:i?2:1,onChange:r,value:String(null==n||n),children:[(0,rz.jsx)("option",{value:"true",children:"True"}),(0,rz.jsx)("option",{value:"false",children:"False"})]})},label:"is",type:"booleanEqual"}}),EP),{defined:{buttonLabel:"not empty",groqFilter:e=>{let{fieldPath:t}=e;return t?"defined(".concat(t,")"):null},label:"not empty",type:"defined"},notDefined:{buttonLabel:"empty",groqFilter:e=>{let{fieldPath:t}=e;return t?"!defined(".concat(t,")"):null},label:"empty",type:"notDefined"}}),{numberEqual:{buttonLabel:"is",buttonValueComponent:Sc,groqFilter:e=>{let{fieldPath:t,value:n}=e;return Number.isFinite(n)&&t?"".concat(t," == ").concat(SH(n)):null},initialValue:null,inputComponent:Sg,label:"is",type:"numberEqual"},numberGt:{buttonLabel:">",buttonValueComponent:Sc,groqFilter:e=>{let{fieldPath:t,value:n}=e;return Number.isFinite(n)&&t?"".concat(t," > ").concat(SH(n)):null},icon:SB,initialValue:null,inputComponent:Sg,label:"greater than",type:"numberGt"},numberGte:{buttonLabel:"≥",buttonValueComponent:Sc,groqFilter:e=>{let{fieldPath:t,value:n}=e;return Number.isFinite(n)&&t?"".concat(t," >= ").concat(SH(n)):null},icon:SV,initialValue:null,inputComponent:Sg,label:"greater than or equal to",type:"numberGte"},numberLt:{buttonLabel:"<",buttonValueComponent:Sc,groqFilter:e=>{let{fieldPath:t,value:n}=e;return Number.isFinite(n)&&t?"".concat(t," < ").concat(SH(n)):null},icon:SK,initialValue:null,inputComponent:Sg,label:"less than",type:"numberLt"},numberLte:{buttonLabel:"≤",buttonValueComponent:Sc,groqFilter:e=>{let{fieldPath:t,value:n}=e;return Number.isFinite(n)&&t?"".concat(t," <= ").concat(SH(n)):null},icon:SU,initialValue:null,inputComponent:Sg,label:"less than or equal to",type:"numberLte"},numberNotEqual:{buttonLabel:"is not",buttonValueComponent:Sc,groqFilter:e=>{let{fieldPath:t,value:n}=e;return Number.isFinite(n)&&t?"".concat(t," != ").concat(SH(n)):null},initialValue:null,inputComponent:Sg,label:"is not",type:"numberNotEqual"},numberRange:{buttonLabel:"is between",buttonValueComponent:function(e){let{value:t}=e;return(0,rz.jsxs)(rz.Fragment,{children:[t.min," → ",t.max]})},groqFilter:e=>{let{fieldPath:t,value:n}=e;return Number.isFinite(null==n?void 0:n.max)&&Number.isFinite(null==n?void 0:n.min)&&t?"".concat(t," > ").concat(SH(null==n?void 0:n.min)," && ").concat(t," < ").concat(SH(null==n?void 0:n.max)):""},initialValue:null,inputComponent:Sx,label:"is between",type:"numberRange"}}),{portableTextEqual:{buttonLabel:"is",buttonValueComponent:Sh,groqFilter:e=>{let{fieldPath:t,value:n}=e;return n&&t?"pt::text(".concat(t,") == ").concat(SH(n)):null},initialValue:null,inputComponent:EI,label:"is",type:"portableTextEqual"},portableTextMatches:{buttonLabel:"contains",buttonValueComponent:Sh,groqFilter:e=>{let{fieldPath:t,value:n}=e;return n&&t?"pt::text(".concat(t,") match ").concat(SH(n)):null},initialValue:null,inputComponent:EI,label:"contains",type:"portableTextMatches"},portableTextNotEqual:{buttonLabel:"is not",buttonValueComponent:Sh,groqFilter:e=>{let{fieldPath:t,value:n}=e;return n&&t?"pt::text(".concat(t,") != ").concat(SH(n)):null},initialValue:null,inputComponent:EI,label:"is not",type:"portableTextNotEqual"},portableTextNotMatches:{buttonLabel:"does not contain",buttonValueComponent:Sh,groqFilter:e=>{let{fieldPath:t,value:n}=e;return n&&t?"!(pt::text(".concat(t,") match ").concat(SH(n),")"):null},initialValue:null,inputComponent:EI,label:"does not contain",type:"portableTextNotMatches"}}),EM),{slugEqual:{buttonLabel:"is",buttonValueComponent:Sh,groqFilter:e=>{let{fieldPath:t,value:n}=e;return n&&t?"".concat(t,".current == ").concat(SH(n)):null},initialValue:null,inputComponent:EI,label:"is",type:"slugEqual"},slugMatches:{buttonLabel:"contains",buttonValueComponent:Sh,groqFilter:e=>{let{fieldPath:t,value:n}=e;return n&&t?"".concat(t,".current match ").concat(SH(n)):null},initialValue:null,inputComponent:EI,label:"contains",type:"slugMatches"},slugNotEqual:{buttonLabel:"is not",buttonValueComponent:Sh,groqFilter:e=>{let{fieldPath:t,value:n}=e;return n&&t?"".concat(t,".current != ").concat(SH(n)):null},initialValue:null,inputComponent:EI,label:"is not",type:"slugNotEqual"},slugNotMatches:{buttonLabel:"does not contain",buttonValueComponent:Sh,groqFilter:e=>{let{fieldPath:t,value:n}=e;return n&&t?"!(".concat(t,".current match ").concat(SH(n),")"):null},initialValue:null,inputComponent:EI,label:"does not contain",type:"slugNotMatches"}}),{stringEqual:{buttonLabel:"is",buttonValueComponent:Sh,groqFilter:e=>{let{fieldPath:t,value:n}=e;return n&&t?"".concat(t," == ").concat(SH(n)):null},initialValue:null,inputComponent:EI,label:"is",type:"stringEqual"},stringListEqual:{buttonLabel:"is",buttonValueComponent:Sh,groqFilter:e=>{let{fieldPath:t,value:n}=e;return n&&t?"".concat(t," == ").concat(SH(n)):null},initialValue:null,inputComponent:SN,label:"is",type:"stringListEqual"},stringListNotEqual:{buttonLabel:"is not",buttonValueComponent:Sh,groqFilter:e=>{let{fieldPath:t,value:n}=e;return n&&t?"".concat(t," != ").concat(SH(n)):null},initialValue:null,inputComponent:SN,label:"is not",type:"stringListNotEqual"},stringMatches:{buttonLabel:"contains",buttonValueComponent:Sh,groqFilter:e=>{let{fieldPath:t,value:n}=e;return n&&t?"".concat(t," match ").concat(SH(n)):null},initialValue:null,inputComponent:EI,label:"contains",type:"stringMatches"},stringNotEqual:{buttonLabel:"is not",buttonValueComponent:Sh,groqFilter:e=>{let{fieldPath:t,value:n}=e;return n&&t?"".concat(t," != ").concat(SH(n)):null},initialValue:null,inputComponent:EI,label:"is not",type:"stringNotEqual"},stringNotMatches:{buttonLabel:"does not contain",buttonValueComponent:Sh,groqFilter:e=>{let{fieldPath:t,value:n}=e;return n&&t?"!(".concat(t," match ").concat(SH(n),")"):null},initialValue:null,inputComponent:EI,label:"does not contain",type:"stringNotMatches"}}),ER=Object.values(Ez),EF=[],EO=[],ED=[],EZ=(e,t,n)=>{let{schema:i}=t,r=null==i?void 0:i.types;if(!r)return e;if("function"==typeof r)return r(e,n);if(Array.isArray(r))return[...e,...r];throw Error("Expected `schema.types` to an array or a function but found ".concat(typeof r," instead."))},EL=async(e,t,n)=>{let{document:i}=t,r=null==i?void 0:i.productionUrl;return r?await r(e,n):e},Eq=(e,t,n)=>{let{tools:i}=t;if(!i)return e;if("function"==typeof i)return i(e,n);if(Array.isArray(i))return[...e,...i];throw Error("Expected `tools` to an array or a function but found ".concat(typeof i," instead."))},EN=(e,t,n)=>{let{schema:i}=t,r=null==i?void 0:i.templates;if(!r)return e;if("function"==typeof r)return r(e,n);if(Array.isArray(r))return[...e,...r];throw Error("Expected `schema.templates` to an array or a function but found ".concat(typeof r," instead."))},EV=(e,t,n)=>{let{document:i}=t,r=null==i?void 0:i.badges;if(!r)return e;if("function"==typeof r)return r(e,n);if(Array.isArray(r))return[...e,...r];throw Error("Expected `document.actions` to an array or a function but found ".concat(typeof r," instead."))},EB=(e,t,n)=>{let{document:i}=t,r=null==i?void 0:i.actions;if(!r)return e;if("function"==typeof r)return r(e,n);if(Array.isArray(r))return[...e,...r];throw Error("Expected `document.actions` to an array or a function but found ".concat(typeof r," instead."))},EU=(e,t,n)=>{let{document:i}=t,r=null==i?void 0:i.newDocumentOptions;if(!r)return e;if("function"!=typeof r)throw Error("Expected `document.resolveNewDocumentOptions` a function but found ".concat(typeof r," instead."));return r(e,n)},EK=(e,t,n)=>{var i;let{form:r}=t,l=null==(i=null==r?void 0:r.file)?void 0:i.assetSources;if(!l)return e;if("function"==typeof l)return l(e,n);if(Array.isArray(l))return[...e,...l];throw Error("Expected `file.assetSources` to an array or a function but found ".concat(typeof l," instead."))},EH=(e,t,n)=>{var i;let{form:r}=t,l=null==(i=null==r?void 0:r.image)?void 0:i.assetSources;if(!l)return e;if("function"==typeof l)return l(e,n);if(Array.isArray(l))return[...e,...l];throw Error("Expected `image.assetSources` to an array or a function but found ".concat(typeof l," instead."))},E$=(e,t,n)=>{let{document:i}=t,r=null==i?void 0:i.unstable_languageFilter;if(!r)return e;if("function"==typeof r)return r(e,n);if(Array.isArray(r))return[...e,...r];throw Error("Expected `document.actions` to an array or a function but found ".concat(typeof r," instead."))};class EX extends Error{constructor(e){let{propertyName:t,path:n,cause:i}=e,r=cC(i)&&"string"==typeof(null==i?void 0:i.message)?": ".concat(i.message):"";super("An error occurred while resolving `".concat(t,"` from ").concat(n.join(" > ")).concat(r)),this.propertyName=t,this.cause=i,this.path=n}}let EW=(e,t)=>{let{plugins:n=[]}=e,i=d3(e,dR),r={config:i,path:[...t,i.name]},l=n.flatMap(e=>EW(e,[...t,i.name])),a=[...l,r];return a};function EG(e){let{config:t,context:n,initialValue:i,propertyName:r}=e,l=d3(e,dF),a=EW(t,[]);if("reducer"in l)return a.reduce((e,t)=>{let{config:i,path:a}=t;try{return l.reducer(e,i,n)}catch(o){throw new EX({propertyName:r,path:a,cause:o})}},i);let o=l.asyncReducer;return(async()=>{let e=i;for(let{config:t,path:l}of a)try{e=await o(e,t,n)}catch(s){throw new EX({propertyName:r,path:l,cause:s})}return e})()}class EY extends Error{constructor(e){let{causes:t,name:n,type:i}=e,r=t.filter(Boolean).map(e=>cC(e)&&"string"==typeof(null==e?void 0:e.message)?e.message:String(e));super("Could not resolve ".concat(i).concat(n?" `".concat(n,"`"):"",":\n").concat(r.map(e=>"	- ".concat(e)).join("\n"),"\n\n")),this.name=n,this.causes=t,this.type=i}}class EJ extends Error{constructor(e){super("SchemaError"),this.schema=e}}function EQ(e){let t=e.split("").reduce((e,t)=>(e<<5)-e+t.charCodeAt(0)|0,0);return Math.abs(16807*t%2147483647)/2147483647}let E0=lO.ZP.text(nH||(nH=d4(["\n  font-family: ",";\n  font-weight: ",";\n  font-size: 16px;\n  transform: translateY(1px);\n"])),e=>{let{theme:t}=e;return t.sanity.fonts.heading.family},e=>{let{theme:t}=e;return t.sanity.fonts.heading.weights.bold});function E1(e){let{projectId:t,dataset:n,schema:i,currentUser:r,getClient:l}=e;return(0,rF.useMemo)(()=>({projectId:t,dataset:n,schema:i,currentUser:r,getClient:l}),[t,n,i,r,l])}function E2(e){let{projectId:t,dataset:n,schema:i,currentUser:r,getClient:l}=e;return{projectId:t,dataset:n,schema:i,currentUser:r,getClient:l}}function E3(e){let{title:t}=e;return(0,rz.jsx)(rN.xu,{padding:3,children:(0,rz.jsx)(rN.xv,{weight:"bold",children:t})})}let E4="sanityStudio:ui:colorScheme",E5=(0,rF.createContext)(null);function E6(e){let{children:t,onSchemeChange:n,scheme:i}=e,{getItem:r,setItem:l,removeItem:a}=(0,rF.useMemo)(()=>(function(){let e="undefined"!=typeof window&&window.localStorage;return{getItem:function(t){return e?window.localStorage.getItem(t):void 0},setItem:function(t,n){return e?window.localStorage.setItem(t,n):void 0},removeItem:function(t){return e?window.localStorage.removeItem(t):void 0}}})(),[]),o=(0,rN.ue)(),s=o?"dark":"light",d=null==r?void 0:r(E4),[c,u]=(0,rF.useState)(!d),[p,h]=(0,rF.useState)(i||d||s),f=(0,rF.useCallback)(e=>{("dark"===e||"light"===e)&&(null==l||l(E4,e),h(e),null==n||n(e),u(!1))},[n,l]),m=(0,rF.useCallback)(()=>{null==a||a(E4),h(s),null==n||n(s),u(!0)},[n,a,s]);(0,rF.useEffect)(()=>{d||(h(s),u(!0))},[n,d,s]);let g=(0,rF.useMemo)(()=>({scheme:p,setScheme:f,usingSystemScheme:c,clearStoredScheme:m}),[m,f,p,c]);return(0,rz.jsx)(E5.Provider,{value:g,children:(0,rz.jsx)(rN.f6,{scheme:p,theme:rN.Lg,tone:"transparent",children:t})})}function E8(){let e=(0,rF.useContext)(E5);if(!e)throw Error("Could not find `colorScheme` context");return e}let E7=(0,rF.createContext)(null);function E9(e){let{config:t,children:n}=e,{workspaces:i}=(0,rF.useMemo)(()=>(function(e){let t=Array.isArray(e)?e:[e];try{!function(e){let{workspaces:t}=e;if(0===t.length)throw new Ti("At least one workspace is required.");(function(e){let t=1===e.length,n=new Map;e.forEach((e,i)=>{let{name:r,title:l}=e,a=Tt(l,i);if(!r&&!t)throw new Ti("All workspaces must have a `name`, unless only a single workspace is defined. Workspace ".concat(a," did not define a `name`."),{workspace:e,index:i});let o=t&&void 0===r?"default":r;if("string"!=typeof o)throw new Ti("Workspace at index ".concat(i," defined an invalid `name` - must be a string."),{workspace:e,index:i});let s=o.toLowerCase(),d=n.get(s);if(d){let c=Tt(d.workspace.title,d.index);throw new Ti("`name`s must be unique. Workspace ".concat(c," and workspace ").concat(a," both have the `name` `").concat(o,"`"),{workspace:e,index:i})}if(n.set(s,{index:i,workspace:e}),!/^[a-z0-9][a-z0-9_-]*$/i.test(o))throw new Ti("All workspace `name`s must consist of only a-z, 0-9, underscore and dashes, and cannot begin with an underscore or dash. Workspace ".concat(a," has the invalid name `").concat(o,"`"),{workspace:e,index:i})})})(t),function(e){e.length>1&&e.every(Tr),e.every(Tl);let[t,...n]=e,i=(t.basePath||"/").substring(1).split("/").filter(Boolean).length;n.forEach((e,n)=>{let r=(e.basePath||"/").substring(1).split("/").length;if(i!==r)throw new Ti("All workspace `basePath`s must have the same amount of segments. Workspace `".concat(Te(t,n),"` had ").concat(i," segment").concat(1===i?"":"s"," `").concat(t.basePath,"` but workspace `").concat(Te(e,n),"` had ").concat(r," segment").concat(1===r?"":"s"," `").concat(e.basePath,"`"),{workspace:e,index:n})});let r=new Map;e.forEach((e,t)=>{let n=(e.basePath||"").toLowerCase(),i=r.get(n);if(i)throw new Ti("`basePath`s must be unique. Workspaces `".concat(i,"` and `").concat(Te(e,t),"` both have the `basePath` `").concat(n,"`"),{workspace:e,index:t});r.set(n,Te(e,t))})}(t)}({workspaces:t})}catch(n){throw new EY({name:"",type:"workspace",causes:[n.message]})}let i=t.map(e=>{let{unstable_sources:t=[]}=e,n=d3(e,dO),i=[n,...t],r=i.map(e=>{let t;let n=e.unstable_clientFactory||rI(),i=e.projectId,r=e.dataset,l=e.auth||uM({clientFactory:n,dataset:r,projectId:i});try{t=EG({propertyName:"schema.types",config:e,context:{projectId:i,dataset:r},initialValue:[],reducer:EZ})}catch(a){throw new EY({name:e.name,type:"source",causes:[a]})}let o=function(e){let t=(0,lY.Fv)(e.types).getTypes(),n=(0,lY._T)(t),i=n.some(e=>e.problems.some(uK)),r=lG.Z.compile({name:e.name,types:i?[]:[...e.types,...uH].filter(Boolean)});return r._validation=n,(0,lJ.PA)(r)}({name:e.name,types:t}),s=o._validation,d=null==s?void 0:s.filter(e=>e.problems.some(e=>"error"===e.severity));if(s&&(null==d?void 0:d.length))throw new EJ(o);let c=l.state.pipe((0,r8.U)(t=>{let{client:n,authenticated:i,currentUser:r}=t;return function(e){var t,n,i,r;let l,a,o,{config:s,client:d,currentUser:c,schema:u,authenticated:p,auth:h}=e,{dataset:f,projectId:m}=s,g=function(e,t){let n=e.withConfig({apiVersion:"2022-06-30"}),i=n.config().dataset,r=n.getUrl("/socket/".concat(i)).replace(/^http/,"ws"),l=t.token?{token$:t.token}:{};return(0,lX.W0)(r,l)}(d,h),x=[],v={},b=e=>{if(!e||!e.apiVersion)throw Error("Missing required `apiVersion` option");return v[e.apiVersion]||(v[e.apiVersion]=d.withConfig(e)),v[e.apiVersion]},y={client:d,getClient:b,currentUser:c,dataset:f,projectId:m,schema:u};y.client=[...Object.keys(d),...Object.keys(d.__proto__)].reduce((e,t)=>{let n=Object.hasOwnProperty.call(d,t)?d[t]:d.__proto__[t];return Object.defineProperty(e,t,{get:()=>(console.warn('`configContext.client` is deprecated and will be removed in the next release! Use `context.getClient({apiVersion: "2021-06-07"})` instead'),n)})},{});try{l=EG({config:s,context:y,propertyName:"schema.templates",reducer:EN,initialValue:u.getTypeNames().filter(e=>!/^sanity\./.test(e)).map(e=>u.get(e)).filter(cf).filter(e=>{var t;return(null==(t=e.type)?void 0:t.name)==="document"}).map(e=>{let t={id:e.name,schemaType:e.name,title:e.title||e.name,icon:e.icon,value:e.initialValue||{_type:e.name}};return t})})}catch(j){throw new EY({name:s.name,type:"source",causes:[j]})}try{a=EG({config:s,context:y,initialValue:[],propertyName:"tools",reducer:Eq})}catch(w){throw new EY({name:s.name,type:"source",causes:[w]})}if(a.some(e=>{let{name:t}=e;return"tool"===t}))throw Error('A tool cannot have the name "tool". Please enter a different name.');let k=l.filter(e=>{var t;return!(null==(t=e.parameters)?void 0:t.length)}).map(e=>({templateId:e.id,description:e.description,icon:e.icon,title:e.title})),C=l.reduce((e,t)=>(e.set(t.id,t),e),new Map),_=e=>{let{schemaType:t}=e,n=EG({config:s,context:d6(d6({},y),{},{creationContext:e}),initialValue:k,propertyName:"document.resolveNewDocumentOptions",reducer:EU}),i=[];if(i.length)throw new EY({name:s.name,type:"source",causes:i});return n.map((e,t)=>{let n=C.get(e.templateId);if(!n)throw Error("Could not find template with ID `".concat(e.templateId,"`"));let i=u.get(n.schemaType);if(!i)throw Error("Could not find matching schema type `".concat(n.schemaType,"` for template `").concat(n.id,"`"));let r=e.title||n.title,l=(null==i?void 0:i.title)===r?void 0:null==i?void 0:i.title;return{id:"".concat(e.templateId,"-").concat(t),templateId:e.templateId,type:"initialValueTemplateItem",title:r,subtitle:e.subtitle||l,description:e.description||n.description,icon:e.icon||n.icon||(null==i?void 0:i.icon),initialDocumentId:e.initialDocumentId,parameters:e.parameters,schemaType:n.schemaType}}).filter(e=>{var n;return!t||t===(null==(n=C.get(e.templateId))?void 0:n.schemaType)})};try{o=_({type:"global"})}catch(S){x.push(S)}if(x.length)throw new EY({name:s.name,type:"source",causes:x});let E={type:"source",name:s.name,title:s.title||l$()(s.name),schema:u,getClient:b,dataset:f,projectId:m,tools:a,currentUser:c,authenticated:p,templates:l,auth:h,document:{actions:e=>EG({config:s,context:d6(d6({},y),e),initialValue:EO,propertyName:"document.actions",reducer:EB}),badges:e=>EG({config:s,context:d6(d6({},y),e),initialValue:EF,propertyName:"document.badges",reducer:EV}),resolveProductionUrl:e=>EG({config:s,context:d6(d6({},y),e),initialValue:void 0,propertyName:"resolveProductionUrl",asyncReducer:EL}),resolveNewDocumentOptions:_,unstable_languageFilter:e=>EG({config:s,context:d6(d6({},y),e),initialValue:ED,propertyName:"document.unstable_languageFilter",reducer:E$})},form:{file:{assetSources:EG({config:s,context:y,initialValue:[Sr],propertyName:"formBuilder.file.assetSources",reducer:EK}),directUploads:(null==(n=null==(t=s.form)?void 0:t.file)?void 0:n.directUploads)===void 0||s.form.file.directUploads},image:{assetSources:EG({config:s,context:y,initialValue:[Sl],propertyName:"formBuilder.image.assetSources",reducer:EH}),directUploads:(null==(r=null==(i=s.form)?void 0:i.image)?void 0:r.directUploads)===void 0||s.form.image.directUploads}},search:{filters:So,operators:ER},__internal:{bifur:g,staticInitialValueTemplateItems:o,options:s}};return E}({config:e,client:n,currentUser:r,schema:o,authenticated:i,auth:l})}),(0,ln.d)(1));return Object.assign(c,{name:e.name,projectId:e.projectId,dataset:e.dataset,title:e.title||l$()(e.name),auth:l,schema:o})}),l=n.title||l$()(n.name),a={type:"workspace-summary",auth:r[0].auth,basePath:n.basePath||"/",dataset:n.dataset,schema:r[0].schema,icon:function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";return(0,lW.isValidElementType)(e)?(0,rF.createElement)(e):(0,rF.isValidElement)(e)?e:function(e,t){let n=EQ("".concat(e," ").concat(t)),i=aT.mE.filter(e=>"gray"!==e),r=i[Math.floor(n*i.length)],l=["300","400","500","600","700"],a=EQ(n.toString()),o=l[Math.floor(a*l.length)],s=aT.VG[r][o].hex,d=e.split(/\s/g).map(e=>e.replace(/\\W/g,"")).filter(Boolean).slice(0,2).map(e=>e.charAt(0).toUpperCase()),c=(0,a8._j)(s,.4),u=(0,a8.$n)(s,.4),p=(0,a8.WC)(s,"readable",c)?(0,a8.WC)(s,"readable",u)?(0,a8.XV)(s):u:c;return(0,rz.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 32",children:[(0,rz.jsx)("rect",{width:32,height:32,rx:2,fill:s}),(0,rz.jsx)(E0,{x:"50%",y:"50%",textAnchor:"middle",alignmentBaseline:"middle",dominantBaseline:"middle",fill:p,children:d})]})}(t,n)}(n.icon,l,"".concat(n.projectId," ").concat(n.dataset)),name:n.name||"default",projectId:n.projectId,theme:n.theme||rN.Lg,title:l,subtitle:n.subtitle,__internal:{sources:r}};return a});return{type:"prepared-config",workspaces:i}})(t),[t]);return(0,rz.jsx)(E7.Provider,{value:i,children:n})}function Te(e,t){let{name:n,title:i}=e;return"string"==typeof n&&n.trim().length>0?n:Tt(i,t)}function Tt(e,t){let n="string"==typeof e&&e.trim().length>0?' (titled "'.concat(e,'")'):"";return"at index ".concat(t).concat(n)}function Tn(){let e=(0,rF.useContext)(E7);if(!e)throw Error("Could not find `workspaces` context");return e}class Ti extends Error{constructor(e,t){super(e),this.index=null==t?void 0:t.index,this.identifier=(null==t?void 0:t.workspace)&&Te(t.workspace,t.index)}}function Tr(e,t){let{name:n,basePath:i}=e;if(i&&"string"==typeof i)return!0;if(void 0===i)throw new Ti("If more than one workspace is defined, every workspace must have a `basePath` defined. Workspace `".concat(n,"` is missing a `basePath`"),{workspace:e,index:t});throw new Ti("If more than one workspace is defined, every workspace must have a `basePath` defined. Workspace `".concat(n,"` has an invalid `basePath` (must be a non-empty string)"),{workspace:e,index:t})}function Tl(e,t){let{name:n,basePath:i}=e;if(i&&"/"!==i&&!/^\/[a-z0-9/_-]*[a-z0-9_-]+$/i.test(i))throw new Ti("All workspace `basePath`s must start with a leading `/`, consist of only URL safe characters, and cannot end with a trailing `/`. Workspace `".concat(n,"`'s basePath is `").concat(i,"`"),{workspace:e,index:t})}function Ta(){return(0,rz.jsx)(rN.Zb,{height:"fill",children:(0,rz.jsx)(rN.kC,{align:"center",height:"fill",justify:"center",padding:4,sizing:"border",children:(0,rz.jsx)(rN.W2,{width:0,children:(0,rz.jsx)(rN.Zb,{padding:4,radius:2,shadow:1,tone:"caution",children:(0,rz.jsxs)(rN.kC,{children:[(0,rz.jsx)(rN.xu,{children:(0,rz.jsx)(rN.xv,{size:1,children:(0,rz.jsx)(lL.foC,{})})}),(0,rz.jsxs)(rN.Kq,{flex:1,marginLeft:3,space:3,children:[(0,rz.jsx)(rN.xv,{as:"h1",size:1,weight:"bold",children:"No configured tools!"}),(0,rz.jsx)(rN.xv,{as:"p",muted:!0,size:1,children:"Please configure a tool in your Studio configuration."}),(0,rz.jsx)(rN.xv,{as:"p",hidden:!0,muted:!0,size:1,children:(0,rz.jsx)("a",{href:"",children:"Learn how to add a tool →"})})]})]})})})})})}function To(e){let{toolName:t}=e;return(0,rz.jsx)(rN.Zb,{height:"fill",children:(0,rz.jsx)(rN.kC,{align:"center",height:"fill",justify:"center",padding:4,sizing:"border",children:(0,rz.jsx)(rN.W2,{width:0,children:(0,rz.jsx)(rN.Zb,{padding:4,radius:2,shadow:1,tone:"caution",children:(0,rz.jsxs)(rN.kC,{children:[(0,rz.jsx)(rN.xu,{children:(0,rz.jsx)(rN.xv,{size:1,children:(0,rz.jsx)(lL.foC,{})})}),(0,rz.jsx)(rN.Kq,{flex:1,marginLeft:3,space:3,children:(0,rz.jsxs)(rN.xv,{as:"h1",size:1,weight:"bold",children:["Tool not found: ",(0,rz.jsx)("code",{children:t})]})})]})})})})})}function Ts(){return(0,rz.jsxs)(rN.kC,{as:rN.Zb,justify:"center",align:"center",height:"fill",direction:"column",gap:4,children:[(0,rz.jsx)(rN.xv,{muted:!0,children:"Loading…"}),(0,rz.jsx)(rN.$j,{muted:!0})]})}let Td={error:"critical",warning:"caution"},Tc=lO.ZP.code(n$||(n$=d4(["\n  && {\n    background: none;\n    color: inherit;\n  }\n"]))),Tu=(0,lO.ZP)(rN.xv)(nX||(nX=d4(["\n  white-space: pre-line;\n"])));function Tp(e){let{problemGroups:t}=e,n=(0,rF.useMemo)(()=>{let e=[];for(let n of t)for(let i of n.problems)e.push({group:n,problem:i});return e},[t]);return(0,rz.jsx)(rN.Kq,{as:"ul",space:4,children:n.map((e,t)=>{let{group:n,problem:i}=e,r="error"===i.severity,l="warning"===i.severity,a=function(e){let t=e.path[0];return"type"===t.kind?{name:t.name,type:t.type}:null}(n);return(0,rz.jsxs)(rN.Zb,{border:!0,padding:4,radius:2,tone:Td[i.severity],children:[(0,rz.jsxs)(rN.kC,{children:[(0,rz.jsx)(rN.xu,{marginRight:3,children:(0,rz.jsxs)(rN.xv,{muted:!0,size:1,children:[r&&(0,rz.jsx)(lL.uIy,{}),l&&(0,rz.jsx)(lL.foC,{})]})}),(0,rz.jsx)(rN.xu,{flex:1,children:(0,rz.jsx)(rN.xv,{size:1,weight:"semibold",children:a?(0,rz.jsxs)(rz.Fragment,{children:[oO()(a.type),' type "',a.name,'"']}):null})})]}),(0,rz.jsx)(rN.xu,{marginTop:4,children:(0,rz.jsx)(rN.Zb,{border:!0,overflow:"auto",padding:2,tone:"inherit",children:(0,rz.jsx)(rN.Oo,{separator:(0,rz.jsx)(rN.xv,{muted:!0,size:1,children:"→"}),children:n.path.map((e,t)=>"type"===e.kind?(0,rz.jsx)(rN.xv,{size:1,children:(0,rz.jsx)(Tc,{children:"".concat(function(e){if(null==e?void 0:e.startsWith("<unnamed_type_@_index")){let t=e.slice(1,-1).split("_");return"[".concat(t[4],"]")}return e}(e.name),":").concat(e.type)})},t):"property"===e.kind?(0,rz.jsx)(rN.xv,{size:1,children:(0,rz.jsx)(Tc,{children:e.name})},t):null)})})}),(0,rz.jsx)(rN.xu,{as:"ul",marginTop:4,children:(0,rz.jsx)(rN.xu,{as:"li",children:(0,rz.jsxs)(rN.Kq,{space:3,children:[(0,rz.jsx)(Tu,{muted:!0,size:1,children:i.message}),i.helpId&&(0,rz.jsx)(rN.xv,{muted:!0,size:1,children:(0,rz.jsx)("a",{href:(0,sp.h)(i.helpId),target:"_blank",rel:"noopener noreferrer",children:"View documentation →"})})]})})})]},t)})})}function Th(e){var t;let{schema:n}=e,i=(null==(t=n._validation)?void 0:t.filter(e=>e.problems.some(e=>"error"===e.severity)))||[];return(0,rF.useEffect)(()=>(function(e){let t=e._validation,n=null==t?void 0:t.filter(e=>e.problems.some(e=>"warning"===e.severity));(null==n?void 0:n.length)!==0&&(console.groupCollapsed("⚠️ Schema has ".concat(null==n?void 0:n.length," warnings")),null==n||n.forEach(e=>{let t=e.path.map(e=>"type"===e.kind?"".concat(e.name||"<unnamed>","(").concat(e.type,")"):"property"===e.kind?e.name:null).filter(Boolean).join(" > ");console.group("%cAt ".concat(t),"color: #FF7636"),e.problems.forEach(e=>{console.log(e.message)}),console.groupEnd()}),console.groupEnd())})(n),[n]),(0,rz.jsx)(rN.Zb,{height:"fill",overflow:"auto",paddingY:[4,5,6,7],paddingX:4,sizing:"border",children:(0,rz.jsx)(rN.W2,{width:1,children:(0,rz.jsxs)(rN.Kq,{space:5,children:[(0,rz.jsx)(rN.X6,{as:"h1",children:"Schema errors"}),(0,rz.jsx)(Tp,{problemGroups:i})]})})})}function Tf(e){return(0,rz.jsx)(rN.Zb,{height:"fill",sizing:"border",tone:"caution",display:"flex",children:(0,rz.jsx)(rN.kC,{direction:"row",justify:"center",flex:1,align:"center",children:(0,rz.jsxs)(rN.Kq,{space:4,children:[(0,rz.jsx)(rN.X6,{as:"h1",children:"Workspace not found"}),(0,rz.jsx)(rN.gF,{children:(0,rz.jsx)(rN.zx,{text:"Go to default workspace",onClick:e.onNavigateToDefaultWorkspace,mode:"ghost"})})]})})})}let Tm=(0,rF.createContext)(null),Tg=()=>"undefined"==typeof document?(0,oD.PP)():(0,oD.lX)();function Tx(e){let{children:t,LoadingComponent:n,NotFoundComponent:i,unstable_history:r}=e,[l,a]=(0,rF.useState)(null);if(l)throw l;let o=Tn(),[s,d]=(0,rF.useState)(null),[c,u]=(0,rF.useState)(!1),p=(0,rF.useMemo)(()=>r||Tg(),[r]);(0,rF.useEffect)(()=>{let e=new rQ.y(e=>{let t=p.listen(t=>e.next(t.pathname));return e.next(p.location.pathname||"/"),t}),t=e.pipe((0,r8.U)(e=>(function(e){let{pathname:t,workspaces:n}=e,i=n.map(e=>({workspace:e,name:e.name,basePath:e.basePath||"/"})),[r]=i;for(let{workspace:l,basePath:a}of i)if(RegExp("^".concat(oL()(a),"(\\/|$)"),"i").test(t)||"/"===a)return{type:"match",workspace:l};let o=i.map(e=>e.basePath.substring(1).split("/"));if("/"===t)return{type:"redirect",pathname:r.basePath};let s=o.reduce((e,t)=>{for(let n=0;n<e.length;n++){let i=e[n],r=t[n].toLowerCase();if(i!==r)return e.slice(0,n)}return e});return RegExp("^".concat(function e(t){let[n,...i]=t;return n?"(\\/".concat(oL()(n)).concat(e(i),"(\\/|$))?"):""}(s),"$"),"i").test(t)?{type:"redirect",pathname:r.basePath}:{type:"not-found"}})({pathname:e,workspaces:o}))).subscribe({error:a,next:e=>{"match"===e.type&&(u(!1),d(e.workspace)),"redirect"===e.type&&p.replace(e.pathname),"not-found"===e.type&&u(!0)}});return()=>t.unsubscribe()},[p,o]);let h=(0,rF.useCallback)(e=>{let t=o.find(t=>t.name===e);t&&p.push(t.basePath)},[p,o]),f=o[0].name,m=(0,rF.useCallback)(()=>{h(f)},[h,f]),g=(0,rF.useMemo)(()=>({__internal:{history:p},activeWorkspace:s,setActiveWorkspace:h}),[p,s,h]);return c?(0,rz.jsx)(i,{onNavigateToDefaultWorkspace:m}):g.activeWorkspace?(0,rz.jsx)(Tm.Provider,{value:g,children:t}):(0,rz.jsx)(n,{})}function Tv(){let e=(0,rF.useContext)(Tm);if(!e)throw Error("Could not find `ActiveWorkspaceMatcher` context");return e}let Tb={"logged-in":"","logged-out":"Signed out","no-access":""},Ty=(0,lO.ZP)(rN.Zb)(nW||(nW=d4(["\n  width: 35px;\n  height: 35px;\n\n  svg {\n    width: 100%;\n    height: 100%;\n  }\n"]))),Tj=e=>(0,lW.isValidElementType)(e)?(0,rF.createElement)(e):(0,rF.isValidElement)(e)?e:void 0;function Tw(e){let{state:t,subtitle:n,selected:i,title:r,icon:l,iconRight:a}=e,o=(0,rF.useMemo)(()=>Tj(l),[l]),s=(0,rF.useMemo)(()=>Tj(a),[a]);return(0,rz.jsxs)(rN.kC,{align:"center",flex:"none",gap:3,children:[(0,rz.jsx)(Ty,{radius:2,tone:"transparent",children:o}),(0,rz.jsxs)(rN.Kq,{flex:1,space:2,children:[(0,rz.jsx)(rN.xv,{textOverflow:"ellipsis",weight:"medium",children:r}),n&&(0,rz.jsx)(rN.xv,{muted:!0,size:1,textOverflow:"ellipsis",children:n})]}),t&&Tb[t]&&(0,rz.jsx)(rN.xu,{paddingLeft:1,children:(0,rz.jsx)(rN.xv,{size:1,muted:!0,textOverflow:"ellipsis",children:Tb[t]})}),(i||s)&&(0,rz.jsxs)(rN.kC,{align:"center",gap:4,paddingLeft:3,paddingRight:2,children:[i&&(0,rz.jsx)(rN.xv,{children:(0,rz.jsx)(lL.KML,{})}),s&&(0,rz.jsx)(rN.xv,{muted:!0,children:s})]})]})}let Tk=ch(e=>(0,r0.aj)(e.map(e=>e.auth.state.pipe((0,r8.U)(t=>[e.name,t])))).pipe((0,r8.U)(e=>Object.fromEntries(e)))),TC=[{url:"https://slack.sanity.io/",title:"Community"},{url:"https://www.sanity.io/docs",title:"Docs"},{url:"https://www.sanity.io/legal/privacy",title:"Privacy"},{url:"https://www.sanity.io",title:"sanity.io"}],T_=(0,lO.ZP)(rN.xv)(nG||(nG=d4(["\n  a {\n    color: inherit;\n  }\n"])));function TS(e){let{children:t,footer:n,header:i}=e;return(0,rz.jsxs)(rN.Kq,{space:6,children:[(0,rz.jsx)(rN.Zb,{border:!0,radius:3,overflow:"auto",children:(0,rz.jsxs)(rN.Kq,{children:["object"==typeof i&&(0,rz.jsx)(rN.xu,{children:i}),"string"==typeof i&&(0,rz.jsx)(rN.xu,{paddingY:4,children:(0,rz.jsx)(rN.X6,{align:"center",size:1,children:i})}),(0,rz.jsx)(rN.xu,{paddingX:1,children:(0,rz.jsx)(rN.Zb,{borderTop:Boolean(i),borderBottom:Boolean(n),children:t})}),n&&(0,rz.jsx)(rN.xu,{children:n})]})}),(0,rz.jsxs)(rN.kC,{direction:"column",gap:4,justify:"center",align:"center",children:[(0,rz.jsx)(rN.xv,{size:3,children:(0,rz.jsx)(sh.hn,{})}),(0,rz.jsx)(rN.kC,{align:"center",gap:2,children:TC.map((e,t)=>(0,rz.jsxs)(rF.Fragment,{children:[(0,rz.jsx)(T_,{muted:!0,size:1,children:(0,rz.jsx)("a",{href:e.url,target:"_blank",rel:"noopener noreferrer",children:e.title})}),t<TC.length-1&&(0,rz.jsx)(rN.xv,{size:1,muted:!0,children:"•"})]},e.title))})]})]})}function TE(){var e;let t=Tn(),{activeWorkspace:n,setActiveWorkspace:i}=Tv(),[r]=Tk(t),[l,a]=(0,rF.useState)((null==n?void 0:n.name)||null),o=1===t.length?t[0]:t.find(e=>e.name===l),s=null==(e=null==o?void 0:o.auth)?void 0:e.LoginComponent,d=(0,rF.useCallback)(()=>a(null),[]);return r?s&&o?(0,rz.jsxs)(rN.Kq,{space:2,children:[t.length>1&&(0,rz.jsx)(rN.kC,{children:(0,rz.jsx)(rN.zx,{fontSize:1,icon:lL.Y4O,mode:"bleed",onClick:d,padding:2,text:"Choose another workspace"})}),(0,rz.jsx)(TS,{header:(0,rz.jsx)(rN.xu,{padding:3,children:(0,rz.jsx)(Tw,{icon:o.icon,title:o.title,subtitle:null==o?void 0:o.subtitle})}),children:(0,rz.jsx)(rN.Kq,{padding:2,paddingBottom:3,paddingTop:4,children:(0,rF.createElement)(s,d6(d6({},aQ()(o,["type","__internal"])),{},{key:l}))})})]}):(0,rz.jsx)(TS,{header:"Choose your workspace",footer:(0,rz.jsx)(rN.Kq,{padding:1,children:(0,rz.jsx)(rN.zx,{as:"a",href:"https://beta.sanity.io/docs/platform/studio/config/workspaces",icon:lL.dtP,justify:"flex-start",mode:"bleed",rel:"noopener noreferrer",target:"__blank",text:"Add workspace"})}),children:(0,rz.jsx)(rN.Kq,{space:1,paddingX:1,paddingY:2,children:t.map(e=>{let t=r[e.name],l=t.authenticated?"logged-in":e.auth.LoginComponent?"logged-out":"no-access",o=()=>{"logged-in"===l&&e.name!==n.name&&i(e.name),"logged-out"===l&&a(e.name)};return(0,rz.jsx)(rN.Zb,{as:"button",radius:2,padding:2,onClick:o,children:(0,rz.jsx)(Tw,{icon:null==e?void 0:e.icon,iconRight:lL.XCv,state:l,subtitle:null==e?void 0:e.subtitle,title:(null==e?void 0:e.title)||e.name})},e.name)})})}):(0,rz.jsx)(Ts,{})}let TT=(0,lO.ZP)(rN.v2)(nY||(nY=d4(["\n  max-width: 350px;\n  min-width: 250px;\n"])));function TA(e){let{scheme:t}=E8(),n=Tn(),{activeWorkspace:i,setActiveWorkspace:r}=Tv(),[l]=Tk(n),{navigateUrl:a}=(0,lq.tv)(),o=(0,rF.useMemo)(()=>({constrainSize:!0,scheme:t,portal:!0}),[t]);return(0,rz.jsx)(rN.j2,{button:(0,rz.jsx)(rN.zx,d6(d6({icon:lL.GVG,mode:"bleed"},e),{},{disabled:!l})),id:"workspace-menu",menu:(0,rz.jsxs)(TT,{children:[(0,rz.jsx)(rN.xu,{paddingX:3,paddingY:3,children:(0,rz.jsx)(rN.__,{size:1,muted:!0,children:"Workspaces"})}),l&&n.map(e=>{let t=l[e.name],n=t.authenticated?"logged-in":e.auth.LoginComponent?"logged-out":"no-access",o=()=>{"logged-in"===n&&e.name!==i.name&&r(e.name),"logged-out"===n&&a({path:e.basePath})};return(0,rz.jsx)(rN.sN,{onClick:o,padding:2,pressed:e.name===i.name,children:(0,rz.jsx)(Tw,{icon:null==e?void 0:e.icon,selected:e.name===i.name,state:n,subtitle:null==e?void 0:e.subtitle,title:(null==e?void 0:e.title)||e.name})},e.name)})]}),popover:o})}function TP(){return(0,rz.jsx)(rN.Zb,{height:"fill",children:(0,rz.jsx)(rN.kC,{align:"center",justify:"center",height:"fill",children:(0,rz.jsx)(rN.W2,{width:0,children:(0,rz.jsx)(TE,{})})})})}function TI(){return(0,rz.jsx)(rz.Fragment,{children:"TODO: implement config errors screen"})}function TM(){let[e,t]=(0,rF.useState)(null),[n,i]=(0,rF.useState)(null);if(n)throw n;let{activeWorkspace:r}=Tv(),l=(0,rF.useCallback)(()=>{var e,t;null==(t=(e=r.auth).logout)||t.call(e)},[r]);(0,rF.useEffect)(()=>{let e=r.auth.state.subscribe({next:e=>{let{currentUser:n}=e;t(n)},error:i});return()=>{e.unsubscribe()}},[r]);let a=uz(null==e?void 0:e.provider);return(0,rz.jsx)(rN.Zb,{height:"fill",children:(0,rz.jsx)(rN.Vq,{id:"not-authorized-dialog",header:"Not authorized",width:1,footer:(0,rz.jsx)(rN.Kq,{paddingX:3,paddingY:2,children:(0,rz.jsx)(rN.zx,{text:"Sign out",onClick:l})}),children:(0,rz.jsxs)(rN.Kq,{paddingX:4,paddingY:5,space:4,children:[(0,rz.jsx)(rN.xv,{children:"You are not authorized to access this studio. Maybe you could ask someone to invite you to collaborate on this project?"}),(0,rz.jsxs)(rN.xv,{children:["If you think this is an error, verify that you are signed in with the correct account. You are currently signed in as"," ",(0,rz.jsxs)("strong",{children:[null==e?void 0:e.name," (",null==e?void 0:e.email,")"]}),a?" through ".concat(a):"","."]})]})})})}let Tz=lO.ZP.label(nJ||(nJ=d4(["\n  clip: rect(0 0 0 0);\n  clip-path: inset(50%);\n  height: 1px;\n  overflow: hidden;\n  position: absolute;\n  white-space: nowrap;\n  width: 1px;\n"])));function TR(e){let{projectId:t}=e,n=window.location.origin,i=(0,rF.useMemo)(()=>{let e=new URL("https://sanity.io/manage/project/".concat(t,"/api"));return e.searchParams.set("cors","add"),e.searchParams.set("origin",n),e.searchParams.set("credentials",""),e.toString()},[n,t]);return(0,rF.useEffect)(()=>{let e=()=>{window.location.reload()};return window.addEventListener("focus",e),()=>{window.removeEventListener("focus",e)}},[]),(0,rz.jsx)(rN.Zb,{height:"fill",children:(0,rz.jsx)(rN.Vq,{id:"cors-error-dialog",header:"Before you continue...",width:1,children:(0,rz.jsxs)(rN.Kq,{paddingX:4,paddingY:5,space:4,children:[(0,rz.jsxs)(rN.xv,{children:["To access your content, you need to ",(0,rz.jsx)("b",{children:"add the following URL as a CORS origin"})," to your Sanity project."]}),(0,rz.jsx)(Tz,{"aria-hidden":"true",children:"CORS URL to be added"}),(0,rz.jsx)(rN.oi,{value:n,readOnly:!0}),(0,rz.jsx)(rN.zx,{as:"a",href:i,target:"_blank",rel:"noopener noreferrer",tone:"primary",children:(0,rz.jsxs)(rN.kC,{align:"center",justify:"center",gap:3,children:[(0,rz.jsx)(rN.xv,{weight:"medium",children:"Continue"}),(0,rz.jsx)(rN.xv,{weight:"medium",children:(0,rz.jsx)(lL.buG,{})})]})})]})})})}function TF(e){let{children:t,heading:n="An error occured"}=e,[{error:i},r]=(0,rF.useState)({error:null}),l=cC(i)&&"string"==typeof i.message&&i.message,a=cC(i)&&"string"==typeof i.stack&&i.stack,o=(0,rF.useCallback)(()=>r({error:null}),[r]);return((0,oc.H)(o),i instanceof uf)?(0,rz.jsx)(TR,{projectId:null==i?void 0:i.projectId}):i instanceof EJ?(0,rz.jsx)(Th,{schema:i.schema}):i?(0,rz.jsx)(rN.Zb,{height:"fill",overflow:"auto",paddingY:[4,5,6,7],paddingX:4,sizing:"border",tone:"critical",children:(0,rz.jsx)(rN.W2,{width:3,children:(0,rz.jsxs)(rN.Kq,{space:4,children:[(0,rz.jsx)(rN.X6,{children:n}),(0,rz.jsx)("div",{children:(0,rz.jsx)(rN.zx,{onClick:o,text:"Retry",tone:"default"})}),(0,rz.jsx)(rN.Zb,{border:!0,radius:2,overflow:"auto",padding:4,tone:"inherit",children:(0,rz.jsxs)(rN.Kq,{space:4,children:[l&&(0,rz.jsx)(rN.EK,{size:1,children:(0,rz.jsxs)("strong",{children:["Error: ",l]})}),a&&(0,rz.jsx)(rN.EK,{size:1,children:a})]})})]})})}):(0,rz.jsx)(rN.SV,{onCatch:r,children:t})}let TO=(0,lO.ZP)(rN.Zb)(nQ||(nQ=d4(["\n  height: 100%;\n  left: 0;\n  overflow: hidden;\n  position: fixed;\n  top: 0;\n  width: 100%;\n  z-index: 200;\n"]))),TD=(0,rF.createContext)({onSearchFullscreenOpenChange:()=>"",searchFullscreenOpen:!1,searchFullscreenPortalEl:null});function TZ(){let{state:e}=(0,lq.tv)(),{name:t,title:n,tools:i}=SW(),r="string"==typeof e.tool?e.tool:void 0,l=i.find(e=>e.name===r),[a,o]=(0,rF.useState)(!1),[s,d]=(0,rF.useState)(null),c=(0,rF.useMemo)(()=>{let e=n||l$()(t);return r?"".concat(e," – ").concat(l$()(r)):e},[r,t,n]);(0,rF.useEffect)(()=>{document.title=c},[c]);let u=(0,rF.useCallback)(e=>{o(e)},[]),p=(0,rF.useMemo)(()=>({searchFullscreenOpen:a,searchFullscreenPortalEl:s,onSearchFullscreenOpenChange:u}),[a,s,u]),h=uQ({defaultComponent:IC,pick:IP});return(0,rz.jsxs)(rN.kC,{"data-ui":"ToolScreen",direction:"column",height:"fill","data-testid":"studio-layout",children:[(0,rz.jsx)(TD.Provider,{value:p,children:(0,rz.jsx)(h,{})}),0===i.length&&(0,rz.jsx)(Ta,{}),i.length>0&&!l&&r&&(0,rz.jsx)(To,{toolName:r}),a&&(0,rz.jsx)(TO,{ref:d,overflow:"auto"}),(0,rz.jsx)(TF,{heading:"The ".concat(null==l?void 0:l.name," tool crashed"),children:(0,rz.jsx)(rN.Zb,{flex:1,hidden:a,children:l&&r&&(0,rz.jsx)(lq.NZ,{scope:r,children:(0,rz.jsx)(rF.Suspense,{fallback:(0,rz.jsx)(TL,{}),children:(0,rF.createElement)(l.component,{tool:l})})})})},null==l?void 0:l.name)]})}function TL(){return(0,rz.jsx)(rN.kC,{align:"center",height:"fill",justify:"center",children:(0,rz.jsx)(rN.$j,{muted:!0})})}let Tq=lO.ZP.div(n0||(n0=d4(["\n  position: absolute;\n  width: 18px;\n  height: 18px;\n  background: var(--card-bg-color);\n  bottom: -4px;\n  right: -4px;\n  border-radius: 50%;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  border: 1px solid var(--card-bg-color);\n  box-sizing: content-box;\n\n  svg {\n    box-sizing: content-box;\n    border: 1px solid var(--card-hairline-soft-color);\n    border-radius: 50%;\n    padding: 2px;\n    width: 12px;\n    height: 12px;\n  }\n\n  &[data-logo='github'] {\n    svg {\n      path {\n        fill: var(--card-fg-color);\n      }\n    }\n  }\n\n  &[data-logo='saml'] {\n    svg {\n      path {\n        fill: var(--card-fg-color);\n      }\n    }\n  }\n"]))),TN=(0,rz.jsxs)("svg",{width:"12",height:"12",viewBox:"0 0 12 12",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[(0,rz.jsxs)("g",{clipPath:"url(#clip0)",children:[(0,rz.jsx)("path",{d:"M12 6.13764C12 5.72977 11.9663 5.31971 11.8943 4.91846H6.12036V7.22895H9.42684C9.28963 7.97412 8.84876 8.63332 8.20322 9.05221V10.5514H10.1759C11.3342 9.50637 12 7.9631 12 6.13764Z",fill:"#4285F4"}),(0,rz.jsx)("path",{d:"M6.12019 12.0002C7.77118 12.0002 9.16349 11.4688 10.1779 10.5517L8.20529 9.05253C7.65646 9.41851 6.94793 9.62574 6.12244 9.62574C4.52544 9.62574 3.17136 8.56971 2.68552 7.1499H0.649902V8.69537C1.68908 10.7215 3.80567 12.0002 6.12019 12.0002V12.0002Z",fill:"#34A853"}),(0,rz.jsx)("path",{d:"M2.68332 7.14986C2.4269 6.40469 2.4269 5.59778 2.68332 4.8526V3.30713H0.649951C-0.218278 5.00252 -0.218278 6.99995 0.649951 8.69533L2.68332 7.14986V7.14986Z",fill:"#FBBC04"}),(0,rz.jsx)("path",{d:"M6.12019 2.37483C6.99291 2.3616 7.8364 2.68348 8.46845 3.27433L10.2161 1.56131C9.1095 0.542752 7.64071 -0.017233 6.12019 0.000404333C3.80566 0.000404333 1.68908 1.27911 0.649902 3.3074L2.68326 4.85288C3.16686 3.43087 4.52319 2.37483 6.12019 2.37483V2.37483Z",fill:"#EA4335"})]}),(0,rz.jsx)("defs",{children:(0,rz.jsx)("clipPath",{id:"clip0",children:(0,rz.jsx)("rect",{width:"12",height:"12",fill:"white"})})})]}),TV=(0,rz.jsxs)("svg",{width:"12",height:"12",viewBox:"0 0 12 12",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[(0,rz.jsx)("g",{clipPath:"url(#clip0)",children:(0,rz.jsx)("path",{d:"M11.195 3.13503C10.6711 2.22838 9.91808 1.47537 9.01144 0.951471C8.09222 0.414976 7.08837 0.146729 5.99987 0.146729C4.91137 0.146729 3.90752 0.414976 2.98831 0.951471C2.08163 1.47534 1.32862 2.22836 0.804744 3.13503C0.268248 4.05497 0 5.05883 0 6.14659C0 7.45399 0.381531 8.62978 1.14459 9.67394C1.90765 10.7181 2.89327 11.4408 4.10143 11.8419C4.24208 11.868 4.34624 11.8497 4.41392 11.7872C4.44666 11.7577 4.47263 11.7215 4.49006 11.681C4.50749 11.6405 4.51595 11.5967 4.51488 11.5527C4.51488 11.537 4.51361 11.3963 4.51105 11.1307C4.5085 10.8651 4.50722 10.6334 4.50722 10.4355L4.32745 10.4666C4.18407 10.4895 4.03885 10.4986 3.89375 10.494C3.71159 10.4908 3.53001 10.4725 3.35087 10.4393C3.16049 10.4045 2.98119 10.3246 2.82796 10.2064C2.66705 10.0846 2.54715 9.91661 2.48428 9.72484L2.40602 9.54506C2.34022 9.40286 2.25754 9.2691 2.15976 9.14666C2.04775 9.00072 1.93447 8.90176 1.81991 8.84977L1.76518 8.81064C1.72769 8.78356 1.6936 8.75205 1.66367 8.71679C1.63479 8.6841 1.61108 8.64719 1.59334 8.60734C1.57766 8.57085 1.5907 8.54085 1.63247 8.51731C1.67461 8.49405 1.75123 8.48256 1.86068 8.48256L2.01692 8.50582C2.12108 8.52662 2.24996 8.5891 2.40356 8.69326C2.5585 8.79876 2.68797 8.93748 2.78254 9.09932C2.90239 9.31294 3.04695 9.47575 3.21624 9.58775C3.38552 9.69976 3.55609 9.75576 3.72793 9.75576C3.87725 9.7578 4.02641 9.74479 4.17312 9.7169C4.29459 9.69195 4.41264 9.65254 4.52473 9.59952C4.57162 9.25037 4.69931 8.98212 4.90782 8.79477C4.63684 8.76849 4.36827 8.72157 4.10444 8.6544C3.84797 8.58382 3.60133 8.48141 3.37029 8.34958C3.12825 8.218 2.91442 8.04015 2.74095 7.82613C2.57421 7.6178 2.4374 7.34417 2.3305 7.00524C2.2236 6.6663 2.1707 6.27584 2.1718 5.83383C2.1718 5.20357 2.37757 4.66708 2.7891 4.22435C2.59629 3.75006 2.61453 3.21885 2.84383 2.63073C2.99487 2.58385 3.21879 2.61897 3.51559 2.73608C3.81239 2.85319 4.02983 2.95352 4.16792 3.03707C4.30601 3.12025 4.41665 3.19058 4.49983 3.24804C5.48153 2.9773 6.51821 2.9773 7.49991 3.24804L7.79679 3.0606C8.0249 2.92356 8.26549 2.80849 8.51535 2.71693C8.79135 2.61276 9.00231 2.58412 9.14825 2.63101C9.38248 3.21949 9.40327 3.7507 9.21064 4.22462C9.62199 4.66735 9.82776 5.20385 9.82795 5.83411C9.82795 6.27684 9.77459 6.66904 9.66787 7.01071C9.56116 7.35238 9.42325 7.62601 9.25415 7.8316C9.07785 8.04326 8.86311 8.21966 8.62124 8.35149C8.39008 8.48329 8.14337 8.5857 7.88682 8.65632C7.62412 8.72277 7.35674 8.76915 7.087 8.79505C7.35698 9.02927 7.49206 9.3994 7.49225 9.90543V11.5527C7.49115 11.5964 7.49929 11.6398 7.51612 11.6802C7.53295 11.7206 7.5581 11.7569 7.58993 11.7869C7.65505 11.8493 7.75794 11.8675 7.89858 11.8416C9.10693 11.4403 10.0926 10.7177 10.8557 9.67367C11.6188 8.62968 12.0003 7.4539 12.0003 6.14632C11.9997 5.05873 11.7313 4.05497 11.195 3.13503V3.13503Z",fill:"black"})}),(0,rz.jsx)("defs",{children:(0,rz.jsx)("clipPath",{id:"clip0",children:(0,rz.jsx)("rect",{width:"12",height:"12",fill:"white"})})})]}),TB=(0,rz.jsxs)("svg",{width:"17",height:"9",viewBox:"0 0 17 9",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[(0,rz.jsx)("path",{d:"M0.0691681 5.98162C0.115833 7.24157 1.07247 8.00221 2.59841 8.00221C4.17102 8.00221 5.12299 7.19957 5.12299 5.86962C5.12299 4.83832 4.55367 4.25501 3.25172 3.96569L2.56108 3.80703C1.8331 3.64837 1.53445 3.38704 1.53445 2.91106C1.53445 2.40708 1.94977 2.09442 2.61708 2.09442C3.27505 2.09442 3.6997 2.43508 3.75103 2.99039H5.00166C4.95966 1.78643 4.01236 0.997795 2.60308 0.997795C1.14713 0.997795 0.218496 1.79577 0.218496 3.05105C0.218496 4.04968 0.815808 4.69366 2.03376 4.96898L2.73374 5.13231C3.51304 5.30497 3.8117 5.54763 3.8117 6.00495C3.8117 6.55093 3.34972 6.90092 2.62174 6.90092C1.85644 6.90092 1.38045 6.56493 1.31979 5.98162H0.0691681Z"}),(0,rz.jsx)("path",{d:"M5.97695 5.98162C6.02362 7.24157 6.98025 8.00221 8.5062 8.00221C10.0788 8.00221 11.0308 7.19957 11.0308 5.86962C11.0308 4.83832 10.4615 4.25501 9.15951 3.96569L8.46886 3.80703C7.74089 3.64837 7.44223 3.38704 7.44223 2.91106C7.44223 2.40708 7.85755 2.09442 8.52486 2.09442C9.18284 2.09442 9.60749 2.43508 9.65882 2.99039H10.9094C10.8674 1.78643 9.92015 0.997795 8.51086 0.997795C7.05492 0.997795 6.12628 1.79577 6.12628 3.05105C6.12628 4.04968 6.72359 4.69366 7.94155 4.96898L8.64153 5.13231C9.42083 5.30497 9.71949 5.54763 9.71949 6.00495C9.71949 6.55093 9.2575 6.90092 8.52953 6.90092C7.76422 6.90092 7.28824 6.56493 7.22758 5.98162H5.97695Z"}),(0,rz.jsx)("path",{d:"M16.9852 5.01565V3.98435C16.9852 2.11309 16.0099 0.997795 14.3953 0.997795C12.7807 0.997795 11.8054 2.11309 11.8054 3.98435V5.01565C11.8054 6.88692 12.7807 8.00221 14.3953 8.00221C16.0099 8.00221 16.9852 6.88692 16.9852 5.01565ZM14.3953 6.82625C13.5833 6.82625 13.154 6.21494 13.154 5.00165V3.99835C13.154 2.78506 13.5833 2.17375 14.3953 2.17375C15.2073 2.17375 15.6366 2.78506 15.6366 3.99835V5.00165C15.6366 6.21494 15.2073 6.82625 14.3953 6.82625Z"})]}),TU=e=>{let{provider:t}=e,n=null==t?void 0:t.startsWith("saml-");return(0,rz.jsxs)(Tq,{"data-logo":n?"saml":t,children:["google"===t&&TN,"github"===t&&TV,"sanity"===t&&(0,rz.jsx)(sh.xN,{}),n&&TB]})},TK=(0,lO.ZP)(rN.v2)(n1||(n1=d4(["\n  min-width: 125px;\n  max-width: 350px;\n"]))),TH=(0,lO.ZP)(rN.xu)(n2||(n2=d4(["\n  position: relative;\n  min-width: ","px;\n  min-height: ","px;\n"])),e=>{let{theme:t}=e;return t.sanity.avatar.sizes[1].size},e=>{let{theme:t}=e;return t.sanity.avatar.sizes[1].size});function T$(){let{currentUser:e,projectId:t,auth:n}=SW(),i=(0,rN.Ur)().theme,{scheme:r,setScheme:l,clearStoredScheme:a,usingSystemScheme:o}=E8(),s=uz(null==e?void 0:e.provider),d=(0,rF.useMemo)(()=>({placement:"bottom-end",portal:!0,preventOverflow:!0,scheme:r}),[r]);return(0,rz.jsx)(rN.j2,{button:(0,rz.jsx)(rN.zx,{mode:"bleed",padding:0,paddingX:1,children:(0,rz.jsxs)(rN.kC,{align:"center",gap:1,children:[(0,rz.jsx)(Rw,{user:"me",size:1}),(0,rz.jsx)(rN.xv,{size:1,muted:!0,children:(0,rz.jsx)(lL.v4q,{})})]})}),id:"user-menu",menu:(0,rz.jsxs)(TK,{children:[(0,rz.jsxs)(rN.Zb,{padding:2,children:[(0,rz.jsx)(rN.xu,{marginBottom:3,children:(0,rz.jsx)(rN.__,{size:1,muted:!0,children:"Signed in as"})}),(0,rz.jsxs)(rN.kC,{align:"center",children:[(0,rz.jsx)(rN.u,{disabled:!s,portal:!0,content:s&&(0,rz.jsx)(rN.xu,{padding:2,children:(0,rz.jsxs)(rN.xv,{size:1,children:["Signed in with ",s]})}),children:(0,rz.jsxs)(TH,{marginRight:3,children:[(0,rz.jsx)(Rw,{size:1,user:"me"}),(null==e?void 0:e.provider)&&(0,rz.jsx)(TU,{provider:e.provider})]})}),(0,rz.jsxs)(rN.Kq,{space:2,flex:1,children:[(0,rz.jsx)(rN.xv,{size:1,weight:"semibold",textOverflow:"ellipsis",children:null==e?void 0:e.name}),(0,rz.jsx)(rN.xv,{size:1,muted:!0,textOverflow:"ellipsis",children:null==e?void 0:e.email})]})]})]}),!(null==i?void 0:i.__legacy)&&(0,rz.jsxs)(rz.Fragment,{children:[(0,rz.jsx)(rN.R,{}),(0,rz.jsx)(rN.xu,{padding:2,children:(0,rz.jsx)(rN.__,{size:1,muted:!0,children:"Appearance"})}),(0,rz.jsx)(rN.sN,{"aria-label":"Use system appearance",icon:lL.ugZ,onClick:a,pressed:o,text:"System",iconRight:o&&(0,rz.jsx)(lL.KML,{})}),(0,rz.jsx)(rN.sN,{"aria-label":"Use dark appearance",icon:lL.kLh,onClick:()=>l("dark"),pressed:"dark"===r&&!o,iconRight:"dark"===r&&!o&&(0,rz.jsx)(lL.KML,{}),text:"Dark"}),(0,rz.jsx)(rN.sN,{"aria-label":"Use light appearance",icon:lL.NWY,onClick:()=>l("light"),pressed:"light"===r&&!o,iconRight:"light"===r&&!o&&(0,rz.jsx)(lL.KML,{}),text:"Light"})]}),(0,rz.jsx)(rN.R,{}),(0,rz.jsx)(rN.sN,{as:"a",href:"https://sanity.io/manage/project/".concat(t),target:"_blank",text:"Manage project",icon:lL.IEm}),n.logout&&(0,rz.jsxs)(rz.Fragment,{children:[(0,rz.jsx)(rN.R,{}),(0,rz.jsx)(rN.sN,d6({iconRight:lL.Ow9,text:"Sign out",disabled:!n.logout},n.logout&&{onClick:n.logout}))]})]}),popover:d})}let TX=(0,lO.ZP)(rN.zx)(n3||(n3=d4(["\n  text-decoration: none;\n"]))),TW=(0,lO.ZP)(rN.xu)(n4||(n4=d4(["\n  max-width: 300px;\n"]))),TG=lO.ZP.div(n5||(n5=d4(["\n  & > * {\n    width: 100%;\n  }\n"])));function TY(){let[e,t]=(0,rF.useState)(null),[n,i]=(0,rF.useState)(!1),{scheme:r}=E8(),{__internal:{staticInitialValueTemplateItems:l},currentUser:a}=SJ(),[o,s]=zv({templateItems:l}),d=(0,rF.useMemo)(()=>o?o.reduce((e,t)=>(e[t.id]=t,e),{}):{},[o]),c=l.length>0,u=l.some(e=>{var t;return null==(t=d[e.id])?void 0:t.granted}),p=(0,rF.useMemo)(()=>c?u?(0,rz.jsx)(rN.xv,{size:1,children:"New document..."}):(0,rz.jsx)(ul,{currentUser:a,operationLabel:"create any document"}):(0,rz.jsx)(rN.xv,{size:1,children:"No document types"}),[u,a,c]),h=(0,rF.useCallback)(()=>{i(!0)},[]),f=(0,rF.useCallback)(()=>{i(!1),null==e||e.focus()},[e]),m=(0,rF.useCallback)(()=>{i(!1)},[]);return(0,rz.jsxs)(rz.Fragment,{children:[(0,rz.jsx)(rN.u,{content:(0,rz.jsx)(TW,{padding:2,children:p}),disabled:s,placement:"bottom",portal:!0,scheme:r,children:(0,rz.jsx)(rN.xu,{children:(0,rz.jsx)(rN.zx,{"aria-label":"New document…",disabled:!u||!c||s,icon:lL.j29,mode:"bleed",onClick:h,ref:t,style:{cursor:u&&c?void 0:"not-allowed"}})})}),n&&(0,rz.jsxs)(rN.Vq,{header:"New document",id:"new-document-dialog",onClickOutside:f,onClose:f,scheme:r,width:2,children:[s&&(0,rz.jsx)(rN.kC,{padding:4,align:"center",justify:"center",children:(0,rz.jsx)(rN.$j,{muted:!0,"aria-label":"Loading…"})}),!s&&(0,rz.jsx)(rN.rj,{padding:4,columns:[1,1,2,3],gap:3,children:l.map(e=>{var t;return(null==(t=d[e.id])?void 0:t.granted)?(0,rz.jsx)(TX,{forwardedAs:lq.nR,intent:"create",mode:"ghost",onClick:m,padding:2,params:{template:e.templateId,type:e.schemaType},children:(0,rz.jsx)(RH,{media:e.icon,subtitle:e.subtitle,title:e.title})},e.id):(0,rz.jsx)(rN.u,{content:(0,rz.jsx)(TW,{padding:2,children:(0,rz.jsx)(ul,{currentUser:a,operationLabel:"create this document"})}),children:(0,rz.jsx)(TG,{children:(0,rz.jsx)(TX,{mode:"ghost",padding:2,disabled:!0,children:(0,rz.jsx)(RH,{media:e.icon,subtitle:e.subtitle,title:e.title})},e.id)})},e.id)})})]})]})}let TJ=(0,lO.iv)(n6||(n6=d4(["\n  &:after {\n    content: '';\n    width: 6px;\n    height: 6px;\n    background-color: var(--status-button-dot-bg);\n    position: absolute;\n    top: 0;\n    right: 0;\n    border-radius: 50%;\n    transform: translate(-7px, 7px);\n    border: 1px solid var(--card-bg-color);\n  }\n"]))),TQ=(0,lO.ZP)(rN.zx)(e=>{let{theme:t,active:n,statusTone:i}=e,{color:r}=t.sanity,l=r.selectable&&r.selectable[i].selected.bg;return(0,lO.iv)(n8||(n8=d4(["\n      position: relative;\n      --status-button-dot-bg: ",";\n\n      ","\n    "])),l,n&&l&&TJ)}),T0=(0,lO.ZP)(rN.Zb)(n7||(n7=d4(["\n  background: transparent;\n  margin: calc((-35px + 11px) / 2);\n"]))),T1=(0,rF.memo)(function(e){let{presence:t,focused:n,onFocus:i}=e,[r,l]=(0,rF.useState)(null),a=a1()(t.locations||[],["lastActiveAt"],["desc"]).find(e=>e.documentId),o=Boolean(null==a?void 0:a.documentId);(0,rF.useEffect)(()=>{n&&r&&(r.focus(),r.setAttribute("data-selected","")),n||null==r||r.removeAttribute("data-selected")},[r,n]);let s=(0,rF.useCallback)(()=>{i(t.user.id)},[i,t.user.id]),d=(0,rF.useMemo)(()=>(0,rF.forwardRef)(function(e,t){return(null==a?void 0:a.path)?(0,rz.jsx)(lq.nR,d6(d6({},e),{},{intent:"edit",params:{id:null==a?void 0:a.documentId,path:rR.BB(null==a?void 0:a.path)},ref:t})):null}),[a]);return(0,rz.jsx)(rN.sN,{as:a?d:"div","data-as":a?"a":"div",onFocus:s,padding:4,paddingRight:3,ref:l,children:(0,rz.jsxs)(rN.kC,{align:"center",children:[(0,rz.jsx)(T0,{children:(0,rz.jsx)(Rw,{size:1,user:t.user},t.user.id)}),(0,rz.jsx)(rN.xu,{flex:1,marginLeft:4,children:(0,rz.jsx)(rN.xv,{textOverflow:"ellipsis",children:t.user.displayName})}),o&&(0,rz.jsx)(rN.xu,{marginLeft:3,children:(0,rz.jsx)(rN.xv,{children:(0,rz.jsx)(lL.xPt,{})})})]})})}),T2=(0,lO.ZP)(rN.Zb)(n9||(n9=d4(["\n  background: transparent;\n"]))),T3=(0,lO.ZP)(rN.v2)(ie||(ie=d4(["\n  max-width: 350px;\n  min-width: 250px;\n"]))),T4=(0,lO.ZP)(rN.Kq)(it||(it=d4(["\n  position: sticky;\n  bottom: 0;\n"])));function T5(e){let{collapse:t}=e,n=function(){let[e,t]=(0,rF.useState)([]),n=Rx();return(0,rF.useEffect)(()=>{let e=n.globalPresence$.subscribe(t);return()=>{e.unsubscribe()}},[n]),e}(),{projectId:i}=SW(),{scheme:r}=E8(),l=n.length>0,[a,o]=(0,rF.useState)(),s=(0,rF.useCallback)(e=>{o(e)},[]),d=(0,rF.useCallback)(()=>{o("")},[]),c=(0,rF.useMemo)(()=>t?(0,rz.jsx)(TQ,{icon:lL.oyc,mode:"bleed",active:l,statusTone:"positive"}):(0,rz.jsx)(rN.zx,{mode:"bleed",padding:1,children:(0,rz.jsx)(T2,{children:(0,rz.jsx)(rN.Jh,{maxLength:4,children:n.map(e=>(0,rz.jsx)(Rw,{user:e.user},e.user.id))})})}),[t,l,n]),u=(0,rF.useMemo)(()=>({constrainSize:!0,portal:!0,scheme:r}),[r]);return(0,rz.jsx)(rN.j2,{button:c,id:"global-presence-menu",onClose:d,menu:(0,rz.jsxs)(T3,{padding:1,children:[l&&(0,rz.jsx)(rN.Kq,{space:2,children:n.map(e=>(0,rz.jsx)(T1,{focused:a===e.user.id,onFocus:s,presence:e},e.user.id))}),!l&&(0,rz.jsx)(rN.xu,{paddingX:3,paddingY:4,children:(0,rz.jsxs)(rN.Kq,{space:3,children:[(0,rz.jsx)(rN.xv,{weight:"semibold",size:2,children:"No one else is here"}),(0,rz.jsx)(rN.xv,{size:1,muted:!0,children:"Invite people to the project to see their online status."})]})}),(0,rz.jsxs)(T4,{space:1,children:[(0,rz.jsx)(rN.R,{}),(0,rz.jsx)(rN.sN,{as:"a",href:"https://sanity.io/manage/project/".concat(i),iconRight:lL.IEm,onFocus:d,paddingY:4,rel:"noopener noreferrer",target:"_blank",text:"Manage members"})]})]}),popover:u})}let T6=(0,lO.ZP)(rN.mh)(ii||(ii=d4(["\n  position: fixed;\n  top: 0;\n  left: 0;\n  width: 100%;\n  height: 100%;\n  pointer-events: none;\n"]))),T8=(0,lO.ZP)(rN.Zb)(ir||(ir=d4(["\n  position: absolute;\n  top: 0;\n  left: 0;\n  right: 0;\n  bottom: 0;\n  background: var(--card-shadow-penumbra-color);\n  transition: 200ms opacity ease-in-out;\n  pointer-events: none;\n  opacity: 0;\n\n  &[data-open='true'] {\n    opacity: 1;\n    pointer-events: all;\n  }\n"]))),T7=(0,lO.ZP)(rN.Zb)(il||(il=d4(["\n  position: relative;\n  pointer-events: all;\n  flex-direction: column;\n  min-width: 200px;\n  max-width: 280px;\n  transition: 200ms transform ease-in-out;\n  transform: translate3d(calc(-100% - 1px), 0, 0);\n\n  &[data-open='true'] {\n    transform: translate3d(0, 0, 0);\n  }\n"]))),T9=(0,rF.memo)(function(e){let{activeToolName:t,isOpen:n,onClose:i,tools:r}=e,[l,a]=(0,rF.useState)(null),[o,s]=(0,rF.useState)(null),d=n?0:-1,{auth:c,currentUser:u}=SW(),p=Tn();Fg({rootElement:o,navigation:["tab"]}),(0,rN.qh)(e=>{"Escape"===e.key&&n&&i()}),(0,rF.useEffect)(()=>{n&&(null==l||l.focus())},[l,n]);let h=Iz();return(0,rz.jsxs)(T6,{children:[(0,rz.jsx)(T8,{"data-open":n,onClick:i}),(0,rz.jsxs)(T7,{display:"flex",height:"fill","data-open":n,shadow:1,ref:s,children:[(0,rz.jsx)(rN.Zb,{borderBottom:!0,children:(0,rz.jsxs)(rN.Kq,{space:3,padding:[3,3,4],children:[(0,rz.jsxs)(rN.kC,{align:"center",children:[(0,rz.jsx)(rN.kC,{flex:1,align:"center",paddingRight:2,children:(0,rz.jsxs)(rN.kC,{flex:1,align:"center",children:[(0,rz.jsx)(rN.xu,{children:(0,rz.jsx)(Rw,{size:1,user:"me"})}),(0,rz.jsx)(rN.xu,{flex:1,marginLeft:2,title:(null==u?void 0:u.name)||(null==u?void 0:u.email),children:(0,rz.jsx)(rN.xv,{textOverflow:"ellipsis",children:(null==u?void 0:u.name)||(null==u?void 0:u.email)})})]})}),(0,rz.jsx)(rN.xu,{children:(0,rz.jsx)(rN.zx,{icon:lL.Two,mode:"bleed",onClick:i,ref:a,tabIndex:d,title:"Close menu"})})]}),p.length>1&&(0,rz.jsx)(TA,{text:"Select workspace",justify:"flex-start"})]})}),(0,rz.jsx)(rN.xu,{flex:"auto",overflow:"auto",padding:[3,3,4],children:(0,rz.jsx)(h,{activeToolName:t,closeSidebar:i,context:"sidebar",isSidebarOpen:n,tools:r})}),c.logout&&(0,rz.jsx)(rN.Zb,{flex:"none",padding:[3,3,4],borderTop:!0,children:(0,rz.jsx)(rN.Kq,{children:(0,rz.jsx)(rN.zx,{iconRight:lL.Ow9,justify:"flex-start",mode:"bleed",onClick:c.logout,tabIndex:d,text:"Sign out"})})})]})]})}),Ae=(0,lO.iv)(ia||(ia=d4(["\n  --margin-top: ","px;\n\n  &:not([data-list-type='number']) {\n    counter-reset: section;\n  }\n\n  &[data-list-type='bullet'] {\n    --bullet-marker: '●';\n    margin-top: var(--margin-top);\n\n    [data-list-type='bullet'] {\n      --bullet-marker: '○';\n      margin-top: var(--margin-top);\n\n      [data-list-type='bullet'] {\n        --bullet-marker: '■';\n        margin-top: var(--margin-top);\n\n        [data-list-type='bullet'] {\n          --bullet-marker: '●';\n          margin-top: var(--margin-top);\n\n          [data-list-type='bullet'] {\n            --bullet-marker: '○';\n            margin-top: var(--margin-top);\n\n            [data-list-type='bullet'] {\n              --bullet-marker: '■';\n              margin-top: var(--margin-top);\n\n              [data-list-type='bullet'] {\n                --bullet-marker: '●';\n                margin-top: var(--margin-top);\n\n                [data-list-type='bullet'] {\n                  --bullet-marker: '○';\n                  margin-top: var(--margin-top);\n\n                  [data-list-type='bullet'] {\n                    --bullet-marker: '■';\n                    margin-top: var(--margin-top);\n\n                    [data-list-type='bullet'] {\n                      --bullet-marker: '●';\n                      margin-top: var(--margin-top);\n\n                      [data-list-type='bullet'] {\n                        --bullet-marker: '○';\n                        margin-top: var(--margin-top);\n\n                        [data-list-type='bullet'] {\n                          --bullet-marker: '■';\n                          margin-top: var(--margin-top);\n                        }\n                      }\n                    }\n                  }\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  }\n\n  &[data-list-type='number'] {\n    --bullet-marker: counter(section, number) '. ';\n    counter-reset: section;\n    margin-top: var(--margin-top);\n\n    [data-list-type='number'] {\n      --bullet-marker: counter(section, lower-alpha) '. ';\n      counter-reset: section;\n      margin-top: var(--margin-top);\n\n      [data-list-type='number'] {\n        --bullet-marker: counter(section, lower-roman) '. ';\n        counter-reset: section;\n        margin-top: var(--margin-top);\n\n        [data-list-type='number'] {\n          --bullet-marker: counter(section, number) '. ';\n          counter-reset: section;\n          margin-top: var(--margin-top);\n\n          [data-list-type='number'] {\n            --bullet-marker: counter(section, lower-alpha) '. ';\n            counter-reset: section;\n            margin-top: var(--margin-top);\n\n            [data-list-type='number'] {\n              --bullet-marker: counter(section, lower-roman) '. ';\n              counter-reset: section;\n              margin-top: var(--margin-top);\n\n              [data-list-type='number'] {\n                --bullet-marker: counter(section, number) '. ';\n                counter-reset: section;\n                margin-top: var(--margin-top);\n\n                [data-list-type='number'] {\n                  --bullet-marker: counter(section, lower-alpha) '. ';\n                  counter-reset: section;\n                  margin-top: var(--margin-top);\n\n                  [data-list-type='number'] {\n                    --bullet-marker: counter(section, lower-roman) '. ';\n                    counter-reset: section;\n                    margin-top: var(--margin-top);\n\n                    [data-list-type='number'] {\n                      --bullet-marker: counter(section, number) '. ';\n                      counter-reset: section;\n                      margin-top: var(--margin-top);\n\n                      [data-list-type='number'] {\n                        --bullet-marker: counter(section, lower-alpha) '. ';\n                        counter-reset: section;\n                        margin-top: var(--margin-top);\n\n                        [data-list-type='number'] {\n                          --bullet-marker: counter(section, lower-roman) '. ';\n                          counter-reset: section;\n                          margin-top: var(--margin-top);\n                        }\n                      }\n                    }\n                  }\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  }\n"])),e=>{let{theme:t}=e;return t.sanity.space[1]}),At=(0,lO.ZP)(rN.xu)(io||(io=d4(["\n  ",";\n"])),Ae),An=(0,lO.ZP)(rN.xu)(is||(is=d4(["\n  ",":first-child {\n    &:not([data-list-type='number'], [data-list-type='bullet']) {\n      margin-top: 0;\n    }\n  }\n\n  ",":last-child {\n    margin-bottom: 0;\n  }\n"])),At,At),Ai=(0,lO.ZP)(rN.xu)(id||(id=d4(["\n  line-height: 1;\n"]))),Ar=(0,lO.ZP)(rN.xu)(()=>(0,lO.iv)(ic||(ic=d4(["\n    &:not([hidden]) {\n      position: relative;\n      padding-left: 2rem;\n      display: inline-flex;\n    }\n\n    & > [data-list-prefix] {\n      position: absolute;\n      width: 3rem;\n      left: -2rem;\n      text-align: right;\n\n      &[data-list-prefix='bullet'] {\n        top: -0.1875em;\n\n        & > span:before {\n          content: var(--bullet-marker);\n          font-size: 0.46666em;\n        }\n      }\n\n      &[data-list-prefix='number'] {\n        counter-increment: section;\n\n        & > span:before {\n          font-size: 1em;\n          content: var(--bullet-marker);\n        }\n      }\n    }\n  "])))),Al=(0,lO.ZP)(rN.Zb)(iu||(iu=d4(["\n  position: relative;\n  padding-bottom: ","%;\n  background-image: ",";\n  background-size: cover;\n\n  img {\n    position: absolute;\n    top: 0;\n    left: 0;\n    width: 100%;\n    height: 100%;\n    object-fit: cover;\n  }\n"])),e=>{let{$aspectRatio:t}=e;return t},e=>{let{$lqip:t}=e;return"url(".concat(t,")")});function Aa(e){let{value:t}=e;if(!(null==t?void 0:t.asset))return null;let n=(0,aj.e5)(t.asset),i=ay()(n).image(t).fit("max").auto("format").url(),{asset:r,alt:l,caption:a}=t,{dimensions:o,lqip:s}=(null==r?void 0:r.metadata)||{},d=o.height/o.width*100;return(0,rz.jsx)(At,{marginY:4,children:(0,rz.jsxs)(rN.Kq,{space:3,as:"figure",children:[(0,rz.jsx)(Al,{radius:1,shadow:1,overflow:"hidden",$aspectRatio:d,$lqip:s,children:(0,rz.jsx)("img",{src:i,alt:l||a,referrerPolicy:"strict-origin-when-cross-origin"})}),a&&(0,rz.jsx)(rN.xv,{align:"center",as:"figcaption",muted:!0,size:1,children:t.caption})]})})}let Ao={types:{image:e=>{let{value:t}=e;return(0,rz.jsx)(Aa,{value:t})},code:e=>{let{value:t}=e;return(0,rz.jsx)(At,{marginY:4,children:(0,rz.jsx)(rN.Zb,{padding:3,tone:"transparent",radius:1,overflow:"auto",children:(0,rz.jsx)(rN.EK,{size:1,language:null==t?void 0:t.language,children:null==t?void 0:t.code})})})}},block:{h1:e=>{let{children:t}=e;return(0,rz.jsx)(At,{marginBottom:4,marginTop:5,children:(0,rz.jsx)(rN.X6,{size:5,children:t})})},h2:e=>{let{children:t}=e;return(0,rz.jsx)(At,{marginBottom:4,marginTop:5,children:(0,rz.jsx)(rN.X6,{size:4,children:t})})},h3:e=>{let{children:t}=e;return(0,rz.jsx)(At,{marginBottom:4,marginTop:5,children:(0,rz.jsx)(rN.X6,{size:3,children:t})})},h4:e=>{let{children:t}=e;return(0,rz.jsx)(At,{marginBottom:4,marginTop:5,children:(0,rz.jsx)(rN.X6,{size:2,children:t})})},h5:e=>{let{children:t}=e;return(0,rz.jsx)(At,{marginBottom:4,marginTop:5,children:(0,rz.jsx)(rN.X6,{size:1,children:t})})},h6:e=>{let{children:t}=e;return(0,rz.jsx)(At,{marginBottom:4,marginTop:5,children:(0,rz.jsx)(rN.X6,{size:0,children:t})})},normal:e=>{let{children:t}=e;return(0,rz.jsx)(At,{marginY:4,children:(0,rz.jsx)(rN.xv,{as:"p",muted:!0,size:1,children:t})})}},list:{bullet:e=>{let{children:t}=e;return(0,rz.jsx)(At,{"data-list-type":"bullet",marginBottom:4,children:(0,rz.jsx)(rN.xu,{as:"ul",children:t})})},number:e=>{let{children:t}=e;return(0,rz.jsx)(At,{"data-list-type":"number",marginBottom:4,children:(0,rz.jsx)(rN.xu,{as:"ol",children:t})})}},listItem:{bullet:e=>{let{children:t}=e;return(0,rz.jsx)(Ai,{marginBottom:1,forwardedAs:"li",children:(0,rz.jsxs)(Ar,{children:[(0,rz.jsx)(rN.xv,{muted:!0,size:1,"data-list-prefix":"bullet"}),(0,rz.jsx)(rN.xv,{muted:!0,size:1,children:t})]})})},number:e=>{let{children:t}=e;return(0,rz.jsx)(Ai,{marginBottom:1,forwardedAs:"li",children:(0,rz.jsxs)(Ar,{children:[(0,rz.jsx)(rN.xv,{muted:!0,"data-list-prefix":"number",size:1}),(0,rz.jsx)(rN.xv,{muted:!0,size:1,children:t})]})})}}};function As(e){let{value:t}=e;return(0,rz.jsx)(An,{children:(0,rz.jsx)(sf.YI,{value:t,components:Ao})})}let Ad={bugfix:"Bugfixes",feature:"Feature"};function Ac(e){let{changeType:t,description:n,title:i}=e,r=Ad[t];return(0,rz.jsx)(rN.Zb,{padding:4,shadow:1,radius:2,children:(0,rz.jsxs)(rN.Kq,{space:i?4:3,children:[r&&(0,rz.jsx)(rN.__,{size:1,children:r}),(0,rz.jsxs)(rN.Kq,{space:3,children:[i&&(0,rz.jsx)(rN.X6,{size:1,children:i}),n&&(0,rz.jsx)(As,{value:n})]})]})})}function Au(e){let{changeItems:t,isLatest:n,version:i}=e,r=t.filter(e=>"feature"===e.changeType),l=t.filter(e=>"bugfix"===e.changeType),a=l.map(e=>{let{description:t}=e;return t}).flat();return(0,rz.jsxs)(rN.Kq,{space:4,children:[(0,rz.jsxs)(rN.kC,{align:"center",gap:2,children:[(0,rz.jsxs)(rN.X6,{size:1,children:["v",i]}),n&&(0,rz.jsx)(rN.Ct,{tone:"positive",children:"Latest"})]}),(0,rz.jsxs)(rN.Kq,{space:3,children:[null==r?void 0:r.map(e=>(0,rz.jsx)(Ac,{changeType:e.changeType,description:null==e?void 0:e.description,title:e.title},e.title)),a.length>0&&(0,rz.jsx)(Ac,{changeType:"bugfix",description:a})]}),(0,rz.jsx)(rN.kC,{justify:"flex-end",children:(0,rz.jsx)(rN.xv,{size:1,children:(0,rz.jsx)("a",{href:"https://github.com/sanity-io/sanity/releases",rel:"noreferrer noopener",target:"_blank",children:"See full changelog on GitHub"})})})]})}let Ap=(0,lO.ZP)(rN.xu)(ip||(ip=d4(["\n  position: sticky;\n  top: 0;\n  z-index: 1;\n"]))),Ah=[];function Af(e){let{changelog:t,currentVersion:n,dialogProps:i,latestVersion:r}=e,l=(t||Ah).filter(e=>{var t;return(null==(t=(null==e?void 0:e.changeItems)||Ah)?void 0:t.length)>0}),a=l.length>0;return(0,rz.jsx)(rN.Vq,d6(d6({header:"Upgrade the Sanity Studio",width:1},i),{},{id:"changelog-dialog",children:(0,rz.jsxs)(rz.Fragment,{children:[(0,rz.jsx)(Ap,{children:(0,rz.jsx)(rN.Zb,{padding:4,borderBottom:a,children:(0,rz.jsx)(rN.Kq,{space:4,children:(0,rz.jsxs)(rN.Kq,{space:3,children:[a&&(0,rz.jsx)(rN.xv,{weight:"semibold",children:"Changelog"}),n&&r&&(0,rz.jsxs)(rN.xv,{muted:!0,size:1,children:["Your Sanity Studio is version ",(0,rz.jsx)("code",{children:n}),". The latest version is ",(0,rz.jsx)("code",{children:r}),"."]})]})})})}),a&&(0,rz.jsx)(rN.Kq,{space:5,paddingY:4,children:null==l?void 0:l.map((e,t)=>{let{changeItems:n,version:i}=e,a=t<l.length-1;return(0,rz.jsxs)(rF.Fragment,{children:[(0,rz.jsx)(rN.xu,{paddingX:4,children:(0,rz.jsx)(Au,{changeItems:n||Ah,version:i,isLatest:i===r})}),a&&(0,rz.jsx)(rN.R,{})]},i)})})]})}))}let Am={sanity:"3.1.4"},Ag=new Map,Ax=["npm install sanity@latest"],Av=(0,lO.ZP)(lL.tgp)(ih||(ih=d4(["\n  &[data-rotate='true'] {\n    transform: rotate(90deg);\n  }\n"])));function Ab(e){let{defaultOpen:t}=e,[n,i]=(0,rF.useState)(t),r=(0,rF.useCallback)(()=>i(e=>!e),[]);return(0,rz.jsxs)(rN.Zb,{overflow:"hidden",children:[(0,rz.jsx)(rN.Kq,{children:(0,rz.jsx)(rN.zx,{"aria-controls":"upgrade-commands",icon:(0,rz.jsx)(Av,{"data-rotate":n}),justify:"flex-start",mode:"bleed",onClick:r,padding:4,radius:0,space:2,text:"How to upgrade"})}),(0,rz.jsx)(rN.Zb,{"aria-hidden":!n,hidden:!n,id:"upgrade-commands",overflow:"auto",paddingX:4,paddingY:2,role:"region",tone:"inherit",children:(0,rz.jsxs)(rN.Kq,{space:2,children:[(0,rz.jsx)(rN.Zb,{tone:"transparent",padding:3,radius:2,children:(0,rz.jsx)(rN.Kq,{space:3,children:(0,rz.jsx)(rN.EK,{language:"bash",size:1,children:["# Run this command to upgrade",...Ax].join("\n")})})}),(0,rz.jsx)(rN.xu,{paddingX:2,paddingY:3,children:(0,rz.jsxs)(rN.xv,{size:1,muted:!0,children:["If you have problems upgrading, please get in touch with us in the"," ",(0,rz.jsx)("a",{href:"https://slack.sanity.io/",rel:"noopener noreferrer",target:"_blank",children:"Sanity Community"}),"."]})})]})})]})}let Ay=[];function Aj(){let[e,t]=(0,rF.useState)(!1),[n,i]=(0,rF.useState)(null),r=IW(uX),l=(0,rF.useMemo)(()=>r.withConfig({apiVersion:"1"}),[r]),{scheme:a}=E8(),{value:o,error:s,isLoading:d}=function(e){let t=(0,rF.useMemo)(()=>(function(e){let{moduleVersions:t=Am,client:n}=e,i={m:Object.keys(t).sort().filter(e=>t[e]).map(e=>"".concat(e,"@").concat(t[e]))},r=i.m.join(",").replace(/@?sanity[/-]/g,""),l=Ag.get(r);return l||(l=n.observable.request({url:"/versions",query:i,json:!0,tag:"module.version-check"}).pipe((0,r8.U)(e=>d6(d6({},e),{},{installed:t})),(0,ln.d)(1)),Ag.set(r,l)),l})(e),[e]);return cZ(t)}({client:l}),{changelog:c,currentVersion:u,latestVersion:p,isUpToDate:h}=o||{},f=(0,rF.useCallback)(()=>t(!0),[]),m=(0,rF.useCallback)(()=>{t(!1),n&&n.focus()},[n]),g=(0,rF.useMemo)(()=>({footer:(0,rz.jsx)(Ab,{defaultOpen:mD}),onClickOutside:m,onClose:m,scheme:a}),[m,a]);return s||d||h?null:(0,rz.jsxs)(rz.Fragment,{children:[(0,rz.jsx)(TQ,{active:!0,icon:lL.jtq,mode:"bleed",onClick:f,ref:i,selected:e,statusTone:"primary"}),e&&(0,rz.jsx)(Af,{changelog:c||Ay,currentVersion:u,dialogProps:g,latestVersion:p})]})}function Aw(){var e;let t=I3(),n=(null==(e=t._validation)?void 0:e.filter(e=>e.problems.some(e=>"warning"===e.severity)))||[],{scheme:i}=E8(),r=(0,rF.useId)(),[l,a]=(0,rF.useState)(!1),[o,s]=(0,rF.useState)(null),d=(0,rF.useCallback)(()=>a(!0),[]),c=(0,rF.useCallback)(()=>{a(!1),o&&o.focus()},[o]);return 0===n.length?null:(0,rz.jsxs)(rz.Fragment,{children:[(0,rz.jsx)(rN.u,{content:(0,rz.jsx)(rN.xu,{padding:2,children:(0,rz.jsx)(rN.xv,{size:1,children:"Found configuration issues"})}),placement:"bottom",portal:!0,scheme:i,children:(0,rz.jsx)(rN.xu,{children:(0,rz.jsx)(rN.zx,{icon:lL.foC,mode:"bleed",tone:"caution",onClick:d,ref:s,selected:l})})}),l&&(0,rz.jsx)(rN.Vq,{header:(0,rz.jsxs)(rN.Kq,{space:3,children:[(0,rz.jsx)(rN.xv,{weight:"semibold",children:"Configuration issues"}),(0,rz.jsx)(rN.xv,{muted:!0,size:1,children:"Configuration checks are only performed during development and will not be visible in production builds"})]}),width:2,onClickOutside:c,onClose:c,scheme:i,id:r,children:(0,rz.jsxs)(rN.Kq,{space:4,padding:4,children:[(0,rz.jsxs)(rN.X6,{as:"h2",size:1,children:["Found ",n.length," schema warnings"]}),(0,rz.jsx)(Tp,{problemGroups:n})]})})]})}function Ak(e){let{title:t,children:n,href:i,onClick:r}=e;return(0,rz.jsx)(rN.zx,{"aria-label":t,as:"a","data-testid":"logo",href:i,mode:"bleed",onClick:r,padding:0,children:n})}let AC=(0,rF.createContext)(void 0);function A_(){let e=(0,rF.useContext)(AC);if(void 0===e)throw Error("useCommandList must be used within a CommandListProvider");return e}let AS=(0,lO.ZP)(rN.kC)(im||(im=d4(["\n  &[data-focused='true'],\n  &[data-hovered='true'] {\n    [data-active='true'] {\n      [data-command-list-item]:not(:active) {\n        background: ",";\n        // Disable box-shadow to hide the halo effect when we have keyboard focus over a selected <Button>\n        box-shadow: none;\n      }\n    }\n  }\n"])),e=>{let{theme:t}=e;return t.sanity.color.button.bleed.default.hovered.bg});function AE(e){let{children:t}=e,{setContainerElement:n}=A_();return(0,rz.jsx)(AS,{ref:n,children:t})}function AT(e,t){return t?e.find(e=>e.type===t):void 0}function AA(e,t){var n;return{fieldId:t,filterName:e.name,operatorType:(null==(n=null==e?void 0:e.operators.find(e=>"item"===e.type))?void 0:n.name)||""}}function AP(e){let{fieldDefinitions:t,filterDefinitions:n,filters:i,operatorDefinitions:r}=e;return i.filter(e=>AR({filter:e,filterDefinitions:n,fieldDefinitions:t,operatorDefinitions:r})).map(e=>{var i;return null==(i=AT(r,e.operatorType))?void 0:i.groqFilter({fieldPath:function(e){let{filter:t,fieldDefinitions:n,filterDefinitions:i}=e,r=n.find(e=>e.id===(null==t?void 0:t.fieldId)),l=Sa(i,t.filterName);if(l)switch(l.type){case"field":return null==r?void 0:r.fieldPath;case"pinned":return null==l?void 0:l.fieldPath;default:return}}({filter:e,fieldDefinitions:t,filterDefinitions:n}),value:null==e?void 0:e.value})}).filter(e=>!oe()(e)).filter(cf).join(" && ")}function AI(e,t){return e.find(e=>e.id===(null==t?void 0:t.fieldId))}function AM(e){return[e.filterName,...e.fieldId?[e.fieldId]:[]].join("-")}function Az(e){let{fieldDefinitions:t,filters:n,types:i}=e,r=i.map(e=>e.name),l=t.filter(e=>n.map(e=>null==e?void 0:e.fieldId).includes(e.id)).filter(e=>e.documentTypes.length>0).map(e=>e.documentTypes),a=aM()(...l),o=[];return r.length>0&&o.push(r),a.length>0&&o.push(a),aM()(...o).sort()}function AR(e){let{filter:t,filterDefinitions:n,fieldDefinitions:i,operatorDefinitions:r}=e,l=Sa(n,t.filterName),a=AT(r,t.operatorType),o=AI(i,t);if(!l||!a||t.fieldId&&!o)return!1;if("field"===l.type){if(!(null==o?void 0:o.fieldPath)||!t.fieldId)return!1;let s=a.groqFilter({fieldPath:o.fieldPath,value:t.value});if(!s)return!1}if("pinned"===l.type){let d=a.groqFilter({fieldPath:l.fieldPath,value:t.value});if(!d)return!1}return!0}let AF=(0,ot.ZP)("escape"),AO=lO.ZP.div(ig||(ig=d4(["\n  background: transparent;\n  height: 100%;\n  left: 0;\n  position: fixed;\n  top: 0;\n  width: 100%;\n  z-index: -1;\n"])));function AD(e){let{anchorElement:t,children:n,onClose:i}=e,{isTopLayer:r}=(0,rN.sJ)(),l=(0,rF.useCallback)(e=>{AF(e)&&r&&i()},[r,i]);(0,rN.qh)(l);let a=function(e){let[t,n]=(0,rF.useState)(e&&AZ(e)),i=(0,rF.useCallback)(()=>{e&&n(AZ(e))},[e]);return(0,rF.useEffect)(()=>{e&&n(AZ(e))},[e]),(0,rF.useEffect)(()=>(window.addEventListener("resize",i),()=>window.removeEventListener("resize",i)),[i]),t}(t||null);return(0,rz.jsxs)(rz.Fragment,{children:[(0,rz.jsx)(AO,{onClick:i}),(0,rz.jsx)(a7.ZP,{autoFocus:!1,returnFocus:!0,children:(0,rz.jsx)(rN.Zb,{display:"flex",overflow:"hidden",radius:2,style:{maxHeight:"min(calc(100vh - ".concat(a,"px - ").concat(5,"px - ").concat(SS,"px), ").concat(500,"px"),zIndex:1},children:(0,rz.jsx)(rN.kC,{children:n})})})]})}function AZ(e){let t=e.getBoundingClientRect(),n=t.y+t.height+5;return n}let AL="undefined"!=typeof window&&"ontouchstart"in window;function Aq(e){let{ariaActiveDescendant:t=!0,ariaChildrenLabel:n,ariaHeaderLabel:i,ariaMultiselectable:r=!1,autoFocus:l,children:a,initialSelectedIndex:o,itemIndices:s,itemIndicesSelected:d}=e,c=(0,rF.useRef)(-1),[u,p]=(0,rF.useState)(null),[h,f]=(0,rF.useState)(null),[m,g]=(0,rF.useState)(null),[x,v]=(0,rF.useState)(null),b=s.filter(cf).length,y=(0,rF.useId)(),j=(0,rF.useRef)(null),w=(0,rF.useCallback)(e=>null==x?void 0:x.setAttribute("data-enabled",(!e).toString()),[x]),k=(0,rF.useCallback)(e=>"".concat(y,"-item-").concat(e),[y]),C=(0,rF.useCallback)(()=>{let e=null==c?void 0:c.current;t?null==m||m.setAttribute("aria-activedescendant",k(e)):null==m||m.removeAttribute("aria-activedescendant");let n=Array.from((null==u?void 0:u.children)||[]);null==n||n.forEach(t=>{var n;let i=Number(null==(n=t.dataset)?void 0:n.index),r=s[i];"number"==typeof r&&(t.setAttribute("aria-posinset",(r+1).toString()),d&&t.setAttribute("aria-selected",d[i].toString()),t.setAttribute("aria-setsize",b.toString()),t.setAttribute("data-active",(r===e).toString()),t.setAttribute("id",k(r)),t.setAttribute("role","option"),t.setAttribute("tabIndex","-1"))})},[b,t,u,k,m,s,d]),_=(0,rF.useMemo)(()=>lF()(C,200),[C]),S=(0,rF.useCallback)(()=>{let e=null==u?void 0:u.parentElement;if(e&&u){let t=e.getBoundingClientRect().top,n=u.getBoundingClientRect().top;return Math.floor((t-n)/59)}return -1},[u]),E=(0,rF.useCallback)(e=>{var t;let{index:n,scrollAlign:i=!1,scrollIntoView:r=!0}=e;if(c.current=n,C(),r){let l=s.indexOf(n);null==(t=null==j?void 0:j.current)||t.call(j,l,i?{align:"start"}:{})}},[C,s]),T=(0,rF.useCallback)(()=>{AL||null==m||m.focus()},[m]),A=(0,rF.useCallback)(e=>{T(),e.preventDefault()},[T]),P=(0,rF.useCallback)(e=>function(){E({index:e,scrollIntoView:!1})},[E]),I=(0,rF.useCallback)(e=>{j.current=e},[]),M=(0,rF.useCallback)(e=>{let t=-1;"next"===e&&(t=c.current<b-1?c.current+1:0),"previous"===e&&(t=c.current>0?c.current-1:b-1),E({index:t,scrollIntoView:!0}),w(!1)},[b,w,E]);return(0,rF.useEffect)(()=>{void 0!==o&&E({index:o,scrollAlign:!0,scrollIntoView:!0})},[o,E]),(0,rF.useEffect)(()=>{function e(){w(!0)}return document.addEventListener("mousemove",e),()=>{document.removeEventListener("mousemove",e)}},[w]),(0,rF.useEffect)(()=>{function e(e){let t=Array.from((null==u?void 0:u.children)||[]);if(t.length&&("ArrowDown"===e.key&&(e.preventDefault(),M("next")),"ArrowUp"===e.key&&(e.preventDefault(),M("previous")),"Enter"===e.key)){e.preventDefault();let n=t.find(e=>Number(e.dataset.index)===s.indexOf(c.current));if(n){let i=null==n?void 0:n.querySelector("[data-command-list-item]");null==i||i.click()}}}return null==m||m.addEventListener("keydown",e),()=>{null==m||m.removeEventListener("keydown",e)}},[u,m,s,M]),(0,rF.useEffect)(()=>{function e(e){"ArrowDown"===e.key&&(e.preventDefault(),T(),M("next")),"ArrowUp"===e.key&&(e.preventDefault(),T(),M("previous"))}return null==h||h.addEventListener("keydown",e),()=>{null==h||h.removeEventListener("keydown",e)}},[u,h,T,m,M]),(0,rF.useEffect)(()=>{function e(e){return()=>null==h?void 0:h.setAttribute("data-focused",e.toString())}return null==m||m.addEventListener("blur",e(!1)),null==m||m.addEventListener("focus",e(!0)),()=>{null==m||m.removeEventListener("blur",e(!1)),null==m||m.removeEventListener("focus",e(!0))}},[a,h,m]),(0,rF.useEffect)(()=>{function e(e){return()=>null==h?void 0:h.setAttribute("data-hovered",e.toString())}return null==u||u.addEventListener("mouseenter",e(!0)),null==u||u.addEventListener("mouseleave",e(!1)),()=>{null==u||u.removeEventListener("mouseenter",e(!0)),null==u||u.removeEventListener("mouseleave",e(!1))}},[u,h]),(0,rF.useEffect)(()=>{w(!1)},[b,w]),(0,rF.useEffect)(()=>{C()},[C,s]),(0,rF.useEffect)(()=>{let e=new MutationObserver(_);return u&&e.observe(u,{childList:!0,subtree:!0}),()=>{e.disconnect()}},[u,_]),(0,rF.useEffect)(()=>{null==u||u.setAttribute("aria-multiselectable",r.toString()),null==u||u.setAttribute("aria-label",n),null==u||u.setAttribute("role","listbox"),null==h||h.setAttribute("id","".concat(y,"-children")),null==m||m.setAttribute("aria-autocomplete","list"),null==m||m.setAttribute("aria-expanded","true"),null==m||m.setAttribute("aria-controls","".concat(y,"-children")),null==m||m.setAttribute("aria-label",i),null==m||m.setAttribute("role","combobox"),null==x||x.setAttribute("data-enabled","true")},[n,i,r,u,y,h,m,x]),(0,rF.useEffect)(()=>{l&&T()},[l,T]),(0,rz.jsx)(AC.Provider,{value:{focusHeaderInputElement:T,getTopIndex:S,itemIndices:s,onChildMouseDown:A,onChildMouseEnter:P,setChildContainerElement:p,setContainerElement:f,setHeaderInputElement:g,setPointerOverlayElement:v,setVirtualListScrollToIndex:I},children:a})}let AN=(0,lO.ZP)(rN.xu)(ix||(ix=d4(["\n  border-bottom: 1px solid ",";\n  flex-shrink: 0;\n"])),e=>{let{theme:t}=e;return t.sanity.color.base.border}),AV=(0,lO.ZP)(rN.kC)(iv||(iv=d4(["\n  box-sizing: border-box;\n"])));function AB(e){let{onChange:t,onClear:n,typeFilter:i}=e,{state:{fullscreen:r}}=Sm(),{setHeaderInputElement:l}=A_();return(0,rz.jsx)(AN,{children:(0,rz.jsx)(AV,{align:"center",flex:1,padding:1,children:(0,rz.jsx)(Er,{autoComplete:"off",border:!1,clearButton:!!i,fontSize:r?2:1,icon:lL.W1M,muted:!0,onChange:t,onClear:n,placeholder:"Filter",ref:l,smallClearButton:!0,spellCheck:!1,radius:2,value:i})})})}function AU(e){let{activeIndex:t=-1,children:n,fixedHeight:i,measure:r,virtualRow:l}=e,a=d3(e,dD),{onChildMouseDown:o,onChildMouseEnter:s}=A_();return(0,rz.jsx)(rN.xu,d6(d6({onMouseDown:o,onMouseEnter:s(t),ref:r,style:d6(d6({flex:1},i?{height:"".concat(l.size,"px")}:{}),{},{left:0,position:"absolute",top:0,transform:"translateY(".concat(l.start,"px)"),width:"100%"})},a),{},{children:n}))}let AK=lO.ZP.div(ib||(ib=d4(["\n  bottom: 0;\n  display: none;\n  left: 0;\n  position: absolute;\n  right: 0;\n  top: 0;\n  z-index: 1;\n\n  @media (hover: hover) {\n    &[data-enabled='true'] {\n      display: block;\n    }\n  }\n"]))),AH=(0,lO.ZP)(rN.xu)(iy||(iy=d4(["\n  height: 100%;\n  outline: none;\n  overflow-x: hidden;\n  overflow-y: auto;\n  overscroll-behavior: contain;\n  width: 100%;\n"]))),A$=(0,lO.ZP)(rN.xu)(ij||(ij=d4(["\n  height: ",";\n  position: relative;\n  width: 100%;\n"])),e=>{let{$height:t}=e;return"".concat(t,"px")});function AX(e){let{children:t,setVirtualListRef:n,totalHeight:i}=e,r=d3(e,dZ),{setChildContainerElement:l,setPointerOverlayElement:a}=A_();return(0,rz.jsxs)(AH,{ref:n,tabIndex:-1,children:[(0,rz.jsx)(AK,{"aria-hidden":"true",ref:a}),(0,rz.jsx)(A$,d6(d6({$height:i,flex:1,ref:l},r),{},{children:t}))]})}function AW(e){let{filter:t,maxLength:n}=e,{state:{definitions:i}}=Sm(),r=(0,rF.useMemo)(()=>{let e=Sa(i.filters,t.filterName);switch(null==e?void 0:e.type){case"field":{let n=AI(i.fields,t);if(null==n?void 0:n.titlePath)return n.titlePath[n.titlePath.length-1];return null}case"pinned":return e.title;default:return null}},[i,t]);return r?n&&r.length>n?(0,rz.jsxs)("span",{children:[r.slice(0,n),"…"]}):(0,rz.jsx)("span",{children:r}):null}function AG(e){var t;let{filter:n}=e,{state:{definitions:i}}=Sm(),r=null==(t=Sa(i.filters,n.filterName))?void 0:t.icon;return r?(0,rF.createElement)(r):(0,rz.jsx)(lL.Tzq,{})}function AY(e){var t;let{filter:n,small:i=!0}=e,{state:{definitions:r}}=Sm(),l=AI(r.fields,n);return(0,rz.jsxs)(rN.Kq,{space:i?2:3,children:[(null==l?void 0:l.titlePath)&&(null==(t=l.titlePath)?void 0:t.length)>1&&(0,rz.jsx)(rN.xu,{marginLeft:4,children:(0,rz.jsx)(rN.xv,{muted:!0,size:i?0:1,children:l.titlePath.slice(0,-1).map((e,t)=>(0,rz.jsxs)(rF.Fragment,{children:[(0,rz.jsx)("span",{children:e}),t!==l.titlePath.length-2&&(0,rz.jsx)("span",{style:{opacity:.75,paddingLeft:"0.25em",paddingRight:"0.25em"},children:(0,rz.jsx)(lL.XCv,{})})]},t))})}),(0,rz.jsxs)(rN.kC,{align:"flex-start",gap:3,children:[(0,rz.jsx)(rN.xu,{style:{flexShrink:0},children:(0,rz.jsx)(rN.xv,{size:i?1:2,children:(0,rz.jsx)(AG,{filter:n})})}),(0,rz.jsx)(rN.xv,{size:i?1:2,weight:"medium",children:(0,rz.jsx)(AW,{filter:n})})]})]})}function AJ(e){let{children:t,fieldDefinition:n,filterDefinition:i,visible:r}=e,{state:{documentTypesNarrowed:l}}=Sm(),a=I3(),o=(0,rF.useMemo)(()=>(null==n?void 0:n.documentTypes)?n.documentTypes.map(e=>{let t=a.get(e);return(null==t?void 0:t.title)||l$()(null==t?void 0:t.name)}).filter(cf).sort():[],[null==n?void 0:n.documentTypes,a]),s=(0,rF.useMemo)(()=>{if(null==n?void 0:n.documentTypes){let e=n.documentTypes.map(e=>{let t=a.get(e);if(t){let i=Sv(t,n.fieldPath);return null==i?void 0:i.type.description}return null}).sort(),t=aV()(e);if(1===t.length)return t[0]}},[null==n?void 0:n.documentTypes,null==n?void 0:n.fieldPath,a]);return(0,rz.jsx)(rN.u,{content:(0,rz.jsx)(rN.Zb,{tone:"default",radius:2,style:{maxWidth:"250px"},children:(0,rz.jsxs)(rN.Kq,{padding:3,space:4,children:[n&&(0,rz.jsxs)(rN.Kq,{space:2,children:[(0,rz.jsx)(rN.__,{muted:!0,size:0,children:"Field name"}),(0,rz.jsx)(rN.gF,{children:(0,rz.jsx)(rN.Zb,{tone:"caution",padding:1,radius:2,children:(0,rz.jsx)(rN.EK,{size:0,children:null==n?void 0:n.name})})})]}),s&&(0,rz.jsxs)(rN.Kq,{space:3,children:[(0,rz.jsx)(rN.__,{muted:!0,size:0,children:"Field description"}),(0,rz.jsx)(rN.xv,{muted:!0,size:0,children:AQ(s)})]}),(null==i?void 0:i.description)&&(0,rz.jsx)(rN.xv,{muted:!0,size:0,children:AQ(i.description)}),!l.length&&o.length>0&&(0,rz.jsxs)(rN.Kq,{space:2,children:[(0,rz.jsxs)(rN.kC,{align:"center",gap:1,children:[(0,rz.jsx)(rN.__,{muted:!0,size:0,children:"Used in document types"}),(0,rz.jsx)(rN.Zb,{padding:1,radius:2,tone:"transparent",children:(0,rz.jsx)(rN.xv,{size:0,muted:!0,children:o.length})})]}),(0,rz.jsxs)(rN.xv,{size:0,weight:"regular",muted:!0,children:[o.slice(0,10).join(", "),(null==o?void 0:o.length)>10?" +".concat(o.length-10," more"):""]})]})]})}),disabled:!r,fallbackPlacements:["left"],placement:"right",portal:!0,children:t})}function AQ(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:256;return e.length>t?"".concat(e.slice(0,t-1),"…"):e}let A0=rF.memo(function(e){let{item:t,onClose:n}=e,i=d3(e,dL),[r,l]=(0,rF.useState)(!1),{dispatch:a,state:{filters:o}}=Sm(),s=(0,rF.useCallback)(()=>{a({filter:t.filter,type:"TERMS_FILTERS_ADD"}),null==n||n()},[a,t.filter,n]),d=!!o.find(e=>AM(e)===AM(t.filter)),c=(0,rF.useRef)(),u=(0,rF.useCallback)(()=>{c.current=setTimeout(()=>l(!0),500)},[]),p=(0,rF.useCallback)(()=>{l(!1),clearTimeout(c.current)},[]);(0,rF.useEffect)(()=>()=>clearTimeout(c.current),[]);let h=!!(t.fieldDefinition||t.filterDefinition.description);return(0,rz.jsx)(rN.xu,d6(d6({},i),{},{children:(0,rz.jsx)(rN.zx,{"data-command-list-item":!0,disabled:d,fontSize:1,justify:"flex-start",mode:"bleed",onClick:d?void 0:s,onMouseEnter:u,onMouseLeave:p,padding:0,style:{position:"relative",whiteSpace:"normal",width:"100%"},tabIndex:-1,tone:null==t?void 0:t.tone,children:(0,rz.jsx)(AJ,{fieldDefinition:t.fieldDefinition,filterDefinition:t.filterDefinition,visible:h&&r,children:(0,rz.jsx)(rN.xu,{padding:3,children:(0,rz.jsx)(AY,{filter:t.filter})})})})}))}),A1=rF.memo(function(e){let{item:t}=e;return(0,rz.jsx)(rN.xu,{paddingTop:1,children:(0,rz.jsx)(rN.Zb,{borderBottom:!0,padding:3,tone:null==t?void 0:t.tone,children:(0,rz.jsx)(rN.__,{muted:!0,size:0,textOverflow:"ellipsis",children:t.title})})})});function A2(e){let{menuItems:t,onClose:n}=e,[i,r]=(0,rF.useState)(null),{itemIndices:l,setVirtualListScrollToIndex:a}=A_(),{getTotalSize:o,getVirtualItems:s,measureElement:d,scrollToIndex:c}=(0,on.MG)({count:t.length,estimateSize:()=>45,getItemKey:e=>{let n=t[e];switch(n.type){case"filter":return[...n.group?[n.group]:[],AM(n.filter)].join("-");case"header":return"".concat(n.type,"-").concat(n.title);default:return e}},getScrollElement:()=>i,overscan:20});return(0,rF.useEffect)(()=>{c(0)},[t.length,c]),(0,rF.useEffect)(()=>{a(c)},[a,c]),(0,rz.jsx)(AX,{paddingBottom:1,setVirtualListRef:r,totalHeight:o(),children:s().map(e=>{var i;let r=t[e.index];return(0,rz.jsxs)(AU,{activeIndex:"filter"===r.type&&null!=(i=l[e.index])?i:-1,"data-index":e.index,measure:d,virtualRow:e,children:["filter"===r.type&&(0,rz.jsx)(A0,{item:r,onClose:n,paddingTop:1,paddingX:1}),"header"===r.type&&(0,rz.jsx)(A1,{item:r})]},e.key)})})}function A3(e){let{fieldDefinitions:t,filterDefinitions:n,filters:i,id:r,headerTitle:l,tone:a}=e,o=i.map(e=>({fieldDefinition:AI(t,e),filterDefinition:Sa(n,e.filterName),filter:e,group:r,tone:a||"default",type:"filter"}));return o.length>0?[...l?[{title:l||"",tone:a||"default",type:"header"}]:[],...o]:[]}function A4(e,t){return e.title.toLowerCase().includes(t.toLowerCase())}function A5(e){return"pinned"===e.type&&void 0!==(null==e?void 0:e.group)}function A6(e){return"pinned"===e.type&&void 0===(null==e?void 0:e.group)}function A8(e){let{onClose:t}=e,[n,i]=(0,rF.useState)(""),r=(0,rF.useCallback)(e=>i(e.currentTarget.value),[i]),l=(0,rF.useCallback)(()=>i(""),[]),a=I3(),{state:{documentTypesNarrowed:o,definitions:s,terms:{types:d}}}=Sm(),c=(0,rF.useMemo)(()=>(function(e){let{documentTypesNarrowed:t,fieldDefinitions:n,filterDefinitions:i,schema:r,titleFilter:l,types:a}=e,o=n.filter(e=>(function(e,t){let n=e.titlePath.join("/");return n.toLowerCase().includes(t.toLowerCase())})(e,l)).map(e=>{let t=Sa(i,e.filterName);return t?AA(t,e.id):null}).filter(cf),s=function(e){let{fieldDefinitions:t,filterDefinitions:n,titleFilter:i}=e,r=n.filter(A6).filter(e=>A4(e,i)).map(e=>AA(e)),l=n.filter(A5).filter(e=>A4(e,i)).reduce((e,t)=>(e[t.group]=e[t.group]||[],e[t.group].push(AA(t)),e),{});return[...A3({fieldDefinitions:t,filterDefinitions:n,filters:r,id:"pinned-ungrouped",tone:"primary"}),...Object.entries(l).flatMap(e=>{let[i,r]=e;return A3({fieldDefinitions:t,filterDefinitions:n,filters:r,headerTitle:i,id:i,tone:"primary"})})]}({fieldDefinitions:n,filterDefinitions:i,titleFilter:l});return 0===t.length?[...s,...A3({fieldDefinitions:n,filterDefinitions:i,filters:o,headerTitle:"All fields",id:"field"})]:[...s,...function(e){let{documentTypesNarrowed:t,fieldDefinitions:n,filterDefinitions:i,filters:r,schema:l,types:a}=e,o=r.filter(e=>{let i=AI(n,e);return 0===o3()(t,(null==i?void 0:i.documentTypes)||[]).length}),s=t.length>1&&a.length>1?A3({fieldDefinitions:n,filterDefinitions:i,filters:o,headerTitle:"Shared fields",id:"shared",tone:"primary"}):[],d=t.map(e=>{let t=l.get(e);return{title:(null==t?void 0:t.title)||l$()(null==t?void 0:t.name)||"(Unknown type)",documentType:e}}).sort((e,t)=>e.title.localeCompare(t.title)).map(e=>{let{documentType:t,title:l}=e,a=r.filter(e=>{var i;let r=AI(n,e);return i=[t],null==r?void 0:r.documentTypes.some(e=>i.includes(e))});return A3({fieldDefinitions:n,filterDefinitions:i,filters:a,id:l,headerTitle:l})}).flat();return[...s,...d]}({documentTypesNarrowed:t,fieldDefinitions:n,filterDefinitions:i,filters:o,schema:r,types:a})]})({documentTypesNarrowed:o,fieldDefinitions:s.fields,filterDefinitions:s.filters,schema:a,titleFilter:n,types:d}),[o,s.fields,s.filters,a,n,d]),u=(0,rF.useMemo)(()=>{let e=-1;return c.reduce((t,n,i)=>{let r="filter"===n.type;return r&&(e+=1),t[i]=r?e:null,t},[])},[c]);return(0,rz.jsx)(Aq,{ariaActiveDescendant:c.length>0,ariaChildrenLabel:"Filters",ariaHeaderLabel:"Filter by title",autoFocus:!0,itemIndices:u,children:(0,rz.jsxs)(rN.kC,{direction:"column",style:{width:"300px"},children:[(0,rz.jsx)(AB,{onChange:r,onClear:l,typeFilter:n}),(0,rz.jsxs)(AE,{children:[c.length>0&&(0,rz.jsx)(A2,{menuItems:c,onClose:t}),0==c.length&&(0,rz.jsx)(rN.xu,{padding:3,children:(0,rz.jsxs)(rN.xv,{muted:!0,size:1,textOverflow:"ellipsis",children:["No matches for '",n,"'"]})})]})]})})}function A7(){let[e,t]=(0,rF.useState)(!1),[n,i]=(0,rF.useState)(null),{state:{fullscreen:r}}=Sm(),l=(0,rF.useCallback)(()=>t(!1),[]),a=(0,rF.useCallback)(()=>t(!0),[]);return(0,rz.jsx)(rN.J2,{__unstable_margins:[5,0,0,0],content:(0,rz.jsx)(AD,{anchorElement:n,onClose:l,children:(0,rz.jsx)(A8,{onClose:l})}),open:e,placement:"bottom-start",radius:2,portal:!0,children:(0,rz.jsx)(rN.zx,{fontSize:1,icon:lL.dtP,mode:"bleed",onClick:a,padding:r?3:2,ref:i,space:2,text:"Add filter"})})}let A9=rF.memo(function(e){var t,n;let{selected:i,type:r}=e,l=d3(e,dq),{dispatch:a}=Sm(),o=(0,rF.useCallback)(()=>{a({type:"TERMS_TYPE_ADD",schemaType:r})},[a,r]),s=(0,rF.useCallback)(()=>{a({type:"TERMS_TYPE_REMOVE",schemaType:r})},[a,r]),d=(0,rF.useCallback)(()=>{i?s():o()},[o,s,i]);return(0,rz.jsx)(rN.xu,d6(d6({},l),{},{children:(0,rz.jsx)(rN.zx,{"data-command-list-item":!0,fontSize:1,iconRight:i&&lL.KML,justify:"flex-start",mode:"bleed",onClick:d,selected:i,style:{width:"100%"},tabIndex:-1,text:null!=(n=r.title)?n:r.name,tone:i?"primary":"default"},null!=(t=r.title)?t:r.name)}))});function Pe(e){let{filteredItems:t}=e,{state:{terms:{types:n}}}=Sm(),[i,r]=(0,rF.useState)(null),{getTotalSize:l,getVirtualItems:a,measureElement:o,scrollToIndex:s}=(0,on.MG)({count:t.length,estimateSize:()=>37,getItemKey:e=>{let n=t[e];switch(n.type){case"divider":return"".concat(n.type,"-").concat(e);case"header":return"".concat(n.type,"-").concat(n.title);case"item":return"".concat(n.type,"-").concat(n.item.name);default:return e}},getScrollElement:()=>i,overscan:20}),{itemIndices:d,setVirtualListScrollToIndex:c}=A_();return(0,rF.useEffect)(()=>{0===n.length&&s(0)},[s,n.length]),(0,rF.useEffect)(()=>{c(s)},[c,s]),(0,rz.jsx)(AX,{paddingBottom:1,setVirtualListRef:r,totalHeight:l(),children:a().map(e=>{var n;let i=t[e.index];return(0,rz.jsxs)(AU,{activeIndex:"item"===i.type&&null!=(n=d[e.index])?n:-1,"data-index":e.index,measure:o,virtualRow:e,children:["divider"===i.type&&(0,rz.jsx)(rN.xu,{padding:1,children:(0,rz.jsx)(rN.R,{})}),"header"===i.type&&(0,rz.jsx)(rN.xu,{margin:1,paddingBottom:2,paddingTop:3,paddingX:3,children:(0,rz.jsx)(rN.__,{muted:!0,size:0,children:i.title})}),"item"===i.type&&(0,rz.jsx)(A9,{paddingX:1,paddingTop:1,selected:i.selected,type:i.item},e.key)]},e.key)})})}let Pt=(0,lO.ZP)(rN.xu)(iw||(iw=d4(["\n  border-top: 1px solid ",";\n  flex-shrink: 0;\n"])),e=>{let{theme:t}=e;return t.sanity.color.base.border});function Pn(){let[e,t]=(0,rF.useState)(""),n=I3(),{dispatch:i,state:{terms:{types:r}}}=Sm(),[l,a]=(0,rF.useState)(r),o=(0,rF.useMemo)(()=>{let[t,i]=aO()(ST(n).filter(t=>{var n;return!e||(null!=(n=t.title)?n:t.name).toLowerCase().includes(null==e?void 0:e.toLowerCase())}).sort(SA),e=>l.includes(e)),a=t.length>0,o=t.length>0,s=[];return a&&s.push({title:"Selected",type:"header"}),t.forEach(e=>s.push({item:e,selected:r.includes(e),type:"item"})),a&&o&&s.push({type:"divider"}),i.forEach(e=>s.push({item:e,selected:r.includes(e),type:"item"})),s},[n,r,l,e]),s=(0,rF.useCallback)(e=>t(e.currentTarget.value),[t]),d=(0,rF.useCallback)(()=>t(""),[]),c=(0,rF.useCallback)(()=>{a([]),i({type:"TERMS_TYPES_CLEAR"})},[i]),u=(0,rF.useMemo)(()=>{let e=-1;return o.reduce((t,n,i)=>{let r="item"===n.type;return r&&(e+=1),t[i]=r?e:null,t},[])},[o]),p=(0,rF.useMemo)(()=>o.map(e=>"item"===e.type&&e.selected),[o]);return(0,rz.jsx)(Aq,{ariaActiveDescendant:o.length>0,ariaChildrenLabel:"Document types",ariaHeaderLabel:"Filter by document type",ariaMultiselectable:!0,autoFocus:!0,itemIndices:u,itemIndicesSelected:p,children:(0,rz.jsxs)(rN.kC,{direction:"column",style:{width:"250px"},children:[(0,rz.jsx)(AB,{onChange:s,onClear:d,typeFilter:e}),(0,rz.jsxs)(AE,{children:[o.length>0&&(0,rz.jsx)(Pe,{filteredItems:o}),!o.length&&(0,rz.jsx)(rN.xu,{padding:3,children:(0,rz.jsxs)(rN.xv,{muted:!0,size:1,textOverflow:"ellipsis",children:["No matches for '",e,"'"]})})]}),!e&&r.length>0&&(0,rz.jsx)(Pi,{onClick:c,selectedTypes:r})]})})}function Pi(e){let{onClick:t,selectedTypes:n}=e,{focusHeaderInputElement:i}=A_(),r=(0,rF.useCallback)(()=>{i(),null==t||t()},[i,t]);return(0,rz.jsx)(Pt,{padding:1,children:(0,rz.jsx)(rN.Kq,{children:(0,rz.jsx)(rN.zx,{"aria-label":"Clear checked filters","data-name":"type-filter-button",disabled:0===n.length,fontSize:1,mode:"bleed",onClick:r,padding:3,text:"Clear",tone:"primary"})})})}let Pr=(0,lO.ZP)(rN.zx)(e=>{let{theme:t}=e,{regular:n}=t.sanity.fonts.text.weights;return(0,lO.iv)(ik||(ik=d4(["\n    [data-ui='Text'] {\n      font-weight: ",";\n    }\n  "])),n)});function Pl(){let[e,t]=(0,rF.useState)(!1),[n,i]=(0,rF.useState)(null),[r,l]=(0,rF.useState)(null),{state:{fullscreen:a,terms:{types:o}}}=Sm(),s=(0,rF.useCallback)(()=>t(!1),[]),d=(0,rF.useCallback)(()=>t(!0),[]);(0,rN.O8)(s,[n,r]);let c=(0,rF.useMemo)(()=>SR({types:o}),[o]);return(0,rz.jsx)(rN.J2,{__unstable_margins:[5,0,0,0],content:(0,rz.jsx)(AD,{anchorElement:n,onClose:s,children:(0,rz.jsx)(Pn,{})}),open:e,placement:"bottom-start",portal:!0,radius:2,ref:l,children:(0,rz.jsx)(Pr,{fontSize:1,iconRight:lL.GVG,mode:"ghost",onClick:d,padding:a?3:2,ref:i,style:{maxWidth:"100%"},text:c,tone:"default"})})}let Pa=(0,lO.ZP)(rN.xu)(iC||(iC=d4(["\n  flex-shrink: ",";\n"])),e=>{let{$flexShrink:t=0}=e;return t});function Po(e){let{filter:t,fontSize:n=1,showContent:i=!0}=e,{state:{definitions:r,fullscreen:l}}=Sm(),a=AT(r.operators,t.operatorType),o=null==a?void 0:a.buttonValueComponent;return(0,rz.jsxs)(rN.kC,{align:"center",gap:1,children:[(0,rz.jsx)(Pa,{$flexShrink:l?1:0,children:(0,rz.jsx)(uc,{tone:"default",size:n,textOverflow:"ellipsis",weight:"semibold",children:(0,rz.jsx)(AW,{filter:t,maxLength:l?25:40})})}),i&&(null==a?void 0:a.buttonLabel)&&(0,rz.jsx)(Pa,{$flexShrink:0,children:(0,rz.jsx)(uc,{tone:"default",size:n,textOverflow:"ellipsis",weight:"regular",children:a.buttonLabel})}),i&&o&&(0,rz.jsx)(Pa,{$flexShrink:1,children:(0,rz.jsx)(uc,{tone:"default",size:n,textOverflow:"ellipsis",weight:"semibold",children:(0,rz.jsx)(o,{value:null==t?void 0:t.value})})})]})}function Ps(e){return(0,rz.jsx)(rN.xu,d6(d6({},e),{},{children:(0,rz.jsxs)(rN.kC,{align:"flex-start",gap:3,children:[(0,rz.jsx)(uc,{tone:"critical",children:(0,rz.jsx)(lL.uIy,{})}),(0,rz.jsxs)(rN.Kq,{space:4,children:[(0,rz.jsx)(uc,{size:1,tone:"critical",weight:"semibold",children:"An error occurred whilst displaying this filter."}),(0,rz.jsx)(uc,{size:1,tone:"critical",children:"This may indicate invalid options defined in your schema."})]})]})}))}function Pd(e){let{onClick:t,operator:n,selected:i}=e,r=(0,rF.useCallback)(()=>t(n.type),[t,n.type]);return(0,rz.jsx)(rN.sN,{onClick:r,padding:3,pressed:i,tone:"default",children:(0,rz.jsxs)(rN.kC,{align:"center",justify:"space-between",gap:3,children:[(0,rz.jsx)(rN.xu,{paddingRight:2,children:(0,rz.jsx)(rN.xv,{size:1,weight:"regular",children:n.label})}),(null==n?void 0:n.icon)&&(0,rz.jsx)(rN.xv,{muted:!0,size:1,children:(0,rF.createElement)(n.icon)})]})})}function Pc(e){var t;let{filter:n,operator:i}=e,r=(0,rF.useId)(),{dispatch:l,state:a}=Sm(),o=null==(t=Sa(a.definitions.filters,n.filterName))?void 0:t.operators,s=(0,rF.useCallback)(e=>{l({filterKey:AM(n),operatorType:e,type:"TERMS_FILTERS_SET_OPERATOR"})},[l,n]);return i&&o&&!(o.length<=1)?(0,rz.jsx)(rN.gF,{children:(0,rz.jsx)(rN.j2,{button:(0,rz.jsx)(rN.zx,{mode:"ghost",padding:3,children:(0,rz.jsxs)(rN.kC,{align:"center",gap:2,justify:"space-between",children:[(0,rz.jsx)(rN.xv,{size:a.fullscreen?2:1,weight:"regular",children:i.label}),(0,rz.jsx)(rN.xu,{marginLeft:1,children:(0,rz.jsx)(rN.xv,{size:1,children:(0,rz.jsx)(lL.GVG,{})})})]})}),id:r||"",menu:(0,rz.jsx)(rN.v2,{children:o.map((e,t)=>{if("item"===e.type){let n=AT(a.definitions.operators,e.name);return n?(0,rz.jsx)(Pd,{onClick:s,operator:n,selected:i.type===e.name},t):null}return"divider"===e.type?(0,rz.jsx)(rN.R,{},t):null})}),placement:"bottom-start",popover:{constrainSize:!0,portal:!1,radius:2}})}):null}function Pu(e){let{filter:t}=e,[n,i]=(0,rF.useState)(null),{dispatch:r,state:{definitions:l,fullscreen:a}}=Sm(),o=Sa(l.filters,t.filterName),s=AT(l.operators,t.operatorType),d=AI(l.fields,t),c=AM(t),u=(0,rF.useCallback)(()=>{r({filterKey:AM(t),type:"TERMS_FILTERS_REMOVE"})},[r,t]),p=(0,rF.useCallback)(e=>{r({filterKey:c,type:"TERMS_FILTERS_SET_VALUE",value:e})},[r,c]),h=(0,rF.useCallback)(e=>{i(e)},[]),f=null==s?void 0:s.inputComponent;return n?(0,rz.jsx)(Ps,{padding:4}):(0,rz.jsx)(rN.SV,{onCatch:h,children:(0,rz.jsx)(a7.ZP,{autoFocus:!AL,returnFocus:!0,children:(0,rz.jsxs)(rN.kC,{direction:"column-reverse",children:[f&&(0,rz.jsx)(rN.Zb,{borderTop:!0,padding:3,children:(0,rz.jsx)(f,{fieldDefinition:d,onChange:p,value:t.value},t.operatorType)}),(0,rz.jsx)(rN.Zb,{padding:3,children:(0,rz.jsxs)(rN.Kq,{space:3,children:[(0,rz.jsxs)(rN.kC,{align:"flex-start",gap:3,justify:"space-between",children:[(0,rz.jsx)(rN.xu,{paddingBottom:1,paddingLeft:1,paddingRight:2,paddingTop:a?2:1,children:(0,rz.jsx)(AY,{filter:t,small:!a})}),a&&(0,rz.jsx)(rN.zx,{fontSize:2,icon:lL.XHJ,mode:"bleed",onClick:u,padding:2,tone:"critical"})]}),(null==o?void 0:o.description)&&(0,rz.jsx)(rN.Zb,{border:!0,padding:3,radius:2,tone:"transparent",children:(0,rz.jsx)(rN.xv,{muted:!0,size:1,children:o.description})}),(0,rz.jsx)(Pc,{filter:t,operator:s})]})})]})})})}let Pp=(0,lO.ZP)(rN.kC)(i_||(i_=d4(["\n  max-height: 600px;\n  max-width: 480px;\n  min-width: 150px;\n  overflow: hidden;\n  width: 100%;\n"])));function Ph(e){let{filter:t}=e;return(0,rz.jsxs)(Pp,{direction:"column",children:[(0,rz.jsx)(Pu,{filter:t}),!1]})}let Pf=(0,lO.ZP)(rN.zx)(iS||(iS=d4(["\n  border-radius: ",";\n"])),e=>{let{theme:t}=e;return"0 ".concat((0,rN.hO)(t.sanity.radius[2])," ").concat((0,rN.hO)(t.sanity.radius[2])," 0")}),Pm=(0,lO.ZP)(rN.Zb)(iE||(iE=d4(["\n  position: absolute;\n  right: 0;\n"]))),Pg=lO.ZP.div(iT||(iT=d4(["\n  align-items: center;\n  display: inline-flex;\n  max-width: 100%;\n  position: relative;\n"]))),Px=(0,lO.ZP)(rN.zx)(iA||(iA=d4(["\n  border: none;\n  width: 100%;\n"])));function Pv(e){let{filter:t,initialOpen:n}=e,[i,r]=(0,rF.useState)(n),{dispatch:l,state:{definitions:a,fullscreen:o}}=Sm(),s=(0,rF.useCallback)(()=>r(!1),[]),d=(0,rF.useCallback)(()=>r(!0),[]),c=(0,rF.useCallback)(()=>l({filterKey:AM(t),type:"TERMS_FILTERS_REMOVE"}),[l,t]),u=(0,rF.useCallback)(e=>{["Backspace","Delete"].includes(e.key)&&c()},[c]),p=AR({fieldDefinitions:a.fields,filter:t,filterDefinitions:a.filters,operatorDefinitions:a.operators});return(0,rz.jsx)(rN.J2,{__unstable_margins:[5,0,0,0],content:(0,rz.jsx)(AD,{onClose:s,children:(0,rz.jsx)(Ph,{filter:t})}),constrainSize:!0,open:i,overflow:"auto",placement:"bottom-start",portal:!0,radius:2,children:(0,rz.jsxs)(Pg,{children:[(0,rz.jsx)(rN.Zb,{__unstable_focusRing:!0,display:"flex",radius:2,tone:p?"primary":"transparent",children:(0,rz.jsx)(Px,{mode:"bleed",onClick:d,onKeyDown:u,paddingLeft:o?3:2,paddingRight:o?3:5,paddingY:o?3:2,children:(0,rz.jsx)(Po,{filter:t,showContent:p})})}),!o&&(0,rz.jsx)(Pm,{__unstable_focusRing:!0,display:"flex",radius:2,tone:p?"primary":"transparent",children:(0,rz.jsx)(Pf,{"aria-label":"Delete filter",fontSize:1,icon:lL.Two,mode:"bleed",onClick:c,onKeyDown:u,padding:2,radius:2})})]})})}function Pb(){let{dispatch:e,state:{filters:t,fullscreen:n,lastAddedFilter:i,terms:{types:r}}}=Sm(),l=(0,rF.useRef)(!1),a=(0,rF.useCallback)(()=>{e({type:"TERMS_FILTERS_CLEAR"}),e({type:"TERMS_TYPES_CLEAR"})},[e]),o=t.length>0||r.length>0;(0,rF.useEffect)(()=>{l.current=!0},[]);let s=i&&AM(i),d=()=>(0,rz.jsx)(rN.zx,{fontSize:1,mode:"bleed",onClick:a,padding:n?3:2,text:"Clear filters",tone:"critical"});return(0,rz.jsxs)(rz.Fragment,{children:[(0,rz.jsxs)(rN.kC,{align:"flex-start",gap:3,justify:"space-between",padding:2,children:[(0,rz.jsxs)(rN.kC,{flex:1,gap:2,wrap:"wrap",children:[(0,rz.jsx)(Pl,{}),null==t?void 0:t.map(e=>{let t=AM(e);return(0,rz.jsx)(Pv,{filter:e,initialOpen:l.current&&s===t},t)}),!n&&(0,rz.jsx)(A7,{})]}),o&&!n&&(0,rz.jsx)(d,{})]}),n&&(0,rz.jsxs)(rN.kC,{justify:"space-between",paddingBottom:2,paddingX:2,children:[(0,rz.jsx)(A7,{}),o&&(0,rz.jsx)(d,{})]}),!1]})}function Py(){return(0,rz.jsx)(rN.kC,{align:"center",direction:"column",gap:4,paddingX:4,paddingY:5,children:(0,rz.jsxs)(rN.gF,{space:3,children:[(0,rz.jsx)(rN.xv,{muted:!0,children:"Use"}),(0,rz.jsx)(rN.xv,{muted:!0,children:(0,rz.jsx)(lL.d$S,{})}),(0,rz.jsx)(rN.xv,{muted:!0,children:"to refine your search"})]})})}function Pj(e){let{availableCharacters:t,types:n}=e,i=(0,rF.useMemo)(()=>SR({availableCharacters:t,types:n}),[t,n]);return(0,rz.jsx)(rN.Zb,{border:!0,padding:2,radius:2,children:(0,rz.jsx)(rN.xv,{muted:!0,size:1,children:i})})}let Pw=(0,lO.ZP)(rN.Zb)(iP||(iP=d4(["\n  cursor: default;\n"])));function Pk(e){let{filter:t}=e;return(0,rz.jsx)(Pw,{border:!0,padding:2,radius:2,tone:"primary",children:(0,rz.jsx)(Po,{filter:t})})}let PC=(0,lO.ZP)(rN.zx)(iI||(iI=d4(["\n  border-radius: ",";\n  cursor: default;\n  width: 100%;\n"])),e=>{let{theme:t}=e;return(0,rN.hO)(t.sanity.radius[2])}),P_=(0,lO.ZP)(rN.xu)(iM||(iM=d4(["\n  flex-shrink: 3;\n"]))),PS=(0,lO.ZP)(rN.xu)(iz||(iz=d4(["\n  flex-shrink: 2;\n"]))),PE=lO.ZP.div(iR||(iR=d4(["\n  opacity: 0.8;\n  visibility: hidden;\n\n  @media (hover: hover) {\n    ",":hover & {\n      visibility: visible;\n    }\n    &:hover {\n      opacity: 0.4;\n    }\n  }\n"])),PC);function PT(e){var t;let{index:n,maxVisibleTypePillChars:i=40,showFiltersOnClick:r,value:l}=e,a=d3(e,dN),{dispatch:o,recentSearchesStore:s}=Sm(),d=i-l.query.length,c=(0,rF.useCallback)(()=>{let e=l.filters&&l.filters.length,t=l.types.length;if(r&&(e||t)&&o({type:"FILTERS_VISIBLE_SET",visible:!0}),o({type:"TERMS_SET",filters:null==l?void 0:l.filters,terms:l}),s){let n=null==s?void 0:s.addSearch(l,null==l?void 0:l.filters);o({recentSearches:n,type:"RECENT_SEARCHES_SET"})}},[o,s,r,l]),u=(0,rF.useCallback)(e=>{if(e.stopPropagation(),s){let t=null==s?void 0:s.removeSearchAtIndex(n);o({recentSearches:t,type:"RECENT_SEARCHES_SET"})}},[o,n,s]);return(0,rz.jsx)(rN.xu,d6(d6({},a),{},{children:(0,rz.jsx)(PC,{"data-command-list-item":!0,mode:"bleed",onClick:c,paddingLeft:3,paddingRight:1,paddingY:1,children:(0,rz.jsxs)(rN.kC,{align:"stretch",children:[(0,rz.jsxs)(rN.gF,{paddingY:2,children:[(0,rz.jsx)(rN.xv,{muted:!0,size:1,children:(0,rz.jsx)(lL.T39,{})}),(0,rz.jsx)(rN.xv,{children:"​"})]}),(0,rz.jsxs)(rN.kC,{align:"stretch",flex:1,gap:2,justify:"flex-start",marginLeft:3,wrap:"wrap",children:[l.query&&(0,rz.jsx)(PS,{paddingY:2,children:(0,rz.jsx)(rN.xv,{muted:!0,textOverflow:"ellipsis",children:l.query})}),l.types.length>0&&(0,rz.jsx)(P_,{children:(0,rz.jsx)(Pj,{availableCharacters:d,types:l.types})}),null==(t=null==l?void 0:l.filters)?void 0:t.map((e,t)=>(0,rz.jsx)(Pk,{filter:e},t))]}),(0,rz.jsx)(rN.kC,{align:"center",children:(0,rz.jsx)(PE,{onClick:u,children:(0,rz.jsx)(rN.kC,{padding:2,children:(0,rz.jsx)(rN.xv,{size:1,children:(0,rz.jsx)(lL.Two,{})})})})})]})})}))}function PA(e){let{showFiltersOnClick:t}=e,[n,i]=(0,rF.useState)(null),{state:{recentSearches:r}}=Sm(),{getTotalSize:l,getVirtualItems:a,measureElement:o}=(0,on.MG)({count:r.length,getScrollElement:()=>n,estimateSize:()=>36}),s=(0,rN.d2)(),d=(0,rF.useMemo)(()=>s<2?20:40,[s]);return(0,rz.jsx)(AX,{paddingBottom:1,setVirtualListRef:i,totalHeight:l(),children:a().map(e=>{let n=r[e.index];return(0,rz.jsx)(AU,{activeIndex:e.index,"data-index":e.index,measure:o,virtualRow:e,children:(0,rz.jsx)(PT,{index:e.index,maxVisibleTypePillChars:d,paddingTop:1,paddingX:2,showFiltersOnClick:t,value:n})},e.key)})})}let PP=(0,lO.ZP)(rN.Zb)(iF||(iF=d4(["\n  overflow-x: hidden;\n  overflow-y: auto;\n  position: relative;\n"])));function PI(e){let{showFiltersOnClick:t}=e,{dispatch:n,recentSearchesStore:i,state:{filtersVisible:r,fullscreen:l,recentSearches:a}}=Sm(),{focusHeaderInputElement:o}=A_(),s=(0,rF.useCallback)(()=>{if(i){let e=i.removeSearch();n({recentSearches:e,type:"RECENT_SEARCHES_SET"})}o()},[n,o,i]),d=!!a.length;return(0,rz.jsx)(PP,{borderTop:d||!d&&!r&&l,flex:1,children:a.length?(0,rz.jsxs)(rz.Fragment,{children:[(0,rz.jsx)(rN.xu,{paddingBottom:2,paddingTop:4,paddingX:3,children:(0,rz.jsx)(rN.__,{muted:!0,size:1,children:"Recent searches"})}),(0,rz.jsx)(rN.xu,{children:(0,rz.jsx)(PA,{showFiltersOnClick:t})}),(0,rz.jsx)(rN.xu,{paddingBottom:2,paddingTop:1,paddingX:2,children:(0,rz.jsx)(rN.zx,{justify:"flex-start",fontSize:1,mode:"bleed",onClick:s,padding:2,tone:"default",children:(0,rz.jsx)(rN.xv,{muted:!0,size:1,children:"Clear recent searches"})})})]}):!r&&l&&(0,rz.jsx)(Py,{})})}let PM=(0,lO.F4)(iO||(iO=d4(["\n  from {\n    transform: rotate(0deg);\n  }\n  to {\n    transform: rotate(360deg);\n  }\n"]))),Pz=(0,lO.ZP)(lL.L4p)(iD||(iD=d4(["\n  animation: "," 500ms linear infinite;\n"])),PM),PR=(0,lO.ZP)(rN.xu)(iZ||(iZ=d4(["\n  position: relative;\n"]))),PF=(0,lO.ZP)(rN.Zb)(iL||(iL=d4(["\n  flex-shrink: 0;\n"]))),PO=lO.ZP.div(iq||(iq=d4(["\n  background: ",";\n  border-radius: 100%;\n  height: 6px;\n  position: absolute;\n  right: 2px;\n  top: 2px;\n  width: 6px;\n"])),e=>{var t;let{theme:n}=e;return null==(t=n.sanity.color.selectable)?void 0:t.primary.enabled.fg});function PD(e){let{onClose:t}=e,n=(0,rF.useRef)(!1),{dispatch:i,state:{filters:r,filtersVisible:l,fullscreen:a,result:{loading:o},terms:{types:s,query:d}}}=Sm(),{setHeaderInputElement:c}=A_(),u=(0,rF.useCallback)(()=>i({type:"FILTERS_VISIBLE_SET",visible:!l}),[i,l]),p=(0,rF.useCallback)(e=>i({type:"TERMS_QUERY_SET",query:e.currentTarget.value}),[i]),h=(0,rF.useCallback)(()=>{i({type:"TERMS_QUERY_SET",query:""})},[i]);(0,rF.useEffect)(()=>{a||i({type:"FILTERS_VISIBLE_SET",visible:!0})},[i,a]),(0,rF.useEffect)(()=>{n.current=!0},[]);let f=r.length>0||s.length>0;return(0,rz.jsx)(PF,{children:(0,rz.jsxs)(rN.kC,{align:"center",flex:1,gap:a?2:1,padding:a?2:1,children:[a&&(0,rz.jsx)(rN.Zb,{children:(0,rz.jsx)(rN.zx,{"aria-label":"Close search",icon:lL.Y4O,mode:"bleed",onClick:t})}),(0,rz.jsx)(rN.xu,{flex:1,children:(0,rz.jsx)(Er,{autoComplete:"off",background:a,border:!1,clearButton:!!d,fontSize:2,icon:o?Pz:lL.W1M,onChange:p,onClear:h,placeholder:"Search",ref:c,smallClearButton:a,spellCheck:!1,value:d})}),a&&(0,rz.jsxs)(PR,{children:[(0,rz.jsx)(rN.zx,{"aria-expanded":l,"aria-label":"Toggle filters",height:"fill",icon:lL.d$S,mode:"bleed",onClick:u,padding:3,selected:l,tone:"default"}),f&&(0,rz.jsx)(PO,{})]})]})})}function PZ(){return(0,rz.jsx)(rN.W2,{width:0,children:(0,rz.jsxs)(rN.Kq,{"aria-live":"assertive",space:4,paddingX:4,paddingY:5,children:[(0,rz.jsx)(rN.xv,{align:"center",muted:!0,weight:"semibold",children:"No results found"}),(0,rz.jsx)(rN.xv,{align:"center",muted:!0,size:1,children:"Try another keyword or adjust your filters"})]})})}function PL(){return(0,rz.jsxs)(rN.kC,{align:"center","aria-live":"assertive",direction:"column",flex:1,gap:3,marginY:2,padding:4,children:[(0,rz.jsx)(rN.xu,{marginBottom:1,children:(0,rz.jsx)(uc,{tone:"critical",children:(0,rz.jsx)(lL.foC,{})})}),(0,rz.jsx)(uc,{size:2,tone:"critical",weight:"semibold",children:"Something went wrong while searching"}),(0,rz.jsx)(uc,{size:1,tone:"critical",children:"Please try again or check your connection"})]})}let Pq={createdAsc:{ignoreScore:!0,sort:{direction:"asc",field:"_createdAt"},title:"Created: Oldest first"},createdDesc:{ignoreScore:!0,sort:{direction:"desc",field:"_createdAt"},title:"Created: Newest first"},relevance:{customMeasurementLabel:"relevance",sort:{direction:"desc",field:"_updatedAt"},title:"Best match"},updatedAsc:{ignoreScore:!0,sort:{direction:"asc",field:"_updatedAt"},title:"Updated: Oldest first"},updatedDesc:{ignoreScore:!0,sort:{direction:"desc",field:"_updatedAt"},title:"Updated: Newest first"}},PN=[Pq.relevance,{type:"divider"},Pq.createdAsc,Pq.createdDesc,{type:"divider"},Pq.updatedAsc,Pq.updatedDesc],PV=(0,lO.ZP)(rN.kC)(iN||(iN=d4(["\n  box-sizing: border-box;\n"])));function PB(e){return"divider"===e.type}function PU(e){let{ordering:t}=e,{dispatch:n,state:{ordering:i}}=Sm(),r=(0,rF.useCallback)(()=>{n({ordering:t,type:"ORDERING_SET"})},[n,t]),l=(0,rF.useMemo)(()=>lM()(i,t),[i,t]);return(0,rz.jsx)(rN.sN,{onClick:r,padding:3,pressed:l,tone:"default",children:(0,rz.jsx)(rN.kC,{align:"center",justify:"space-between",paddingRight:2,children:(0,rz.jsx)(rN.xv,{size:1,weight:"medium",children:t.title})})})}function PK(){let{state:{ordering:e}}=Sm(),t=(0,rF.useId)(),n=PN.find(t=>lM()(e,t)&&!PB(t));return n?(0,rz.jsx)(rN.Zb,{borderBottom:!0,children:(0,rz.jsx)(PV,{align:"center",flex:1,padding:2,children:(0,rz.jsx)(rN.j2,{button:(0,rz.jsx)(rN.zx,{mode:"bleed",padding:2,children:(0,rz.jsxs)(rN.kC,{align:"center",gap:1,justify:"space-between",children:[(0,rz.jsx)(rN.xu,{marginRight:1,children:(0,rz.jsx)(rN.xv,{size:1,children:(0,rz.jsx)(lL.fzI,{})})}),(0,rz.jsx)(rN.gF,{space:2,children:(0,rz.jsx)(rN.xv,{size:1,weight:"medium",children:n.title})})]})}),id:t||"",menu:(0,rz.jsx)(rN.v2,{children:PN.map((e,t)=>PB(e)?(0,rz.jsx)(rN.R,{},t):(0,rz.jsx)(PU,{ordering:e},t))}),placement:"bottom-start",popover:{portal:!0,radius:2}})})}):null}let PH=(0,lO.ZP)(rN.Zb)(iV||(iV=d4(["\n  cursor: help;\n  left: 0;\n  position: absolute;\n  top: 0;\n"])));function P$(e){let{data:t}=e,{score:n}=t,i="default";n<=.1?i="critical":n>=.5&&(i="primary");let r=t.stories.filter(e=>e.score>0);return(0,rz.jsx)(rz.Fragment,{children:(0,rz.jsx)(rN.u,{content:(0,rz.jsx)(rN.xu,{padding:2,children:(0,rz.jsx)(rN.Kq,{space:2,children:r.length?(0,rz.jsx)(rz.Fragment,{children:r.map(e=>(0,rz.jsxs)(rN.gF,{space:3,children:[(0,rz.jsx)(rN.EK,{size:0,weight:"semibold",children:e.path}),(0,rz.jsx)(rN.EK,{size:0,children:e.why})]},e.path))}):(0,rz.jsx)(rN.EK,{size:0,children:"No matches"})})}),placement:"bottom-start",portal:!0,children:(0,rz.jsx)(PH,{padding:1,shadow:1,tone:i,children:(0,rz.jsxs)(rN.EK,{size:0,children:["score: ",n]})})})})}function PX(e){let{onClose:t}=e,[n,i]=(0,rF.useState)(null),{dispatch:r,recentSearchesStore:l,state:{debug:a,filters:o,terms:s,result:d}}=Sm(),{setVirtualListScrollToIndex:c}=A_(),{getTotalSize:u,getVirtualItems:p,scrollToIndex:h}=(0,on.MG)({count:d.hits.length,getScrollElement:()=>n,estimateSize:()=>59,overscan:4}),f=(0,rF.useCallback)(()=>{if(l){let e=l.addSearch(s,o);r({recentSearches:e,type:"RECENT_SEARCHES_SET"})}t()},[r,o,t,l,s]);return(0,rF.useEffect)(()=>{c(h)},[c,h]),(0,rz.jsx)(AX,{paddingBottom:2,setVirtualListRef:i,totalHeight:u(),children:p().map(e=>{let t=d.hits[e.index];return(0,rz.jsxs)(AU,{activeIndex:e.index,"data-index":e.index,fixedHeight:!0,virtualRow:e,children:[(0,rz.jsx)(Sk,{documentId:cb(t.hit._id)||"",documentType:t.hit._type,onClick:f,paddingTop:2,paddingX:2},e.key),a&&(0,rz.jsx)(P$,{data:t})]},e.key)})})}let PW=(0,lO.ZP)(rN.Zb)(iB||(iB=d4(["\n  overflow-x: hidden;\n  overflow-y: auto;\n  position: relative;\n"]))),PG=(0,lO.ZP)(rN.kC)(iU||(iU=d4(["\n  height: 100%;\n"]))),PY=(0,lO.ZP)(rN.kC)(iK||(iK=d4(["\n  opacity: ",";\n  overflow: hidden;\n  position: relative;\n  transition: 300ms opacity;\n  width: 100%;\n"])),e=>{let{$loading:t}=e;return t?.5:1});function PJ(e){let{onClose:t}=e,{state:{fullscreen:n,result:i}}=Sm(),r=!!i.hits.length,l=!i.hits.length&&i.loaded,a=i.error;return(0,rz.jsx)(PW,{borderTop:n||!!(a||r||l),flex:1,children:(0,rz.jsxs)(PG,{direction:"column",children:[r&&(0,rz.jsx)(PK,{}),(0,rz.jsx)(PY,{$loading:i.loading,"aria-busy":i.loading,flex:1,children:a?(0,rz.jsx)(PL,{}):(0,rz.jsxs)(rz.Fragment,{children:[r&&(0,rz.jsx)(PX,{onClose:t}),l&&(0,rz.jsx)(PZ,{})]})})]})})}let PQ=(0,ot.ZP)("mod+".concat("k")),P0=(0,ot.ZP)("escape");function P1(e){let{open:t,onClose:n,onOpen:i}=e,{isTopLayer:r}=(0,rN.sJ)(),l=(0,rF.useCallback)(()=>{null==n||n()},[n]),a=(0,rF.useCallback)(e=>{PQ(e)&&(e.preventDefault(),t?l():null==i||i()),P0(e)&&t&&r&&l()},[l,r,t,i]);(0,rN.qh)(a)}let P2=(0,lO.ZP)(rN.Zb)(iH||(iH=d4(["\n  flex-direction: column;\n  overflow: hidden;\n  pointer-events: all;\n  position: relative;\n"]))),P3=(0,lO.ZP)(rN.xu)(i$||(i$=d4(["\n  height: 100%;\n  left: 0;\n  overflow: hidden;\n  pointer-events: none;\n  position: fixed;\n  top: 0;\n  width: 100%;\n  z-index: 1;\n"])));function P4(e){let{onClose:t,onOpen:n,open:i}=e,r=(0,rF.useRef)(!1),[l,a]=(0,rF.useState)(-1),{dispatch:o,setOnClose:s,state:{filtersVisible:d,recentSearches:c,result:u,terms:p}}=Sm(),h=SE({terms:p}),f=(0,rF.useCallback)(e=>{a(e),t()},[t]);P1({onOpen:n,open:i}),(0,rF.useEffect)(()=>{(!h||u.loaded)&&r.current&&a(0)},[h,u.loaded]),(0,rF.useEffect)(()=>{h||!r.current||i||o({type:"ORDERING_RESET"})},[o,h,i]),(0,rF.useEffect)(()=>{s(t)},[t,s]),(0,rF.useEffect)(()=>{(null==r?void 0:r.current)||(r.current=!0)},[]);let m=(0,rF.useMemo)(()=>h?Array.from(Array(u.hits.length).keys()):Array.from(Array(c.length).keys()),[h,c.length,u.hits.length]);return i?(0,rz.jsx)(rN.h_,{children:(0,rz.jsx)(a7.ZP,{autoFocus:!1,returnFocus:!0,children:(0,rz.jsx)(Aq,{ariaActiveDescendant:m.length>0,ariaChildrenLabel:h?"Search results":"Recent searches",ariaHeaderLabel:"Search",autoFocus:!0,"data-testid":"search-results-dialog",itemIndices:m,initialSelectedIndex:h?l:0,children:(0,rz.jsx)(P5,{filtersVisible:d,hasValidTerms:h,onClose:f,open:i})})})}):null}function P5(e){let{filtersVisible:t,hasValidTerms:n,onClose:i,open:r}=e,{scheme:l}=E8(),{getTopIndex:a}=A_(),o=(0,rF.useCallback)(()=>{i(a())},[a,i]);return P1({onClose:o,open:r}),(0,rz.jsx)(P3,{children:(0,rz.jsxs)(P2,{display:"flex",height:"fill",scheme:l,tone:"default",children:[(0,rz.jsx)(PD,{onClose:o}),t&&(0,rz.jsx)(rN.Zb,{borderTop:!0,style:{flexShrink:0},children:(0,rz.jsx)(Pb,{})}),(0,rz.jsx)(AE,{children:n?(0,rz.jsx)(PJ,{onClose:o}):(0,rz.jsx)(PI,{})})]})})}let P6=(0,lO.ZP)(rN.kC)(iX||(iX=d4(["\n  position: absolute;\n  right: 0;\n  top: 0;\n\n  & > :first-child {\n    margin-right: 1px;\n  }\n"]))),P8=(0,lO.ZP)(rN.kC)(iW||(iW=d4(["\n  min-width: 253px;\n  max-width: 350px;\n  position: relative;\n"]))),P7=(0,lO.ZP)(rN.oi)(iG||(iG=d4(["\n  padding-right: 60px;\n"]))),P9=(0,rF.forwardRef)(function(e,t){let{onOpen:n}=e,{dispatch:i,state:{terms:r}}=Sm(),l=(0,rF.useCallback)(e=>{i({type:"TERMS_QUERY_SET",query:e.currentTarget.value}),n()},[i,n]),a=(0,rF.useCallback)(e=>{"Enter"===e.key&&n()},[n]);return(0,rz.jsxs)(P8,{align:"center",children:[(0,rz.jsx)(P7,{"aria-autocomplete":"list","aria-expanded":"false",autoComplete:"off",icon:lL.W1M,"data-testid":"studio-search",onChange:l,onClick:n,onKeyDown:a,placeholder:"Search",radius:2,ref:t,role:"combobox",value:r.query}),(0,rz.jsxs)(P6,{align:"center",height:"fill",marginRight:2,children:[(0,rz.jsx)(rN.WB,{children:S_}),(0,rz.jsx)(rN.WB,{children:"K"})]})]})}),Ie=(0,lO.ZP)(rN.Zb)(iY||(iY=d4(["\n  flex-shrink: 0;\n"]))),It=lO.ZP.div(iJ||(iJ=d4(["\n  background-color: ",";\n  bottom: 0;\n  left: 0;\n  position: absolute;\n  right: 0;\n  top: 0;\n"])),e=>{let{theme:t}=e;return t.sanity.color.base.shadow.ambient}),In=(0,lO.ZP)(rN.Zb)(iQ||(iQ=d4(["\n  ","\n  display: flex !important;\n  flex-direction: column;\n  max-height: ",";\n  position: absolute;\n  top: ","px;\n  width: min(calc(100vw - ","px), ","px);\n"])),e=>{let{$position:t}=e;return t.x?(0,lO.iv)(i0||(i0=d4(["\n          left: ","px;\n        "])),t.x):(0,lO.iv)(i1||(i1=d4(["\n          left: 50%;\n          transform: translateX(-50%);\n        "])))},e=>{let{$position:t}=e;return"min(calc(100vh - ".concat(t.y,"px - ").concat(SS,"px), ").concat(735,"px)")},e=>{let{$position:t}=e;return t.y},2*SS,800);function Ii(e){let{disableFocusLock:t,onClose:n,onOpen:i,open:r,position:l}=e,a=(0,rF.useRef)(!1),[o,s]=(0,rF.useState)(-1),{zIndex:d}=(0,rN.sJ)(),{dispatch:c,setOnClose:u,state:{filtersVisible:p,recentSearches:h,result:f,terms:m}}=Sm(),g=SE({terms:m});P1({onOpen:i,open:r});let x=(0,rF.useCallback)(e=>{s(e),n()},[n]);(0,rF.useEffect)(()=>{(!g||f.loaded)&&a.current&&s(0)},[g,f.loaded]),(0,rF.useEffect)(()=>{g||!a.current||r||c({type:"ORDERING_RESET"})},[c,g,r]),(0,rF.useEffect)(()=>{u(n)},[n,u]),(0,rF.useEffect)(()=>{(null==a?void 0:a.current)||(a.current=!0)},[]);let v=(0,rF.useMemo)(()=>g?Array.from(Array(f.hits.length).keys()):Array.from(Array(h.length).keys()),[g,h.length,f.hits.length]);return r?(0,rz.jsx)(rN.h_,{children:(0,rz.jsxs)(a7.ZP,{autoFocus:!1,disabled:t,returnFocus:!0,children:[(0,rz.jsx)(It,{style:{zIndex:d}}),(0,rz.jsx)(Aq,{ariaActiveDescendant:v.length>0,ariaChildrenLabel:g?"Search results":"Recent searches",ariaHeaderLabel:"Search results",autoFocus:!0,"data-testid":"search-results-popover",initialSelectedIndex:g?o:0,itemIndices:v,children:(0,rz.jsx)(Ir,{filtersVisible:p,hasValidTerms:g,onClose:x,open:r,position:l})})]})}):null}function Ir(e){let{filtersVisible:t,hasValidTerms:n,onClose:i,open:r,position:l}=e,[a,o]=(0,rF.useState)(null),{isTopLayer:s,zIndex:d}=(0,rN.sJ)(),{scheme:c}=E8(),{getTopIndex:u}=A_(),p=(0,rF.useCallback)(()=>{i(u())},[u,i]),h=(0,rF.useCallback)(()=>{r&&s&&p()},[p,s,r]);return(0,rN.O8)(h,[a]),P1({onClose:p,open:r}),(0,rz.jsxs)(In,{$position:l,overflow:"hidden",radius:2,ref:o,scheme:c,shadow:2,style:{zIndex:d},children:[(0,rz.jsx)(PD,{onClose:p}),t&&(0,rz.jsx)(Ie,{borderTop:!0,children:(0,rz.jsx)(Pb,{})}),(0,rz.jsx)(AE,{children:n?(0,rz.jsx)(PJ,{onClose:p}):(0,rz.jsx)(PI,{showFiltersOnClick:!0})})]})}function Il(){let[e,t]=(0,rF.useState)(null),[n,i]=(0,rF.useState)(!1),r=(0,rF.useCallback)(()=>i(!1),[]),l=(0,rF.useCallback)(()=>i(!0),[]),a=function(e){let[t,n]=(0,rF.useState)(null),i=(0,rF.useCallback)(()=>{e&&n(Ia(e))},[e]);return(0,rF.useEffect)(()=>{e&&n(Ia(e))},[e]),(0,rF.useEffect)(()=>(window.addEventListener("resize",i),()=>window.removeEventListener("resize",i)),[i]),t}(e);return(0,rz.jsxs)(rz.Fragment,{children:[(0,rz.jsx)(P9,{onOpen:l,ref:t}),a&&(0,rz.jsx)(Ii,{onClose:r,onOpen:l,open:n,position:a})]})}function Ia(e){let t=e.getBoundingClientRect();return{x:window.innerWidth-t.x>800?t.x-SS:null,y:t.y-SS}}function Io(e){let t=Id?window.localStorage.getItem(e):void 0;return t?JSON.parse(t):{version:1,recentSearches:[]}}function Is(e){let{lsKey:t,schema:n,fieldDefinitions:i,filterDefinitions:r,operatorDefinitions:l}=e,a=Io(t);return(function(e){let{fieldDefinitions:t,filterDefinitions:n,lsKey:i,operatorDefinitions:r,storedSearch:l,studioSchema:a}=e,o=ST(a).map(e=>e.name),s=l.recentSearches.filter(e=>e.terms.typeNames.every(e=>o.includes(e))&&e.filters.every(e=>AR({fieldDefinitions:t,filter:e,filterDefinitions:n,operatorDefinitions:r}))),d={version:1,recentSearches:s};return d.recentSearches.length<l.recentSearches.length&&window.localStorage.setItem(i,JSON.stringify(d)),Io(i)})({studioSchema:n,storedSearch:a,lsKey:t,filterDefinitions:r,fieldDefinitions:i,operatorDefinitions:l}).recentSearches.filter(e=>!!e.terms).map((e,t)=>({__recent:{index:t,timestamp:new Date(e.created).getTime()},filters:e.filters,query:e.terms.query,types:e.terms.typeNames.map(e=>n.get(e)).filter(e=>!!(e&&"object"===e.jsonType))}))}let Id=(()=>{let e="__tmp__can_use";try{if("undefined"==typeof localStorage)return!1;return localStorage.setItem(e,"---"),localStorage.removeItem(e),!0}catch(t){return!1}})();function Ic(e){return d6(d6({},e),{},{id:sm.V8.hashStr(JSON.stringify([e.documentTypes,e.fieldPath,e.filterName,e.type]))})}function Iu(e){return"array"===e.type}function Ip(e){return"document"===e.type}function Ih(e){return"object"===e.type}function If(e,t){let n=e.titlePath.slice(0,-1).join("/"),i=t.titlePath.slice(0,-1).join("/");return e.title.localeCompare(t.title)||n.localeCompare(i)||e.fieldPath.localeCompare(t.fieldPath)}function Im(e){return void 0!==e.__recent}let Ig="core:studio:navbar:search:";oQ()(Ig);let Ix=function(e){let t="".concat(Ig).concat(e);return oQ()&&oQ().enabled(t)?oQ()(t):oQ()(Ig)}("reducer");function Iv(e,t){let n="\uD83D\uDD0D";switch(t.type.startsWith("SEARCH_REQUEST")&&(n="\uD83D\uDEA8"),t.type.startsWith("RECENT_SEARCHES")&&(n="\uD83D\uDCBE"),Ix(n,t),t.type){case"FILTERS_VISIBLE_SET":return d6(d6({},e),{},{filtersVisible:t.visible});case"ORDERING_RESET":return d6(d6({},e),{},{ordering:Pq.relevance,terms:Ib(e.terms)});case"ORDERING_SET":return d6(d6({},e),{},{ordering:t.ordering,terms:Ib(e.terms)});case"PAGE_INCREMENT":return d6(d6({},e),{},{pageIndex:e.pageIndex+1,terms:Ib(e.terms)});case"RECENT_SEARCHES_SET":return d6(d6({},e),{},{recentSearches:t.recentSearches});case"SEARCH_CLEAR":return d6(d6({},e),{},{pageIndex:0,result:d6(d6({},e.result),{},{hasMore:null,hits:[]})});case"SEARCH_REQUEST_COMPLETE":return d6(d6({},e),{},{result:d6(d6({},e.result),{},{error:null,hasMore:t.hits.length>0,hits:e.pageIndex>0?[...e.result.hits,...t.hits]:t.hits,loaded:!0,loading:!1})});case"SEARCH_REQUEST_ERROR":return d6(d6({},e),{},{result:d6(d6({},e.result),{},{error:t.error,loaded:!1,loading:!1})});case"SEARCH_REQUEST_START":return d6(d6({},e),{},{result:d6(d6({},e.result),{},{loaded:!1,loading:!0})});case"TERMS_FILTERS_ADD":{var i;let r=d6(d6({},t.filter),{},{value:null==(i=AT(e.definitions.operators,t.filter.operatorType))?void 0:i.initialValue}),l=[...e.filters,r];return d6(d6({},e),{},{documentTypesNarrowed:Az({fieldDefinitions:e.definitions.fields,filters:l,types:e.terms.types}),filters:l,lastAddedFilter:r,terms:d6(d6({},e.terms),{},{filter:AP({fieldDefinitions:e.definitions.fields,filterDefinitions:e.definitions.filters,filters:l,operatorDefinitions:e.definitions.operators})})})}case"TERMS_FILTERS_CLEAR":{let a=[];return d6(d6({},e),{},{documentTypesNarrowed:Az({fieldDefinitions:e.definitions.fields,filters:a,types:e.terms.types}),filters:a,terms:d6(d6({},e.terms),{},{filter:AP({fieldDefinitions:e.definitions.fields,filterDefinitions:e.definitions.filters,filters:a,operatorDefinitions:e.definitions.operators})})})}case"TERMS_FILTERS_REMOVE":{let o=e.filters.findIndex(e=>AM(e)===t.filterKey),s=[...e.filters.slice(0,o),...e.filters.slice(o+1)];return d6(d6({},e),{},{documentTypesNarrowed:Az({fieldDefinitions:e.definitions.fields,filters:s,types:e.terms.types}),filters:s,terms:d6(d6({},e.terms),{},{filter:AP({fieldDefinitions:e.definitions.fields,filterDefinitions:e.definitions.filters,filters:s,operatorDefinitions:e.definitions.operators})})})}case"TERMS_FILTERS_SET_OPERATOR":{let d=e.filters.find(e=>AM(e)===t.filterKey),c=AT(e.definitions.operators,null==d?void 0:d.operatorType),u=AT(e.definitions.operators,t.operatorType),p=null==u?void 0:u.initialValue,h=(null==c?void 0:c.inputComponent)!=(null==u?void 0:u.inputComponent),f=e.filters.map(e=>AM(e)===t.filterKey?d6(d6({},e),{},{operatorType:t.operatorType},h?{value:p}:{}):e);return d6(d6({},e),{},{filters:f,terms:d6(d6({},e.terms),{},{filter:AP({fieldDefinitions:e.definitions.fields,filterDefinitions:e.definitions.filters,filters:f,operatorDefinitions:e.definitions.operators})})})}case"TERMS_FILTERS_SET_VALUE":{let m=e.filters.map(e=>AM(e)===t.filterKey?d6(d6({},e),{},{value:t.value}):e);return d6(d6({},e),{},{filters:m,terms:d6(d6({},e.terms),{},{filter:AP({fieldDefinitions:e.definitions.fields,filterDefinitions:e.definitions.filters,filters:m,operatorDefinitions:e.definitions.operators})})})}case"TERMS_QUERY_SET":return d6(d6({},e),{},{pageIndex:0,result:d6(d6({},e.result),{},{loaded:!1}),terms:Ib(d6(d6({},e.terms),{},{query:t.query}))});case"TERMS_SET":{let g=t.filters||[],x=[...e.terms.types||[],...t.terms.types].sort(SA);return d6(d6({},e),{},{documentTypesNarrowed:Az({fieldDefinitions:e.definitions.fields,filters:g,types:x}),filters:g,lastAddedFilter:null,pageIndex:0,result:d6(d6({},e.result),{},{loaded:!1}),terms:d6(d6({},t.terms),{},{filter:AP({fieldDefinitions:e.definitions.fields,filterDefinitions:e.definitions.filters,filters:g,operatorDefinitions:e.definitions.operators})})})}case"TERMS_TYPE_ADD":{let v=[...e.terms.types||[],t.schemaType].sort(SA),b=Az({fieldDefinitions:e.definitions.fields,filters:[],types:v}),y=e.filters.filter(t=>{let n=AI(e.definitions.fields,t);return!n||0===n.documentTypes.length||b.every(e=>n.documentTypes.findIndex(t=>t===e)>-1)});return d6(d6({},e),{},{documentTypesNarrowed:b,filters:y,pageIndex:0,result:d6(d6({},e.result),{},{loaded:!1}),terms:Ib(d6(d6({},e.terms),{},{filter:AP({fieldDefinitions:e.definitions.fields,filterDefinitions:e.definitions.filters,operatorDefinitions:e.definitions.operators,filters:y}),types:v}))})}case"TERMS_TYPE_REMOVE":{let j=(e.terms.types||[]).filter(e=>e!==t.schemaType);return d6(d6({},e),{},{documentTypesNarrowed:Az({fieldDefinitions:e.definitions.fields,filters:e.filters,types:j}),pageIndex:0,result:d6(d6({},e.result),{},{loaded:!1}),terms:Ib(d6(d6({},e.terms),{},{types:j}))})}case"TERMS_TYPES_CLEAR":return d6(d6({},e),{},{documentTypesNarrowed:Az({fieldDefinitions:e.definitions.fields,filters:e.filters,types:[]}),pageIndex:0,result:d6(d6({},e.result),{},{loaded:!1}),terms:Ib(d6(d6({},e.terms),{},{types:[]}))});default:return e}}function Ib(e){if(Im(e)){let{__recent:t}=e,n=d3(e,dV);return n}return e}function Iy(e){let{__debugFieldDefinitions:t=[],children:n,fullscreen:i}=e,r=(0,rF.useRef)(null),l=IW(uX),a=I3(),o=Mi(),{search:{operators:s,filters:d}}=SJ(),{dataset:c,projectId:u}=l.config(),p=(0,rF.useMemo)(()=>[...function(e,t){var n;let i=ST(e).map(e=>e.name),{documentTypes:r,objectTypes:l}=((null==(n=e._original)?void 0:n.types)||[]).filter(e=>!Ip(e)||i.includes(e.name)).filter(e=>"slug"!==e.name).filter(e=>!e.name.startsWith("sanity.")).reduce((e,t)=>(Ip(t)&&(e.documentTypes[t.name]=t),Ih(t)&&(e.objectTypes[t.name]=t),e),{documentTypes:{},objectTypes:{}})||{documentTypes:{},objectTypes:{}},a=t.reduce((e,t)=>("field"===t.type&&e.push(t.fieldType),e),[]);return function(e,t,n){let i=Object.values(t).reduce((i,r)=>{let l=r.fields.reduce((i,l)=>(!function i(r){var l;let{acc:a,defType:o,depth:s=0,documentType:d,prevFieldPath:c,prevTitlePath:u}=r,p=o.name.startsWith("_"),h=(null==o?void 0:o.title)||l$()(o.name),f=c?"".concat(c,".").concat(o.name):o.name,m=u?[...u,h]:[h];if(!(s<=3))return;let g=n[o.type],x=t[o.type],v=Ih(o)?o:null,b=x||g||v;if(b){null==(l=null==b?void 0:b.fields)||l.forEach(e=>i({acc:a,defType:e,depth:s+1,documentType:d,prevFieldPath:f,prevTitlePath:m}));return}e.includes(o.type)&&a.push({documentTypes:d&&!p?[d]:[],fieldPath:f,filterName:function(e){var t,n;if("string"===e.type&&null!=(t=e.options)&&t.list&&e.options.list.length>0)return"stringList";if(Iu(e)){if(e.of.some(e=>"reference"===e.type))return"arrayReferences";if(e.of.find(e=>"block"===e.type))return"portableText";if(Iu(e)&&e.of.every(e=>["boolean","number","string"].includes(e.type))&&null!=(n=e.options)&&n.list&&e.options.list.length>0)return"arrayList"}return e.type}(o),id:"",name:o.name,titlePath:m,title:h,type:o.type})}({acc:i,defType:l,documentType:r.name}),i),[]);return i.push(...l),i},[]).reduce((e,t)=>{let n=e.findIndex(e=>e.fieldPath===t.fieldPath&&e.title===t.title&&e.type===t.type);return n>-1?e[n]=d6(d6({},e[n]),{},{documentTypes:[...e[n].documentTypes,...t.documentTypes]}):e.push(t),e},[]).map(Ic).sort(If);return i}(a,r,l)}(a,d),...t],[t,a,d]),h=(0,rF.useMemo)(()=>(function(e){let{dataset:t,fieldDefinitions:n,filterDefinitions:i,operatorDefinitions:r,projectId:l,schema:a,user:o}=e;if(!t||!l||!Id||!o)return;let s="".concat("search::recent","__").concat(l,":").concat(t,":").concat(o.id);return{addSearch:(e,t)=>{let l=(t||[]).map(e=>({fieldId:e.fieldId,filterName:e.filterName,operatorType:e.operatorType,value:e.value})),o=l.filter(e=>AR({fieldDefinitions:n,filter:e,filterDefinitions:i,operatorDefinitions:r})),d={created:new Date().toISOString(),filters:o,terms:{query:e.query.trim(),typeNames:e.types.map(e=>e.name)}},c=JSON.stringify(aQ()(d,"created")),u={version:1,recentSearches:[d,...Io(s).recentSearches.filter(e=>JSON.stringify(aQ()(e,"created"))!==c)].slice(0,5)};return window.localStorage.setItem(s,JSON.stringify(u)),Is({fieldDefinitions:n,filterDefinitions:i,lsKey:s,operatorDefinitions:r,schema:a})},getRecentSearches:()=>Is({fieldDefinitions:n,filterDefinitions:i,lsKey:s,operatorDefinitions:r,schema:a}),removeSearch:()=>{let e=Io(s),t=d6(d6({},e),{},{recentSearches:[]});return window.localStorage.setItem(s,JSON.stringify(t)),Is({fieldDefinitions:n,filterDefinitions:i,lsKey:s,operatorDefinitions:r,schema:a})},removeSearchAtIndex:e=>{let t=Io(s);if(e<0||e>t.recentSearches.length)return Is({fieldDefinitions:n,filterDefinitions:i,lsKey:s,operatorDefinitions:r,schema:a});let l=d6(d6({},t),{},{recentSearches:[...t.recentSearches.slice(0,e),...t.recentSearches.slice(e+1)]});return window.localStorage.setItem(s,JSON.stringify(l)),Is({fieldDefinitions:n,filterDefinitions:i,lsKey:s,operatorDefinitions:r,schema:a})}}})({dataset:c,fieldDefinitions:p,filterDefinitions:d,operatorDefinitions:s,projectId:u,schema:a,user:o}),[o,c,p,d,s,u,a]),f=(0,rF.useMemo)(()=>null==h?void 0:h.getRecentSearches(),[h]),m=(0,rF.useMemo)(()=>(function(e){let{currentUser:t,fullscreen:n,recentSearches:i=[],definitions:r}=e;return{currentUser:t,debug:"undefined"!=typeof window&&window.location.hash.slice(1).split(";").includes("_debug_search_score"),documentTypesNarrowed:[],filters:[],filtersVisible:!0,fullscreen:n,ordering:Pq.relevance,pageIndex:0,recentSearches:i,result:{error:null,hasMore:null,hits:[],loaded:!1,loading:!1},terms:{query:"",types:[]},definitions:r}})({currentUser:o,fullscreen:i,recentSearches:f,definitions:{fields:p,operators:s,filters:d}}),[o,p,d,i,s,f]),[g,x]=(0,rF.useReducer)(Iv,m),{documentTypesNarrowed:v,filters:b,ordering:y,pageIndex:j,result:w,terms:k}=g,C=(0,rF.useRef)(!1),_=(0,rF.useRef)(m.ordering),S=(0,rF.useRef)(m.pageIndex),E=(0,rF.useRef)(m.terms),{handleSearch:T,searchState:A}=Sz({initialState:d6(d6({},w),{},{terms:k}),onComplete:e=>x({hits:e,type:"SEARCH_REQUEST_COMPLETE"}),onError:e=>x({error:e,type:"SEARCH_REQUEST_ERROR"}),onStart:()=>x({type:"SEARCH_REQUEST_START"}),schema:a}),P=SE({terms:k}),I=v.map(e=>a.get(e)),M=b.filter(e=>AR({fieldDefinitions:p,filter:e,filterDefinitions:d,operatorDefinitions:s})),z=(0,rF.useCallback)(e=>{r.current=e},[]);return(0,rF.useEffect)(()=>{let e=!lM()(y,_.current),t=j!==S.current,n=!lM()(k,E.current);if(e||t||n){let i=(null==y?void 0:y.customMeasurementLabel)||"".concat(y.sort.field," ").concat(y.sort.direction);T({options:{comments:["findability-mvi:".concat(3),...Im(k)?["findability-recent-search:".concat(k.__recent.index)]:[],"findability-selected-types:".concat(k.types.length),"findability-sort:".concat(i),"findability-filter-count:".concat(M.length)],limit:1e3,offset:1e3*j,skipSortByScore:y.ignoreScore,sort:y.sort},terms:d6(d6({},k),I?{types:I}:{})}),S.current=j}_.current=y,E.current=k},[M.length,b,I,T,P,y,j,A.terms,k]),(0,rF.useEffect)(()=>{!P&&(null==C?void 0:C.current)&&w.hits.length>0&&x({type:"SEARCH_CLEAR"}),C.current=!0},[x,P,w.hits,k.query,k.types]),(0,rz.jsx)(Sf.Provider,{value:{dispatch:x,onClose:null==r?void 0:r.current,recentSearchesStore:h,setOnClose:z,state:d6(d6({},g),{},{fullscreen:i})},children:n})}let Ij=(0,lO.ZP)(rN.mh)(i2||(i2=d4(["\n  min-height: auto;\n  position: relative;\n\n  &[data-search-open='true'] {\n    top: 0;\n    position: sticky;\n  }\n"]))),Iw=(0,lO.ZP)(rN.Zb)(i3||(i3=d4(["\n  line-height: 0;\n"]))),Ik=(0,lO.ZP)(rN.kC)(i4||(i4=d4(["\n  width: max-content;\n"])));function IC(){let e=SW(),{name:t,tools:n}=e,i=d3(e,dB),r=(0,rN.Ur)().theme,l=Tn(),a=(0,lq.z)(),{scheme:o}=E8(),{href:s,onClick:d}=(0,lq.rJ)({state:{}}),c=(0,rN.d2)(),u="string"==typeof a.tool?a.tool:void 0,{onSearchFullscreenOpenChange:p,searchFullscreenOpen:h,searchFullscreenPortalEl:f}=(0,rF.useContext)(TD),m=uQ({defaultComponent:E3,pick:IM}),g=Iz(),[x,v]=(0,rF.useState)(!1),b=(0,rF.useRef)(a),y=(0,rF.useRef)(t);(0,rF.useEffect)(()=>{(b.current.tool!==a.tool||t!==y.current)&&v(!1),b.current=a,y.current=t},[t,a]);let[j,w]=(0,rF.useState)(null),[k,C]=(0,rF.useState)(null),_=(0,rF.useMemo)(()=>({brandingCenter:c<=1,changelog:c>1,collapsedPresenceMenu:c<=1,loginStatus:c>1,searchFullscreen:c<=1,configIssues:c>1&&mD,workspaces:c>=3&&l.length>1,tools:c>=3}),[c,l.length]),S="string"==typeof t&&"root"!==t?l$()(t):null,E=i.title||S||"Studio";(0,rF.useEffect)(()=>{p(h)},[h,p]),(0,rF.useEffect)(()=>{p&&!_.searchFullscreen&&p(!1)},[p,_.searchFullscreen]);let T=(0,rF.useCallback)(()=>{p(!0)},[p]),A=(0,rF.useCallback)(()=>{p(!1),null==k||k.focus()},[p,k]),P=(0,rF.useCallback)(()=>{v(!1),null==j||j.focus()},[j]),I=(0,rF.useCallback)(()=>{v(!0)},[]);return(0,rz.jsxs)(Ij,{zOffset:100,"data-search-open":h,children:[(0,rz.jsx)(Iw,{"data-testid":"navbar","data-ui":"Navbar",padding:2,scheme:"dark",shadow:r.__legacy||"dark"===o?1:void 0,sizing:"border",children:(0,rz.jsxs)(rN.kC,{align:"center",justify:"space-between",children:[(0,rz.jsxs)(Ik,{align:"center",flex:_.brandingCenter?void 0:1,children:[!_.tools&&(0,rz.jsx)(rN.xu,{marginRight:1,children:(0,rz.jsx)(rN.zx,{mode:"bleed",icon:lL.Oqj,onClick:I,ref:w})}),!_.brandingCenter&&(0,rz.jsx)(rN.xu,{marginRight:1,children:(0,rz.jsx)(Ak,{href:s,onClick:d,title:E,children:(0,rz.jsx)(m,{title:E})})}),_.workspaces&&(0,rz.jsx)(rN.xu,{marginRight:2,children:(0,rz.jsx)(rN.u,{content:(0,rz.jsx)(rN.xu,{padding:2,children:(0,rz.jsx)(rN.xv,{size:1,children:"Select workspace"})}),placement:"bottom",portal:!0,scheme:o,children:(0,rz.jsx)(rN.xu,{children:(0,rz.jsx)(TA,{})})})}),(0,rz.jsx)(rN.xu,{marginRight:_.brandingCenter?void 0:2,children:(0,rz.jsx)(TY,{})}),(0,rz.jsx)(rN.li,{children:(0,rz.jsx)(Iy,{fullscreen:_.searchFullscreen,children:(0,rz.jsxs)(rN.NM,{element:document.body,children:[(0,rz.jsx)(rN.Xp,{element:f,children:_.searchFullscreen&&(0,rz.jsx)(P4,{onClose:A,onOpen:T,open:h})}),!_.searchFullscreen&&(0,rz.jsx)(Il,{})]})})}),_.tools&&(0,rz.jsx)(rN.Zb,{borderRight:!0,flex:1,marginX:2,overflow:"visible",paddingRight:1,children:(0,rz.jsx)(g,{activeToolName:u,closeSidebar:P,context:"topbar",isSidebarOpen:!1,tools:n})})]}),_.brandingCenter&&(0,rz.jsx)(rN.xu,{marginX:1,children:(0,rz.jsx)(Ak,{href:s,onClick:d,title:E,children:(0,rz.jsx)(m,{title:E})})}),(0,rz.jsxs)(rN.kC,{align:"center",children:[(0,rz.jsx)(rN.xu,{marginRight:1,children:(0,rz.jsx)(T5,{collapse:_.collapsedPresenceMenu})}),_.changelog&&(0,rz.jsx)(rN.xu,{marginRight:1,children:(0,rz.jsx)(Aj,{})}),_.configIssues&&(0,rz.jsx)(rN.xu,{marginRight:2,children:(0,rz.jsx)(Aw,{})}),_.tools&&(0,rz.jsx)(rN.xu,{children:(0,rz.jsx)(T$,{})}),_.searchFullscreen&&(0,rz.jsx)(rN.zx,{"aria-label":"Open search",icon:lL.W1M,mode:"bleed",onClick:T,ref:C})]})]})}),!_.tools&&(0,rz.jsx)(T9,{activeToolName:u,isOpen:x,onClose:P,tools:n})]})}let I_=(0,rF.forwardRef)(function(e,t){let{name:n}=e,i=d3(e,dU),r=(0,lq.z)(),l=(0,rF.useMemo)(()=>d6(d6({},r),{},{tool:n,[n]:void 0}),[r,n]);return(0,rz.jsx)(lq.Px,d6(d6({state:l},i),{},{ref:t}))});function IS(e){let{activeToolName:t,tools:n}=e,{scheme:i}=E8(),[r,l]=(0,rF.useState)(null);Fg({rootElement:r,navigation:["arrows"]});let a=(0,rF.useMemo)(()=>({popover:{constrainSize:!0,portal:!0,scheme:i}}),[i]),o=(0,rF.useMemo)(()=>n.map((e,n)=>{let r=(null==e?void 0:e.title)||l$()(e.name)||void 0,l=(0,rF.forwardRef)(function(t,n){return(0,rz.jsx)(I_,d6(d6({},t),{},{ref:n,name:e.name}))});return(0,rz.jsx)(w3,{as:l,"data-as":"a",collapsedProps:{tooltipText:e.title},icon:e.icon||lL.Tzq,mode:"bleed",selected:t===e.name,text:r,tooltipProps:{scheme:i}},"".concat(e.name,"-").concat(n))}),[t,i,n]);return(0,rz.jsx)(w2,{"data-testid":"tool-collapse-menu",gap:1,menuButtonProps:a,ref:l,children:o})}function IE(e){let{activeToolName:t,isVisible:n,tools:i}=e;return(0,rF.useMemo)(()=>(0,rz.jsx)(rN.Kq,{as:"ul",space:[1,2],children:i.map(e=>{let i=(null==e?void 0:e.title)||l$()(e.name)||void 0,r=(0,rF.forwardRef)(function(t,n){return(0,rz.jsx)(I_,d6(d6({},t),{},{ref:n,name:e.name}))});return(0,rz.jsx)(rN.Kq,{as:"li",children:(0,rz.jsx)(rN.zx,{as:r,icon:e.icon||lL.BWR,justify:"flex-start",mode:"bleed",selected:t===e.name,tabIndex:n?0:-1,text:i})},e.name)})}),[t,n,i])}function IT(e){let{context:t,isSidebarOpen:n}=e,i=d3(e,dK);return"sidebar"===t?(0,rz.jsx)(IE,d6({isVisible:n},i)):(0,rz.jsx)(IS,d6({},i))}function IA(e){var t,n;return null==(n=null==(t=e.studio)?void 0:t.components)?void 0:n.toolMenu}function IP(e){var t,n;return null==(n=null==(t=e.studio)?void 0:t.components)?void 0:n.navbar}function II(e){var t,n;return null==(n=null==(t=e.studio)?void 0:t.components)?void 0:n.layout}function IM(e){var t,n;return null==(n=null==(t=e.studio)?void 0:t.components)?void 0:n.logo}function Iz(){return uQ({defaultComponent:IT,pick:IA})}let IR=ck.__sanityErrorChannel;function IF(){let{push:e}=(0,rN.pm)();return(0,rF.useEffect)(()=>{if(IR)return IR.subscribe(t=>{var n;!(!t.error||(n=t.error)instanceof EJ||n instanceof uf||n instanceof EY)&&(console.error(t.error),e({id:t.error.message,closable:!0,description:t.error.message,duration:5e3,title:"Uncaught error",status:"error"}))})},[e]),null}function IO(e){let{children:t,AuthenticateComponent:n=TP,LoadingComponent:i=Ts,NotAuthenticatedComponent:r=TM}=e,[l,a]=(0,rF.useState)(null);if(l)throw l;let[o,s]=(0,rF.useState)("loading"),{activeWorkspace:d}=Tv();return((0,rF.useEffect)(()=>{var e,t;null==(t=(e=d.auth).handleCallbackUrl)||t.call(e).catch(a)},[d.auth]),(0,rF.useEffect)(()=>{let e=d.auth.state.subscribe({next:e=>{var t;let{authenticated:n,currentUser:i}=e;if((null==(t=null==i?void 0:i.roles)?void 0:t.length)===0){s("unauthorized");return}s(n?"logged-in":"logged-out")},error:a});return()=>{e.unsubscribe()}},[d]),"loading"===o)?(0,rz.jsx)(i,{}):"unauthorized"===o?(0,rz.jsx)(r,{}):"logged-out"===o?(0,rz.jsx)(n,{}):(0,rz.jsx)(rz.Fragment,{children:t})}function ID(e){let{children:t}=e,n=Tv().activeWorkspace.theme,i=E8(),r=n.__legacy?n.__dark?"dark":"light":i.scheme;return(0,rz.jsx)(E5.Provider,{value:d6(d6({},i),{},{scheme:r}),children:(0,rz.jsx)(rN.f6,{scheme:r,theme:n,tone:"transparent",children:(0,rz.jsx)(rN.li,{children:t})})})}let IZ={toast:[100,11e3]};function IL(e){let t={}.toolSwitcher||{},n=t.order||[],i=t.hidden||[];if(!n.length&&!i.length)return e;let r=e.reduce((e,t)=>{let i=t.title||"<unknown>";if(!t.name)return console.warn('Tool "'.concat(i,'" does not have the required "name" property')),e;if(e[t.name]){let r=e[t.name].tool.title;return console.warn('Tools with duplicate name "'.concat(t.name,'" found ("').concat(i,'" and "').concat(r,'")')),e}let l=n.indexOf(t.name);return e[t.name]={tool:t,index:-1===l?1/0:l},e},{}),l=e=>-1===i.indexOf(e.name),a=e.filter(l);return a.sort((e,t)=>{let n=r[e.name],i=r[t.name],l=n?n.index:1/0,a=i?i.index:1/0;return l===a?0:l-a}),a}function Iq(e){return null!=e}(0,lO.ZP)(rN.kC)(i5||(i5=d4([""]))),(0,lO.ZP)(rN.xu).attrs({padding:4})(i6||(i6=d4([""])));let IN=e=>"state"===e.type,IV={isNotFound:!0,state:{}},IB=ch(e=>{let[t,n,i]=e;return n&&i?(function(e){let{unstable_history:t,router:n,tools:i}=e,r=n.getBasePath(),l=new rQ.y(e=>{let n=t.listen(t=>e.next(t));return e.next(t.location),n}).pipe((0,lt.h)(e=>{let{pathname:t}=e;return"/"===r||RegExp("^".concat(oL()(r),"(\\/|$)"),"i").test(t)}),(0,r8.U)(e=>{let{pathname:t}=e;return{type:"state",state:n.decode(t)||{},isNotFound:n.isNotFound(t)}}),(0,lb.fU)(function(e,r){var l;if((null==r?void 0:r.type)==="state"&&(null==(l=r.state)?void 0:l.intent)){let a=function(e,t,n){let{intent:i,params:r,payload:l}=n;if("string"!=typeof i)throw Error("intent must be a string");if(!cC(r))throw Error("intent params must be a string");let a=IL(e),o=(null==t?void 0:t.tool)?a.find(e=>e.name===t.tool):null,s=(o?[o,...a]:a).find(e=>e&&"function"==typeof e.canHandleIntent&&e.canHandleIntent(i,r,t&&t[e.name]));if(null==s?void 0:s.getIntentState){let d=s.getIntentState(i,r,t&&t[s.name],l);return{type:"state",isNotFound:!1,state:d6(d6({},t),{},{tool:s.name,[s.name]:d})}}return{type:"intent",isNotFound:!0,intent:{name:i,params:r}}}(i,(null==e?void 0:e.type)==="state"?e.state:{},r.state);if((null==a?void 0:a.type)==="state")return t.replace(n.encode(a.state)),rJ.E}return(0,rB.of)(r)},null),(0,lt.h)(Iq),(0,r8.U)(function(e){if("state"===e.type){let r=function(e,t){let n=function(e,t){let n=IL(e),i=n[0];return t&&!t.tool&&i?Object.assign({},t,{tool:i.name}):t}(e,t&&IL(e).find(e=>e.name===t.space)?d6(d6({},t),{},{tool:t.space,space:void 0}):t);return n}(i,e.state);if(r&&r!==e.state)return t.replace(n.encode(r)),null}return e}),(0,lt.h)(Iq),(0,r9.x)(lM()),(0,ln.d)(1));return l})({unstable_history:t,router:n,tools:i}).pipe((0,lt.h)(IN),(0,r7.R)((e,t)=>d6(d6({},e),{},{isNotFound:t.isNotFound,state:t.state}),IV)):(0,rB.of)(IV)},IV);function IU(e){let{children:t,LoadingComponent:n}=e,[i,r]=(0,rF.useState)(null);if(i)throw i;let{activeWorkspace:l,__internal:{history:a}}=Tv(),[o,s]=(0,rF.useState)(null),d=(0,rF.useCallback)(e=>{e.replace?a.replace(e.path):a.push(e.path)},[a]);(0,rF.useEffect)(()=>{let e=(0,r0.aj)(l.__internal.sources.map(e=>{let{source:t}=e;return t.pipe((0,le.K)(e=>{if(e instanceof EY)return(0,rB.of)(e);throw e}))})).pipe((0,r8.U)(e=>{let t=e.filter(e=>e instanceof EY);if(t.length)throw new EY({name:l.name,causes:t,type:"workspace"});return e}),(0,r8.U)(e=>{let[t,...n]=e;return d6(d6(d6({},l),t),{},{unstable_sources:[t,...n],type:"workspace"})})).subscribe({next:s,error:r});return()=>e.unsubscribe()},[l]);let c=null==o?void 0:o.tools,u=(0,rF.useMemo)(()=>{if(o)return function(e){let{basePath:t="/",tools:n}=e,i=lq.BC.create("/:tool",e=>{let t=n.find(t=>t.name===e.tool);return t?lq.BC.scope(t.name,"/",t.router):lq.BC.create("/")});return lq.BC.create(t,[lq.BC.intents("/intent"),i])}(o)},[o]),[p]=IB((0,rF.useMemo)(()=>[a,u,c],[a,u,c]));return u&&o?(0,rz.jsx)(SX,{workspace:o,children:(0,rz.jsx)(SY,{source:o.unstable_sources[0],children:(0,rz.jsx)(lq.pG,{onNavigate:d,router:u,state:p.state,children:t})})}):(0,rz.jsx)(n,{})}function IK(e){let{ConfigErrorsComponent:t}=e,n=d3(e,dH),[{error:i},r]=(0,rF.useState)({error:null});if(i)throw i;return(0,rz.jsx)(rN.SV,{onCatch:r,children:(0,rz.jsx)(IU,d6({},n))})}function IH(e){let{children:t,config:n,onSchemeChange:i,scheme:r,unstable_history:l,unstable_noAuthBoundary:a}=e,o=(0,rF.useMemo)(()=>a?rF.Fragment:IO,[a]);return(0,rz.jsx)(E6,{onSchemeChange:i,scheme:r,children:(0,rz.jsxs)(rN.VW,{paddingY:7,zOffset:IZ.toast,children:[(0,rz.jsx)(IF,{}),(0,rz.jsx)(TF,{children:(0,rz.jsx)(E9,{config:n,children:(0,rz.jsx)(Tx,{unstable_history:l,NotFoundComponent:Tf,LoadingComponent:Ts,children:(0,rz.jsx)(ID,{children:(0,rz.jsx)(vb,{children:(0,rz.jsx)(o,{LoadingComponent:Ts,AuthenticateComponent:TP,NotAuthenticatedComponent:TM,children:(0,rz.jsx)(IK,{LoadingComponent:Ts,ConfigErrorsComponent:TI,children:(0,rz.jsx)(up,{children:t})})})})})})})})]})})}function I$(){let e=uQ({defaultComponent:TZ,pick:II});return(0,rz.jsx)(e,{})}function IX(e){let{unstable_globalStyles:t}=e,n=d3(e,d$);return(0,rz.jsxs)(IH,d6(d6({},n),{},{children:[t&&(0,rz.jsx)(uN,{}),(0,rz.jsx)(I$,{})]}))}function IW(e){let t=SJ();return e?t.getClient(e):(console.warn('Calling `useClient()` without specifying an API version is deprecated and will stop working in the next dev-preview release - please migrate to use `useClient({apiVersion: "2021-06-07"})`.'),t.getClient({apiVersion:"2021-06-07"}))}op().registerLanguage(of()),op().registerLanguage(og()),op().registerLanguage(ov()),op().registerLanguage(oy()),op().registerLanguage(ow());let IG="connecting";function IY(e,t){let n=Rg();return(0,rV.m2)(()=>n.pair.documentEvents(e,t).pipe((0,r8.U)(e=>e.type),(0,r8.U)(e=>"reconnect"!==e),(0,r6.w)(e=>e?(0,rB.of)("connected"):(0,rG.H)(200).pipe((0,ly.h)("reconnecting"))),(0,li.O)(IG),(0,r9.x)()),[e,t],IG)}function IJ(){return SJ().dataset}function IQ(e,t){let n=Rg();return(0,rV.m2)(()=>n.pair.editOperations(e,t),[t,n.pair,e])}function I0(e,t){let n=Rg();return(0,rV.m2)(()=>n.pair.operationEvents(e,t),[e,t])}function I1(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"default",i=Rg();return(0,rV.m2)(()=>{let r=i.pair.editState(e,t).pipe((0,lh.B)());return"low"===n?(0,r$.T)(r.pipe((0,lo.q)(1)),r.pipe((0,lj.T)(1),(0,lv.D)(()=>(0,rG.H)(1e3)))):i.pair.editState(e,t)},[e,t,n])}function I2(){return SJ().projectId}function I3(){return SJ().schema}let I4={isSyncing:!0},I5={isSyncing:!1};function I6(e,t){let n=Rg();return(0,rV.m2)(()=>n.pair.consistencyStatus(e,t).pipe((0,r8.U)(e=>e?I5:I4)),[e],I5)}function I8(){return SJ().templates}function I7(e){let{minimal:t,agoSuffix:n}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=e instanceof Date?e:new Date(e);if(!n.getTime())return{timestamp:"",refreshInterval:null};let i=Date.now(),r=(0,au.Z)(i,n),l=(0,ap.Z)(i,n);if(r||l)return t.minimal&&0===l?{timestamp:(0,ao.Z)(n,"MMM d"),refreshInterval:null}:t.minimal?{timestamp:(0,ao.Z)(n,"MMM d, yyyy"),refreshInterval:null}:{timestamp:(0,ao.Z)(n,"MMM d, yyyy, hh:mm a"),refreshInterval:null};let a=(0,ah.Z)(i,n),o=(0,av.Z)("week",a);if(a)return t.minimal?{timestamp:t.agoSuffix?"".concat(a,"w ago"):"".concat(a,"w"),refreshInterval:36e5}:{timestamp:t.agoSuffix?"".concat(a," ").concat(o," ago"):"".concat(a," ").concat(o),refreshInterval:36e5};let s=(0,af.Z)(i,n),d=(0,av.Z)("days",s);if(s){if(t.minimal){let c=t.agoSuffix?"".concat(s,"d ago"):"".concat(s,"d");return{timestamp:1===s?"yesterday":c,refreshInterval:36e5}}let u=t.agoSuffix?"".concat(s," ").concat(d," ago"):"".concat(s," ").concat(d);return{timestamp:1===s?"yesterday":u,refreshInterval:36e5}}let p=(0,am.Z)(i,n),h=(0,av.Z)("hour",p);if(p)return t.minimal?{timestamp:t.agoSuffix?"".concat(p,"h ago"):"".concat(p,"h"),refreshInterval:6e4}:{timestamp:t.agoSuffix?"".concat(p," ").concat(h," ago"):"".concat(p," ").concat(h),refreshInterval:6e4};let f=(0,ag.Z)(i,n),m=(0,av.Z)("minute",f);if(f)return t.minimal?{timestamp:t.agoSuffix?"".concat(f,"m ago"):"".concat(f,"m"),refreshInterval:2e4}:{timestamp:t.agoSuffix?"".concat(f," ").concat(m," ago"):"".concat(f," ").concat(m),refreshInterval:2e4};let g=(0,ax.Z)(i,n),x=(0,av.Z)("second",g);return g>10?t.minimal?{timestamp:t.agoSuffix?"".concat(g,"s ago"):"".concat(g,"s"),refreshInterval:5e3}:{timestamp:t.agoSuffix?"".concat(g," ").concat(x," ago"):"".concat(g," ").concat(x),refreshInterval:5e3}:{timestamp:"just now",refreshInterval:5e3}}(e,{minimal:t,agoSuffix:n}),[,r]=(0,rF.useReducer)(e=>e+1,0);return(0,rF.useEffect)(()=>{let e;return null!==i.refreshInterval&&function t(n){e=window.setTimeout(()=>{r(),e=window.setTimeout(()=>t(n),n)},n)}(i.refreshInterval),()=>{null!==e&&clearTimeout(e)}},[r,i.refreshInterval]),i.timestamp}let I9={validation:[],isValidating:!1};function Me(e,t){let n=Rg();return(0,rV.m2)(()=>n.pair.validation(e,t),[e,t],I9)}let Mt=ch(e=>{let[t,n]=e;return(0,r1.D)(t.getUser(n))});function Mn(e){let t=Rp();return Mt((0,rF.useMemo)(()=>[t,e],[e,t]))}function Mi(){let{currentUser:e}=SJ();return e}let Mr=e=>{let t=e.LOCAL,n=e.document.HEAD;return t?d6(d6({},t),{},{_type:(n||t)._type,_rev:(n||t)._rev,_updatedAt:new Date().toISOString()}):t},Ml=e=>({type:"snapshot",document:e}),Ma=e=>e.document,Mo=e=>{let t=new rH.xQ,n=new r3.X(!0),i=new rH.xQ,r=new rH.xQ,l=new rH.xQ,a=new rH.xQ,o=e=>{let t=new oW.W6(e);return t.onMutation=e=>{let{mutation:n,remote:r}=e;i.next({type:"mutation",document:Mr(t),mutations:n.mutations,origin:r?"remote":"local"})},t.onRemoteMutation=e=>{l.next({type:"remoteMutation",head:t.document.HEAD,transactionId:e.transactionId,timestamp:e.timestamp,author:e.identity,effects:e.effects})},t.onRebase=(e,t,n)=>{r.next({type:"rebase",document:e,remoteMutations:t,localMutations:n})},t.onConsistencyChanged=e=>{n.next(e)},t.commitHandler=e=>a.next(e),t},s=e.pipe((0,r7.R)((e,t)=>"snapshot"===t.type?(e&&e.commit(),o(t.document||null)):null===e?(console.warn('Ignoring event of type "%s" since buffered document has not yet been set up with snapshot',t.type),null):e,null),(0,lt.h)(e=>null!==e),(0,r9.x)(),(0,lf._)(1),(0,lm.x)()),d=e.pipe((0,lt.h)(e=>"mutation"===e.type),(0,lw.M)(s),(0,r8.U)(e=>{let[t,n]=e;return n.arrive(new oW.mm(t)),Mr(n)})),c=t.pipe((0,lw.M)(s),(0,lr.b)(e=>{let[t,n]=e;"mutation"===t.type&&n.add(new oW.mm({mutations:t.mutations})),"commit"===t.type&&n.commit()}),(0,ll.j)(rJ.E),(0,lh.B)()),u=e=>t.next(e),p=e=>u({type:"mutation",mutations:e}),h=e=>p([e]),f=()=>{s.pipe((0,lo.q)(1),(0,lr.b)(e=>e.commit())).subscribe()},m=(0,r$.T)(s.pipe((0,r8.U)(e=>e.LOCAL)),i.pipe((0,r8.U)(Ma)),r.pipe((0,r8.U)(Ma)),d).pipe((0,r8.U)(Ml),(0,lf._)(1),(0,lm.x)()),g=(0,r$.T)(s.pipe((0,r8.U)(e=>e.document.HEAD),(0,r8.U)(Ml)),l).pipe((0,lf._)(1),(0,lm.x)());return{updates$:(0,r$.T)(m,c,i,r),consistency$:n.pipe((0,r9.x)(),(0,lf._)(1),(0,lm.x)()),remoteSnapshot$:g,commitRequest$:a,addMutation:h,addMutations:p,commit:f}},Ms=e=>t=>{let{_id:n,_rev:i,_updatedAt:r}=t,l=d3(t,dX);return d6({_id:e},l)},Md=(e,t)=>{let n=Mo(t),i=Ms(e),r={delete:{id:e}};return{events:n.updates$,consistency$:n.consistency$,remoteSnapshot$:n.remoteSnapshot$,commitRequest$:n.commitRequest$,patch:t=>t.map(t=>({patch:d6(d6({},t),{},{id:e})})),create:e=>({create:i(e)}),createIfNotExists:e=>({createIfNotExists:i(e)}),createOrReplace:e=>({createOrReplace:i(e)}),delete:()=>r,mutate:e=>n.addMutations(e),commit:()=>n.commit()}},Mc={type:"pending",phase:"begin"},Mu={type:"pending",phase:"end"};function Mp(e,t){return{type:"snapshot",documentId:e,document:t}}let Mh=e=>t=>"reconnect"!==t.type&&"pending"!==t.type&&t.documentId===e;function Mf(e){return t=>d6(d6({},t),{},{version:e})}function Mm(e,t){let{publishedId:n,draftId:i}=t,r=(function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},{publishedId:i,draftId:r}=t;return(0,rX.P)(()=>e.observable.listen("*[_id == $publishedId || _id == $draftId]",{publishedId:i,draftId:r},{includeResult:!1,events:["welcome","mutation","reconnect"],effectFormat:"mendoza",tag:n.tag||"document.pair-listener"})).pipe((0,lg.b)(t=>"welcome"===t.type?e.observable.getDocuments([r,i],{tag:"document.snapshots"}).pipe((0,r8.U)(e=>{let[t,n]=e;return{draft:t,published:n}})).pipe((0,lg.b)(e=>[Mp(r,e.draft),Mp(i,e.published)])):(0,rB.of)(t)),(0,r7.R)((e,t)=>{if("mutation"!==t.type)return{next:[t],buffer:[]};let n=e.buffer.length>0,i=t.transactionTotalEvents>1;if(!i&&!n)return{next:[t],buffer:[]};if(!i)return{next:[],buffer:e.buffer.concat(t)};let r=e.buffer.concat(t);return!function(e){let t=os()(e.filter(e=>"mutation"===e.type),e=>e.transactionId);return Object.values(t).every(e=>e.length===e[0].transactionTotalEvents)}(r)?{next:1===r.length?[Mc]:[],buffer:r}:{next:r.concat(Mu),buffer:[]}},{next:[],buffer:[]}),(0,ls.zg)(e=>e.next))})(e,t).pipe((0,lh.B)()),l=r.pipe((0,lt.h)(e=>"reconnect"===e.type)),a=Md(i,r.pipe((0,lt.h)(Mh(i)))),o=Md(n,r.pipe((0,lt.h)(Mh(n)))),s=r.pipe((0,lt.h)(e=>"pending"===e.type)),d=(0,r$.T)(a.commitRequest$,o.commitRequest$).pipe((0,ls.zg)(t=>(0,r1.D)(function(e,t){let{resultRev:n}=t,i=d3(t,dW);return e.dataRequest("mutate",i,{visibility:"async",returnDocuments:!1,tag:"document.commit",skipCrossDatasetReferenceValidation:!0})}(e,t.mutation.params)).pipe((0,lr.b)({error:e=>{let n="statusCode"in e&&"number"==typeof e.statusCode&&e.statusCode>=400&&e.statusCode<=500;n?t.cancel(e):t.failure(e)},next:()=>t.success()}))),(0,ll.j)(rJ.E),(0,lh.B)());return{transactionsPendingEvents$:s,draft:d6(d6({},a),{},{events:(0,r$.T)(d,l,a.events).pipe((0,r8.U)(Mf("draft"))),consistency$:a.consistency$,remoteSnapshot$:a.remoteSnapshot$.pipe((0,r8.U)(Mf("draft")))}),published:d6(d6({},o),{},{events:(0,r$.T)(d,l,o.events).pipe((0,r8.U)(Mf("published"))),consistency$:o.consistency$,remoteSnapshot$:o.remoteSnapshot$.pipe((0,r8.U)(Mf("published")))})}}let Mg=(e,t)=>{var n;return(null==(n=e.get(t))?void 0:n.liveEdit)===!0};function Mx(e,t){let n=Object.create(null);return function(){let i=t(...arguments);return i in n||(n[i]=e(...arguments)),n[i]}}let Mv=Mx((e,t,n)=>new rQ.y(n=>{n.next(Mm(e,t))}).pipe((0,lf._)(1),(0,lm.x)()),(e,t)=>t.publishedId);function Mb(e){return"snapshot"===e.type}function My(e){return{snapshots$:e.events.pipe((0,lt.h)(Mb),(0,r8.U)(e=>e.document),(0,lf._)(1),(0,lm.x)()),patch:e.patch,create:e.create,createIfNotExists:e.createIfNotExists,createOrReplace:e.createOrReplace,delete:e.delete,mutate:e.mutate,commit:e.commit}}let Mj=Mx((e,t,n)=>Mv(e,t,n).pipe((0,r8.U)(e=>{let{published:t,draft:n,transactionsPendingEvents$:i}=e;return{transactionsPendingEvents$:i,published:My(t),draft:My(n)}}),(0,lf._)(1),(0,lm.x)()),(e,t,n)=>t.publishedId+n),Mw={enabled:!0},Mk={enabled:!1},MC=(e,t,n)=>{let i=Mg(e.schema,n);return Mj(e.client,t,n).pipe((0,r6.w)(e=>(0,r0.aj)([e.draft.snapshots$,e.published.snapshots$,e.transactionsPendingEvents$.pipe((0,r8.U)(e=>"begin"===e.phase?Mw:Mk),(0,li.O)(Mk))])),(0,r8.U)(e=>{let[r,l,a]=e;return{id:t.publishedId,type:n,draft:r,published:l,liveEdit:i,ready:!0,transactionSyncLock:a}}),(0,li.O)({id:t.publishedId,type:n,draft:null,published:null,liveEdit:i,ready:!1,transactionSyncLock:null}),(0,lf._)(1),(0,lm.x)())},M_=Mx((e,t,n)=>Mj(e.client,t,n).pipe((0,r6.w)(i=>(0,r0.aj)([i.draft.snapshots$,i.published.snapshots$]).pipe((0,r8.U)(r=>{let[l,a]=r;return d6(d6({},e),{},{idPair:t,typeName:n,snapshots:{draft:l,published:a},draft:i.draft,published:i.published})}))),(0,lf._)(1),(0,lm.x)()),(e,t,n)=>t.publishedId+n),MS={disabled:e=>{let{snapshots:t}=e;return!t.draft&&!t.published&&"NOTHING_TO_DELETE"},execute:e=>{let{client:t,schema:n,idPair:i,typeName:r}=e,l=t.observable.transaction().delete(i.publishedId);return Mg(n,r)?l.commit({tag:"document.delete"}):l.delete(i.draftId).commit({tag:"document.delete",skipCrossDatasetReferenceValidation:!0})}},ME={disabled:e=>{let{schema:t,typeName:n,snapshots:i}=e;return Mg(t,n)?"LIVE_EDIT_ENABLED":!i.draft&&(i.published?"ALREADY_PUBLISHED":"NO_CHANGES")},execute:e=>{let{client:t,idPair:n,snapshots:i}=e;if(!i.draft)throw Error('cannot execute "publish" when draft is missing');let r=function e(t){return(0,rM.Yk)(t)?t._strengthenOnPublish?aQ()(t,["_strengthenOnPublish"].concat(t._strengthenOnPublish.weak?[]:["_weak"])):t:"object"==typeof t&&t?Array.isArray(t)?t.map(e):Object.fromEntries(Object.entries(t).map(t=>{let[n,i]=t;return[n,e(i)]})):t}(aQ()(i.draft,"_updatedAt")),l=t.observable.transaction();if(!i.draft)throw Error('cannot execute "publish" when draft is missing');return i.published?(l.patch(n.publishedId,{unset:["_revision_lock_pseudo_field_"],ifRevisionID:i.published._rev}),l.createOrReplace(d6(d6({},r),{},{_id:n.publishedId,_type:i.draft._type}))):l.create(d6(d6({},r),{},{_id:n.publishedId,_type:i.draft._type})),l.delete(n.draftId),l.commit({tag:"document.publish",visibility:"async"})}},MT={disabled:()=>!1,execute:function(e){let{schema:t,snapshots:n,idPair:i,draft:r,published:l,typeName:a}=e,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],s=arguments.length>2?arguments[2]:void 0;Mg(t,a)?l.mutate([l.createIfNotExists(d6({_type:a},s)),...l.patch(o)]):r.mutate([r.createIfNotExists(d6(d6(d6({},s),n.published),{},{_id:i.draftId,_type:a})),...r.patch(o)])}},MA={disabled:()=>!1,execute:e=>{let{draft:t,published:n}=e;return t.commit(),n.commit(),rJ.E}},MP={disabled:e=>{let{snapshots:t}=e;return t.draft?!t.published&&"NOT_PUBLISHED":"NO_CHANGES"},execute:e=>{let{client:t,idPair:n}=e;return t.observable.transaction().delete(n.draftId).commit({tag:"document.discard-changes"})}},MI={disabled:e=>{let{schema:t,snapshots:n,typeName:i}=e;return Mg(t,i)?"LIVE_EDIT_ENABLED":!n.published&&"NOT_PUBLISHED"},execute:e=>{let{client:t,idPair:n,snapshots:i}=e,r=t.observable.transaction().delete(n.publishedId);return i.published&&(r=r.createIfNotExists(d6(d6({},aQ()(i.published,"_updatedAt")),{},{_id:n.draftId,_type:i.published._type}))),r.commit({tag:"document.unpublish",visibility:"async",skipCrossDatasetReferenceValidation:!0})}},MM=["_createdAt","_updatedAt"],Mz={disabled:e=>{let{snapshots:t}=e;return!t.published&&!t.draft&&"NOTHING_TO_DUPLICATE"},execute:(e,t)=>{let{schema:n,client:i,snapshots:r,typeName:l}=e,a=r.draft||r.published;if(!a)throw Error("cannot execute on empty document");return i.observable.create(d6(d6({},aQ()(a,MM)),{},{_id:Mg(n,l)?t:cv(t),_type:a._type}),{tag:"document.duplicate"})}},MR={disabled:()=>!1,execute:(e,t)=>{let{historyStore:n,schema:i,idPair:r,typeName:l}=e,a=Mg(i,l)?r.publishedId:r.draftId;return n.restore(r.publishedId,a,t)}},MF=Mx((e,t,n)=>Mv(e,t,n).pipe((0,r6.w)(e=>{let{draft:t,published:n}=e;return(0,r0.aj)([t.consistency$,n.consistency$])}),(0,r8.U)(e=>{let[t,n]=e;return t&&n}),(0,r9.x)(),(0,lf._)(1),(0,lm.x)()),(e,t,n)=>t.publishedId+n),MO={del:MS,delete:MS,publish:ME,patch:MT,commit:MA,discardChanges:MP,unpublish:MI,duplicate:Mz,restore:MR},MD=(e,t,n)=>{let i=MO[e];return(0,rX.P)(()=>{var e;return(0,r$.T)((0,rB.of)(null),void 0===(e=i.execute(t,...n))?(0,rB.of)(null):e)}).pipe((0,lk.Z)())},MZ=new rH.xQ;function ML(e,t,n,i){MZ.next({operationName:e,idPair:t,typeName:n,extraArgs:i})}let Mq=["publish","unpublish","discardChanges","delete"],MN=new Map;function MV(e){let{dataset:t,projectId:n}=e.client.config(),i="".concat(n,"-").concat(t);if(MN.has(i))return MN.get(i);let r=MZ.pipe((0,lC.v)(e=>e.idPair.publishedId),(0,ls.zg)(t=>t.pipe((0,r6.w)(t=>M_(e,t.idPair,t.typeName).pipe((0,lo.q)(1),(0,r6.w)(n=>{let i=Mq.includes(t.operationName);i&&(n.published.commit(),n.draft.commit());let r=MF(e.client,t.idPair,t.typeName).pipe((0,lt.h)(Boolean)),l=i?r.pipe((0,lo.q)(1)):(0,rB.of)(null);return l.pipe((0,ls.zg)(()=>MD(t.operationName,n,t.extraArgs)))}),(0,r8.U)(()=>({type:"success",args:t})),(0,le.K)(e=>(0,rB.of)({type:"error",args:t,error:e})))))),(0,lh.B)()),l=r.pipe((0,lt.h)(e=>"success"===e.type&&"patch"===e.args.operationName),(0,l_.p)(1e3,r4.z,{leading:!0,trailing:!0}),(0,lr.b)(e=>{ML("commit",e.args.idPair,e.args.typeName,[])})),a=new Map;function o(e,t){let n="".concat(e.publishedId,":").concat(t),i=a.get(n);return i||(i=(0,r$.T)(r,l.pipe((0,ll.j)(rJ.E))).pipe((0,lt.h)(t=>t.args.idPair.publishedId===e.publishedId),(0,r8.U)(e=>{let{operationName:t,idPair:n}=e.args;return"success"===e.type?{type:"success",op:t,id:n.publishedId}:{type:"error",op:t,id:n.publishedId,error:e.error}})),a.set(n,i)),i}return MN.set(i,o),o}let MB=Mx((e,t,n)=>Mv(e,t,n).pipe((0,r6.w)(e=>{let{published:t,draft:n}=e;return(0,r$.T)(t.remoteSnapshot$,n.remoteSnapshot$)})),(e,t,n)=>t.publishedId+n),MU={isValidating:!0,validation:[]},MK=[],MH=(e,t)=>e(t).pipe((0,r8.U)(e=>{let{published:t}=e;return t.available})),M$=Mx((e,t,n)=>{let{draftId:i,publishedId:r}=t,l=MC(e,{draftId:i,publishedId:r},n).pipe((0,r8.U)(e=>{let{draft:t,published:n}=e;return t||n}),(0,l_.p)(200,r4.z,{trailing:!0}),(0,r9.x)((e,t)=>(null==e?void 0:e._rev)===(null==t?void 0:t._rev)||aC()(aQ()(e,"_rev","_updatedAt"),aQ()(t,"_rev","_updatedAt"))),(0,lh.B)()),a=l.pipe((0,r8.U)(e=>(0,o7.u4)(e,(e,t)=>((0,rM.Yk)(t)&&e.add(t._ref),e),new Set)),(0,ls.zg)(e=>(0,r1.D)(e))),o=a.pipe((0,lC.v)(e=>e,void 0,()=>(0,rG.H)(18e5)),(0,ls.zg)(t=>t.pipe((0,lS.E)(),(0,ls.zg)(t=>MH(e.observeDocumentPairAvailability,t).pipe((0,r8.U)(e=>[t,e]))))),(0,r7.R)((e,t)=>{let[n,i]=t;return Boolean(e[n])===i?e:i?d6(d6({},e),{},{[n]:i}):aQ()(e,n)},{}),(0,r9.x)(aC()),(0,ln.d)({refCount:!0,bufferSize:1})),s=e=>{let{id:t}=e;return o.pipe((0,lx.P)(),(0,r8.U)(e=>e[t])).toPromise()},d=o.pipe((0,lj.T)(1),(0,l_.p)(1e3,r4.z,{leading:!0,trailing:!0}));return(0,r0.aj)([l,(0,rU.z)((0,rB.of)(null),d)]).pipe((0,r8.U)(e=>{let[t]=e;return t}),(0,o9.q)(t=>(0,rX.P)(()=>(null==t?void 0:t._type)?(0,rU.z)((0,rB.of)({isValidating:!0,revision:t._rev}),(0,lJ.aj)(e.getClient,t,e.schema,{getDocumentExists:s}).pipe((0,r8.U)(e=>({validation:e,isValidating:!1})))):(0,rB.of)({validation:MK,isValidating:!1}))),(0,r7.R)((e,t)=>d6(d6({},e),t),MU),(0,lf._)(1),(0,lm.x)())},(e,t)=>t.publishedId);function MX(e){return{disabled:"NOT_READY",execute:()=>{throw Error("Called ".concat(e," before it was ready."))}}}let MW={commit:MX("commit"),delete:MX("delete"),del:MX("del"),publish:MX("publish"),patch:MX("patch"),discardChanges:MX("discardChanges"),unpublish:MX("unpublish"),duplicate:MX("duplicate"),restore:MX("restore")},MG=(e,t,n)=>function(){for(var i=arguments.length,r=Array(i),l=0;l<i;l++)r[l]=arguments[l];return ML(e,t,n,r)};function MY(e,t,n){let i=t.disabled(n);return{disabled:i,execute:MG(e,n.idPair,n.typeName)}}function MJ(e){return{commit:MY("commit",MA,e),delete:MY("delete",MS,e),del:MY("delete",MS,e),publish:MY("publish",ME,e),patch:MY("patch",MT,e),discardChanges:MY("discardChanges",MP,e),unpublish:MY("unpublish",MI,e),duplicate:MY("duplicate",Mz,e),restore:MY("restore",MR,e)}}let MQ=new Map,M0=(e,t,n)=>{let i="".concat(t.publishedId,":").concat(n),r=MQ.get(i);if(!r){let l=MV(e),a=l(t,n).pipe((0,ll.j)(rJ.E)),o=M_(e,t,n),s=o.pipe((0,r8.U)(MJ));r=(0,rU.z)((0,rB.of)(MW),(0,r$.T)(a,s)).pipe((0,lf._)(1),(0,lm.x)()),MQ.set(i,r)}return r},M1=(e,t,n,i)=>(0,rX.P)(()=>e.observable.fetch(t,n,{tag:i.tag,filterResponse:!0})),M2=(e,t,n,i)=>(0,rX.P)(()=>e.listen(t,n,{events:["welcome","mutation","reconnect"],includeResult:!1,visibility:"query",tag:i.tag}));function M3(e){return"welcome"===e.type}let M4=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},r="string"==typeof t?t:t.fetch,l="string"==typeof t?t:t.listen,a=M1(e,r,n,i),o=M2(e,l,n,i).pipe((0,ls.zg)((e,t)=>0!==t||M3(e)?(0,rB.of)(e):(0,rW._)(Error("reconnect"===e.type?"Could not establish EventSource connection":'Received unexpected type of first event "'.concat(e.type,'"')))),(0,lh.B)()),[s,d]=(0,r5.u)(o,M3),c=e=>!i.transitions||"mutation"!==e.type||i.transitions.includes(e.transition);return(0,r$.T)(s.pipe((0,lo.q)(1)),d.pipe((0,lt.h)(c),(0,l_.p)(i.throttleTime||1e3,r4.z,{leading:!0,trailing:!0}))).pipe((0,o9.t)(a))},M5=["_key","_ref","_weak","_type"];function M6(e){return e&&e.length>0?'"'.concat(e,'"'):e}function M8(e,t){let n=e=>'Template "'.concat(t.id,'" initial value: ').concat(e);if(!oR()(e))throw Error(n("resolved to a non-object"));if(e._type&&t.schemaType!==e._type)throw Error(n('includes "_type"-property ('.concat(e._type,") that does not match template (").concat(t.schemaType,")")));try{return function e(t){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(Array.isArray(t))return t.map((t,i)=>{if(Array.isArray(t))throw Error('multidimensional arrays are not supported (at path "'.concat((0,rR.BB)(n),'")'));return e(t,n.concat(i),!0)});if(!oR()(t))return t;let r=i&&!t._key?{_key:(0,a3.E2)()}:{};return n.length>0&&!t._type&&t._ref&&(r._type="reference"),t._ref&&function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];if(!e._type&&e.type)throw Error('Reference is missing "_type", but has a "type" property at path "'.concat((0,rR.BB)(t),'"'));let n=Object.keys(e).filter(e=>!M5.includes(e));if(n.length>0){let i=n.length>1?"properties":"property";throw Error("Disallowed ".concat(i," found in reference: ").concat(n.map(M6).join(", "),' at path "').concat((0,rR.BB)(t),'"'))}}(t,n),Object.keys(t).reduce((i,r)=>(i[r]=e(t[r],n.concat([r])),i),r)}(e)}catch(i){throw i.message=n(i.message),i}}function M7(e,t){let n=d6(d6({},e),t);return Object.keys(n).forEach(i=>{let r=t[i],l=e[i];oR()(r)&&oR()(l)&&(n[i]=M7(l,r))}),n}async function M9(e,t,n){return"function"==typeof e?e(t,n):e}async function ze(e,t){var n;let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=arguments.length>3?arguments[3]:void 0;if(oR()(t)&&"function"==typeof t.serialize)return ze(e,t.serialize(),i,r);let{id:l,schemaType:a,value:o}=t;if(!o)throw Error('Template "'.concat(l,'" has invalid "value" property'));let s=await M9(o,i,r);if(n=s,!oR()(n))throw Error('Template "'.concat(l,'" has invalid "value" property - must be a plain object or a resolver function returning a plain object'));s=M8(s,t);let d=e.get(a);if(!d)throw Error('Could not find schema type with name "'.concat(a,'".'));let c=M7(await zn(d,i,zt,r)||{},s);return M8(c,t)}let zt=10;function zn(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:zt,i=arguments.length>3?arguments[3]:void 0;return n<=0?Promise.resolve(void 0):(0,rM.m$)(e)?zr(e,t,n,i):(0,rM.jB)(e)?zi(e,t,n,i):M9(e.initialValue,t,i)}async function zi(e,t,n,i){let r=await M9(e.initialValue,void 0,i);if(Array.isArray(r))return Promise.all(r.map(async r=>{let l=function(e,t){let n=(0,a3.wq)(t);return"object"===n&&1===e.of.length?e.of[0]:e.of.find(e=>e.name===n)}(e,r);return(0,rM.m$)(l)?d6(d6(d6({},r),await zn(l,t,n-1,i)),{},{_key:(0,a3.E2)()}):r}))}async function zr(e,t,n,i){let r=d6({},await M9(e.initialValue,t,i)||{}),l={};await Promise.all(e.fields.map(async e=>{let r=await zn(e.type,t,n-1,i);null!=r&&(l[e.name]=r)}));let a=M7(l,r);if(!(0,a3.xb)(a))return"object"!==e.name&&(a._type=e.name),a}let zl={type:"loading"};function za(e){if(cg(e))throw Error("editOpsOf does not expect a draft id.");return{publishedId:e,draftId:cv(e)}}let zo={isLoaded:!1,documentType:void 0};function zs(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"*",n=Rg(),i=cb(e),r=Boolean(t&&"*"!==t),l=(0,rF.useMemo)(()=>({documentType:t,isLoaded:!0}),[t]),[a,o]=(0,rF.useState)(r?l:zo);return(0,rF.useEffect)(()=>o(zo),[i,t]),(0,rF.useEffect)(()=>{if(r)return;let e=n.resolveTypeForDocument(i,t).subscribe(e=>o({documentType:e,isLoaded:!0}));return()=>e.unsubscribe()},[n,i,t,r]),r?l:a}function zd(e){let{documentId:t,documentType:n,templateName:i,templateParams:r}=e,l=cp(r),a=Rg(),o=zc(),s=(0,rF.useMemo)(()=>({_id:t,_type:n}),[t,n]),[d,c]=(0,rF.useState)({loading:!1,error:null,value:s});return(0,rF.useEffect)(()=>{if(!i){c({loading:!0,error:null,value:s});return}let e=a.initialValue({documentId:t,documentType:n,templateName:i,templateParams:l},o),r=e.subscribe(e=>{"loading"===e.type&&c({loading:!0,error:null,value:s}),"success"===e.type&&c({loading:!1,error:null,value:e.value?d6(d6({},s),e.value):s}),"error"===e.type&&c({loading:!1,error:e.error,value:s})});return c({loading:!0,error:null,value:s}),()=>r.unsubscribe()},[s,t,a,n,i,l,o]),d}function zc(){let e=SJ(),t=I3(),n=Mi(),i=I2(),r=IJ(),l=e.getClient;return(0,rF.useMemo)(()=>({projectId:i,dataset:r,getClient:l,schema:t,currentUser:n}),[l,t,n,i,r])}function zu(){let e=zc();return(0,rF.useCallback)((t,n)=>zn(t,n,zt,e),[e])}let zp=ch(function(e){let{client:t,grantsStore:n,schema:i,id:r,permission:l,type:a}=e;if("*"===a)return(0,rB.of)({granted:!1,reason:"Type specified was `*`"});let o=Boolean(function(e,t){let n=e.get(t);if(!n)throw Error("No such schema type: ".concat(t));return n}(i,a).liveEdit);return Mj(t,{draftId:cv(r),publishedId:cb(r)},a).pipe((0,r6.w)(e=>(0,r0.aj)([e.draft.snapshots$,e.published.snapshots$]).pipe((0,r8.U)(e=>{let[t,n]=e;return{draft:t,published:n}}))),(0,r6.w)(e=>{let{draft:t,published:i}=e,r=(function(e){let{grantsStore:t,permission:n,draft:i,published:r,liveEdit:l}=e,a=i||r,o=a===i?"draft":"published",{checkDocumentPermission:s}=t;switch(n){case"delete":if(l)return[["delete published document (live-edit)",s("update",r)]];return[["delete draft document",s("update",i)],["delete published document",s("update",r)]];case"discardDraft":if(l)return[];return[["delete draft document",s("update",i)]];case"publish":if(l)return[];return[["update published document at its current state",s("update",r)],["delete draft document",s("update",i)],["create published document from draft",s("create",i&&d6(d6({},i),{},{_id:cb(i._id)}))]];case"unpublish":if(l)return[];return[["update draft document at its current state",s("create",i)],["delete published document",s("update",r)],["create draft document from published version",s("create",r&&d6(d6({},r),{},{_id:cv(r._id)}))]];case"update":if(l)return[["update published document (live-edit)",s("update",r)]];return[["update ".concat(o," document"),s("update",a)]];case"duplicate":if(l)return[["create new published document from existing document (live-edit)",s("create",d6(d6({},r),{},{_id:"dummy-id"}))]];return[["create new draft document from existing ".concat(o," document"),s("create",d6(d6({},a),{},{_id:cv("dummy-id")}))]];default:throw Error("Could not match permission: ".concat(n))}})({grantsStore:n,permission:l,draft:t,published:i,liveEdit:o}).map(e=>{let[t,n]=e;return n.pipe((0,r8.U)(e=>{let{granted:n,reason:i}=e;return{granted:n,reason:n?"":"not allowed to ".concat(t,": ").concat(i),label:t,permission:l}}))});return r.length?(0,r0.aj)(r).pipe((0,r8.U)(e=>{let t=e.every(e=>e.granted),n=t?"":"Unable to ".concat(l,":\n	").concat(e.filter(e=>!e.granted).map(e=>e.reason).join("\n	"));return{granted:t,reason:n}})):(0,rB.of)({granted:!0,reason:""})}))});function zh(e){let{id:t,type:n,permission:i,client:r,schema:l,grantsStore:a}=e,o=IW(uX),s=I3(),d=Rh(),c=(0,rF.useMemo)(()=>r||o,[o,r]),u=(0,rF.useMemo)(()=>l||s,[s,l]),p=(0,rF.useMemo)(()=>a||d,[d,a]);return zp((0,rF.useMemo)(()=>({client:c,schema:u,grantsStore:p,id:t,permission:i,type:n}),[c,p,t,i,u,n]))}function zf(e){let{grantsStore:t,document:n,permission:i}=e,{checkDocumentPermission:r}=t;return r(i,n)}let zm=ch(zf);function zg(e){let{document:t,permission:n}=e,i=d3(e,dG),r=Rh();return zm({grantsStore:i.grantsStore||r,document:t,permission:n})}let zx=ch(function(e){let{grantsStore:t,templateItems:n,templates:i,schema:r,context:l}=e;return(null==n?void 0:n.length)?(0,r0.aj)(n.map(function e(t){return t&&"serialize"in t?e(t.serialize()):t}).map(async e=>{let t=i.find(t=>t.id===e.templateId);if(!t)throw Error('template not found: "'.concat(e.templateId,'"'));let n=await ze(r,t,e.parameters,l);return{template:t,item:e,resolvedInitialValue:n}}).map(e=>(0,r1.D)(e).pipe((0,r6.w)(e=>{let{item:n,resolvedInitialValue:i,template:l}=e,a=r.get(l.schemaType);if(!a)throw Error('schema type not found: "'.concat(l.schemaType,'"'));let o=null==a?void 0:a.liveEdit,{initialDocumentId:s="dummy-id"}=n;return zf({grantsStore:t,permission:"create",document:d6({_id:o?cb(s):cv(s)},i)}).pipe((0,r8.U)(e=>{let{granted:t,reason:r}=e,o=n.title||l.title,s=d6(d6({},n),{},{granted:t,reason:r,resolvedInitialValue:i,template:l,title:o,subtitle:a.title===o?void 0:a.title,description:n.description||l.description,icon:n.icon||l.icon});return s}))})))):(0,rB.of)([])});function zv(e){let{templateItems:t}=e,n=d3(e,dY),i=I3(),r=I8(),l=Rh(),a=zc();return zx({templateItems:t,grantsStore:n.grantsStore||l,schema:n.schema||i,templates:n.templates||r,context:a})}let zb="_debug_",zy="undefined"==typeof window?(0,rB.of)({}):(0,rK.R)(window,"hashchange"),zj=(0,rU.z)((0,rB.of)(0),zy).pipe((0,r8.U)(()=>"undefined"==typeof document?"#":document.location.hash),(0,r9.x)(),(0,r8.U)(e=>e.substring(1).split(";").filter(e=>e.toLowerCase().startsWith(zb)).map(e=>e.substring(zb.length)))),zw=zj.pipe((0,r8.U)(e=>e.find(e=>e.startsWith("roles="))),(0,r8.U)(e=>(null==e?void 0:e.split("roles=")[1].split(",").map(e=>e.trim()))||[])),zk=[{filter:'_id in path("**")',permissions:["read","create","history","update"]}],zC=[{filter:'_id in path("**")',permissions:["read","history"]}],z_={administrator:[{filter:'_id in path("**")',permissions:["read","create","history","update"]}],editor:zk,developer:[{filter:'_id in path("**")',permissions:["read","create","history","update"]}],contributor:[{filter:'_id in path("**")',permissions:["read"]},{filter:'_id in path("drafts.**")',permissions:["create","history","update"]}],viewer:zC,restricted:[{filter:'_id in path("drafts.**") && _type in ["stringsTest", "book", "author", "referenceTest"]',permissions:["read","create","history","update"]},{filter:'_id in path("**")',permissions:["read"]}],requiresApproval:[{filter:"!locked",permissions:["read","create","update"]}],read:zC,write:zk},zS=zw.pipe((0,r8.U)(e=>e.length?e.filter(e=>Boolean(e)&&e in z_).flatMap(e=>z_[e]||[]):null));async function zE(e,t,n){let i=await e.request({uri:"/projects/".concat(t,"/datasets/").concat(n,"/acl"),tag:"acl.get",withCredentials:!0});return i}let zT=new Map;async function zA(e,t,n){zT.has(t)||zT.set(t,(0,se.Q)("*[".concat(t,"]")));let i=zT.get(t),r=function(e){let t={};return null!==e&&(t.identity=e.id),t}(e),l=await (await (0,se.k)(i,{dataset:[n],params:r})).get();return(null==l?void 0:l.length)===1}async function zP(e,t,n,i){if(!i)return{granted:!0,reason:"Null document, nothing to check"};if(!t.length)return{granted:!1,reason:"No document grants"};let r=[];for(let l of t)await zA(e,l.filter,i)&&r.push(l);let a=r.some(e=>e.permissions.some(e=>e===n));return{granted:a,reason:a?"Matching grant":"No matching grants found"}}async function zI(e,t){let n=await fetch(e,t?{headers:{Authorization:"Bearer ".concat(t)}}:{credentials:"include"});return function(e){let t;let n=e.body;if(!n)throw Error("Failed to read body from response");let i=!1;return new ReadableStream({start(e){t=n.getReader();let r=new TextDecoder,l="";t.read().then(function n(a){if(a.done){if(i)return;if(0===(l=l.trim()).length){e.close();return}e.enqueue(JSON.parse(l)),e.close();return}l+=r.decode(a.value,{stream:!0});let o=l.split("\n");for(let s=0;s<o.length-1;++s){let d=o[s].trim();if(0!==d.length)try{e.enqueue(JSON.parse(d))}catch(c){e.error(c),i=!0,t.cancel();return}}return l=o[o.length-1],t.read().then(n).catch(t=>e.error(t))}).catch(t=>e.error(t))},cancel(){i=!0,t.cancel()}})}(n)}function zM(e){return{id:e,hasAttrs:!1,attrs:null,rev:null,events:[],aligned:!1}}function zz(e,t){if(e.hasAttrs=!0,t){if(e.attrs=d6({},t),"string"!=typeof e.attrs._rev)throw Error("snapshot has no _rev");e.rev=e.attrs._rev,delete e.attrs._rev}else e.attrs=null,e.rev=null;e.events=[]}class zR{constructor(e){this.earliestTransactionId=null,this.timeline=e,this._states={draft:zM(e.draftId),published:zM(e.publishedId)}}appendRemoteSnapshotEvent(e){let t=this._states[e.version];if("snapshot"===e.type){this._maybeInvalidateHistory(),zz(t,e.document);return}"remoteMutation"===e.type&&(t.aligned?(this._apply(t,e),this.timeline.addRemoteMutation(e)):t.hasAttrs?t.events.push(e):zz(t,e.head))}prependHistoryEvent(e){if(!this.acceptsHistory)throw Error("cannot prepend history at this point");for(let t of Object.values(this._states))if(!t.aligned){let n=function(e,t){let n=t.events.findIndex(t=>e.id===t.transactionId);return n>=0?n+1:t.rev?t.rev===e.id?0:-1:0}(e,t);n>=0&&this._alignAtIndex(t,n)}this.timeline.addTranslogEntry(e),this.earliestTransactionId=e.id}didReachEarliestEntry(){for(let e of Object.values(this._states))if(!e.aligned){if(null!==e.attrs)throw Error("unable to find translog entry to align to");this._alignAtIndex(e,0)}this.timeline.didReachEarliestEntry()}get isAligned(){return Object.values(this._states).every(e=>e.aligned)}get acceptsHistory(){return this._isComplete}get currentDocument(){return{draft:this._states.draft.attrs,published:this._states.published.attrs}}_alignAtIndex(e,t){for(let n of e.events.slice(0,t))this._apply(e,n);for(let i of e.events.slice(t))this._apply(e,i),this.timeline.addRemoteMutation(i);e.events=[],e.aligned=!0}get _isComplete(){return Object.values(this._states).every(e=>e.hasAttrs)}_apply(e,t){e.attrs=(0,sn.a)(e.attrs,t.effects.apply),e.rev=t.transactionId}_maybeInvalidateHistory(){if(this._isComplete){for(let e of Object.values(this._states))e.aligned=!1;this.earliestTransactionId=null,this.timeline.reset()}}}class zF{constructor(e,t,n,i){this.timeline=e,this.start=n,this.end=i,this.doc=t}same(e,t){return this.start===e&&this.end===t}endAttributes(){return zO(this.endDocument())}endDocument(){return this._endDocument||(this._endDocument=this.timeline.replayBackwardsUntil(this.end.end,this.doc)),this._endDocument}startAttributes(){return zO(this.startDocument())}startDocument(){if(!this.start)throw Error("start required");return this._startDocument||(this._startDocument=this.timeline.replayBackwardsBetween(this.start.end,this.end.end-1,this.endDocument())),this._startDocument}diff(){if(!this._diff){if(!this.start)throw Error("start required");this._diff=this.timeline.calculateDiff(this.startDocument(),this.endDocument(),this.start.index+1,this.end.index)}return this._diff}}function zO(e){return e.draft||e.published}class zD{constructor(e){this.version=0,this.selectionState="inactive",this._fetchMore=!1,this._fetchAtLeast=0,this._isRunning=!1,this._didErr=!1,this._since=null,this._sinceTime=null,this._rev=null,this._revTime=null,this.timeline=e.timeline,this.client=e.client,this.handler=e.handler,this._aligner=new zR(this.timeline),this.markChange()}clearRange(){this.setRange(null,null)}setRange(e,t){t!==this._rev&&this.setRevTime(t),e!==this._since&&this.setSinceTime(e);let n=10;if("loading"!==this._sinceTime&&"loading"!==this._revTime&&this._aligner.isAligned){if("invalid"===this._sinceTime||"invalid"===this._revTime)this.selectionState="invalid";else if(this._sinceTime){this.selectionState="range";let i=this._revTime||this.timeline.lastChunk();this._sinceTime.index>i.index?(this._revTime="invalid",this.selectionState="invalid"):this.setReconstruction(this._sinceTime,i)}else this._revTime?(this.selectionState="rev",this.setReconstruction(null,this._revTime)):(this.selectionState="inactive",n=0)}else this.selectionState="loading";this._fetchAtLeast=n,this.start()}setLoadMore(e){this._fetchMore=e,this.start()}get sinceTime(){return this._sinceTime&&"object"==typeof this._sinceTime?this._sinceTime:null}get revTime(){return this._revTime&&"object"==typeof this._revTime?this._revTime:null}get realRevChunk(){return this.revTime||this.timeline.lastChunk()}onOlderRevision(){return Boolean(this._rev)&&("range"===this.selectionState||"rev"===this.selectionState)}changesPanelActive(){return Boolean(this._since)&&"range"===this.selectionState}findRangeForNewRev(e){let t=this.timeline.isLatestChunk(e)?null:this.timeline.createTimeId(e);if(!this._since)return[null,t];let n=this.sinceTime;return n&&n.index<e.index?[this._since,t]:["@lastPublished",t]}findRangeForNewSince(e){let t=this.revTime;return t&&e.index<t.index?[this.timeline.createTimeId(e),this._rev]:[this.timeline.createTimeId(e),null]}setRevTime(e){this._rev=e,this._revTime=e?this.timeline.parseTimeId(e):null,"@lastPublished"===this._since&&(this._since=null,this._sinceTime=null)}setSinceTime(e){"@lastPublished"===e?"string"==typeof this._revTime?this._sinceTime=this._revTime:this._sinceTime=this.timeline.findLastPublishedBefore(this._revTime):this._sinceTime=e?this.timeline.parseTimeId(e):null,this._since=e}sinceAttributes(){return this._sinceTime&&this._reconstruction?this._reconstruction.startAttributes():null}displayed(){return this._revTime&&this._reconstruction?this._reconstruction.endAttributes():null}setReconstruction(e,t){this._reconstruction&&this._reconstruction.same(e,t)||(this._reconstruction=new zF(this.timeline,this._aligner.currentDocument,e,t))}currentDiff(){return this._reconstruction?this._reconstruction.diff():null}currentObjectDiff(){let e=this.currentDiff();if(e){if("null"===e.type)return null;if("object"!==e.type)throw Error("ObjectDiff expected, got ".concat(e.type))}return e}handleRemoteMutation(e){this._aligner.appendRemoteSnapshotEvent(e),this.markChange(),this._aligner.acceptsHistory&&this.start()}start(){this._didErr||this._isRunning||(this._isRunning=!0,this.tick().then(()=>{this._isRunning=!1}))}async tick(){let e=this._aligner.acceptsHistory&&!this.timeline.reachedEarliestEntry&&("loading"===this.selectionState||this._fetchMore||this.timeline.chunkCount<=this._fetchAtLeast);if(e){try{await this.fetchMoreTransactions()}catch(t){this._didErr=!0,this.handler(t,this);return}await this.tick()}}async fetchMoreTransactions(){let e=this.timeline.publishedId,t=this.timeline.draftId,n=this.client.config(),i="tag=sanity.studio.desk.history&effectFormat=mendoza&excludeContent=true&excludeMutations=true&includeIdentifiedDocumentsOnly=true&reverse=true&limit=".concat(50),r=this._aligner.earliestTransactionId;r&&(i+="&toTransaction=".concat(r));let l=this.client.getUrl("/data/history/".concat(n.dataset,"/transactions/").concat(e,",").concat(t,"?").concat(i)),a=await zI(l,n.token),o=a.getReader(),s=0;for(;;){let d=await o.read();if(d.done)break;if("error"in d.value)throw Error(d.value.error.description||d.value.error.type);if(s++,d.value.id!==r){if(this._aligner.earliestTransactionId!==r||!this._aligner.acceptsHistory)return;this._aligner.prependHistoryEvent(d.value),r=this._aligner.earliestTransactionId}}this._aligner.earliestTransactionId===r&&this._aligner.acceptsHistory&&(s<50&&this._aligner.didReachEarliestEntry(),this.markChange())}markChange(){this.timeline.updateChunks(),this.setRevTime(this._rev),this.setSinceTime(this._rev),this.version++,this.handler(null,this)}}function zZ(e){return e.draft||e.published}class zL{constructor(e,t,n,i){this.type="array",this.elements=[],this.content=e,this.value=t,this.annotation=n,this.extractor=i,this.length=e.elements.length}at(e){if(e>=this.length)throw Error("out of bounds");let t=this.elements[e];return t||(this.elements[e]=zV(this.content.elements[e],this.value[e],this.extractor))}annotationAt(e){let t=this.content.metas[e];return this.extractor.fromMeta(t)}}class zq{constructor(e,t,n,i){this.type="object",this.fields={},this.content=e,this.value=t,this.annotation=n,this.extractor=i,this.keys=Object.keys(e.fields)}get(e){let t=this.fields[e];if(t)return t;let n=this.content.fields[e];if(n)return this.fields[e]=zV(n,this.value[e],this.extractor)}}class zN{constructor(e,t,n,i){this.type="string",this.content=e,this.value=t,this.annotation=n,this.extractor=i}sliceAnnotation(e,t){let n=[],i=0;for(let r of this.content.parts){let l=r.value.length,a=Math.max(0,e-i);if(a<l){let o=Math.min(l,t-i);if(o<=0)break;!function(e,t){if(n.length>0){var i;let r=n[n.length-1];if((i=r.annotation)&&t?i.author===t.author&&i.chunk===t.chunk:!i&&!t){r.text+=e;return}}n.push({text:e,annotation:t})}(r.value.slice(a,o),this.extractor.fromValue(r))}i+=l}return n}}function zV(e,t,n){let i=n.fromValue(e);if(e.content)switch(e.content.type){case"array":return new zL(e.content,t,i,n);case"object":return new zq(e.content,t,i,n);case"string":return new zN(e.content,t,i,n)}return(0,sr.r)(t,i)}function zB(e,t,n){return n?zK(e,n.transactionIndex+1,n.chunk.index):t?zK(e,t.start,t.index):null}function zU(e,t){return t?zK(e,t.transactionIndex,t.chunk.index):null}function zK(e,t,n){let i=e.transactionByIndex(t);if(!i)return null;let r=e.chunkByTransactionIndex(t,n);return r?{chunk:r,timestamp:i.timestamp,author:i.author}:null}class zH{constructor(){this._postive=[],this._negative=[]}addToEnd(e){e.index=this._postive.length,this._postive.push(e)}addToBeginning(e){if(0==this.length){this.addToEnd(e);return}e.index=-(this._negative.length+1),this._negative.push(e)}mergeAtEnd(e,t){if(0===this.length){this.addToEnd(e);return}let n=this.lastIdx,i=t(this.get(n),e);Array.isArray(i)?(this.set(n,i[0]),this.addToEnd(i[1])):this.set(n,i)}mergeAtBeginning(e,t){if(0===this.length){this.addToEnd(e);return}let n=this.firstIdx,i=t(e,this.get(n));Array.isArray(i)?(this.set(n,i[1]),this.addToBeginning(i[0])):this.set(n,i)}removeFromEnd(){0===this._postive.length?this._negative.shift():this._postive.pop()}has(e){return e>=0?e<this._postive.length:-(e+1)<this._negative.length}get(e){return e>=0?this._postive[e]:this._negative[-(e+1)]}set(e,t){e>=0?(t.index=e,this._postive[e]=t):(t.index=e,this._negative[-(e+1)]=t)}get lastIdx(){return this._postive.length-1}get last(){return this.get(this.lastIdx)}get firstIdx(){return-this._negative.length}get first(){return this.get(this.firstIdx)}get length(){return this._postive.length+this._negative.length}}function z$(e,t){var n,i;if(e.end!==t.start)throw Error("chunks are not next to each other");let r=zG(e.draftState,t.draftState),l=zG(e.publishedState,t.publishedState);if("delete"===e.type&&"editDraft"===t.type)return[e,d6(d6({},t),{},{type:"create",draftState:r,publishedState:l})];if("delete"===t.type){if("missing"===r&&"present"===l)return[e,d6(d6({},t),{},{type:"discardDraft",draftState:r,publishedState:l})];if("present"===r&&"missing"===l)return[e,d6(d6({},t),{},{type:"unpublish",draftState:r,publishedState:l})]}if(("create"===(n=e.type)||"editDraft"===n)&&"editDraft"===t.type&&(i=e.endTimestamp,Date.parse(t.startTimestamp)-Date.parse(i)<3e5)){let a=new Set;for(let o of e.authors)a.add(o);for(let s of t.authors)a.add(s);return{index:0,id:t.id,type:e.type,start:e.start,end:t.end,startTimestamp:e.startTimestamp,endTimestamp:t.endTimestamp,authors:a,draftState:r,publishedState:l}}return[e,d6(d6({},t),{},{draftState:r,publishedState:l})]}function zX(e){let t=Boolean(e),n=e&&zY(null==e?void 0:e.apply);return n?"deleted":t?"upsert":"unedited"}function zW(e){let t=Boolean(e.draftEffect),n=Boolean(e.publishedEffect),i=e.draftEffect&&zY(e.draftEffect.apply),r=e.publishedEffect&&zY(e.publishedEffect.apply),l=function(e){let t=zX(e.draftEffect),n=zX(e.publishedEffect);if("unedited"===n){if("deleted"===t)return"delete";if("upsert"===t)return"editDraft"}if("deleted"===n)return"delete";if("upsert"===n){if("unedited"===t)return"editLive";if("deleted"===t)return"publish"}return"editLive"}(e);return{index:0,id:e.id,type:l,start:e.index,end:e.index+1,startTimestamp:e.timestamp,endTimestamp:e.timestamp,authors:new Set([e.author]),draftState:t?i?"missing":"present":"unknown",publishedState:n?r?"missing":"present":"unknown"}}function zG(e,t){return"unknown"===t?e:t}function zY(e){return 0===e[0]&&null===e[1]}class zJ{constructor(e){this.reachedEarliestEntry=!1,this._transactions=new zH,this._chunks=new zH,this._possiblePendingTransactions=new Map,this.publishedId=e.publishedId,this.draftId="drafts.".concat(e.publishedId),e.enableTrace&&(this._trace=[],this._trace.push({type:"initial",publishedId:e.publishedId}),window.__sanityTimelineTrace=this._trace)}get chunkCount(){return this._chunks.length}mapChunks(e){let t=[],n=this._chunks.firstIdx,i=this._chunks.lastIdx;for(let r=i;r>=n;r--)t.push(e(this._chunks.get(r),r));return t}reset(){this._transactions=new zH,this._chunks=new zH,this._possiblePendingTransactions=new Map,this._recreateTransactionsFrom=void 0,this.reachedEarliestEntry=!1}addRemoteMutation(e){this._trace&&this._trace.push({type:"addRemoteMutation",event:e});let t=this._possiblePendingTransactions.get(e.transactionId),n=t?t.transaction:{index:0,id:e.transactionId,timestamp:e.timestamp.toISOString(),author:e.author};"draft"===e.version?n.draftEffect=e.effects:n.publishedEffect=e.effects,t?(this._possiblePendingTransactions.delete(e.transactionId),this._invalidateTransactionFrom(t.idx)):(this._transactions.addToEnd(n),this._possiblePendingTransactions.set(e.transactionId,{transaction:n,idx:this._transactions.lastIdx}))}addTranslogEntry(e){this._trace&&this._trace.push({type:"addTranslogEntry",event:e}),this._transactions.addToBeginning({index:0,id:e.id,author:e.author,timestamp:e.timestamp,draftEffect:e.effects[this.draftId],publishedEffect:e.effects[this.publishedId]})}didReachEarliestEntry(){this._trace&&this._trace.push({type:"didReachEarliestEntry"}),this.reachedEarliestEntry=!0}updateChunks(){this._trace&&this._trace.push({type:"updateChunks"}),this._removeInvalidatedChunks(),this._addChunksFromTransactions(),this._createInitialChunk()}_removeInvalidatedChunks(){if(this._recreateTransactionsFrom){for(;this._chunks.length>0;){let e=this._chunks.last;if(this._recreateTransactionsFrom<e.end)this._chunks.removeFromEnd();else break}this._recreateTransactionsFrom=void 0}}_addChunksFromTransactions(){let e=this._transactions.firstIdx,t=this._transactions.lastIdx,n=this._chunks.length>0?this._chunks.last.end:e;for(let i=n;i<=t;i++){let r=this._transactions.get(i);this._chunks.mergeAtEnd(zW(r),z$)}if(0==this._chunks.length)return;let l=this._chunks.first.start;for(let a=l-1;a>=e;a--){let o=this._transactions.get(a);this._chunks.mergeAtBeginning(zW(o),z$)}}_invalidateTransactionFrom(e){(void 0===this._recreateTransactionsFrom||e<this._recreateTransactionsFrom)&&(this._recreateTransactionsFrom=e)}_createInitialChunk(){var e;if(this.reachedEarliestEntry){if((null==(e=this._chunks.first)?void 0:e.type)==="initial")return;let t=this._transactions.first;if(!t)return;let n=zW(t);n.type="initial",n.id="@initial",n.end=n.start,this._chunks.addToBeginning(n)}}parseTimeId(e){if(0===this._chunks.length)return this.reachedEarliestEntry?"invalid":"loading";let t=e.split("/",3),n=t.shift(),i=t.shift(),r=Number(n);for(let l=this._chunks.lastIdx;l>=this._chunks.firstIdx;l--){let a=this._chunks.get(l);if(a.id===i)return a;if(Date.parse(a.endTimestamp)+36e5<r)return"invalid"}return this.reachedEarliestEntry?"invalid":"loading"}findLastPublishedBefore(e){for(let t=e?e.index-1:this._chunks.lastIdx;t>=this._chunks.firstIdx;t--){let n=this._chunks.get(t);if("publish"===n.type||"initial"===n.type)return n}return this.reachedEarliestEntry?this._chunks.first:"loading"}isLatestChunk(e){return e===this._chunks.last}createTimeId(e){return"".concat(e.endTimestamp.valueOf(),"/").concat(e.id)}lastChunk(){return this._chunks.last}transactionByIndex(e){return this._transactions.has(e)?this._transactions.get(e):null}chunkByTransactionIndex(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=t;for(;;){let i=this._chunks.get(n);if(!i)throw Error("transaction does not belong in any chunk");if(e>=i.end)n++;else{if(!(e<i.start))return i;n--}}}replayBackwardsBetween(e,t,n){let i=n.draft,r=n.published;for(let l=t;l>=e;l--){let a=this._transactions.get(l);a.draftEffect&&(i=(0,sn.a)(i,a.draftEffect.revert)),a.publishedEffect&&(r=(0,sn.a)(r,a.publishedEffect.revert))}return{draft:i,published:r}}replayBackwardsUntil(e,t){return this.replayBackwardsBetween(e,this._transactions.lastIdx,t)}calculateDiff(e,t,n,i){var r,l;let a=si.re(e.draft,null),o=si.re(e.published,null),s=(r=a,l=o,"null"===si.oL(r)?l:r),d=zZ(e),c=null;for(let u=n;u<=i;u++){let p=this._chunks.get(u);c||(c=p);for(let h=p.start;h<p.end;h++){let f=this._transactions.get(h),m={chunk:p,transactionIndex:h},g=a,x=o;f.draftEffect&&(a=si.af(a,f.draftEffect.apply,m)),f.publishedEffect&&(o=si.af(o,f.publishedEffect.apply,m));let v="null"!==si.oL(g),b="null"!==si.oL(a),y="null"!==si.oL(o);y&&!b&&(o=si.ZI(g,o)),b&&!v&&(a=si.ZI(x,a))}}let j="null"===si.oL(a)?o:a,w=zZ(t);return function(e,t,n,i,r,l){let a=zV(n,i,{fromValue:n=>zB(e,t,n.endMeta),fromMeta:n=>zB(e,t,n)}),o=zV(r,l,{fromValue:t=>zU(e,t.startMeta),fromMeta:t=>zU(e,t)});return(0,sr.t)(a,o)}(this,c,s,d,j,w)}}let zQ=Object.create(null),z0=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=Array.isArray(t)?t:[t],{time:r,revision:l}=n;if(r&&l)throw Error("getHistory can't handle both time and revision parameters");let a=e.clientConfig.dataset,o="/data/history/".concat(a,"/documents/").concat(i.join(","));if(l)o="".concat(o,"?revision=").concat(l);else{let s=r||new Date().toISOString();o="".concat(o,"?time=").concat(s)}return e.request({url:o})},z1=(e,t,n)=>{let i=cb(t),r=cv(t),l="".concat(i,"@").concat(n),a=zQ[l];if(a)return a;let o=e.clientConfig.dataset,s="/data/history/".concat(o,"/documents/").concat(i,",").concat(r,"?revision=").concat(n),d=e.request({url:s}).then(e=>{let t=e.documents||[],n=t.find(e=>e._id===i),l=t.find(e=>e._id===r);return l||n});return zQ[l]=d,d},z2=async(e,t)=>{let n=Array.isArray(t)?t:[t],i=e.clientConfig.dataset,r="/data/history/".concat(i,"/transactions/").concat(n.join(",")),l=await e.request({url:r,query:{excludeContent:"true",includeIdentifiedDocumentsOnly:"true"}}),a=l.toString("utf8").split("\n").filter(Boolean).map(e=>JSON.parse(e));return a},z3=e=>(0,o7.u4)(e,(e,t)=>(0,rM.Yk)(t)&&!e.includes(t._ref)?[...e,t._ref]:e,[]),z4=(e,t)=>(function e(t,n){return Array.isArray(t)?n(t.map(t=>e(t,n)).filter(e=>void 0!==e)):cC(t)?n(Object.keys(t).reduce((i,r)=>{let l=e(t[r],n);return void 0!==l&&(i[r]=l),i},{})):n(t)})(e,e=>(0,rM.Yk)(e)?t(e):e),z5=(e,t)=>z4(e,e=>{let n=t[e._ref];return n?e:void 0}),z6=[["nested","first"],["nested","second"],["nestedArray",{_key:"565c867c8dac"},"arrayNo1",{_key:"a645548a8f01"},"arrayNo1",{_key:"1685e372c40f"},"fieldNo0"],["nestedArray",{_key:"565c867c8dac"},"fieldNo0"],["nestedArray",{_key:"565c867c8dac"},"arrayNo19",{_key:"a02e7a93e2a2"},"fieldNo0"],["nestedArray",{_key:"565c867c8dac"},"arrayNo19",{_key:"a02e7a93e2a2"},"fieldNo19"],["address","country"],["address","street"],["customInputWithDefaultPresence","row3","cell3"]],z8=(0,rX.P)(()=>(0,rG.H)(0,1e4)).pipe((0,ll.j)(["pqSMwf6hH","pnLYqNfv5","priDVVmy8","p0NFOU0j8","pTDl2jw8d","pHMeQnTse","pDQYzJbyS","pZyoPHKUs","p4Tyi2Be5","pb9vii060","pE8yhOisw","p7Fd2C6Cj","p3exSgYCx","pbIQRYViC","p8GJaTEhN","p27ewL8aM","pYg97z75S","pdLr4quHv","pkJXiDgg6","pkl4UAKcA","pNoExists"]),(0,r8.U)((e,t)=>({type:"state",userId:e,sessionId:e+t,timestamp:new Date().toISOString(),locations:[{type:"document",documentId:"presence-debug",lastActiveAt:new Date().toISOString(),path:so()(z6)}]})),(0,ln.d)()),z7=e=>{if("rollCall"===e.type)return{type:"rollCall",userId:e.i,sessionId:e.session};if("state"===e.type){let{sessionId:t,locations:n}=e.m;return{type:"state",userId:e.i,sessionId:t,timestamp:new Date().toISOString(),locations:n}}if("disconnect"===e.type)return{type:"disconnect",userId:e.i,sessionId:e.m.session,timestamp:new Date().toISOString()};throw Error("Got unknown presence event: ".concat(JSON.stringify(e)))},z9=(e,t)=>{let n=e.request("presence").pipe((0,r8.U)(z7)),i=n=>"rollCall"===n.type?e.request("presence_rollcall",{session:t}):"state"===n.type?e.request("presence_announce",{data:{locations:n.locations,sessionId:t}}):"disconnect"===n.type?e.request("presence_disconnect",{session:t}):rJ.E;return[n.pipe((0,lh.B)()),i]},Re="presence_session_id",Rt=function(){try{return window.sessionStorage.getItem(Re)}catch(e){}return null}()||function(e){try{window.sessionStorage.setItem(Re,e)}catch(t){}return e}((0,sl.x0)(16));function Rn(e){let t=Rx(),[n,i]=(0,rF.useState)([]);return(0,rF.useEffect)(()=>{let n=t.documentPresence(e).subscribe(i);return()=>{n.unsubscribe()}},[e,t]),n}let Ri=(e,t)=>{try{return JSON.parse(e)}catch(n){return console.warn("Failed to parse settings: ".concat(n.message)),t}},Rr=(e,t)=>{let n=localStorage.getItem(e);return(0,rB.of)(null===n?t:Ri(n,t))},Rl=(e,t)=>(null==t?localStorage.removeItem(e):localStorage.setItem(e,JSON.stringify(t)),(0,rB.of)(t)),Ra={get:Rr,set:Rl},Ro=Object.create(null),Rs=(e,t)=>(0,rB.of)(e in Ro?Ro[e]:t),Rd=(e,t)=>(null==t?delete Ro[e]:Ro[e]=t,(0,rB.of)(t)),Rc={get:Rs,set:Rd},Ru=null;function Rp(){let{getClient:e,currentUser:t}=SJ(),n=uh(),i=e(uX);return(0,rF.useMemo)(()=>{let e=n.get({namespace:"userStore",dependencies:[i,t]})||function(e){let{client:t,currentUser:n}=e,i=t.withConfig({apiVersion:"2021-06-07"}),r=new(sd())(async e=>{let t=await i.request({uri:"/users/".concat(e.join(",")),withCredentials:!0,tag:"users.get"}),n=Array.isArray(t)?t:[t],r=n.reduce((e,t)=>((null==t?void 0:t.id)&&(e[t.id]=t),e),{});return e.map(e=>r[e]||null)},{batchScheduleFn:e=>su()(e)}),l=n&&{id:n.id,displayName:n.name,imageUrl:n.profileImage};return r.prime("me",l),(null==l?void 0:l.id)&&r.prime(l.id,l),{getUser:e=>r.load(e),getUsers:async e=>{let t=await r.loadMany(e);return t.filter(e=>cC(e)&&"string"==typeof e.id)}}}({client:i,currentUser:t});return n.set({namespace:"userStore",dependencies:[i,t],value:e}),e},[i,t,n])}function Rh(){let{getClient:e}=SJ(),t=e(uX),n=Mi(),i=uh();return(0,rF.useMemo)(()=>{let e=i.get({namespace:"grantsStore",dependencies:[t,n]})||function(e){let{client:t,currentUser:n}=e,i=t.withConfig({apiVersion:"2021-06-07"}),r=(0,rX.P)(()=>(0,rB.of)(i.config())).pipe((0,r6.w)(e=>{let{projectId:t,dataset:n}=e;if(!t||!n)throw Error("Missing projectId or dataset");return zE(i,t,n)})),l=zS.pipe((0,r6.w)(e=>e?(0,rB.of)(e):r),(0,lf._)(1),(0,st.f)(1e3));return{checkDocumentPermission:(e,t)=>l.pipe((0,r6.w)(i=>zP(n,i,e,t)),(0,r9.x)(aC()))}}({client:t,currentUser:n});return i.set({namespace:"grantsStore",dependencies:[t,n],value:e}),e},[t,n,i])}function Rf(){let e=IW(uX),t=uh();return(0,rF.useMemo)(()=>{let n=t.get({namespace:"historyStore",dependencies:[e]})||function(e){let{client:t}=e;return{getDocumentAtRevision:(e,n)=>z1(t,e,n),getHistory:(e,n)=>z0(t,e,n),getTransactions:e=>z2(t,e),restore:(e,n,i)=>(0,r1.D)(z1(t,e,i)).pipe((0,ls.zg)(n=>{if(!n)throw Error("Unable to find document with ID ".concat(e," at revision ").concat(i));let r=z3(n).map(e=>'"'.concat(e,'": defined(*[_id=="').concat(e,'"]._id)')).join(",");return t.observable.fetch("{".concat(r,"}")).pipe((0,r8.U)(e=>z5(n,e)))}),(0,r8.U)(e=>{let{_updatedAt:t}=e,i=d3(e,dJ);return d6(d6({},i),{},{_id:n})}),(0,ls.zg)(e=>t.observable.createOrReplace(e,{visibility:"async"}))),getTimeline:e=>new zJ(e),getTimelineController:e=>new rQ.y(t=>{let n=new zD(d6(d6({},e),{},{handler:(e,n)=>{e?t.error(e):t.next({historyController:n})}}));return MB(e.client,{publishedId:e.documentId,draftId:"drafts.".concat(e.documentId)},e.documentType).subscribe(e=>{n.handleRemoteMutation(e)})})}}({client:e});return t.set({namespace:"historyStore",dependencies:[e],value:n}),n},[e,t])}function Rm(){let e=IW(uX),t=uh();return(0,rF.useMemo)(()=>{let n=t.get({namespace:"documentPreviewStore",dependencies:[e]})||function(e){let{client:t}=e,n=t.withConfig({apiVersion:"1"}),i=(e,t,n)=>l(e,t,n),{observeFields:r}=function(e){let t;let{observePaths:n,versionedClient:i}=e,r=()=>{if(!t){let e=(0,r1.D)(i.listen('*[!(_id in path("_.**"))]',{},{events:["welcome","mutation"],includeResult:!1,visibility:"query",tag:"preview.global"})).pipe((0,lh.B)()),n=e.pipe((0,lt.h)(e=>"welcome"===e.type),(0,lf._)(1),(0,lm.x)());n.subscribe();let r=e.pipe((0,lt.h)(e=>"mutation"===e.type));t={welcome$:n,mutations$:r}}return t};function l(e){return function(t){let n=o8()(t.reduce((e,t,n)=>{let[i,r]=t,l=lZ()(r.join(","),o5()).join(".");e[l]||(e[l]={fields:r,ids:[],map:[]});let a=e[l].ids.length;return e[l].ids[a]=i,e[l].map[a]=n,e},{}));return e.observable.fetch("[".concat(n.map(pR).join(","),"][0...").concat(n.length,"]"),{},{tag:"preview.document-paths"}).pipe((0,r8.U)(e=>e.reduce((e,t,i)=>{let r=n[i].map;return r.forEach((r,l)=>{let a=n[i].ids[l],o=t.find(e=>e._id===a);e[r]=o||null}),e},[])))}}let a=pE(l(i),100),o=pE(l(i),1e3),s={},d=lV()(function(e){let t=i.withConfig(e),n=l(t);return pE(n,10)},e=>e.dataset+e.projectId),c=(0,rK.R)(document,"visibilitychange").pipe((0,li.O)(0),(0,r8.U)(()=>"visible"===document.visibilityState),(0,r6.w)(e=>e?(0,rG.H)(0,1e4):rJ.E),(0,lh.B)());return{observeFields:function(e,t,n){let i=n?"".concat(n.projectId,":").concat(n.dataset,":").concat(e):"$current$-".concat(e);i in s||(s[i]=[]);let l=s[i],u=o3()(t,aH()(l.map(e=>e.fields)));u.length>0&&l.push(function(e,t,n){let i=null,l=(0,r$.T)((0,rX.P)(()=>null===i?rJ.E:(0,rB.of)(i)),n?c.pipe((0,li.O)(0)).pipe((0,r6.w)(()=>{let i=d(n);return i(e,t)})):(function(e){let t=r();return(0,r$.T)(t.welcome$,t.mutations$.pipe((0,lt.h)(t=>t.documentId===e)))})(e).pipe((0,r6.w)(n=>"welcome"===n.type||"query"===n.visibility?a(e,t).pipe((0,ls.zg)(n=>(0,rU.z)((0,rB.of)(n),void 0===n?o(e,t):[]))):o(e,t)))).pipe((0,lr.b)(e=>i=e),(0,lf._)(1),(0,lm.x)());return{id:e,fields:t,changes$:l}}(e,t,n));let p=l.filter(e=>e.fields.some(e=>t.includes(e))).map(e=>e.changes$);return(0,r0.aj)(p).pipe((0,r8.U)(e=>e.filter(Boolean)),(0,lt.h)(e=>(function(e){let t,n,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:pF;for(let r=0;r<e.length;r++){if(0===r){t=i(e[r]);continue}if(t!==(n=i(e[r])))return!1;t=n}return!0})(e,e=>e._rev)),(0,r8.U)(e=>0===e.length?null:[...pc,...t].reduce((t,n)=>{let i;let r=(e.some(e=>n in e&&(i=e[n],!0)),i);return void 0!==r&&(t[n]=r),t},{})),(0,r9.x)((e,n)=>e===n||!!e&&!!n&&"object"==typeof e&&"object"==typeof n&&t.every(t=>e[t]===n[t])))}}}({observePaths:i,versionedClient:n}),{observePaths:l}=function(e){let{observeFields:t}=e;return{observePaths:(e,n,i)=>(function e(t,n,i,r){if(!t||"object"!=typeof t)return(0,rB.of)(t);let l=pI(t)?t._ref:"_id"in t?t._id:void 0,a=l?d6(d6({},t),{},{_id:l}):d6({},t);"reference"===a._type&&(delete a._type,delete a._ref,delete a._weak,delete a._dataset,delete a._projectId,delete a._strengthenOnPublish);let o=n.filter(e=>!(e[0]in a));if(l&&o.length>0){let s=aV()(o.map(e=>e[0])),d=pI(t)?t._dataset:void 0,c=pI(t)?t._projectId:void 0,u=d&&c?{projectId:c,dataset:d}:r;return i(l,s,u).pipe((0,r6.w)(r=>null===r?(0,rB.of)(null):e(d6(d6(d6({},s.reduce((e,t)=>(e[t]=void 0,e),{})),pI(t)?d6(d6({},t),u):t),r),n,i,u)))}let p={};n.forEach(e=>{let[t,...n]=e;p[t]||(p[t]=[]),p[t].push(n)});let h=Object.keys(p).reduce((n,l)=>{let a=p[l].filter(e=>e.length>0);return 0===a.length?n[l]=cC(t)?t[l]:void 0:n[l]=e(t[l],a,i,r),n},a);return(0,rB.of)(h).pipe(function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return t=>new rQ.y(e=>t.subscribe(e)).pipe((0,r6.w)(t=>{let n=pm(t).map(e=>{let n=t[e];return(0,r2.b)(n)?(0,r1.D)(n).pipe((0,r8.U)(t=>[e,t])):(0,rB.of)([e,n])});return e.wait?(0,r1.D)(n).pipe((0,lu.c)(),(0,r8.U)(e=>e.reduce((e,t)=>{let[n,i]=t;return pP(e,n,i)},{}))):(0,r1.D)(n).pipe((0,lp.J)(),(0,r7.R)((e,t)=>{let[n,i]=t;return pP(e,n,i)},{}))}))}({wait:!0}))})(e,n.map(e=>"string"==typeof e?e.split("."):e),t,i)}}({observeFields:r});function a(e,t){return l({_type:"reference",_ref:e},["_type"],t).pipe((0,r8.U)(e=>cC(e)&&"string"==typeof e._type?e._type:void 0),(0,r9.x)())}let o=function(e){let{observeDocumentTypeFromId:t,observePaths:n}=e;return function e(i,r,l,a){if((0,rM.mz)(r)){if(!(0,rM.Yz)(i))return(0,rB.of)({snapshot:void 0});let o={projectId:i._projectId,dataset:i._dataset};return t(i._ref,o).pipe((0,r6.w)(t=>{if(t){let n=r.to.find(e=>e.type===t);return e(i,n,{},o)}return(0,rB.of)({snapshot:void 0})}))}if((0,rM.dD)(r))return oR()(i)?t(i._ref).pipe((0,r6.w)(t=>{if(t){let n=r.to.find(e=>e.name===t);return e(i,n)}return(0,rB.of)({snapshot:void 0})})):(0,rB.of)({snapshot:void 0});let s=pr(r.preview);return s?n(i,s,a).pipe((0,r8.U)(e=>({type:r,snapshot:e&&pS(e,r,l)}))):(0,rB.of)({type:r,snapshot:i&&oR()(i)?pC(r,i,l).returnValue:null})}}({observeDocumentTypeFromId:a,observePaths:l}),{observeDocumentPairAvailability:s}=pA(n,l),{observePathsDocumentPair:d}=function(e,t){let{observeDocumentPairAvailability:n}=pA(e,t),i=[["_updatedAt"],["_createdAt"],["_type"]];return{observePathsDocumentPair:function(e,r){let{draftId:l,publishedId:a}=cx(e);return n(l).pipe((0,r6.w)(e=>{if(!e.draft.available&&!e.published.available)return(0,rB.of)({id:a,type:null,draft:{availability:e.draft,snapshot:void 0},published:{availability:e.published,snapshot:void 0}});let n=[...r,...i];return(0,r0.aj)([t({_type:"reference",_ref:l},n),t({_type:"reference",_ref:a},n)]).pipe((0,r8.U)(t=>{let[n,i]=t,r=cC(n)&&"_type"in n&&n._type||cC(i)&&"_type"in i&&i._type||null;return{id:a,type:"string"==typeof r?r:null,draft:{availability:e.draft,snapshot:n},published:{availability:e.published,snapshot:i}}}))}))}}}(n,l);return{observePaths:l,observeForPreview:o,observeDocumentTypeFromId:a,unstable_observeDocumentPairAvailability:s,unstable_observePathsDocumentPair:d}}({client:e});return t.set({namespace:"documentPreviewStore",dependencies:[e],value:n}),n},[e,t])}function Rg(){let e=SJ().getClient,t=I3(),n=I8(),i=uh(),r=Rf(),l=Rm();return(0,rF.useMemo)(()=>{let a=i.get({namespace:"documentStore",dependencies:[e,l,r,t]})||function(e){let{getClient:t,documentPreviewStore:n,historyStore:i,initialValueTemplates:r,schema:l}=e,a=n.unstable_observeDocumentPairAvailability,o=t(uX),s={client:o,getClient:t,observeDocumentPairAvailability:a,historyStore:i,schema:l},d={pair:{editOperations:new Map,editState:new Map}},c=MV(s);return{checkoutPair:e=>Mm(o,e),initialValue:(e,t)=>(function(e,t,n,i,r){let l=n.observePaths({_type:"reference",_ref:cv(i.documentId)},["_type"]),a=n.observePaths({_type:"reference",_ref:cb(i.documentId)},["_type"]),o=(0,r$.T)(l.pipe((0,r8.U)(e=>({draft:e}))),a.pipe((0,r8.U)(e=>({published:e})))).pipe((0,r7.R)((e,t)=>d6(d6({},e),t),{}),(0,lt.h)(e=>"draft"in e&&"published"in e),(0,r8.U)(e=>e.draft||e.published),(0,r9.x)((e,t)=>Boolean(e)!==Boolean(t)),(0,lE.b)(25));return o.pipe((0,r6.w)(n=>{if(n)return(0,rB.of)({type:"success",value:null});if(!i.templateName)return(0,rB.of)({isResolving:!1,initialValue:void 0});let l=t.find(e=>e.id===i.templateName);if(!l)return console.warn('Template "%s" not defined, using empty initial value',i.templateName),(0,rB.of)({isResolving:!1,initialValue:void 0});let a=(0,r1.D)(ze(e,l,i.templateParams,r)).pipe((0,r8.U)(e=>({isResolving:!1,initialValue:e}))).pipe((0,le.K)(e=>(console.group("Failed to resolve initial value"),console.error(e),console.error("Template ID: %s",i.templateName),console.error("Parameters: %o",i.templateParams),console.groupEnd(),(0,rB.of)({type:"error",error:e}))));return(0,r$.T)((0,rB.of)({isResolving:!0}),a).pipe((0,r6.w)(e=>{let{isResolving:t,initialValue:n,resolveError:i}=e;return i?(0,rB.of)({type:"error",message:"Failed to resolve initial value"}):t?(0,rB.of)(zl):(0,rB.of)({type:"success",value:n})}))}),(0,li.O)(zl),(0,r9.x)())})(l,r,n,e,t),listenQuery:(e,t,n)=>M4(o,e,t,n),resolveTypeForDocument:(e,t)=>(function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"*";if(n&&"*"!==n)return(0,rB.of)(n);let i=cb(t),r=cv(i);return e.observable.fetch("*[_id in [$documentId, $draftId]]._type",{documentId:i,draftId:r}).pipe((0,r8.U)(e=>e[0]))})(o,e,t),pair:{consistencyStatus:(e,t)=>MF(s.client,za(e),t),documentEvents:(e,t)=>Mv(s.client,za(e)).pipe((0,r6.w)(e=>{let{draft:t,published:n}=e;return(0,r$.T)(t.events,n.events)})),editOperations(e,t){let n=d.pair.editOperations,i="".concat(e,":").concat(t),r=n.get(i);if(r)return r;let l=M0(s,za(e),t);return n.set(i,l),l},editState(e,t){let n=d.pair.editState,i="".concat(e,":").concat(t),r=n.get(i);if(r)return r;let l=MC(s,za(e),t);return n.set(i,l),l},operationEvents:(e,t)=>c(za(e),t),validation:(e,t)=>M$(s,za(e),t)}}}({getClient:e,documentPreviewStore:l,historyStore:r,initialValueTemplates:n,schema:t});return i.set({namespace:"documentStore",dependencies:[e,l,r,t],value:a}),a},[e,l,r,i,t,n])}function Rx(){let{__internal:{bifur:e}}=SJ(),t=uh(),n=Rp(),i=function(){let{bifur:e}=SJ().__internal,t=uh();return(0,rF.useMemo)(()=>{let n=t.get({namespace:"connectionStatusStore",dependencies:[e]})||function(e){var t;let{bifur:n}=e,i=(0,r$.T)(n.heartbeats,uF.pipe((0,ll.j)((0,rW._)(Error("The browser went offline"))))).pipe((0,r8.U)(e=>({type:"connected",lastHeartbeat:e})),(t=(e,t,n)=>{let i=Math.min(24e4,uO(t)),r=new Date(new Date().getTime()+i),l=(0,rG.H)(r),a=!navigator.onLine,o=uq({error:e,retryAt:r,isOffline:a,attemptNo:t}),s=rY.C.pipe((0,la.R)(a?uR:(0,r$.T)(l,uR,uL)));return(0,rU.z)((0,rB.of)(o),s.pipe((0,lo.q)(1)),n)},e=>{let n=[],i=(0,le.K)((e,r)=>(n.push(e),t(e,n.length,r).pipe(i)));return e.pipe((0,lr.b)(()=>{n=[]}),i)}),(0,li.O)(uD));return{connectionStatus$:i}}({bifur:e});return t.set({namespace:"connectionStatusStore",dependencies:[e],value:n}),n},[e,t])}();return(0,rF.useMemo)(()=>{let r=t.get({namespace:"presenceStore",dependencies:[e,i,n]})||function(e){let{bifur:t,connectionStatusStore:n,userStore:i}=e,[r,l]=z9(t,Rt),a=new r3.X([]),o=a.pipe((0,r9.x)()),s=e=>{a.next(e)},d=e=>l({type:"state",locations:e}),c=()=>l({type:"rollCall"}),u=r.pipe((0,lt.h)(e=>"rollCall"===e.type),(0,lt.h)(e=>e.sessionId!==Rt)),p=(0,rG.H)(0,3e4),h=(0,rX.P)(()=>(0,r$.T)(o,u)).pipe((0,r6.w)(()=>p),(0,lw.M)(a),(0,r8.U)(e=>{let[,t]=e;return t}),(0,lT.e)(200),(0,r6.w)(e=>d(e)),(0,ll.j)(rJ.E),(0,lh.B)()),f=(0,rX.P)(()=>c()).pipe((0,ll.j)(rJ.E)),m=n.connectionStatus$.pipe((0,r8.U)(e=>e.type),(0,lt.h)(e=>"connected"===e||"error"===e),(0,r9.x)()),g=zj.pipe((0,r8.U)(e=>e.find(e=>e.startsWith("presence="))),(0,r8.U)(e=>(null==e?void 0:e.split("presence=")[1].split(",").map(e=>e.trim()))||[])),x=g.pipe((0,lt.h)(e=>e.includes("fake_others")),(0,lr.b)(()=>{console.log('Faking other users present in the studio. They will hang out in the document with _type: "presence" and _id: "presence-debug"')}),(0,lA.c)(z8)),v=g.pipe((0,r8.U)(e=>e.includes("show_own"))),b=(0,r$.T)(f,r).pipe((0,lt.h)(e=>"state"===e.type||"disconnect"===e.type)),y=e=>({lastActiveAt:e.timestamp,locations:e.locations,sessionId:e.sessionId,userId:e.userId}),j=(0,r$.T)(b,x).pipe((0,r7.R)((e,t)=>"disconnect"===t.type?aQ()(e,t.sessionId):d6(d6({},e),{},{[t.sessionId]:y(t)}),{})),w=m.pipe((0,r6.w)(e=>"connected"===e?(0,r$.T)(j,h):rY.C),(0,r8.U)(e=>Object.values(e)),(0,r6.w)(e=>{let t=aV()(e.map(e=>e.userId));return(0,r1.D)(i.getUsers(t)).pipe((0,r8.U)(t=>e.map(e=>({user:t.find(t=>t.id===e.userId),session:e})).filter(k)))}),(0,la.R)((0,rK.R)(window,"beforeunload").pipe((0,r6.w)(()=>l({type:"disconnect"})))),(0,ln.d)({refCount:!0,bufferSize:1}));function k(e){return Boolean(e.user&&e.session)}let C=w.pipe((0,r8.U)(e=>{let t=os()(e.map(e=>e.session),e=>e.userId);return Object.keys(t).map(n=>{var i;return{user:null==(i=e.find(e=>e.user.id===n))?void 0:i.user,sessions:t[n]}})}),(0,lw.M)(v),(0,r8.U)(e=>{let[t,n]=e;return t.filter(e=>{if(n)return!0;let t=e.sessions.some(e=>e.sessionId===Rt);return!t})}),(0,r8.U)(e=>e.map(e=>{var t;return{user:e.user,status:"online",lastActiveAt:null==(t=e.sessions.sort()[0])?void 0:t.lastActiveAt,locations:aH()((e.sessions||[]).map(e=>e.locations||[])).map(e=>({type:e.type,documentId:e.documentId,path:e.path,lastActiveAt:e.lastActiveAt})).reduce((e,t)=>e.concat(t),[])}}))),_=e=>w.pipe((0,lw.M)(v),(0,r6.w)(t=>{let[n,i]=t;return(0,r1.D)(n).pipe((0,lt.h)(e=>i||e.session.sessionId!==Rt),(0,ls.VS)(t=>(t.session.locations||[]).filter(t=>t.documentId===e).map(e=>({user:t.user,lastActiveAt:t.session.lastActiveAt,path:e.path||[],sessionId:t.session.sessionId}))),(0,lP.q)())}));return{setLocation:s,reportLocations:d,debugPresenceParam$:g,globalPresence$:C,documentPresence:_}}({bifur:e,connectionStatusStore:i,userStore:n});return t.set({namespace:"presenceStore",dependencies:[e,i,n],value:r}),r},[e,i,t,n])}function Rv(){let e=uh(),t=SW();return(0,rF.useMemo)(()=>{let n=e.get({dependencies:[t],namespace:"settingsStore"})||function(){let e=!function(){if(null!==Ru)return Ru;let e="__test__";try{localStorage.setItem(e,e),localStorage.removeItem(e),Ru=!0}catch(t){Ru=!1}return Ru}()?Rc:Ra,t=new rH.xQ,n=(e,t)=>"".concat(e,"::").concat(t),i=t.pipe((0,r6.w)(t=>e.set(t.key,t.value).pipe((0,r8.U)(e=>({key:t.key,value:e}))))),r=(t,n)=>(0,r$.T)(e.get(t,n),i.pipe((0,lt.h)(e=>e.key===t),(0,r8.U)(e=>e.value))),l=(e,n)=>{t.next({key:e,value:n})},a=e=>({forKey:t=>{let i=n(e,t);return{listen:e=>r(i,e),set:e=>l(i,e),del:()=>l(i,void 0)}},listen:(t,i)=>r(n(e,t),i),set:(t,i)=>l(n(e,t),i),del:t=>l(n(e,t),void 0),forNamespace:t=>a(n(e,t))});return{forNamespace:a}}();return e.set({dependencies:[t],namespace:"settingsStore",value:n}),n},[e,t])}let Rb=/[^\p{Alpha}\p{White_Space}]/gu,Ry=/\p{White_Space}+/u,Rj={small:0,medium:1,large:2};function Rw(e){let{user:t}=e,n=d3(e,dQ);return cC(t)?n.withTooltip?(0,rz.jsx)(Rk,d6(d6({},n),{},{user:t})):(0,rz.jsx)(RC,d6(d6({},n),{},{user:t})):(0,rz.jsx)(R_,d6(d6({},e),{},{user:t}))}function Rk(e){let{user:{displayName:t}}=e;return(0,rz.jsx)(rN.u,{content:(0,rz.jsx)(rN.xu,{padding:2,children:(0,rz.jsx)(rN.xv,{size:1,children:t})}),placement:"top",portal:!0,children:(0,rz.jsx)("div",{style:{display:"inline-block"},children:(0,rz.jsx)(RC,d6({},e))})})}let RC=(0,rF.forwardRef)(function(e,t){let{user:n,animateArrowFrom:i,position:r,size:l,status:a,tone:o}=e,[s,d]=(0,rF.useState)(null),c=function(e){let t=vh();return(0,rV.m2)(e?t.listen(e):(0,rJ.c)(),[e],t.get(null))}(n.id),u=s?void 0:null==n?void 0:n.imageUrl;return(0,rz.jsx)(rN.qE,{animateArrowFrom:i,arrowPosition:r,color:c.name,"data-legacy-tone":o,initials:(null==n?void 0:n.displayName)&&function(e){let t=e.replace(Rb,"").split(Ry);return 1===t.length?"".concat(t[0].charAt(0)).toUpperCase():"".concat(t[0].charAt(0)).concat(t[t.length-1].charAt(0))}(n.displayName),src:u,onImageLoadError:d,ref:t,size:"string"==typeof l?Rj[l]:l,status:a})});function R_(e){let{user:t}=e,n=d3(e,d0),[i]=Mn(t);return i?(0,rz.jsx)(Rw,d6(d6({},n),{},{user:i})):null}let RS=(0,aw.x)(function(e){return e.pipe((0,r9.x)((e,t)=>e.id===t.id),(0,r6.w)(e=>(0,rU.z)((0,rB.of)(d6(d6({},e),{},{referringDocuments:[],isLoading:!0})),e.documentStore.listenQuery("*[references($docId)] [0...101]",{docId:e.id},{tag:"with-referring-documents"}).pipe((0,r8.U)(t=>d6(d6({},e),{},{referringDocuments:t,isLoading:!1}))))))},function(e){let{children:t}=e;return t(d3(e,d1))}),RE=new WeakMap,RT=0;function RA(e){let t=RE.get(e);if(t)return t;let n="".concat(e.name||e.displayName||"<anonymous>","-").concat(RT++);return RE.set(e,n),n}let RP=(0,rF.memo)(function(e){var t;let{hook:n,args:i,id:r,onNext:l,onReset:a,onRequestUpdate:o}=e,s=n(d6(d6({},i),{},{onComplete:()=>{a(r)}}));return t=()=>(l(r,s),o(),()=>{l(r,null),o()}),(0,rF.useEffect)(t,function(e){let t=(0,rF.useRef)(void 0);return aC()(e,t.current)||(t.current=e),[t.current]}(s)),null},(e,t)=>e.args===t.args),RI=e=>{let t=Date.now();return setTimeout(()=>{e({didTimeout:!1,timeRemaining:()=>Math.max(0,Date.now()-t)})},1)},RM=e=>clearTimeout(e),Rz="undefined"==typeof requestIdleCallback?RI:requestIdleCallback,RR={trailing:!0};function RF(e){let{hooks:t,args:n,children:i,onReset:r}=e,l=(0,rF.useRef)({}),[a,o]=(0,rF.useState)(0),[s,d]=(0,rF.useState)({}),c=(0,rF.useRef)(null),u=(0,rF.useCallback)(()=>{c.current&&RM(c.current),c.current=Rz(()=>{c.current=null,o(e=>e+1)})},[]),p=function(e,t,n){let i=(0,rF.useMemo)(()=>lF()(e,t,n),[e,n,t]);return i}(u,60,RR),h=(0,rF.useCallback)((e,t)=>{if(null===t)delete l.current[e];else{let n=l.current[e];l.current[e]=d6(d6({},n),{},{value:t})}},[]),f=(0,rF.useCallback)(e=>{d(t=>d6(d6({},t),{},{[e]:(t[e]||0)+1})),r&&r()},[r]),m=(0,rF.useMemo)(()=>t.map(e=>RA(e)),[t]),g=(0,rF.useMemo)(()=>m.map(e=>{var t;return null==(t=l.current[e])?void 0:t.value}).filter(cf),[m,a]);return(0,rz.jsxs)(rz.Fragment,{children:[t.map(e=>{let t=RA(e),i=s[t]||0;return(0,rz.jsx)(RP,{hook:e,id:t,args:n,onNext:h,onRequestUpdate:p,onReset:f},"".concat(t,"-").concat(i))}),i({states:g})]})}function RO(e){let{children:t,header:n,onClose:i,width:r}=e,l=d3(e,d2),a=(0,rF.useRef)(null);return(0,rF.useEffect)(()=>{(0,rN.fo)(a.current)},[]),(0,rz.jsx)(rN.J2,d6(d6({},l),{},{open:!0,portal:!0,padding:1,content:(0,rz.jsx)(rN.W2,{width:r,ref:a,children:(0,rz.jsxs)(rN.kC,{direction:"column",children:[(0,rz.jsx)(rN.Zb,{padding:1,flex:"none",children:(0,rz.jsxs)(rN.kC,{align:"center",children:[(0,rz.jsx)(rN.xu,{padding:2,flex:1,children:(0,rz.jsx)(rN.xv,{weight:"semibold",children:n})}),(0,rz.jsx)(rN.xu,{children:(0,rz.jsx)(rN.zx,{mode:"bleed",icon:lL.Two,onClick:i})})]})}),(0,rz.jsx)(rN.Zb,{flex:1,overflow:"auto",children:t})]})})}))}let RD={block:{width:33,height:33},blockImage:{width:600,height:400},default:{width:35,height:35},detail:{width:75,height:75},inline:{width:15,height:15},media:{width:160,height:160}},RZ={block:31,blockImage:45,default:33,detail:45,inline:15,media:45},RL=lO.ZP.span(e=>{let{$dimensions:t,$layout:n,$radius:i,$responsive:r}=e,l=t.width||0,a=t.width||0,o=RZ[n];return(0,lO.iv)(i8||(i8=d4(["\n    position: relative;\n    width: ",";\n    height: ",";\n    min-width: ",";\n    border-radius: ",";\n    display: flex;\n    overflow: hidden;\n    align-items: center;\n    justify-content: center;\n\n    & img {\n      position: absolute;\n      left: 0;\n      top: 0;\n      width: 100%;\n      height: 100%;\n      object-fit: contain;\n      border-radius: inherit;\n    }\n\n    & svg {\n      display: block;\n      font-size: calc(21 / 16 * 1em);\n    }\n\n    & [data-sanity-icon] {\n      display: block;\n      font-size: calc(",' / 16 * 1em);\n    }\n\n    /*\n      NOTE on why we can’t use the ":after" pseudo-element:\n      The thing is we only want the shadow when then <MediaWrapper> contains\n      something else than <svg> – icons should not have the shadow.\n      This is why we use the "*:not(svg) + span" selector to target only that\n      situation to render the shadow.\n    */\n    & *:not(svg) + span {\n      display: block;\n      position: absolute;\n      left: 0;\n      top: 0;\n      right: 0;\n      bottom: 0;\n      box-shadow: inset 0 0 0 1px var(--card-fg-color);\n      opacity: 0.2;\n      border-radius: inherit;\n    }\n  '])),r?"100%":(0,rN.hO)(l),r?"100%":(0,rN.hO)(a),r?void 0:(0,rN.hO)(l),e=>{let{theme:t}=e;return(0,rN.hO)(t.sanity.radius[i])},o)});function Rq(e){let{border:t=!0,dimensions:n,layout:i,media:r,radius:l=1,responsive:a=!1,styles:o}=e;return(0,rz.jsxs)(RL,{$dimensions:n,$layout:i,$radius:l,$responsive:a,className:null==o?void 0:o.media,"data-testid":"Media",children:[function(e){let{dimensions:t,layout:n,media:i,styles:r}=e;return(0,lW.isValidElementType)(i)?(0,rF.createElement)(i,{dimensions:t,layout:n}):"string"==typeof i?(0,rz.jsx)(rN.xv,{as:"span",className:null==r?void 0:r.mediaString,children:i}):(0,rF.isValidElement)(i)?i:null}({dimensions:n,layout:i,media:r}),t&&(0,rz.jsx)("span",{})]})}function RN(e,t,n){return"string"==typeof e?e:(0,lW.isValidElementType)(e)?(0,rF.createElement)(e,{layout:t}):e||n}RL.displayName="MediaWrapper";let RV=d6(d6({},RD.default),{},{aspect:1,fit:"crop",dpr:(0,aE.x)()}),RB=(0,lO.ZP)(rN.kC)(i7||(i7=d4(["\n  height: ",";\n"])),(0,rN.hO)(RD.default.height)),RU=(0,lO.ZP)(rN.Qr).attrs({animated:!0,radius:1})(i9||(i9=d4(["\n  max-width: ",";\n  width: 80%;\n"])),(0,rN.hO)(160)),RK=(0,lO.ZP)(rN.Qr).attrs({animated:!0,radius:1,size:1})(re||(re=d4(["\n  max-width: ",";\n  width: 60%;\n"])),(0,rN.hO)(120));function RH(e){let{title:t,subtitle:n,media:i,status:r,isPlaceholder:l,children:a,styles:o}=e,s=aS()(null==o?void 0:o.root,Boolean(n)&&(null==o?void 0:o.hasSubtitle)),d=r&&(0,rz.jsx)(rN.xu,{className:null==o?void 0:o.status,"data-testid":"default-preview__status",paddingLeft:3,paddingRight:1,children:RN(r,"default")});return l?(0,rz.jsxs)(RB,{align:"center",className:null==o?void 0:o.placeholder,"data-testid":"default-preview",children:[!1!==i&&(0,rz.jsx)(rN.Od,{animated:!0,marginRight:2,radius:2,style:RD.default}),(0,rz.jsxs)(rN.Kq,{"data-testid":"default-preview__heading",flex:1,paddingLeft:!1===i?1:2,paddingRight:r?0:1,space:2,children:[(0,rz.jsx)(RU,{}),(0,rz.jsx)(RK,{})]}),d]}):(0,rz.jsxs)(RB,{align:"center",className:s,"data-testid":"default-preview",children:[!1!==i&&void 0!==i&&(0,rz.jsx)(Rq,{dimensions:RV,layout:"default",media:i,styles:o}),(0,rz.jsxs)(rN.Kq,{className:null==o?void 0:o.heading,"data-testid":"default-preview__header",flex:1,paddingLeft:i?2:1,paddingRight:r?0:1,space:2,children:[(0,rz.jsxs)(rN.xv,{className:null==o?void 0:o.title,style:{color:"inherit"},textOverflow:"ellipsis",children:[t&&RN(t,"default"),!t&&(0,rz.jsx)("span",{style:{color:"var(--card-muted-fg-color)"},children:"Untitled"})]}),n&&(0,rz.jsx)(rN.xv,{muted:!0,size:1,textOverflow:"ellipsis",className:null==o?void 0:o.subtitle,children:RN(n,"default")}),a&&(0,rz.jsx)("div",{className:null==o?void 0:o.children,children:a})]}),d]})}let R$=(0,lO.ZP)(rN.kC).attrs({align:"center"})(rt||(rt=d4(["\n  height: ",";\n"])),(0,rN.hO)(RD.detail.height)),RX=(0,lO.ZP)(rN.xu)(rn||(rn=d4(["\n  white-space: nowrap;\n"]))),RW=(0,lO.ZP)(rN.Od).attrs({animated:!0,radius:2})(ri||(ri=d4(["\n  width: ",";\n  height: ",";\n"])),(0,rN.hO)(RD.detail.width),(0,rN.hO)(RD.detail.height)),RG=(0,lO.ZP)(rN.Qr).attrs({animated:!0,radius:1})(rr||(rr=d4(["\n  max-width: ","; /* 80% of 200px */\n  width: 80%;\n"])),(0,rN.hO)(160)),RY=(0,lO.ZP)(rN.Qr).attrs({animated:!0,radius:1,size:1})(rl||(rl=d4(["\n  max-width: ","; /* 60% of 200px */\n  width: 60%;\n"])),(0,rN.hO)(120)),RJ=(0,lO.ZP)(rN.Qr).attrs({animated:!0,radius:1,size:1})(ra||(ra=d4(["\n  max-width: ","; /* 90% of 200px */\n  width: 90%;\n"])),(0,rN.hO)(180)),RQ=(0,lO.ZP)(rN.xv)(e=>{let{theme:t}=e,{fonts:n}=t.sanity,i=n.text.sizes[1],r=2*i.lineHeight;return(0,lO.iv)(ro||(ro=d4(["\n    & > span {\n      max-height: ",";\n\n      /* Multi-line text overflow */\n      display: -webkit-box;\n      overflow: hidden;\n      text-overflow: ellipsis;\n      -webkit-line-clamp: ",";\n      -webkit-box-orient: vertical;\n    }\n  "])),(0,rN.hO)(r),2)}),R0=d6(d6({},RD.detail),{},{fit:"crop",aspect:1,dpr:(0,aE.x)()}),R1=lO.ZP.svg(rs||(rs=d4(["\n  width: ","px;\n  height: ","px;\n  transform: rotate(-90deg);\n"])),43,43),R2=lO.ZP.circle(e=>{let{theme:t}=e,{color:n}=t.sanity;return(0,lO.iv)(rd||(rd=d4(["\n    fill: none;\n    stroke: ",";\n    stroke-width: ","px;\n  "])),aT.VG.gray[n.dark?900:100].hex,3)}),R3=lO.ZP.circle(e=>{let{theme:t}=e,{color:n}=t.sanity;return(0,lO.iv)(rc||(rc=d4(["\n    fill: none;\n    stroke: ",";\n    stroke-width: ","px;\n    transition: stroke-dashoffset 75ms;\n  "])),aT.VG.blue[n.dark?400:500].hex,3)});function R4(e){let{value:t}=e,n=2*Math.PI*20,i="".concat(21.5," ").concat(21.5," ").concat(43," ").concat(43);return(0,rz.jsxs)(R1,{viewBox:i,children:[(0,rz.jsx)(R2,{cx:43,cy:43,r:20}),(0,rz.jsx)(R3,{cx:43,cy:43,r:20,style:{strokeDasharray:n,strokeDashoffset:"".concat((100-Math.min(Math.max(t,0),100))/100*n,"px")}})]})}let R5=(0,lO.ZP)(rN.Zb)(ru||(ru=d4(["\n  overflow: hidden;\n"]))),R6=(0,lO.ZP)(rN.Zb)(e=>{let{theme:t}=e,{color:n}=t.sanity;return(0,lO.iv)(rp||(rp=d4(["\n    height: ","rem;\n    background: ",";\n    transition: transform 75ms;\n  "])),.5,aT.VG.blue[n.dark?400:500].hex)});function R8(e){let{value:t}=e;return(0,rz.jsx)(R5,{radius:5,children:(0,rz.jsx)(R6,{radius:5,style:{transform:"translate3d(".concat(t-100,"%, 0, 0)")}})})}let R7=(0,lO.ZP)(rN.xu)(rh||(rh=d4(["\n  position: relative;\n"]))),R9=(0,lO.ZP)(rN.kC).attrs({align:"center",justify:"center"})(rf||(rf=d4(["\n  position: absolute;\n  left: 0;\n  top: 0;\n  right: 0;\n  bottom: 0;\n"]))),Fe=(0,lO.ZP)(rN.Od).attrs({animated:!0,radius:2})(rm||(rm=d4(["\n  width: 100%;\n  height: 100%;\n"]))),Ft=(0,lO.ZP)(rN.kC).attrs({align:"center",justify:"center"})(rg||(rg=d4(["\n  position: absolute;\n  left: 0;\n  top: 0;\n  right: 0;\n  bottom: 0;\n\n  &:before {\n    background-color: var(--card-bg-color);\n    opacity: 0.75;\n    content: '';\n    display: block;\n    position: absolute;\n    left: 0;\n    top: 0;\n    right: 0;\n    bottom: 0;\n  }\n\n  > svg {\n    position: relative;\n    z-index: 2;\n  }\n"]))),Fn=(0,lO.ZP)(rN.Kq).attrs({padding:2,space:2})(rx||(rx=d4(["\n  max-width: ",";\n"])),(0,rN.hO)(200)),Fi=d6(d6({},RD.media),{},{aspect:1,fit:"crop",dpr:(0,aE.x)()}),Fr=(0,lO.ZP)(rN.kC).attrs({align:"center"})(rv||(rv=d4(["\n  box-shadow: 0 0 0 1px var(--card-border-color);\n  height: ",";\n  white-space: nowrap;\n  position: relative;\n  z-index: 1;\n"])),(0,rN.hO)(RD.block.height)),Fl=(0,lO.ZP)(rN.Zb)(rb||(rb=d4(["\n  position: relative;\n  padding-bottom: ","%;\n\n  & > span {\n    position: absolute;\n    top: 0;\n    left: 0;\n    right: 0;\n    bottom: 0;\n  }\n"])),e=>{let{$ratio:t}=e;return t}),Fa=(0,lO.ZP)(rN.xu).attrs({overflow:"hidden"})(ry||(ry=d4(["\n  border-radius: ","px;\n"])),e=>{let{theme:t}=e;return t.sanity.radius[1]}),Fo=d6(d6({},RD.blockImage),{},{fit:"fillmax",dpr:(0,aE.x)()}),Fs=e=>{let{height:t,width:n}=e;return t&&n?t/n*100:1},Fd=d6(d6({},RD.block),{},{aspect:1,fit:"crop",dpr:(0,aE.x)()}),Fc=(0,lO.ZP)(rN.kC).attrs({align:"center"})(rj||(rj=d4(["\n  min-height: ",";\n"])),(0,rN.hO)(RD.block.height)),Fu=lO.ZP.span(rw||(rw=d4(["\n  display: inline-flex;\n  align-items: center;\n  vertical-align: top;\n  height: calc(1em - 1px);\n  max-width: 100%;\n"]))),Fp=lO.ZP.span(rk||(rk=d4(["\n  position: relative;\n  display: inline-block;\n  width: calc(1em - 1px);\n  height: calc(1em - 1px);\n  min-width: calc(1em - 1px);\n\n  & img {\n    position: absolute;\n    top: 0;\n    left: 0;\n    width: 100%;\n    height: 100%;\n    object-fit: cover;\n    border-radius: ",";\n  }\n\n  & img + span {\n    position: absolute;\n    left: 0;\n    top: 0;\n    right: 0;\n    bottom: 0;\n    box-shadow: inset 0 0 0 1px var(--card-fg-color);\n    opacity: 0.2;\n    border-radius: ",";\n  }\n\n  & svg {\n    display: block;\n    font-size: calc(14 / 16 * 1em);\n    margin: 1px 0;\n\n    &[data-sanity-icon] {\n      font-size: calc(18 / 16 * 1em);\n      margin: calc(1px + (2 / 18 * -1em)) 0;\n    }\n  }\n"])),e=>{let{theme:t}=e;return(0,rN.hO)(t.sanity.radius[1])},e=>{let{theme:t}=e;return(0,rN.hO)(t.sanity.radius[1])}),Fh=(0,lO.ZP)(rN.xv).attrs({forwardedAs:"span"})(e=>{let{theme:t}=e,n=t.sanity.fonts.text,i=n.sizes[1];return(0,lO.iv)(rC||(rC=d4(["\n    font-size: calc("," / 16 * 1em);\n    font-weight: ",";\n    box-sizing: border-box;\n    display: inline-block;\n    vertical-align: top;\n    line-height: ",";\n    padding-left: 0.5em;\n    padding-right: calc(0.5em - 2px);\n    min-width: 0;\n\n    & > span {\n      display: block;\n      white-space: nowrap;\n      text-overflow: ellipsis;\n      overflow: hidden;\n    }\n  "])),i.fontSize,n.weights.medium,i.lineHeight/i.fontSize)}),Ff=d6(d6({},RD.inline),{},{fit:"crop",aspect:1,dpr:(0,aE.x)()});d6(d6({},RD.default),{},{aspect:1,fit:"crop",dpr:(0,aE.x)()}),(0,lO.ZP)(rN.xu)(r_||(r_=d4(["\n  height: 100%;\n\n  a {\n    color: currentColor;\n    text-decoration: none;\n  }\n\n  svg[data-sanity-icon] {\n    margin: 0;\n  }\n"]))),(0,lO.ZP)(rN.kC).attrs({align:"center"})(rS||(rS=d4(["\n  height: ",";\n"])),(0,rN.hO)(RD.default.height)),(0,lO.ZP)(rN.Qr).attrs({animated:!0,radius:1})(rE||(rE=d4(["\n  max-width: ",";\n  width: 80%;\n"])),(0,rN.hO)(160)),(0,lO.ZP)(rN.Qr).attrs({animated:!0,radius:1,size:1})(rT||(rT=d4(["\n  max-width: ",";\n  width: 60%;\n"])),(0,rN.hO)(120));let Fm=["aria-hidden","disabled","href"];function Fg(e){let{direction:t="horizontal",initialFocus:n,loop:i=!0,navigation:r=["arrows"],pause:l=!1,rootElement:a}=e,[o,s]=(0,rF.useState)(-1),[d,c]=(0,rF.useState)([]),u=d.length,p=u-1,h="horizontal"===t?"ArrowRight":"ArrowDown",f="horizontal"===t?"ArrowLeft":"ArrowUp",m=(0,rF.useCallback)(()=>{if(a){let e=[...a.querySelectorAll('a[href], button, input, textarea, select, details, [tabindex]:not([tabindex="-1"])')].filter(e=>!e.hasAttribute("disabled")&&"true"!==e.getAttribute("aria-hidden"));c(e)}},[a]),g=(0,rF.useCallback)(e=>{s(e)},[]),x=(0,rF.useCallback)(e=>{if(l)return;let t=()=>{e.preventDefault(),s(e=>{let t=(e+p)%u;return i||t!==p?t:e})},n=()=>{e.preventDefault(),s(e=>{let t=(e+1)%u;return i||0!==t?t:e})};"Tab"===e.key&&r.includes("tab")&&(e.shiftKey?t():n()),r.includes("arrows")&&(e.key===f&&t(),e.key===h&&n())},[l,f,r,h,p,u,i]);(0,rF.useEffect)(()=>{m()},[m,n,t]),(0,rF.useEffect)(()=>{let e=new MutationObserver(m);return a&&e.observe(a,{childList:!0,subtree:!0,attributeFilter:Fm}),()=>{e.disconnect()}},[d,m,a]),(0,rF.useEffect)(()=>{var e;d.forEach((e,t)=>{t===o?(e.setAttribute("tabIndex","0"),e.setAttribute("aria-selected","true"),e.focus(),e.onfocus=()=>g(t),e.onblur=()=>g(-1)):(e.setAttribute("tabIndex","-1"),e.setAttribute("aria-selected","false"),e.onfocus=()=>g(t))}),-1===o&&d&&(null==(e=d["last"===n?p:0])||e.setAttribute("tabIndex","0"))},[d,o,g,n,p]),(0,rF.useEffect)(()=>(null==a||a.addEventListener("keydown",x),()=>{null==a||a.removeEventListener("keydown",x)}),[x,a])}let Fx=(0,rF.forwardRef)((e,t)=>{let{push:n}=(0,rN.pm)();return(0,rF.useImperativeHandle)(t,()=>({push:n})),null});Fx.displayName="ImperativeToast";let Fv=(0,rF.createContext)({navbar:200,navbarPopover:5e5,navbarDialog:500001,pane:100,paneHeader:[110,15e3],paneFooter:[120,2e4],paneResizer:[130,25e3],popover:200,modal:200,movingItem:1e4,drawershade:1e6,drawer:1000001,fullscreen:12e5,toast:[100,11e3],portal:200,dropdown:200,navbarFixed:1010,fullscreenEdit:1050,popoverBackground:1060,tooltip:200,modalBackground:2e3,spinner:3e3});function Fb(){return(0,rF.useContext)(Fv)}function Fy(e){let{children:t,zOffset:n}=e,i=Fb(),r=i[n];return(0,rz.jsx)(rN.li,{zOffset:r,children:t})}let Fj=(0,lO.ZP)(rN.xv)(rA||(rA=d4(["\n  white-space: initial;\n"]))),Fw={error:"critical",warning:"caution",info:"primary"};function Fk(e){let{marker:t,onClick:n,path:i,truncate:r}=e,l=(0,rF.useCallback)(()=>{n&&n(t.path)},[t.path,n]),a=Fw[null==t?void 0:t.level]||void 0,o=(0,rz.jsxs)(rN.kC,{children:[(0,rz.jsx)(rN.xu,{children:(0,rz.jsxs)(rN.xv,{size:1,children:["error"===t.level&&(0,rz.jsx)(lL.uIy,{}),"warning"===t.level&&(0,rz.jsx)(lL.foC,{}),"info"===t.level&&(0,rz.jsx)(lL.hQ6,{})]})}),(0,rz.jsxs)(rN.Kq,{space:2,flex:1,paddingLeft:3,children:[i&&(0,rz.jsx)(Fj,{size:1,weight:"semibold",children:i}),t.item.message&&(0,rz.jsx)(Fj,{muted:!0,size:1,textOverflow:r?"ellipsis":void 0,children:t.item.message})]})]});return(0,rz.jsx)(rN.sN,{padding:1,onClick:l,radius:2,tone:a,children:(0,rz.jsx)(rN.xu,{padding:2,children:o})})}function FC(e){let{documentType:t,kind:n,validation:i,onFocus:r,onClose:l,truncate:a}=e,o=i.filter(rM.YN),s=i.filter(rM.WQ),d=i.filter(rM.Ny),c=(0,rF.useCallback)(function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];r&&r(e),l&&l()},[r,l]),u=e=>{let n=t&&t.fields,i=n&&n.find(t=>t.name===e[0]);return i&&i.type.title||""},p=o.length>0,h=s.length>0,f=d.length>0;return p||h||f?(0,rz.jsxs)(rN.W2,{width:0,"data-kind":n,"data-testid":"validation-list",children:[p&&o.map((e,t)=>(0,rz.jsx)(Fk,{truncate:a,path:u(e.path),marker:e,onClick:c},t)),h&&s.map((e,t)=>(0,rz.jsx)(Fk,{truncate:a,path:u(e.path),marker:e,onClick:c},t)),f&&d.map((e,t)=>(0,rz.jsx)(Fk,{truncate:a,path:u(e.path),marker:e,onClick:c},t))]}):null}function F_(e,t){let{currentUser:n,document:i,parent:r,value:l}=t;return"boolean"==typeof e||void 0===e?Boolean(e):!0===e({document:i,parent:r,value:l,currentUser:n})}function FS(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;if((null==e?void 0:e.collapsible)===!1||(null==e?void 0:e.collapsable)===!1)return{collapsible:!1,collapsed:!1};let n="boolean"==typeof(null==e?void 0:e.collapsed)?e.collapsed:t>=3||void 0,i=(null==e?void 0:e.collapsible)===!0||(null==e?void 0:e.collapsable)===!0||!0===n||void 0;return{collapsible:i,collapsed:n}}let FE={name:"all-fields",title:"All fields",hidden:!1};function FT(e,t,n){return n.name===FE.name||0===e.length||oK()(t.group).includes(n.name)}function FA(e){return void 0===e||cC(e)}function FP(e,t){return!!e&&!t||!lM()(e,t)}function FI(e){var t,n,i,r,l,a,o,s,d,c,u,p,h,f,m,g,x,v,b,y;let{parent:j,field:w,index:k}=e,C=(0,rR.s6)([...j.path,w.name]),_=(b=w.type,y=j.level+1,(0,rM.jB)(b)?function(e,t){var n;let{options:i}=e,r=(null==(n=(null==i?void 0:i.list)||[])?void 0:n.length)>0,l=gu.includes((null==i?void 0:i.layout)||"");return r&&!l?t:0}(b,y):function(e,t){var n,i,r;let{type:l,options:a}=e,o=function e(t,n){return(null==t?void 0:t.name)&&n.includes(null==t?void 0:t.name)?t:t?e(t.type,n):void 0}(l,gd),s=(null==e?void 0:e.jsonType)==="object"?e.fields:void 0,d=(null==o?void 0:o.name)||"";if(gp.includes(d))return 0;let c=gd.includes(d),u=(null!=(n=null==s?void 0:s.filter(e=>!gc.includes(e.name)).length)?n:0)>0,p=(null!=(r=null==(i=null==a?void 0:a.list)?void 0:i.length)?r:0)>0;return u||p||!c?t:0}(b,y)),S=j.value,E=j.comparisonValue;if(!FA(S))throw Error("Unexpected non-object value");if((0,rM.m$)(w.type)){let T=null==S?void 0:S[w.name],A=cC(E)?null==E?void 0:E[w.name]:void 0;if(!FA(T))return{kind:"error",key:w.name,fieldName:w.name,error:{type:"INCOMPATIBLE_TYPE",expectedSchemaType:w.type,resolvedValueType:(0,a3.wq)(T),value:T}};let P=null==(n=null==(t=j.fieldGroupState)?void 0:t.children)?void 0:n[w.name],I=null==(r=null==(i=j.collapsedPaths)?void 0:i.children)?void 0:r[w.name],M=null==(a=null==(l=j.collapsedFieldSets)?void 0:l.children)?void 0:a[w.name],z=FM({schemaType:w.type,currentUser:j.currentUser,parent:j.value,document:j.document,value:T,changed:FP(T,A),comparisonValue:A,presence:j.presence,validation:j.validation,fieldGroupState:P,path:C,level:_,focusPath:j.focusPath,openPath:j.openPath,collapsedPaths:I,collapsedFieldSets:M,readOnly:j.readOnly,changesOpen:j.changesOpen});if(null===z)return null;let R=FS(w.type.options,_),F=I?I.value:R.collapsed;return{kind:"field",key:"field-".concat(w.name),name:w.name,index:k,open:(0,rR.Ny)(C,j.openPath),field:z,collapsed:F,collapsible:R.collapsible}}if((0,rM.jB)(w.type)){let O=null==S?void 0:S[w.name],D=cC(E)?null==E?void 0:E[w.name]:void 0;if((0,rM.M1)(w.type)){let Z=void 0!==O;if(Z&&!(void 0===O||Array.isArray(O))){let L=(0,a3.wq)(O);return{kind:"error",key:w.name,fieldName:w.name,error:{type:"INCOMPATIBLE_TYPE",expectedSchemaType:w.type,resolvedValueType:L,value:O}}}if(Z&&!(0===O.length||O.every(e=>cC(e))))return{kind:"error",key:w.name,fieldName:w.name,error:{type:"MIXED_ARRAY",schemaType:w.type,value:O}};if(Z&&!(null==O?void 0:O.every(e=>cC(e)&&"_key"in e)))return{kind:"error",key:w.name,fieldName:w.name,error:{type:"MISSING_KEYS",value:O,schemaType:w.type}};let q=Z?function(e){let t=new Set;return e.reduce((e,n,i)=>(t.has(n._key)&&e.push([i,n._key]),t.add(n._key),e),[])}(O):[];if(q.length>0)return{kind:"error",key:w.name,fieldName:w.name,error:{type:"DUPLICATE_KEYS",duplicates:q,schemaType:w.type}};let N=null==(s=null==(o=j.fieldGroupState)?void 0:o.children)?void 0:s[w.name],V=null==(c=null==(d=j.collapsedPaths)?void 0:d.children)?void 0:c[w.name],B=null==(p=null==(u=j.collapsedFieldSets)?void 0:u.children)?void 0:p[w.name],U=j.readOnly||F_(w.type.readOnly,{value:O,parent:j.value,document:j.document,currentUser:j.currentUser}),K=function(e){if(20===e.level)return null;let t={value:e.value,parent:e.parent,document:e.document,currentUser:e.currentUser},n=F_(e.schemaType.hidden,t);if(n)return null;let i=e.readOnly||F_(e.schemaType.readOnly,t),r=Array.isArray(e.value)?e.value:[],l=e.presence.filter(t=>(0,rR.Xy)(t.path,e.path)),a=e.validation.filter(t=>(0,rR.Xy)(t.path,e.path)).map(e=>({level:e.level,message:e.item.message,path:e.path})),o=r.flatMap((t,n)=>(function(e){var t,n,i,r,l,a,o;let{arrayItem:s,parent:d,index:c}=e,u=function(e,t){let n=(0,a3.wq)(t);return"object"===n&&1===e.of.length?e.of[0]:e.of.find(e=>e.name===n)}(d.schemaType,s),p=s._key;if(!u){let h=(0,a3.wq)(s);return{kind:"error",key:p,index:c,error:{type:"INVALID_ITEM_TYPE",resolvedValueType:h,value:s,validTypes:d.schemaType.of}}}let f=(0,rR.s6)([...d.path,{_key:p}]),m=d.level+1,g={value:d.value,parent:e.parent,document:d.document,currentUser:d.currentUser},x=d.readOnly||F_(d.schemaType.readOnly,g),v=null==(n=null==(t=d.fieldGroupState)?void 0:t.children)?void 0:n[p],b=null==(r=null==(i=d.collapsedPaths)?void 0:i.children)?void 0:r[p],y=null==(a=null==(l=d.collapsedFieldSets)?void 0:l.children)?void 0:a[p],j=Array.isArray(d.comparisonValue)&&d.comparisonValue.find(e=>e._key===s._key)||void 0,w=FM({schemaType:u,level:m,document:d.document,value:s,comparisonValue:j,changed:FP(s,j),path:f,focusPath:d.focusPath,openPath:d.openPath,currentUser:d.currentUser,collapsedPaths:b,collapsedFieldSets:y,presence:d.presence,validation:d.validation,fieldGroupState:v,readOnly:x},!1),k=FS(u.options,m),C=null!=(o=null==b?void 0:b.value)?o:k.collapsed;return{kind:"item",key:p,index:c,open:(0,rR.Ny)(f,d.openPath),collapsed:C,collapsible:!0,parentSchemaType:d.schemaType,item:w}})({arrayItem:t,parent:e,index:n}));return{changed:o.some(e=>"item"===e.kind&&e.item.changed),value:e.value,readOnly:i,schemaType:e.schemaType,focused:(0,rR.Xy)(e.path,e.focusPath),focusPath:(0,rR.vC)(e.path,e.focusPath),path:e.path,id:(0,rR.BB)(e.path),level:e.level,validation:a,presence:l,members:o}}({schemaType:w.type,parent:j.value,currentUser:j.currentUser,document:j.document,value:O,changed:FP(O,D),comparisonValue:D,fieldGroupState:N,focusPath:j.focusPath,openPath:j.openPath,presence:j.presence,validation:j.validation,collapsedPaths:V,collapsedFieldSets:B,level:_,path:C,readOnly:U});return null===K?null:{kind:"field",key:"field-".concat(w.name),name:w.name,index:k,open:(0,rR.Ny)(C,j.openPath),collapsible:!1,collapsed:!1,field:K}}{if(!(void 0===O||Array.isArray(O))){let H=(0,a3.wq)(O);return{kind:"error",key:w.name,fieldName:w.name,error:{type:"INCOMPATIBLE_TYPE",expectedSchemaType:w.type,resolvedValueType:H,value:O}}}let $=null==(f=null==(h=j.fieldGroupState)?void 0:h.children)?void 0:f[w.name],X=null==(g=null==(m=j.collapsedPaths)?void 0:m.children)?void 0:g[w.name],W=null==(v=null==(x=j.collapsedFieldSets)?void 0:x.children)?void 0:v[w.name],G=j.readOnly||F_(w.type.readOnly,{value:O,parent:j.value,document:j.document,currentUser:j.currentUser}),Y=function(e){if(20===e.level)return null;let t={comparisonValue:e.comparisonValue,value:e.value,parent:e.parent,document:e.document,currentUser:e.currentUser},n=F_(e.schemaType.hidden,t);if(n)return null;let i=e.readOnly||F_(e.schemaType.readOnly,t),r=Array.isArray(e.value)?e.value:[],l=e.presence.filter(t=>(0,rR.Xy)(t.path,e.path)),a=e.validation.filter(t=>(0,rR.Xy)(t.path,e.path)).map(e=>({level:e.level,message:e.item.message,path:e.path})),o=r.flatMap((t,n)=>(function(e){var t,n;let{arrayItem:i,parent:r,index:l}=e,a=function(e,t){let n=(0,a3.wq)(t);return null==e?void 0:e.of.find(e=>e.name===n||e.jsonType===n)}(r.schemaType,i),o=(0,rR.s6)([...r.path,l]),s=null==(t=r.value)?void 0:t[l],d=null==(n=r.comparisonValue)?void 0:n[l],c=r.level+1,u="".concat((null==a?void 0:a.name)||"invalid-type","-").concat(String(l));if(!a)return{kind:"error",key:u,index:l,error:{type:"INVALID_ITEM_TYPE",validTypes:r.schemaType.of,resolvedValueType:(0,a3.wq)(a),value:s}};let p=r.readOnly||F_(a.readOnly,{value:s,parent:r.value,document:r.document,currentUser:r.currentUser}),h=Fz(d6(d6({},r),{},{path:o,schemaType:a,level:c,value:s,comparisonValue:d,readOnly:p}));return{kind:"item",key:u,index:l,parentSchemaType:r.schemaType,open:(0,rR.Xy)(o,r.openPath),item:h}})({arrayItem:t,parent:e,index:n}));return{changed:o.some(e=>"item"===e.kind&&e.item.changed),value:e.value,readOnly:i,schemaType:e.schemaType,focused:(0,rR.Xy)(e.path,e.focusPath),focusPath:(0,rR.vC)(e.path,e.focusPath),path:e.path,id:(0,rR.BB)(e.path),level:e.level,validation:a,presence:l,members:o}}({changed:FP(O,D),comparisonValue:D,schemaType:w.type,parent:j.value,currentUser:j.currentUser,document:j.document,value:O,fieldGroupState:$,focusPath:j.focusPath,openPath:j.openPath,presence:j.presence,validation:j.validation,collapsedPaths:X,collapsedFieldSets:W,level:_,path:C,readOnly:G});return null===Y?null:{kind:"field",key:"field-".concat(w.name),name:w.name,index:k,open:(0,rR.Ny)(C,j.openPath),collapsible:!1,collapsed:!1,field:Y}}}{let J=null==S?void 0:S[w.name],Q=cC(E)?null==E?void 0:E[w.name]:void 0,ee={value:J,parent:j.value,document:j.document,currentUser:j.currentUser},et=F_(w.type.hidden,ee);if(et)return null;let en=j.readOnly||F_(w.type.readOnly,ee),ei=Fz(d6(d6({},j),{},{comparisonValue:Q,value:J,schemaType:w.type,path:C,readOnly:en}));return{kind:"field",key:"field-".concat(w.name),name:w.name,index:k,open:(0,rR.Ny)(C,j.openPath),collapsible:!1,collapsed:!1,field:ei}}}function FM(e){var t;let n=!(arguments.length>1)||void 0===arguments[1]||arguments[1];if(20===e.level)return null;let i={value:e.value,parent:e.parent,document:e.document,currentUser:e.currentUser},r=n&&F_(e.schemaType.hidden,i);if(r)return null;let l=e.readOnly||F_(e.schemaType.readOnly,i),a=e.schemaType.groups||[],o=null==(t=a.find(e=>e.default)||FE)?void 0:t.name,s=[FE,...a].flatMap(t=>{var n;let r=F_(t.hidden,i),l=t.name===((null==(n=e.fieldGroupState)?void 0:n.value)||o),a=e.changesOpen&&t.name===FE.name||l;return r?[]:[{icon:null==t?void 0:t.icon,name:t.name,selected:a,title:t.title}]}),d=s.find(e=>e.selected),c=d6(d6({},e),{},{hidden:r,readOnly:l}),u=e.schemaType.fieldsets?e.schemaType.fieldsets:e.schemaType.fields.map(e=>({single:!0,field:e})),p=u.flatMap((t,n)=>{var i,r,a,o;if(t.single){let u=FI({field:t.field,parent:c,index:n});return null!==u&&FT(s,t.field,d)?[u]:[]}let p=t.fields.map(e=>e.name),h=F_(t.hidden,{currentUser:e.currentUser,document:e.document,parent:e.value,value:o$()(e.value,p)});if(h)return[];let f=F_(t.readOnly,{currentUser:e.currentUser,document:e.document,parent:e.value,value:o$()(e.value,p)}),m=t.fields.flatMap(e=>{let t=FI({field:e,parent:c,index:n});if(null===t||!FT(s,e,d))return[];let i=d6(d6({},t),{},{field:d6(d6({},null==t?void 0:t.field),{},{readOnly:l||f})});return[i]});if(0===m.length)return[];let g=FS(t.options,e.level),x=null!=(a=null==(r=((null==(i=e.collapsedFieldSets)?void 0:i.children)||{})[t.name])?void 0:r.value)?a:g.collapsed;return[{kind:"fieldSet",key:"fieldset-".concat(t.name),fieldSet:{path:(0,rR.s6)(e.path.concat(t.name)),name:t.name,title:t.title,description:t.description,hidden:!1,level:e.level+1,members:m,collapsible:null==g?void 0:g.collapsible,collapsed:x,columns:null==(o=null==t?void 0:t.options)?void 0:o.columns}}]}),h=a.length>0,f=e.presence.filter(t=>(0,rR.Xy)(t.path,e.path)),m=e.validation.filter(t=>(0,rR.Xy)(t.path,e.path)).map(e=>({level:e.level,message:e.item.message,path:e.path}));if(0===p.length&&n)return null;let g=h?s.map(t=>d6(d6({},t),{},{disabled:(null==e?void 0:e.changesOpen)&&t.name!==FE.name})):[];return{value:e.value,changed:FP(e.value,e.comparisonValue),schemaType:e.schemaType,readOnly:e.readOnly||l,path:e.path,id:(0,rR.BB)(e.path),level:e.level,focused:(0,rR.Xy)(e.path,e.focusPath),focusPath:(0,rR.vC)(e.path,e.focusPath),presence:f,validation:m,members:p,groups:g}}function Fz(e){let t=e.presence.filter(t=>(0,rR.Xy)(t.path,e.path)),n=e.validation.filter(t=>(0,rR.Xy)(t.path,e.path)).map(e=>({level:e.level,message:e.item.message,path:e.path}));return{schemaType:e.schemaType,changed:FP(e.value,e.comparisonValue),value:e.value,level:e.level,id:(0,rR.BB)(e.path),readOnly:e.readOnly,focused:(0,rR.Xy)(e.path,e.focusPath),path:e.path,presence:t,validation:n}}function FR(e,t){let{comparisonValue:n,value:i,fieldGroupState:r,collapsedFieldSets:l,collapsedPaths:a,focusPath:o,openPath:s,presence:d,validation:c,readOnly:u,changesOpen:p}=t,h=Mi(),f=(0,rF.useRef)(null);return(0,rF.useLayoutEffect)(()=>{f.current=null},[e]),(0,rF.useMemo)(()=>{let t=FM({schemaType:e,document:i,fieldGroupState:r,collapsedFieldSets:l,collapsedPaths:a,value:i,comparisonValue:n,focusPath:o,openPath:s,readOnly:u,path:(0,rR.s6)([]),level:0,currentUser:h,presence:d,validation:c,changesOpen:p}),m=jB(f.current,t);return f.current=m,m},[e,i,r,l,a,n,o,s,h,d,c,p])}function FF(e){return e.map(FZ)}function FO(e,t){return aH()(t.map(t=>aH()(Object.keys(t).filter(FD(["id","ifRevisionID","query"])).map(n=>{if("unset"===n)return t.unset.map(t=>({type:"unset",path:gy(t),origin:e}));if("insert"===n){let i="before"in t.insert?"before":"after";return{type:"insert",position:i,path:gy(t.insert[i]),items:t.insert.items,origin:e}}return Object.keys(t[n]).map(i=>"set"===n?{type:"set",path:gy(i),value:t[n][i],origin:e}:"inc"===n||"dec"===n?{type:n,path:gy(i),value:t[n][i],origin:e}:"setIfMissing"===n?{type:"setIfMissing",path:gy(i),value:t[n][i],origin:e}:"diffMatchPatch"===n?{type:n,path:gy(i),value:t[n][i],origin:e}:(console.warn(Error("Unsupported patch type: ".concat(n))),null)).filter(Boolean)}))))}let FD=e=>t=>!e.includes(t);function FZ(e){if(e.patchType!==p1&&e.type)throw Error('Patch is missing "patchType" - import and use "'.concat(e.type,'()" from "sanity/form"'));if(e.patchType!==p1)throw Error('Patch is missing "patchType" - import and use the patch method helpers from "sanity/form"');let t=(0,oW.kC)(e.path||[]);if("insert"===e.type){let{position:n,items:i}=e;return{insert:{[n]:t,items:i}}}if("unset"===e.type)return{unset:[t]};if(!e.type)throw Error("Missing patch type in patch ".concat(JSON.stringify(e)));return t?{[e.type]:{[t]:e.value}}:{[e.type]:e.value}}(0,rF.memo)(function(e){let{transform:t}=e,n=hp(),i=(0,rF.useCallback)(e=>{let i=e.patches,r=t(i);n.onChange(p6.from(r))},[n,t]),r=(0,rF.useMemo)(()=>d6(d6({},n),{},{onChange:i}),[n,i]);return(0,rz.jsx)(hc.Provider,{value:r,children:e.children})}),rN.Lg.fonts.code.family,rN.Lg.fonts.text.family,aT.Sn.hex,aT.ix.hex,aT.iN[500].hex,aT.ix.hex,aT.Sn.hex,aT.MA[500].hex,aT.MA[500].hex,aT.MA[500].hex,aT.Q6[500].hex,aT.iN[500].hex,aT.ek[500].hex,aT.er[500].hex,aT.iN[500].hex,aT.iN[500].hex,aT.ek[500].hex,aT.er[500].hex,aT.Q6[500].hex,aT.Sn.hex,aT.ix.hex;let FL=d6(d6({},rN.Lg),{},{focusRing:{offset:-1,width:2}})}}]);