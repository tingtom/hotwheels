"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[541],{34006:function(e,t,n){n.d(t,{P:function(){return h}});var r=n(85893),i=n(40168),o=n(92212),l=n(11636),c=n(67294),u=n(32932),s=n(34527);function a(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function d(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?a(Object(n),!0).forEach(function(t){var r,i;r=e,i=n[t],t in r?Object.defineProperty(r,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):r[t]=i}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}n(57557),n(64927),n(933);let f=(e,t)=>({title:(0,r.jsxs)("em",{children:["No schema found for type ",(0,r.jsx)("code",{children:t})]}),subtitle:(0,r.jsxs)("em",{children:["Document: ",(0,r.jsx)("code",{children:e})]}),media:()=>(0,r.jsx)(i.foC,{})});function p(e){let{layout:t,value:n}=e;return(0,r.jsx)(u.ogX,d(d({},f(n._id,n._type)),{},{layout:t}))}function m(e,t,n){return!1!==e&&(e||t&&t.icon||n||!1)}function h(e){let{icon:t,id:n,layout:a="default",pressed:f,schemaType:h,selected:j,title:g,value:y}=e,b=(0,u.I_y)(),x=(0,u.rq_)(),{ChildLink:v}=(0,s.i)(),O=(0,u.Dqo)(n),w=Boolean(h&&h.name&&b.get(h.name)),[P,_]=(0,c.useState)(!1),k=(0,c.useMemo)(()=>y&&(0,o.Si)(y)?h&&w?(0,r.jsx)(s.r,{documentPreviewStore:x,icon:m(t,h,i.$lS),layout:a,schemaType:h,value:y,presence:O}):(0,r.jsx)(p,{value:y}):(0,r.jsx)(u.ogX,{status:(0,r.jsx)(l.xv,{muted:!0,children:(0,r.jsx)(i.XCv,{})}),icon:m(t,h,i.ROc),layout:a,title:g}),[x,w,t,a,h,g,y,O]),C=(0,c.useMemo)(()=>function(e){return(0,r.jsx)(v,d(d({},e),{},{childId:n}))},[v,n]),D=(0,c.useCallback)(()=>_(!0),[]);return(0,c.useEffect)(()=>_(!1),[j]),(0,r.jsx)(u.oUE,{__unstable_focusRing:!0,as:C,"data-as":"a","data-ui":"PaneItem",padding:2,radius:2,onClick:D,pressed:f,selected:j||P,tone:"inherit",children:k})}},31541:function(e,t,n){n.r(t),n.d(t,{default:function(){return A}});var r=n(85893),i=n(67294),o=n(11636),l=n(38993),c=n.n(l),u=n(40168);n(933);var s=n(34527),a=n(2102),d=n(64927),f=n(92212),p=n(32932),m=n(34006);n(57557),n(81763),n(47037),n(28440);var h=n(70211),j=n(14370),g=n(18170),y=n(60429),b=n(57027),x=n(55709),v=n(41931),O=n(31762),w=n(3018),P=n(96381),_=n(89095),k=n(81030),C=n(1558),D=n(43485),T=n(40486),E=n(51015),M=n(33756),S=n(22807),W=n(66008),R=n(69590),$=n.n(R);function B(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function L(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?B(Object(n),!0).forEach(function(t){var r,i;r=e,i=n[t],t in r?Object.defineProperty(r,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):r[t]=i}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):B(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}n(74855),n(43174),n(45578),n(68929),n(44908),n(21804),n(35937),n(13311),n(73955),n(5560),n(18029),n(18446),n(18156),n(30222),n(11700),n(34391),n(70248),n(94885);let q={by:[{field:"_updatedAt",direction:"desc"}]},I={};function X(e,t){return e._id?(0,p.vsM)(e._id):"item-".concat(t)}let z=/\b_type\s*==\s*(['"].*?['"]|\$.*?(?:\s|$))|\B(['"].*?['"]|\$.*?(?:\s|$))\s*==\s*_type\b/;function N(e){let{childItemId:t,error:n,filterIsSimpleTypeContraint:l,fullList:c,isActive:d,isLoading:f,items:h,layout:j,onListChange:g,onRetry:y,showIcons:b}=e,x=(0,p.I_y)(),{collapsed:v}=(0,s.n)(),{collapsed:O,index:w}=(0,s.k)(),[P,_]=(0,i.useState)(!1);(0,i.useEffect)(()=>{if(O)return;let e=setTimeout(()=>{_(!0)},0);return()=>{clearTimeout(e)}},[O]);let k=(0,i.useCallback)(e=>{let n=(0,p.vsM)(e._id),i=t===n;return(0,r.jsx)(m.P,{icon:!1!==b&&void 0,id:n,pressed:!d&&i,selected:d&&i,layout:j,schemaType:x.get(e._type),value:e})},[t,d,j,x,b]),C=(0,i.useMemo)(()=>{if(!P)return null;if(n)return(0,r.jsx)(o.kC,{align:"center",direction:"column",height:"fill",justify:"center",children:(0,r.jsx)(o.W2,{width:1,children:(0,r.jsxs)(o.Kq,{paddingX:4,paddingY:5,space:4,children:[(0,r.jsx)(o.X6,{as:"h3",children:"Could not fetch list items"}),(0,r.jsxs)(o.xv,{as:"p",children:["Error: ",(0,r.jsx)("code",{children:n.message})]}),y&&(0,r.jsx)(o.xu,{children:(0,r.jsx)(o.zx,{icon:u.bnu,onClick:y,text:"Retry",tone:"primary"})})]})})});if(null===h)return(0,r.jsx)(o.kC,{align:"center",direction:"column",height:"fill",justify:"center",children:(0,r.jsx)(a.b,{ms:300,children:(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(o.$j,{muted:!0}),(0,r.jsx)(o.xu,{marginTop:3,children:(0,r.jsx)(o.xv,{align:"center",muted:!0,size:1,children:"Loading documents…"})})]})})});if(!f&&0===h.length)return(0,r.jsx)(o.kC,{align:"center",direction:"column",height:"fill",justify:"center",children:(0,r.jsx)(o.W2,{width:1,children:(0,r.jsx)(o.xu,{paddingX:4,paddingY:5,children:(0,r.jsx)(o.xv,{align:"center",muted:!0,size:2,children:l?"No documents of this type":"No matching documents"})})})});let e=c&&2e3===h.length;return(0,r.jsxs)(o.xu,{padding:2,children:[h.length>0&&(0,r.jsx)(o.CP,{gap:1,getItemKey:X,items:h,renderItem:k,onChange:g},"".concat(w,"-").concat(O)),f&&(0,r.jsx)(o.Zb,{borderTop:!0,marginTop:1,paddingX:3,paddingY:4,children:(0,r.jsx)(o.xv,{align:"center",muted:!0,size:1,children:"Loading…"})}),e&&(0,r.jsx)(o.Zb,{marginTop:1,paddingX:3,paddingY:4,radius:2,tone:"transparent",children:(0,r.jsxs)(o.xv,{align:"center",muted:!0,size:1,children:["Displaying a maximum of ",2e3," documents"]})})]})},[n,l,c,g,f,h,y,k,P,O,w]);return(0,r.jsx)(s.h,{overflow:v?void 0:"auto",children:C})}let Y=(0,i.memo)(e=>{let{index:t,initialValueTemplates:n=[],menuItems:l=[],menuItemGroups:c=[],setLayout:d,setSortOrder:f,title:p}=e,{features:m}=(0,a.u)(),h=(0,i.useMemo)(()=>({setLayout:e=>{let{layout:t}=e;d(t)},setSortOrder:e=>{f(e)}}),[d,f]);return(0,r.jsx)(s.g,{backButton:m.backButton&&t>0&&(0,r.jsx)(o.zx,{as:s.B,"data-as":"a",icon:u.Y4O,mode:"bleed"}),title:p,actions:(0,r.jsx)(s.q,{initialValueTemplateItems:n,actionHandlers:h,menuItemGroups:c,menuItems:l})})});Y.displayName="DocumentListPaneHeader";let K={result:null,error:!1},U=e=>({result:{documents:e},loading:!1,error:!1}),F=e=>({result:null,loading:!1,error:e}),V=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=new h.xQ,r=n.next.bind(n),i=e.pipe((0,x.U)(e=>({client:e.client,query:e.query,params:e.params})),(0,v.x)($()),(0,O._)(1),(0,w.x)()),o=i.pipe((0,P.w)(e=>{let n=(0,p.OPK)(e.client,e.query,e.params,t).pipe((0,x.U)(U),(0,_.B)());return(0,j.T)((0,g.of)({loading:!0}).pipe((0,k.g)(400),(0,C.R)(n)),n)}));return o.pipe((0,D.O)(K),(0,T.K)((e,t)=>(0,y.z)((0,g.of)(F(e)),(0,j.T)((0,b.R)(window,"online"),n).pipe((0,E.q)(1),(0,M.j)(t)))),(0,S.R)((e,t)=>L(L(L({},e),t),{},{onRetry:r})))},Z=[],A=(0,i.memo)(function(e){let{childItemId:t,index:n,isActive:o,isSelected:l,pane:u,paneKey:m}=e,h=(0,p.I_y)(),{name:j}=(0,p.Lky)(),{defaultLayout:y="default",displayOptions:b,initialValueTemplates:x=Z,menuItems:v,menuItemGroups:O,options:w,title:P}=u,{apiVersion:_,defaultOrdering:k=Z,filter:C}=w,D=function(e){let t=(0,i.useRef)(e);return c()(t.current,e)||(t.current=e),t.current}(w.params||I),T=u.source,E=(0,i.useMemo)(()=>(function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=e.match(z);if(!n)return null;let r=(n[1]||n[2]).trim().replace(/^["']|["']$/g,"");if("$"===r[0]){let i=r.slice(1),o=t[i];return"string"==typeof o?o:null}return r})(C,D),[C,D]),M=(null==b?void 0:b.showIcons)!==!1,[S,R]=(0,a.c)(E,"layout",y),$=(0,i.useMemo)(()=>(null==k?void 0:k.length)>0?{by:k}:q,[k]),[B,X]=(0,a.c)(E,"sortOrder",$),K=E&&B?function(e,t){let n=e.by.map(e=>{if(e.mapWith)return e;let n=function(e,t){let n=d.mL(t),r=e;for(let i of n){if(!r)return;if("string"==typeof i){r=function(e,t){if(!("fields"in e))return;let n=e.fields.find(e=>e.name===t);return n?n.type:void 0}(r,i);continue}let o=(0,f.Fd)(i)||(0,f.dw)(i);if(!o||"array"!==r.jsonType)return;let[l,c]=r.of||[];if(c||!l)return;if(!(0,f.dD)(l)){r=l;continue}let[u,s]=l.to||[];if(s||!u)return;r=u}return r}(t,e.field);return n?!function(e,t){let n=e.type;for(;n;){if(n.name===t||!n.type&&n.jsonType===t)return!0;n=n.type}return!1}(n,"datetime")?"string"===n.jsonType?L(L({},e),{},{mapWith:"lower"}):e:L(L({},e),{},{mapWith:"dateTime"}):e});return n.every((t,n)=>t===e.by[n])?e:L(L({},e),{},{by:n})}(B,h.get(E)):B,U=(0,p.BoV)(K),F=/^_type\s*==\s*['"$]\w+['"]?\s*$/.test(C.trim()),{error:A,fullList:H,handleListChange:Q,isLoading:G,items:J,onRetry:ee}=function(e){var t;let{apiVersion:n,filter:r,params:o,sortOrder:l}=e,c=(0,p.m85)(p.Dr7),[u,s]=(0,i.useState)(!1),a=(0,i.useRef)(u),[d,f]=(0,i.useState)(null),m=(null==d?void 0:d.error)||null,h=(null==d?void 0:d.loading)||null===d,j=null==d?void 0:d.onRetry,y=null==(t=null==d?void 0:d.result)?void 0:t.documents,b=(0,i.useMemo)(()=>y?(0,p.RgL)(y).map(e=>{let t=e.draft||e.published;return L(L({},t),{},{hasPublished:!!e.published,hasDraft:!!e.draft})}):null,[y]),x=(0,i.useMemo)(()=>{let e=null==l?void 0:l.extendedProjection,t=["_id","_type"],n=t.join(","),i=(null==l?void 0:l.by)||[],o=u?2e3:100,c=i.length>0?i:q.by,s=c.map(e=>[e.mapWith?"".concat(e.mapWith,"(").concat(e.field,")"):e.field,(e.direction||"").toLowerCase()].map(e=>e.trim()).filter(Boolean).join(" ")).join(",");if(e){let a=t.concat(e).join(",");return["*[".concat(r,"] {").concat(a,"}"),"order(".concat(s,") [0...").concat(o,"]"),"{".concat(n,"}")].join("|")}return"*[".concat(r,"]|order(").concat(s,")[0...").concat(o,"]{").concat(n,"}")},[r,u,l]),v=(0,i.useCallback)(e=>{let{toIndex:t}=e;h||a.current||!(t>=50)||(s(!0),a.current=!0)},[h]);return(0,i.useEffect)(()=>{f(e=>e?L(L({},e),{},{loading:!0}):null);let e=V((0,g.of)({client:c,query:x,params:o}),{apiVersion:n,tag:"desk.document-list"}).pipe((0,W.h)(u?e=>Boolean(e.result):()=>!0)),t=e.subscribe(f);return()=>t.unsubscribe()},[n,c,u,x,o]),(0,i.useEffect)(()=>{f(null),s(!1),a.current=!1},[r,o,l,n]),{error:m,fullList:u,handleListChange:v,isLoading:h,items:b,onRetry:j}}({filter:C,params:D,sortOrder:U,apiVersion:_});return(0,r.jsx)(p.cWh,{name:T||j,children:(0,r.jsxs)(s.f,{currentMaxWidth:350,id:m,maxWidth:640,minWidth:320,selected:l,children:[s._,(0,r.jsx)(Y,{index:n,initialValueTemplates:x,menuItems:v,menuItemGroups:O,setLayout:R,setSortOrder:X,title:P}),(0,r.jsx)(N,{childItemId:t,error:A,filterIsSimpleTypeContraint:F,fullList:H,isActive:o,isLoading:G,items:J,layout:S,onListChange:Q,onRetry:ee,showIcons:M})]})})})}}]);